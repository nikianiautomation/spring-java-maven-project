/*! For license information please see widget.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(()=>(()=>{var __webpack_modules__={4537:e=>{"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,i=2,o=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},7419:(e,t)=>{"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),i=new Array(123),o=0;o<64;)i[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,n){for(var i,o=null,a=[],s=0,c=0;t<n;){var l=e[t++];switch(c){case 0:a[s++]=r[l>>2],i=(3&l)<<4,c=1;break;case 1:a[s++]=r[i|l>>4],i=(15&l)<<2,c=2;break;case 2:a[s++]=r[i|l>>6],a[s++]=r[63&l],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=r[i],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";n.decode=function(e,t,n){for(var r,o=n,s=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&s>1)break;if(void 0===(l=i[l]))throw Error(a);switch(s){case 0:r=l,s=1;break;case 1:t[n++]=r<<2|(48&l)>>4,r=l,s=2;break;case 2:t[n++]=(15&r)<<4|(60&l)>>2,r=l,s=3;break;case 3:t[n++]=(3&r)<<6|l,s=0}}if(1===s)throw Error(a);return n-o},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},5124:e=>{"use strict";function t(e,n){"string"==typeof e&&(n=e,e=void 0);var r=[];function i(e){if("string"!=typeof e){var n=o();if(t.verbose&&console.log("codegen: "+n),n="return "+n,e){for(var a=Object.keys(e),s=new Array(a.length+1),c=new Array(a.length),l=0;l<a.length;)s[l]=a[l],c[l]=e[a[l++]];return s[l]=n,Function.apply(null,s).apply(null,c)}return Function(n)()}for(var d=new Array(arguments.length-1),u=0;u<d.length;)d[u]=arguments[++u];if(u=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var n=d[u++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"})),u!==d.length)throw Error("parameter count mismatch");return r.push(e),i}function o(t){return"function "+(t||n||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return i.toString=o,i}e.exports=t,t.verbose=!1},9211:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},9054:(e,t,n)=>{"use strict";e.exports=o;var r=n(4537),i=n(7199)("fs");function o(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&i&&i.readFile?i.readFile(e,(function(r,i){return r&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString("utf8"))})):o.xhr(e,t,n):r(o,this,e,t)}o.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(255&r.responseText.charCodeAt(i))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},945:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function a(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=a.bind(null,i),e.readFloatBE=a.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function a(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,l=4294967296*(1048575&a)+o;return 2047===c?l?NaN:s*(1/0):0===c?5e-324*s*l:s*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=a.bind(null,i,0,4),e.readDoubleBE=a.bind(null,o,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},8626:(e,t)=>{"use strict";var n=t,r=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},i=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=r(e),i="";n&&(i=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):n?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return i+t.join("/")};n.resolve=function(e,t,n){return n||(t=i(t)),r(t)?t:(n||(e=i(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t)}},6662:e=>{"use strict";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},4997:(e,t)=>{"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},n.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},3007:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),o=n(3645),a=n.n(o)()(i());a.push([e.id,".saleassist-client-hyderabad-governemnt{width:100vw;height:100dvh;overflow:auto}.saleassist-client-hyderabad-governemnt .sa-live-call-widget-close-expanded-widget-btn{display:none !important}.saleassist-client-hyderabad-governemnt #peopleImage{position:absolute;bottom:0;left:0;width:100%;z-index:-1}.saleassist-client-hyderabad-governemnt-form{width:100%;display:flex;flex-direction:column;gap:20px;padding:20px}.saleassist-client-hyderabad-governemnt-form p:first-child{margin:5px 0 15px 0}.saleassist-client-hyderabad-governemnt-form p:nth-child(2),.saleassist-client-hyderabad-governemnt-form p:nth-child(4){display:none}.saleassist-client-hyderabad-governemnt-form p{font-size:18px;font-weight:500;text-align:center}.saleassist-client-hyderabad-governemnt-form #boothSearchBox,.saleassist-client-hyderabad-governemnt-form #districtDropdown,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown,.saleassist-client-hyderabad-governemnt-form #boothDropdown,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown,.saleassist-client-hyderabad-governemnt-form #polledVotesBox{position:relative}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-search,.saleassist-client-hyderabad-governemnt-form #districtDropdown-search,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-search,.saleassist-client-hyderabad-governemnt-form #boothDropdown-search,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-search,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-search{position:absolute;top:50%;right:18px;transform:translateY(-50%);display:flex;font-size:18px;padding:4px;background:#e1e1e1;border-radius:8px;cursor:pointer}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-arrow,.saleassist-client-hyderabad-governemnt-form #districtDropdown-arrow,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-arrow,.saleassist-client-hyderabad-governemnt-form #boothDropdown-arrow,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-arrow,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-arrow{position:absolute;top:50%;right:5px;transform:translateY(-50%);display:flex;padding:5px 2px;cursor:pointer}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-arrow #arrow-up,.saleassist-client-hyderabad-governemnt-form #boothSearchBox-arrow #arrow-down,.saleassist-client-hyderabad-governemnt-form #districtDropdown-arrow #arrow-up,.saleassist-client-hyderabad-governemnt-form #districtDropdown-arrow #arrow-down,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-arrow #arrow-up,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-arrow #arrow-down,.saleassist-client-hyderabad-governemnt-form #boothDropdown-arrow #arrow-up,.saleassist-client-hyderabad-governemnt-form #boothDropdown-arrow #arrow-down,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-arrow #arrow-up,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-arrow #arrow-down,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-arrow #arrow-up,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-arrow #arrow-down{font-size:18px}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-input,.saleassist-client-hyderabad-governemnt-form #districtDropdown-input,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-input,.saleassist-client-hyderabad-governemnt-form #boothDropdown-input,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-input,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-input{width:100%;font-size:16px;padding:10px 28px 10px 10px;outline:none;border:1px solid #ccc;border-radius:5px}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-input:disabled,.saleassist-client-hyderabad-governemnt-form #districtDropdown-input:disabled,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-input:disabled,.saleassist-client-hyderabad-governemnt-form #boothDropdown-input:disabled,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-input:disabled,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-input:disabled{background:#f1f1f1}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-datalist,.saleassist-client-hyderabad-governemnt-form #districtDropdown-datalist,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-datalist,.saleassist-client-hyderabad-governemnt-form #boothDropdown-datalist,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-datalist,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-datalist{position:absolute;width:100%;max-height:250px;background:#f6f6f6;border:1px solid #ccc;border-radius:5px;overflow:auto;z-index:1}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-datalist div,.saleassist-client-hyderabad-governemnt-form #districtDropdown-datalist div,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-datalist div,.saleassist-client-hyderabad-governemnt-form #boothDropdown-datalist div,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-datalist div,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-datalist div{padding:10px;font-size:14px;cursor:pointer}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-datalist div:hover,.saleassist-client-hyderabad-governemnt-form #districtDropdown-datalist div:hover,.saleassist-client-hyderabad-governemnt-form #assemblyDropdown-datalist div:hover,.saleassist-client-hyderabad-governemnt-form #boothDropdown-datalist div:hover,.saleassist-client-hyderabad-governemnt-form #issueTypeDropdown-datalist div:hover,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-datalist div:hover{background:#ddd}.saleassist-client-hyderabad-governemnt-form #boothSearchBox,.saleassist-client-hyderabad-governemnt-form #polledVotesBox{padding:8px;background:rgba(3,141,70,.2);border-radius:4px}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-input,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-input{padding:10px 42px 10px 10px}.saleassist-client-hyderabad-governemnt-form #boothSearchBox-datalist,.saleassist-client-hyderabad-governemnt-form #polledVotesBox-datalist{width:calc(100% - 16px)}.saleassist-client-hyderabad-governemnt-form #boothSearchBox{display:none}.saleassist-client-hyderabad-governemnt-form #issueDescriptionText{position:relative}.saleassist-client-hyderabad-governemnt-form #issueDescriptionText-textarea{width:100%;height:100px;outline:none;border:1px solid #ccc;border-radius:5px;padding:12px;font-size:16px}.saleassist-client-hyderabad-governemnt-form #submitButton{position:relative;margin-top:20px}.saleassist-client-hyderabad-governemnt-form #submitButton #errorMsg{position:absolute;top:-20px;width:100%;text-align:center;font-size:12.5px;color:red}.saleassist-client-hyderabad-governemnt-form #submitButton-button{width:100%;padding:12px;font-size:16px;border:none;border-radius:5px;color:var(--invertColor);background:var(--themeColor);cursor:pointer}.saleassist-client-hyderabad-governemnt .select-booth-title{text-align:left !important;font-size:15px !important}.saleassist-client-hyderabad-governemnt .hyderabad-govt-form-wrapper,.saleassist-client-hyderabad-governemnt .booth-form-wrapper{display:flex;flex-direction:column;gap:20px;padding:8px;border-radius:4px}.saleassist-client-hyderabad-governemnt .hyderabad-govt-form-wrapper{background:rgba(3,141,70,.2)}.saleassist-client-hyderabad-governemnt .booth-form-wrapper{background:rgba(30,144,255,.2784313725)}.saleassist-client-hyderabad-governemnt .sa-live-call-widget-expanded-cta-btn-wrapper-2{flex-direction:column !important;align-items:center !important}.saleassist-client-hyderabad-governemnt .sa-live-call-widget-expanded-cta-btn-wrapper-2 .sa-btn-cta-icon-box-expanded{width:180px !important;height:48px !important}.saleassist-client-hyderabad-governemnt .sa-live-call-widget-expanded-cta-btn-wrapper-2 .sa-btn-cta-icon-box-expanded svg{width:22px !important;height:22px !important}.saleassist-client-hyderabad-governemnt .sa-live-call-widget-expanded-cta-btn-wrapper-2 .sa-btn-cta-icon-box-expanded span{font-size:16px !important}.saleassist-client-hyderabad-governemnt .sa-live-call-widget-expanded{width:100%;height:100%}",""]);const s=a},384:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),o=n(3645),a=n.n(o)()(i());a.push([e.id,".saleassist-client-hyderabad-governemnt-thankyou{height:100%;display:flex;flex-direction:column;padding:60px 30px;place-content:center;place-items:center;gap:20px}.saleassist-client-hyderabad-governemnt-thankyou #thankyou-page-title{color:#333}.saleassist-client-hyderabad-governemnt-thankyou #thankyou-page-subTitle{font-size:14px;color:#555}.saleassist-client-hyderabad-governemnt-thankyou #thankyou-page-goBack{width:50%;padding:10px;margin-top:20px;font-size:14px;font-weight:500;border:none;border-radius:8px;background:var(--themeColor);color:var(--invertColor);cursor:pointer}.saleassist-client-hyderabad-governemnt-thankyou #thankyou-page-peopleImage{position:absolute;bottom:0;left:0;width:100%;z-index:-1}",""]);const s=a},8869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),o=n(3645),a=n.n(o)()(i());a.push([e.id,".saleassist-client-hyderabad-governemnt-home{height:100vh;display:flex;flex-direction:column;place-items:center;gap:20px;padding:60px 30px}.saleassist-client-hyderabad-governemnt-home #languageBox{position:absolute;top:15px;right:15px;display:flex;gap:10px}.saleassist-client-hyderabad-governemnt-home #languageBox label{font-size:13px;font-weight:600;color:#888;cursor:pointer}.saleassist-client-hyderabad-governemnt-home #languageBox input[type=radio]{display:none}.saleassist-client-hyderabad-governemnt-home #languageBox input[type=radio]:checked+label{color:#333}.saleassist-client-hyderabad-governemnt-home #logo{width:100%;max-width:400px;margin-bottom:40px}.saleassist-client-hyderabad-governemnt-home #title{font-size:20px;font-weight:500}.saleassist-client-hyderabad-governemnt-home #description{text-align:justify;line-height:normal;color:#333}.saleassist-client-hyderabad-governemnt-home #mobileNumberContainer{width:100%;display:flex;flex-direction:column;place-items:center}.saleassist-client-hyderabad-governemnt-home #mobileNumberContainer-input{display:flex;gap:5px}.saleassist-client-hyderabad-governemnt-home #mobileNumberContainer-input #countryCode{width:50px;font-size:16px;padding:10px;outline:none;border:1px solid #ccc;border-radius:5px}.saleassist-client-hyderabad-governemnt-home #mobileNumberContainer-input #boothCountMobNumInput{width:100%;max-width:205px;font-size:16px;padding:10px;outline:none;border:1px solid #ccc;border-radius:5px}.saleassist-client-hyderabad-governemnt-home #mobileNumberContainer #errorMsg{color:red;font-size:14px;text-align:center;margin-top:5px}.saleassist-client-hyderabad-governemnt-home #startButton,.saleassist-client-hyderabad-governemnt-home #boothCountButton{width:100%;max-width:260px;margin-top:20px;font-size:16px;padding:12px;border:none;border-radius:8px;background:var(--themeColor);color:var(--invertColor);cursor:pointer}.saleassist-client-hyderabad-governemnt-home #boothCountButton{display:none}.saleassist-client-hyderabad-governemnt-home #peopleImage{position:absolute;bottom:0;left:0;width:100%;z-index:-1}",""]);const s=a},8235:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(8081),i=n.n(r),o=n(3645),a=n.n(o),s=n(3626),c=n.n(s),l=new URL(n(8090),n.b),d=new URL(n(1568),n.b),u=a()(i()),p=c()(l),h=c()(d);u.push([e.id,".sa-live-call-widget-call-waiting-container{background-color:#262626;background-position:center bottom;background-repeat:no-repeat;background-size:cover;border-top-left-radius:inherit;border-top-right-radius:inherit;text-align:center;padding:0px;height:100%}.sa-live-call-widget-call-waiting-container img,.sa-live-call-widget-call-waiting-container video{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.sa-live-call-widget-call-waiting-wrapper{position:relative;height:100%;background:linear-gradient(to top, rgb(0, 0, 0), transparent);z-index:1}.sa-live-call-widget-call-waiting-wrapper-content{display:flex;flex-direction:column;place-items:center;position:absolute;bottom:0px;width:100%}.sa-live-call-widget-call-waiting-wrapper-content .sa-lead-capture-prompt{display:block;width:100%}.sa-live-call-widget-call-waiting-wrapper-content .sa-lead-capture-prompt>div{background:rgba(0,0,0,0) !important;padding-top:0px !important}.sa-live-call-widget-call-waiting-wrapper-content .sa-lead-capture-prompt>div>div:nth-child(1),.sa-live-call-widget-call-waiting-wrapper-content .sa-lead-capture-prompt>div>div:nth-child(2){display:none !important}.sa-live-call-widget-call-waiting-title{width:100%;padding:10px 10px 16px;font-size:13px;line-height:normal;color:var(--sa-live-call-widget-text-color-primary)}.sa-live-call-widget-call-waiting-text{position:absolute;top:200px;left:50%;transform:translate(-50%, -50%);width:200px;height:200px;display:flex;place-content:center;place-items:center;color:var(--sa-live-call-widget-text-color-primary)}.sa-live-call-widget-call-waiting-text .ring{position:absolute;width:50px;height:50px;border-radius:50%;border:1px solid #28a745;animation:expand 3s ease-out infinite;opacity:0}.sa-live-call-widget-call-waiting-text .ring:nth-child(1){animation-delay:0s}.sa-live-call-widget-call-waiting-text .ring:nth-child(2){animation-delay:1s}.sa-live-call-widget-call-waiting-text .ring:nth-child(3){animation-delay:2s}.sa-live-call-widget-call-waiting-text .ring:nth-child(4){animation-delay:3s}.sa-live-call-widget-call-waiting-text .icon-video_call,.sa-live-call-widget-call-waiting-text .icon-audio_call{width:50px;height:50px;background-repeat:no-repeat;background-position:center;background-color:#28a745;border-radius:50%;z-index:1}.sa-live-call-widget-call-waiting-text .icon-video_call{background-image:url("+p+")}.sa-live-call-widget-call-waiting-text .icon-audio_call{background-image:url("+h+")}.sa-live-call-widget-call-waiting-text span:nth-child(2){font-size:20px;font-weight:600}.sa-live-call-widget-call-waiting-text span:nth-child(3){font-size:14px;font-weight:300}.sa-live-call-widget-call-waiting-container:has(.sa-live-call-widget-call-waiting-text) .sa-live-call-widget-call-waiting-wrapper{background:rgba(0,0,0,0)}.sa-live-call-widget-call-waiting-dialing{display:flex}.sa-live-call-widget-call-waiting-dialing .text,.sa-live-call-widget-call-waiting-dialing .dots{font-family:monospace !important;font-size:20px;line-height:normal;color:#fff}.sa-live-call-widget-call-waiting-dialing .dots{width:3ch;white-space:nowrap;border-right:1px solid;animation:typing 2s steps(3) infinite,blink-cursor .5s step-end infinite alternate;filter:drop-shadow(1px 2px 2px rgba(0, 0, 0, 0.6));overflow:hidden}@keyframes typing{0%{width:0}50%{width:3ch}100%{width:0}}@keyframes blink-cursor{from{border-right-color:rgba(0,0,0,0)}to{border-right-color:#000}}@keyframes expand{0%{transform:scale(0);opacity:1}50%{opacity:.5}100%{transform:scale(4);opacity:0}}",""]);const f=u},7892:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),o=n(3645),a=n.n(o)()(i());a.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap);"]),a.push([e.id,':root{--themeColor: #3684f2;--invertColor: #fff;--boxShadow: 4px 4px 15px rgba(0, 0, 0, 0.123);--saLiveWidgetBtnPosition: auto 20px 20px auto;--saLiveCallWidgetDefaultContainerPaddingTop: 15px;--themeColorWithOpacity: #3684f260;--themeColorWithFadeOpacity: #3684f20d;--sa-live-call-widget-old-font-family: "Inter", -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--sa-live-call-widget-font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", Arial, sans-serif;--sal-live-call-widget-text-sm: 14px;--sa-live-call-widget-background-primary: #fff;--sa-live-call-widget-background-secondary: #f5f5f5;--sa-live-call-widget-text-color-primary: #fff;--sa-live-call-widget-text-color-secondary: #101010;--sa-live-call-widget-text-color-info: #353535;--sa-live-call-widget-text-color-danger: #dc3545;--sa-live-call-widget-text-color-success: #198754;--sa-live-call-widget-placeholder-color-primary: #909090;--sa-live-call-widget-border-color-primary: #ddd;--sa-live-call-widget-border-color-info: #adadad}.saleassist *,.saleassist *::before,.saleassist *::after{margin:0px;padding:0;box-sizing:border-box;font-family:var(--sa-live-call-widget-font-family);line-height:1}.saleassist img,.saleassist video{max-width:100%;max-height:100%}.saleassist input,.saleassist input[type=number],.saleassist select{font-size:var(--sal-live-call-widget-text-sm) !important;max-width:100%}.saleassist input,.saleassist select,.saleassist textarea{border-width:1px;border-style:solid}.saleassist .sa-live-call-widget-lead-capture-form-radio-label{display:inline-block !important;font-size:14px !important}#sa-live-call-widget-lead-capture-form input::-webkit-input-placeholder,#sa-live-call-widget-feedback-form input::-webkit-input-placeholder{font-size:calc(var(--sal-live-call-widget-text-sm) - 1px);color:var(--sa-live-call-widget-placeholder-color-primary)}#sa-live-call-widget-lead-capture-form input::-moz-placeholder,#sa-live-call-widget-feedback-form input::-moz-placeholder{font-size:calc(var(--sal-live-call-widget-text-sm) - 1px);color:var(--sa-live-call-widget-placeholder-color-primary)}#sa-live-call-widget-lead-capture-form input :-ms-input-placeholder,#sa-live-call-widget-feedback-form input :-ms-input-placeholder{font-size:calc(var(--sal-live-call-widget-text-sm) - 1px);color:var(--sa-live-call-widget-placeholder-color-primary)}.sa-live-call-widget-expanded{height:576px;width:324px;position:fixed;flex-direction:column;z-index:2147483647 !important;border-radius:15px;inset:var(--saLiveWidgetBtnPosition);box-shadow:rgba(0,0,0,.2) 0px 2px 4px -1px,rgba(0,0,0,.14) 0px 4px 5px 0px,rgba(0,0,0,.12) 0px 1px 10px 0px;overflow:hidden;transform:scale(0);transform-origin:100% 100%;animation:sa-widget-panel-zoom-in .5s ease forwards;transition:all ease .5s;border:1px solid #ddd}@media(min-width: 1100px)and (max-width: 1500px){.sa-live-call-widget-expanded{height:500px;width:320px}}@media(max-width: 600px){.client-bc625866-ac2d-4c04-baf1-42f9fd1dbdaa .sa-live-call-widget-expanded{width:280px !important;height:450px !important}}@keyframes sa-widget-panel-zoom-in{to{transform:scale(1)}}.sa-live-call-widget-expanded.sa-live-call-widget-paybima-widget{width:375px !important;height:625px !important}.sa-live-call-widget-expanded-maximize{height:100%;width:100%;border-radius:0;inset:unset;bottom:0 !important;right:0 !important;position:fixed !important}.sa-live-call-widget-expanded-minimize-tile{width:120px;height:160px;border:1px solid var(--themeColor);box-shadow:0 0 12px 3px var(--themeColorWithOpacity)}.sa-live-call-widget-expanded-minimize-tile .mic-status-indicator,.sa-live-call-widget-expanded-minimize-tile .network-quality-info{display:none !important}.sa-live-call-widget-expanded-minimize-tile.audio_call{width:100px;height:50px;border-radius:50px}.sa-live-call-widget-expanded-minimize-tile.audio_call #saleassist-video-call-app #videoCallContainer #videoContainer #videoCallMainScreen #localUserPlaceholder,.sa-live-call-widget-expanded-minimize-tile.audio_call #saleassist-video-call-app #videoCallContainer #videoContainer #videoCallMainScreen #remoteUserPlaceholder{width:40px;height:40px;top:4px;left:4px;transform:unset;font-size:22px}.sa-live-call-widget-expanded-inner-wrapper{width:100%;height:100%;border-radius:inherit;background:var(--sa-live-call-widget-background-primary) !important}.sa-live-call-widget-expanded-inner-wrapper.sa-live-call-widget-powered-by-true{padding-bottom:21.5px !important}.sa-live-call-widget-chat-first-approach-btn,.sa-live-call-widget-watch-live-stream-btn{display:inline-flex;align-items:center;justify-content:center;gap:5px;background:var(--themeColor) !important;color:var(--invertColor) !important;font-size:14px;font-weight:bold;padding:8px 24px;border:none !important;border-radius:36px;box-shadow:rgba(0,0,0,.2) 0px 3px 3px -2px,rgba(0,0,0,.14) 0px 3px 4px 0px,rgba(0,0,0,.12) 0px 1px 8px 0px;cursor:pointer}.sa-live-call-widget-chat-first-approach-btn:hover,.sa-live-call-widget-chat-first-approach-btn:focus,.sa-live-call-widget-chat-first-approach-btn:active,.sa-live-call-widget-watch-live-stream-btn:hover,.sa-live-call-widget-watch-live-stream-btn:focus,.sa-live-call-widget-watch-live-stream-btn:active{background:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-expanded-cta-btn-wrapper{width:100%;display:flex;flex-direction:column;gap:10px;position:absolute;bottom:7%;left:50%;transform:translateX(-50%);z-index:2147483610 !important;text-align:center}.sa-live-call-widget-cta-text{font-size:.83em !important;color:#fff;margin-bottom:10px;padding:4px 8px;background:linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.sa-live-call-widget-expanded-cta-btn-wrapper-2{display:flex;gap:10px;justify-content:center}.sa-btn-cta-icon-box-expanded{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:space-around;padding:5px;color:var(--invertColor);background-color:var(--themeColor);min-width:77px;max-width:77px;height:67px;border-radius:10px;font-size:11px;font-weight:bold;text-align:center;cursor:pointer;z-index:1024;user-select:none;box-shadow:rgba(0,0,0,.2) 0px 2px 4px -1px,rgba(0,0,0,.14) 0px 4px 5px 0px,rgba(0,0,0,.12) 0px 1px 10px 0px}.sa-live-call-widget-one-cta .sa-btn-cta-icon-box-expanded{flex-direction:row;min-width:180px;height:40px;justify-content:center;gap:10px}.sa-live-call-widget-expanded-cta-btn-wrapper-2.sa-live-call-widget-cta-custom-layout{flex-direction:column;align-self:center}.sa-live-call-widget-cta-custom-layout .sa-btn-cta-icon-box-expanded{flex-direction:row;min-width:224px;height:44px;justify-content:center;gap:10px}.sa-live-call-widget-cta-custom-layout .sa-btn-cta-icon-box-expanded span{font-size:15px;font-weight:400}.sa-live-call-widget-cta-custom-layout .sa-btn-cta-icon-box-expanded svg,.sa-live-call-widget-cta-custom-layout .sa-btn-cta-icon-box-expanded span{filter:none}.sa-btn-cta-icon-box-expanded.sa-btn-cta-icon-box-expanded-custom-style-true{color:#3f3597;background-color:#ffce32;border:2px solid #372f7e;border-radius:999px}.sa-btn-cta-icon-box-expanded.sa-btn-cta-icon-box-expanded-custom-style-true+.sa-btn-cta-icon-box-expanded{border:2px solid rgba(0,0,0,0);border-radius:999px}.sa-live-call-widget-close-expanded-widget-btn{position:absolute;top:6px;right:6px;display:flex;align-items:center;justify-content:center;font-size:22px;padding:3px;background:rgba(0,0,0,.1);color:var(--sa-live-call-widget-text-color-primary);border-radius:10px;filter:drop-shadow(1px 2px 2px rgba(0, 0, 0, 0.6));cursor:pointer;z-index:2147483610 !important}.sa-live-call-widget-logo-wrapper{min-height:48px;position:absolute;top:0;left:0;z-index:2147483610 !important;background:rgba(0,0,0,0);padding:6px}.sa-live-call-widget-logo{height:35px;width:auto;border-radius:4px}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-call-waiting-container) .sa-live-call-widget-logo-wrapper{display:none}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper #saleassist-video-call-app) .sa-live-call-widget-logo-wrapper{display:none}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper #saleassist-video-call-app) .sa-live-call-widget-close-expanded-widget-btn{display:none}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper #sa-live-call-widget-hls-video) .sa-live-call-widget-powered-by-strip{background-color:var(--themeColorWithOpacity) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper #sa-live-call-widget-hls-video) .sa-live-call-widget-powered-by-strip:hover{background-color:var(--themeColor) !important}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper #sa-live-call-widget-hls-video) .sa-live-call-widget-powered-by-strip a{color:var(--invertColor) !important}.sa-live-call-widget-form-header{width:100%;position:absolute;top:0;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary);padding:10px;display:flex;align-items:center;justify-content:center;gap:10px;text-transform:capitalize;border-top-right-radius:5px;border-top-left-radius:5px;min-height:var(--saLiveCallWidgetDefaultContainerPaddingTop)}.sa-live-call-widget-form-header p{font-weight:500;color:var(--sa-live-call-widget-text-color-info)}.sa-live-call-widget-default-container{height:100%;width:100%;padding:var(--saLiveCallWidgetDefaultContainerPaddingTop) 10px 10px 10px}.sa-live-call-widget-expanded-inner-wrapper.sa-live-call-widget-powered-by-true .sa-live-call-widget-default-container{padding-bottom:0 !important}.sa-live-call-widget-intent-container{width:100%;display:flex;gap:10px;justify-content:center;padding:2px 0;overflow:auto}.sa-live-call-widget-intent-vertical-container{flex-direction:column;width:100%;padding-left:32px;padding-right:32px}.sa-live-call-widget-intent-box{color:var(--sa-live-call-widget-text-color-primary);background:rgba(0,0,0,.5);padding:5px 10px;font-size:12px;border:1px solid #fff;border-radius:20px;cursor:pointer;user-select:none;display:flex;gap:8px;align-items:center}.sa-live-call-widget-intent-box.sa-live-call-widget-intent-box-home,.sa-live-call-widget-intent-box.sa-live-call-widget-intent-box-back{display:none}.sa-live-call-widget-intent-box.sa-live-call-widget-child-intent-box{display:none}.sa-live-call-widget-intent-number{width:16px;height:16px;border-radius:999px;display:flex;align-items:center;justify-content:center;background:#fff;color:#101010;font-size:11px;font-weight:500}.sa-live-call-widget-intent-title{position:absolute;top:55px;left:0;color:var(--sa-live-call-widget-text-color-primary);text-shadow:#000 .05em 0px,#000 0px .05em,#000 -0.05em 0px,#000 0px -0.05em,#000 -0.05em -0.05em,#000 -0.05em .05em,#000 .05em -0.05em,#000 .05em .05em;font-weight:bold;padding:5px 12px 5px 10px;border-radius:0 15px 15px 0;background:linear-gradient(to right, rgb(0, 0, 0), rgba(0, 0, 0, 0));display:none}@keyframes intentTitleSlide{from{left:-450px}to{left:0px}}.sa-live-call-widget-video-fade{transition:opacity .4s ease-in-out;opacity:1}.sa-live-call-widget-video-hidden{opacity:0}.sa-live-call-widget-powered-by-strip{display:block;position:absolute;bottom:0;left:0;right:0;z-index:2147483610 !important;background:var(--sa-live-call-widget-background-primary) !important;color:var(--sa-live-call-widget-text-color-info) !important;width:100%;display:flex;align-items:center;justify-content:center;border-top:1px solid #dfdfdf;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-size:10px;text-decoration:none;padding:5px}.sa-live-call-widget-powered-by-strip:hover{text-decoration:underline}.sa-live-call-widget-powered-by-strip .sa-live-call-widget-powered-by-strip-saleassist-logo{height:10px;width:9px;margin-right:5px}.sa-live-call-widget-powered-by-strip a{color:var(--sa-live-call-widget-text-color-info) !important;text-decoration:none}.sa-live-call-widget-embed-page .sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper video#sa-live-call-widget-hls-video) .sa-live-call-widget-close-expanded-widget-btn{display:none !important}.sa-live-call-widget-embed-page .sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper video#sa-live-call-widget-hls-video) .sa-live-call-widget-mute-unmute-video-btn{top:8px !important}.sa-live-call-widget-embed-page .sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper video#sa-live-call-widget-hls-video) .sa-live-call-widget-logo-wrapper{padding-top:8px !important}.sa-live-call-widget-d-hidden{display:none !important}.sa-live-call-widget-rotate-180{transform:rotate(180deg)}.sa-live-call-widget-bold{font-weight:bold}::-webkit-scrollbar{width:3px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:rgba(0,0,0,.3)}::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.3)}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;margin:0}.sa-live-call-widget-btn-container{position:fixed;z-index:2147483647 !important;inset:var(--saLiveWidgetBtnPosition)}.sa-live-call-widget-btn-container .sa-live-call-widget-btn{width:100%;height:100%;cursor:pointer}.sa-live-call-widget-btn-container-type-hidden{display:none !important}.sa-live-call-widget-btn-container-type-video_icon,.sa-live-call-widget-btn-container-type-video_message,.sa-live-call-widget-btn-container-type-shoppable_video{width:80px;height:80px}.sa-live-call-widget-btn-container-type-video_icon .sa-live-call-widget-close-btn,.sa-live-call-widget-btn-container-type-video_message .sa-live-call-widget-close-btn,.sa-live-call-widget-btn-container-type-shoppable_video .sa-live-call-widget-close-btn{position:absolute;top:-2px;right:4px;display:none;padding:2px;font-size:12px;font-weight:600;border-radius:50%;border:1px solid var(--themeColor);background:var(--themeColor);color:var(--invertColor);cursor:pointer;z-index:1}.sa-live-call-widget-btn-container-type-video_icon .sa-live-call-widget-close-btn:hover,.sa-live-call-widget-btn-container-type-video_message .sa-live-call-widget-close-btn:hover,.sa-live-call-widget-btn-container-type-shoppable_video .sa-live-call-widget-close-btn:hover{background:var(--invertColor);color:var(--themeColor)}.sa-live-call-widget-btn-container-type-video_icon:hover .sa-live-call-widget-close-btn,.sa-live-call-widget-btn-container-type-video_message:hover .sa-live-call-widget-close-btn,.sa-live-call-widget-btn-container-type-shoppable_video:hover .sa-live-call-widget-close-btn{display:flex}.sa-live-call-widget-btn-container-type-video_icon .sa-live-call-widget-btn,.sa-live-call-widget-btn-container-type-video_message .sa-live-call-widget-btn,.sa-live-call-widget-btn-container-type-shoppable_video .sa-live-call-widget-btn{border-radius:50%;object-fit:cover;border:1px inset var(--themeColor);box-shadow:var(--boxShadow)}.sa-live-call-widget-btn-container-type-video_icon .sa-live-call-widget-btn iframe,.sa-live-call-widget-btn-container-type-video_message .sa-live-call-widget-btn iframe,.sa-live-call-widget-btn-container-type-shoppable_video .sa-live-call-widget-btn iframe{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;border-radius:inherit}.sa-live-call-widget-btn-container-type-video_icon img.sa-live-call-widget-btn,.sa-live-call-widget-btn-container-type-video_message img.sa-live-call-widget-btn,.sa-live-call-widget-btn-container-type-shoppable_video img.sa-live-call-widget-btn{width:auto !important;border:none !important;border-radius:0 !important}.sa-live-call-widget-btn-container-type-video_icon .sa-live-call-widget-close-pop-up-video-btn,.sa-live-call-widget-btn-container-type-video_message .sa-live-call-widget-close-pop-up-video-btn,.sa-live-call-widget-btn-container-type-shoppable_video .sa-live-call-widget-close-pop-up-video-btn{visibility:hidden}.sa-live-call-widget-btn-container-pop-up-video{animation:1s ease 5s 1 normal forwards running sa-live-call-widget-zoom-in-animation}.sa-live-call-widget-btn-container-pop-up-video .sa-live-call-widget-btn{animation:1s ease 5s normal forwards running sa-live-call-widget-border-animation}.sa-live-call-widget-btn-container-pop-up-video .sa-live-call-widget-close-pop-up-video-btn{animation:1s ease 5s 1 normal forwards running sa-live-call-widget-visibility-animation}.sa-live-call-widget-btn-container-pop-up-video .sa-live-call-widget-close-btn{display:none !important}.sa-live-call-widget-btn-container.sa-live-call-widget-btn-container-type-shoppable_video.sa-live-call-widget-btn-container-pop-up-video{animation-delay:0ms !important}.sa-live-call-widget-btn-container.sa-live-call-widget-btn-container-type-shoppable_video.sa-live-call-widget-btn-container-pop-up-video .sa-live-call-widget-btn{animation-delay:0ms !important}.sa-live-call-widget-btn-container.sa-live-call-widget-btn-container-type-shoppable_video.sa-live-call-widget-btn-container-pop-up-video .sa-live-call-widget-close-pop-up-video-btn{animation-delay:0ms !important}.sa-live-call-widget-btn-container-type-icon{width:60px;height:60px}.sa-live-call-widget-btn-container-type-icon .sa-live-call-widget-btn{width:auto;max-width:fit-content}.sa-live-call-widget-btn-container-type-icon .sa-live-call-widget-close-btn{position:absolute;top:-2px;right:4px;width:15px;height:15px;border:1px solid #000;border-radius:50px;display:none;align-items:center;background:#000;justify-content:center;color:#fff;cursor:pointer}.sa-live-call-widget-btn-container-type-icon:hover .sa-live-call-widget-close-btn{display:flex}@keyframes sa-live-call-widget-zoom-in-animation{from{width:80px;height:80px}to{width:180px;height:280px}}@keyframes sa-live-call-widget-border-animation{0%{border:none;border-radius:50%}100%{border-radius:5px;border:none}}@keyframes sa-live-call-widget-visibility-animation{0%{visibility:hidden}100%{visibility:visible}}.sa-live-call-widget-close-pop-up-video-btn{position:absolute;top:5px;right:5px;z-index:1025;height:16px;width:16px;display:flex;align-items:center;justify-content:center;font-size:14px;background:rgba(0,0,0,.3);color:var(--sa-live-call-widget-text-color-primary);border-radius:50%;cursor:pointer}.sa-live-call-widget-icon-btn-bottom_right,.sa-live-call-widget-icon-btn-top_right,.sa-live-call-widget-btn-bottom_right,.sa-live-call-widget-btn-top_right{float:right}.sa-live-call-widget-icon-btn-bottom_left,.sa-live-call-widget-icon-btn-top_left,.sa-live-call-widget-btn-bottom_left,.sa-live-call-widget-btn-top_left{float:left}@media screen and (max-width: 600px){.sa-live-call-widget-btn-container-type-video_icon,.sa-live-call-widget-btn-container-type-video_message,.sa-live-call-widget-btn-container-type-shoppable_video{width:65px;height:65px}.sa-live-call-widget-btn-container-type-video_icon .sa-live-call-widget-close-btn,.sa-live-call-widget-btn-container-type-video_message .sa-live-call-widget-close-btn,.sa-live-call-widget-btn-container-type-shoppable_video .sa-live-call-widget-close-btn{right:2px}@keyframes sa-live-call-widget-zoom-in-animation{from{width:65px;height:65px}to{width:108px;height:168px}}}.sa-live-call-widget-trigger-message-container{position:absolute;z-index:2147483610 !important}.sa-live-call-widget-trigger-message-container-bottom_right,.sa-live-call-widget-trigger-message-container-top_right{right:0px}.sa-live-call-widget-trigger-message-container-bottom_left,.sa-live-call-widget-trigger-message-container-top_left{left:0px}.sa-live-call-widget-trigger-message-cta-wrapper{display:flex;gap:10px;position:relative}.sa-live-call-widget-trigger-message-cta-wrapper-bottom_right .sa-btn-cta-icon-box,.sa-live-call-widget-trigger-message-cta-wrapper-bottom_left .sa-btn-cta-icon-box{margin-bottom:10px}.sa-live-call-widget-trigger-message-cta-wrapper-bottom_left,.sa-live-call-widget-trigger-message-cta-wrapper-top_left{justify-content:start}.sa-live-call-widget-trigger-message-cta-wrapper-bottom_right,.sa-live-call-widget-trigger-message-cta-wrapper-top_right{justify-content:end}.sa-live-call-widget-trigger-message-cta-wrapper .sa-btn-cta-icon-box{background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-info);cursor:pointer;width:58px;height:58px;border-radius:6px;box-shadow:rgba(0,0,0,.24) 0px 3px 8px;display:none;flex-direction:column;align-items:center;justify-content:center;gap:4px;padding:5px 2px}.sa-live-call-widget-trigger-message-cta-wrapper .sa-btn-cta-icon-box:first-child{background:var(--themeColor)}.sa-live-call-widget-trigger-message-cta-wrapper .sa-btn-cta-icon-text{all:unset;font-size:10px;line-height:12px;font-family:var(--sa-live-call-widget-font-family);color:var(--sa-live-call-widget-text-color-info);text-align:center}.sa-live-call-widget-trigger-message-cta-wrapper .sa-btn-cta-icon-text:first-child{color:var(--invertColor)}.sa-live-call-widget-close-trigger-message-btn{position:absolute;background:var(--themeColor);color:var(--invertColor);border-radius:50%;padding:2px;top:-8px;right:-8px;font-size:12px;display:flex;align-items:center;justify-content:center;transition-property:transform,color;transition-duration:.3s;cursor:pointer}.sa-live-call-widget-close-trigger-message-btn:hover{transform:scale(0.9)}.sa-live-call-widget-trigger-message-wrapper{position:relative;display:flex;gap:4px;place-items:flex-start;width:max-content !important;max-width:210px !important;min-height:20px;padding:4px 4px 4px 4px;margin-left:auto;border:1px solid var(--sa-live-call-widget-border-color-primary);border-radius:8px;background:var(--sa-live-call-widget-background-primary);box-shadow:rgba(0,0,0,.2) 0px 3px 3px -2px,rgba(0,0,0,.14) 0px 3px 4px 0px,rgba(0,0,0,.12) 0px 1px 8px 0px;cursor:default}.sa-live-call-widget-trigger-message-wrapper .sa-live-call-widget-trigger-message{display:flex;place-items:center;gap:6px;padding:6px;font-family:var(--sa-live-call-widget-font-family);font-size:12px;line-height:normal;border-radius:6px;background:#e7eaef;color:#333;cursor:default}.sa-live-call-widget-trigger-message-wrapper .sa-live-call-widget-trigger-message .live-now-indication{width:7px;height:7px;margin-top:-1px;background:red;border-radius:50%;animation:live-now-blinking 1s infinite}.sa-live-call-widget-trigger-message-wrapper-bottom_right::after{top:100%;right:20px;clip-path:polygon(0 0, 80% 0, 100% 100%)}.sa-live-call-widget-trigger-message-wrapper-bottom_left::after{top:100%;left:20px;clip-path:polygon(20% 0%, 100% 0%, 0% 100%)}.sa-live-call-widget-trigger-message-wrapper-top_right::after{bottom:98%;right:20px;clip-path:polygon(0% 100%, 80% 100%, 100% 0%)}.sa-live-call-widget-trigger-message-wrapper-top_left::after{bottom:98%;left:20px;clip-path:polygon(20% 100%, 100% 100%, 0% 0%)}@media screen and (max-width: 600px){.sa-live-call-widget-trigger-message-wrapper .sa-live-call-widget-trigger-message{font-size:12px}.sa-live-call-widget-trigger-message-wrapper .sa-live-call-widget-close-trigger-message-btn{font-size:14px}}@keyframes live-now-blinking{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.sa-live-call-widget-live-video{position:relative;width:100%;height:100%}.sa-live-call-widget-live-video iframe{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;border-radius:inherit}#sa-live-call-widget-hls-video{height:100%;width:100%;border-radius:inherit;object-fit:cover;position:absolute !important;inset:0 !important}.sa-live-call-widget-mute-unmute-video-btn{background:rgba(0,0,0,0) !important;border:none !important;cursor:pointer;position:absolute !important;top:50px !important;right:6px !important;z-index:2147483610 !important;display:flex;align-items:center !important;justify-content:space-between !important;filter:drop-shadow(1px 2px 2px rgba(0, 0, 0, 0.9))}.sa-live-call-widget-mute-unmute-video-btn:hover,.sa-live-call-widget-mute-unmute-video-btn:focus .sa-live-call-widget-mute-unmute-video-btn:active{background:rgba(0,0,0,0) !important;border:none !important}.sa-live-call-widget-mute-unmute-video-btn svg{color:var(--sa-live-call-widget-text-color-primary);font-size:24px;padding:3px;background:rgba(0,0,0,.1);border-radius:10px;box-sizing:unset}.sa-live-call-widget-mute-unmute-video-btn .sa-live-call-widget-unmute-icon{display:none}.sa-live-call-widget-play-video-btn,.sa-live-call-widget-pause-video-btn{background-color:rgba(255,255,255,.6) !important;border:none !important;cursor:pointer;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);z-index:2147483610 !important;width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center}.sa-live-call-widget-play-video-btn:hover,.sa-live-call-widget-play-video-btn:focus,.sa-live-call-widget-play-video-btn:active,.sa-live-call-widget-pause-video-btn:hover,.sa-live-call-widget-pause-video-btn:focus,.sa-live-call-widget-pause-video-btn:active{background-color:rgba(255,255,255,.6) !important;border:none !important}.sa-live-call-widget-play-video-btn .sa-live-call-widget-pause-icon,.sa-live-call-widget-play-video-btn .sa-live-call-widget-play-icon,.sa-live-call-widget-pause-video-btn .sa-live-call-widget-pause-icon,.sa-live-call-widget-pause-video-btn .sa-live-call-widget-play-icon{width:16px;height:16px}.sa-live-call-widget-play-video-btn .sa-live-call-widget-play-icon,.sa-live-call-widget-pause-video-btn .sa-live-call-widget-play-icon{margin-left:4px}.unmute-helper-animation{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:none;flex-direction:column;place-content:space-between;place-items:center;color:var(--sa-live-call-widget-text-color-primary);background:rgba(0,0,0,.3);padding:10px;border-radius:8px;filter:drop-shadow(1px 2px 2px rgba(0, 0, 0, 0.6));animation:fadeInOut 5s ease-out forwards;pointer-events:none;z-index:2147483611}.unmute-helper-animation svg{width:48px;height:48px}@keyframes fadeInOut{0%,100%{opacity:0;visibility:hidden}50%{opacity:1;visibility:visible}}.sa-live-call-widget-lead-capture-form-container{position:absolute;top:0;bottom:0;left:0;right:0;z-index:999999999 !important;background:var(--sa-live-call-widget-background-primary);padding:20px 0px;color:var(--sa-live-call-widget-text-color-secondary);display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:inherit}#sa-live-call-widget-lead-capture-form{position:relative;background:var(--sa-live-call-widget-background-primary) !important;padding:0;border-radius:8px;width:100%;margin-top:0px;max-width:100%;font-family:Segoe UI !important}#sa-live-call-widget-lead-capture-form .sa-live-call-widget-lead-capture-form-icon{padding:8px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;background-color:var(--themeColor);color:var(--invertColor);box-shadow:0px 3px 3px -2px rgba(0,0,0,.2),0px 3px 4px 0px rgba(0,0,0,0.1411764706),0px 1px 8px 0px rgba(0,0,0,0.1215686275);width:3rem;height:3rem;margin:0 auto 15px}.sa-live-call-widget-lead-capture-form-fields-container{width:100%;max-height:370px;overflow-y:auto;padding:0 1rem;margin-bottom:1rem}#input-field-number{position:relative}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper{width:calc(100% - 32px);margin:0px auto}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper .sa-live-call-widget-lead-capture-form-microphone-permission-icon-wrapper{display:flex;gap:10px;padding-top:5px}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper .sa-live-call-widget-lead-capture-form-microphone-permission-icon-wrapper .sa-live-call-widget-lead-capture-form-microphone-permission-icon{color:var(--sa-live-call-widget-text-color-success)}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper .sa-live-call-widget-lead-capture-form-microphone-permission-icon-wrapper .sa-live-call-widget-lead-capture-form-microphone-permission-icon-text{color:var(--sa-live-call-widget-text-color-danger);max-width:255px;text-align:justify;font-size:11px;color:var(--sa-live-call-widget-text-color-info);word-spacing:5px}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #sa-live-call-widget-lead-capture-form-microphone-permission-btn{width:100%;display:flex;place-content:center;border:1px solid green !important;border-radius:6px;place-items:center;margin:5px 0;font-weight:bold;font-size:18px;padding:10px;color:var(--sa-live-call-widget-text-color-success) !important;cursor:pointer;user-select:none;background:var(--sa-live-call-widget-background-primary) !important}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #sa-live-call-widget-lead-capture-form-microphone-permission-btn:hover,.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #sa-live-call-widget-lead-capture-form-microphone-permission-btn:focus,.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #sa-live-call-widget-lead-capture-form-microphone-permission-btn:active{background-color:green !important;color:var(--sa-live-call-widget-text-color-primary) !important;border:1px solid green !important}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #otpField{padding:6px 12px;border-radius:5px;width:100%;margin-bottom:5px;outline:none;border:1px solid var(--sa-live-call-widget-border-color-primary);position:relative;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary) !important}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #resendOTPCont{font-size:12px;margin-left:2px}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #resendOTPCont #resendOTP{font-size:12px;font-weight:500;text-decoration:underline;border:none;background:none;cursor:pointer}.sa-live-call-widget-lead-capture-form-submit-btn-wrapper #verifyOTP{display:block;width:100%;background-color:var(--themeColor) !important;color:var(--invertColor) !important;font-size:14px;padding:10px 20px;margin-top:15px;outline:none;border:none !important;border-radius:6px;cursor:pointer;line-height:1}.sa-live-call-widget-required-field-error{font-size:14px;text-align:center;padding:0px 16px;color:var(--sa-live-call-widget-text-color-danger);display:none;margin-bottom:10px}.sa-live-call-widget-terms-n-conditions{padding:0px 16px;color:gray;font-size:12px;text-align:center}.sa-live-call-widget-terms-n-conditions a{text-decoration:none}.sa-live-call-widget-lead-capture-form-group{padding-bottom:20px}.sa-live-call-widget-lead-capture-form-field-label{color:var(--sa-live-call-widget-text-color-info) !important;font-size:15px !important;display:block;padding-bottom:8px;width:100%;font-weight:400}.sa-live-call-widget-lead-capture-form-field-label span{color:var(--sa-live-call-widget-text-color-info) !important;font-size:15px !important}.sa-live-call-widget-lead-capture-form-field-label .sa-form-input-required{color:#1d2030 !important}.sa-live-call-widget-lead-capture-form-checkbox-wrapper{margin-bottom:10px}.sa-live-call-widget-lead-capture-form-checkbox-field-label{color:var(--sa-live-call-widget-text-color-info) !important;font-size:14px !important;line-height:1.375 !important}.sa-live-call-widget-lead-capture-form-field{padding:8px;border-radius:7px;width:100%;outline:none;border:1px solid var(--sa-live-call-widget-border-color-primary);position:relative;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary) !important}.sa-live-call-widget-lead-capture-form-field:-webkit-autofill{-webkit-box-shadow:0 0 0 1000px var(--sa-live-call-widget-background-primary) inset !important;-webkit-text-fill-color:var(--sa-live-call-widget-text-color-secondary) !important}textarea.sa-live-call-widget-lead-capture-form-field{resize:none}.sa-live-call-widget-lead-capture-form-submit-btn{display:block;width:100%;background-color:var(--themeColor) !important;color:var(--invertColor) !important;font-size:18px;padding:10px;outline:none;border:1px solid rgba(0,0,0,0);border-radius:6px;cursor:pointer;line-height:1}.sa-live-call-widget-lead-capture-form-submit-btn:hover,.sa-live-call-widget-lead-capture-form-submit-btn:focus,.sa-live-call-widget-lead-capture-form-submit-btn:active{background-color:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-lead-capture-form-media-permission-denied-overlay{position:absolute;top:0px;width:100%;height:100%;z-index:101;background:rgba(0,0,0,.5);backdrop-filter:blur(5px);display:flex;align-items:center;justify-content:center}.sa-live-call-widget-lead-capture-form-media-permission-denied-overlay-card{width:85%;background:#f2d1d1;color:var(--sa-live-call-widget-text-color-danger);font-size:14px;border:1px solid #ecbbbb;border-radius:8px;padding:10px}.sa-live-call-widget-lead-capture-form-media-permission-denied-overlay-card-title{display:flex;font-weight:bold;margin-bottom:5px}.sa-live-call-widget-lead-capture-form-media-permission-denied-overlay-card-image{width:100%;border-radius:8px;margin-top:10px}.sa-live-call-widget-mobile-number-input-wrapper{display:flex;align-items:center;border-radius:7px;border:1px solid var(--sa-live-call-widget-border-color-primary);padding:8px}.sa-live-call-widget-mobile-number-input-wrapper .sa-live-call-widget-selected-country-wrapper{cursor:pointer;display:flex;align-items:center;gap:2px;padding-right:4px;border-right:1px solid var(--sa-live-call-widget-border-color-primary)}.sa-live-call-widget-mobile-number-input-wrapper .sa-live-call-widget-selected-country-wrapper .sa-live-call-widget-selected-country{font-size:14px;font-family:var(--sa-live-call-widget-font-family);color:var(--sa-live-call-widget-text-color-info)}.sa-live-call-widget-mobile-number-input-wrapper .sa-live-call-widget-selected-country-wrapper .sa-live-call-widget-select-country-arrow{position:relative;display:block;width:14px;height:14px;transition:transform .3s linear;color:var(--sa-live-call-widget-text-color-info)}.sa-live-call-widget-mobile-number-input-wrapper .sa-live-call-widget-selected-country-wrapper .sa-live-call-widget-select-country-arrow::after{content:"";display:block;box-sizing:border-box;position:absolute;width:7px;height:7px;border-bottom:1px solid;border-right:1px solid;transform:rotate(45deg);left:4px;top:2px}.sa-live-call-widget-mobile-number-input-wrapper .sa-live-call-widget-mobile-number-input{margin-left:6px;width:100%;height:auto;outline:none;position:relative;border:none;padding:0 !important;text-align:left}.sa-live-call-widget-country-list{width:calc(100% + 1px) !important;border-radius:.25rem !important;max-height:130px !important;outline:none;z-index:1;list-style:none;margin:10px 0 10px -1px;box-shadow:1px 2px 10px rgba(0,0,0,.35);background:var(--sa-live-call-widget-background-primary) !important;overflow-y:scroll;border-radius:0 0 3px 3px;font-size:13px}.sa-live-call-widget-country-list .sa-live-call-widget-country{padding:7px 9px;cursor:pointer}.sa-live-call-widget-country-list .sa-live-call-widget-country:hover{background-color:var(--sa-live-call-widget-background-primary)}.sa-live-call-widget-lead-capture-form-error-message{color:red;padding-top:4px;display:block;font-size:14px;display:none}.sa-live-call-widget-lead-capture-form-radio-form-fields-box{display:flex;align-items:flex-start;gap:5px;border:1px solid var(--sa-live-call-widget-border-color-primary);margin-bottom:10px;padding:8px;border-radius:7px;overflow:hidden;cursor:pointer;transition:all .3s ease-in-out}.sa-live-call-widget-lead-capture-form-radio-form-fields-box:hover{border:1px solid var(--themeColor);background:var(--themeColorWithFadeOpacity);color:#1d2030}.sa-live-call-widget-lead-capture-form-radio-form-fields-box:has(.sa-live-call-widget-lead-capture-form-field-radio:checked){border:1px solid var(--themeColor);background:var(--themeColorWithFadeOpacity);color:#1d2030}.sa-live-call-widget-lead-capture-form-field:hover{border:1px solid var(--themeColor)}.sa-live-call-widget-lead-capture-form-field-box-group{border:1px solid var(--sa-live-call-widget-border-color-primary);position:relative;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary) !important;padding:8px;border-radius:7px;display:flex;gap:7px;transition:all .3s ease-in-out}.sa-live-call-widget-lead-capture-form-field-box-group svg{stroke:#999 !important;width:16px;height:16px}.sa-live-call-widget-lead-capture-form-field-box-group .sa-live-call-widget-lead-capture-form-field{padding:0;border-radius:0;width:100%;outline:none;border:none;position:unset;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary) !important;height:max-content}.sa-live-call-widget-lead-capture-form-field-box-group .sa-live-call-widget-lead-capture-form-field:hover{border:none !important}.sa-live-call-widget-lead-capture-form-field-box-group:hover{border:1px solid var(--themeColor) !important}.sa-live-call-widget-mobile-number-input-box{display:flex;align-items:center;padding-left:6px}.sa-live-call-widget-mobile-number-input-box svg{stroke:#999;width:16px;height:16px}.sa-live-call-widget-mobile-number-input-box .sa-live-call-widget-lead-capture-form-field:hover{border:none}.sa-live-call-widget-lead-capture-form-checkbox-wrapper{border:1px solid var(--sa-live-call-widget-border-color-primary);position:relative;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary) !important;padding:8px;border-radius:7px;display:flex;gap:7px;transition:all .3s ease-in-out;cursor:pointer}.sa-live-call-widget-lead-capture-form-checkbox-wrapper:hover{border:1px solid var(--themeColor);background:var(--themeColorWithFadeOpacity);color:#1d2030}.sa-live-call-widget-lead-capture-form-checkbox-wrapper:has(.sa-live-call-widget-lead-capture-form-field-checkbox:checked){border:1px solid var(--themeColor);background:var(--themeColorWithFadeOpacity);color:#1d2030}.sa-live-call-widget-lead-capture-form-field-label.sa-live-call-widget-lead-peragraph-text{text-align:center}.sa-live-call-widget-main-title-text{text-align:center;font-size:22px;margin:0px 0px 5px 0px}.sa-live-call-widget-lead-capture-form-fields-container::-webkit-scrollbar-thumb{background:var(--themeColor) !important;border-radius:10px}.sa-live-call-widget-lead-capture-form-fields-container::-webkit-scrollbar-track{border-radius:10px}.sa-live-call-widget-lead-capture-form-radio-fields-wrapper label.sa-live-call-widget-lead-capture-form-radio-form-fields-box:last-child{margin:0}.sa-live-call-widget-lead-capture-form-group label.sa-live-call-widget-lead-capture-form-checkbox-wrapper:last-child{margin:0}.date-picker-container{position:relative;width:100%;overflow:hidden}.date-picker-container .date-input-wrapper{position:relative;width:100%;display:flex;align-items:center}.date-picker-container .date-input-wrapper .date-input{width:100%;padding:8px;border:none;border-radius:6px;font-size:16px;outline:none;cursor:pointer;background:#fff}.date-picker-container .date-input-wrapper .clear-btn{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;font-size:16px;color:#999;cursor:pointer;display:none}.date-picker-container .calendar{position:absolute;top:40px;left:-6px;width:100%;background:#fff;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.1);padding:10px;opacity:0;transform:scale(0.75);pointer-events:none;transition:all .3s ease;z-index:100;border:1px solid #ddd}.date-picker-container .calendar .calendar-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;font-weight:bold}.date-picker-container .calendar .calendar-header button{background:none;border:none;cursor:pointer;font-size:14px;width:30px;height:30px;border-radius:5px}.date-picker-container .calendar .calendar-header button svg{width:14px;height:14px;color:#000}.date-picker-container .calendar .calendar-header button:hover{background:#ddd}.date-picker-container .calendar .calendar-header span#monthYear{color:#3a3a3a;font-size:14px}.date-picker-container .calendar .days{display:grid;grid-template-columns:repeat(7, 1fr);gap:0px}.date-picker-container .calendar .days div{text-align:center;padding:5px 2px 5px 2px;border-radius:6px;cursor:pointer;color:#535151;transition:background .3s}.date-picker-container .calendar .days div:hover:not(.disabled):not(.selected){background:#f0f0f0}.date-picker-container .calendar .days .selected{background:#999;color:#fff;font-weight:bold}.date-picker-container .calendar .days .disabled{color:#ccc;cursor:not-allowed}.date-picker-container .calendar .days .empty{visibility:hidden}.date-picker-container .calendar .weekdays{display:grid;grid-template-columns:repeat(7, 1fr);margin-bottom:5px;font-weight:bold;text-align:center;color:#777}.date-picker-container .calendar.active{opacity:1;transform:scale(1.05);pointer-events:auto;display:block}.date-picker-container:has(.calendar.active){overflow:unset}.sa-live-call-widget-lead-capture-form-fields-main-container{margin-top:5px}#sa-live-call-widget-lead-capture-form h1,#sa-live-call-widget-lead-capture-form h2,#sa-live-call-widget-lead-capture-form h3,#sa-live-call-widget-lead-capture-form h4,#sa-live-call-widget-lead-capture-form h5,#sa-live-call-widget-lead-capture-form h6,#sa-live-call-widget-lead-capture-form p,#sa-live-call-widget-lead-capture-form span,#sa-live-call-widget-lead-capture-form button,#sa-live-call-widget-lead-capture-form label,#sa-live-call-widget-lead-capture-form div,#sa-live-call-widget-lead-capture-form input{font-family:"Segoe UI",-apple-system !important}.sa-live-call-widget-schedule-meeting-container{overflow-y:auto;height:100%;display:flex;flex-direction:column;user-select:none;padding-left:2px;padding-right:12px;padding-bottom:10px}.sa-live-call-widget-schedule-meeting-title{font-size:18px;font-weight:bold;color:#1f1f1f;margin-bottom:10px}.sa-live-call-widget-schedule-meeting-caption{font-size:14px;color:#6d6d6d}.sa-live-call-widget-schedule-meeting-caption span{display:block;margin:5px 0;font-size:12px}.sa-live-call-widget-schedule-meeting-date-container{margin:10px 0 15px}.sa-live-call-widget-schedule-meeting-divider{background:linear-gradient(to left, rgba(217, 83, 79, 0), var(--themeColor), rgba(217, 83, 79, 0));margin:0 auto;width:90%;height:2px}.sa-live-call-widget-schedule-meeting-time-container{position:relative;width:90%;margin:0 auto}.sa-live-call-widget-time-custom-select{width:100%;padding:12px 50px 12px 12px;font-size:16px;margin:20px 0;border-radius:8px;background:var(--sa-live-call-widget-background-primary);border-color:var(--sa-live-call-widget-border-color-info);appearance:none;background-image:linear-gradient(45deg, transparent 50%, gray 50%),linear-gradient(135deg, gray 50%, transparent 50%),linear-gradient(to right, #ccc, #ccc);background-position:calc(100% - 20px) calc(1em + 3px),calc(100% - 15px) calc(1em + 3px),calc(100% - 2.5em) .55em;background-size:5px 5px,5px 5px,1px 1.5em;background-repeat:no-repeat;color:var(--sa-live-call-widget-text-color-secondary)}.sa-live-call-widget-time-custom-select:focus{outline:0}.sa-live-call-widget-time-custom-select-label{position:absolute;font-size:12px;font-weight:bold;top:10px;background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-info);padding:3px 4px;left:10px}.sa-live-call-widget-schedule-meeting-invite-friends-container{display:flex;flex-direction:column;place-content:center;place-items:center}.sa-live-call-widget-schedule-meeting-invite-friends-container img{width:55%}.sa-live-call-widget-schedule-meeting-invite-friends-text{font-size:16px;font-weight:bold;text-align:center;margin:20px 0 5px;color:#1f1f1f}.sa-live-call-widget-schedule-meeting-invite-friends-textarea{width:calc(100% - 30px);min-height:60px !important;padding:8px;border-color:var(--sa-live-call-widget-border-color-info);border-radius:8px;outline:none;resize:none;margin:5px 0px;font-size:12px}.sa-live-call-widget-schedule-meeting-error-text{text-align:center;color:red;font-size:12px;margin-top:10px;display:none}.sa-live-call-widget-schedule-meeting-confirm-btn{background:var(--themeColor) !important;color:var(--invertColor) !important;width:calc(100% - 30px);border-radius:8px;border:none !important;font-size:18px;font-weight:bold;padding:10px 0;margin:15px auto 0;cursor:pointer;box-shadow:rgba(0,0,0,.2) 0px 3px 3px -2px,rgba(0,0,0,.14) 0px 3px 4px 0px,rgba(0,0,0,.12) 0px 1px 8px 0px}.sa-live-call-widget-schedule-meeting-confirm-btn:hover,.sa-live-call-widget-schedule-meeting-confirm-btn:focus,.sa-live-call-widget-schedule-meeting-confirm-btn:active{background:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-slider{width:100%;max-width:600px;margin:0 auto;overflow:hidden;position:relative}.sa-live-call-widget-slider-wrapper{margin:0 12px;overflow:hidden}.sa-live-call-widget-slider-track{display:flex;transition:transform .3s ease;place-items:center}.sa-live-call-widget-slide{flex:0 0 calc((100% - 20px)/3);margin-right:10px;display:flex;place-content:center}.sa-live-call-widget-slide:last-child{margin-right:0}.sa-live-call-widget-slide img{width:100%;height:auto}.sa-live-call-widget-slide-content{text-align:center;padding:10px;background:var(--invertColor);color:var(--themeColor);border-radius:8px;width:74px;height:74px;display:flex;place-content:center;flex-direction:column;gap:5px;user-select:none;cursor:pointer;box-shadow:rgba(0,0,0,.2) 0px 3px 3px -2px,rgba(0,0,0,.14) 0px 3px 4px 0px,rgba(0,0,0,.12) 0px 1px 8px 0px}.sa-live-call-widget-slide-content h1{margin:0;font-size:2em !important;letter-spacing:normal;color:inherit}.sa-live-call-widget-slide-content p{margin:0;font-size:16px !important;color:inherit}.sa-live-call-widget-slide-active .sa-live-call-widget-slide-content{background:var(--themeColor);color:var(--invertColor);width:80px;height:80px}.sa-live-call-widget-slider-nav{display:block;position:absolute;top:50%;transform:translateY(-50%);background-color:rgba(0,0,0,0);color:var(--sa-live-call-widget-text-color-secondary);border:none;cursor:pointer;font-size:20px;font-weight:600;user-select:none}.sa-live-call-widget-slider-nav:hover{background-color:rgba(0,0,0,0);color:var(--sa-live-call-widget-text-color-secondary);border:none}.sa-live-call-widget-slider-nav.prev{left:-2px}.sa-live-call-widget-slider-nav.next{right:-2px}.sa-live-call-widget-loader-spinner>div{width:16px;height:16px;background-color:var(--invertColor);border-radius:100%;display:inline-block;-webkit-animation:sk-bouncedelay 1.4s infinite ease-in-out both;animation:sk-bouncedelay 1.4s infinite ease-in-out both}.sa-live-call-widget-loader-spinner .sa-live-call-widget-loader-bounce1{-webkit-animation-delay:-0.32s;animation-delay:-0.32s}.sa-live-call-widget-loader-spinner .sa-live-call-widget-loader-bounce2{-webkit-animation-delay:-0.16s;animation-delay:-0.16s}@-webkit-keyframes sk-bouncedelay{0%,80%,100%{-webkit-transform:scale(0)}40%{-webkit-transform:scale(1)}}@keyframes sk-bouncedelay{0%,80%,100%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}.sa-live-call-widget-ball-scale-multiple{position:absolute;left:50%;top:22px;margin-top:-30px;margin-left:-30px;z-index:0}.sa-live-call-widget-ball-scale-multiple div{position:absolute;left:0;top:0;width:60px;height:60px;background:var(--invertColor);border-radius:100%;opacity:0;animation:ball-scale-multiple 1.5s linear infinite}.sa-live-call-widget-ball-scale-multiple div:nth-child(2){-webkit-animation-delay:.2s}.sa-live-call-widget-ball-scale-multiple div:nth-child(3){-webkit-animation-delay:.4s}@-webkit-keyframes ball-scale-multiple{0%{-webkit-transform:scale(0);opacity:0}5%{opacity:.35}100%{-webkit-transform:scale(1);opacity:0}}.call-btn-loader{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.call-btn-loader div{background-color:var(--themeColor)}.sa-live-call-widget-thankyou-wrapper{width:100%;height:100%}.sa-live-call-widget-thankyou-container{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;overflow:hidden;height:100%}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container{width:90%;padding:0;margin-top:40px;border-radius:10px;display:flex;flex-direction:column;height:100%;overflow:auto}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-thank-you-message-container{background:var(--themeColor);text-align:center;border-top-right-radius:10px;border-top-left-radius:10px;padding:30px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-thank-you-message-container .sa-live-call-widget-thank-you-single-tick{width:30px;height:30px;margin:0 auto;background:var(--invertColor);border-radius:50px;display:flex;align-items:center;justify-content:center;margin-bottom:10px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-thank-you-message-container .sa-live-call-widget-thank-you-single-tick svg{fill:var(--themeColor);width:20px;height:20px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container{padding:20px 0px;height:100%;overflow:auto;border-bottom-left-radius:10px;border-bottom-right-radius:10px;position:relative;margin-bottom:50px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-note-message-box{background:#fffbeb;padding:10px;border:1px solid #fde68a;border-left:4px solid #92400e;border-top-right-radius:5px;border-bottom-right-radius:5px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-note-message-box .sa-live-call-widget-note-message{font-weight:500;color:#92400e}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-note-message-box .sa-live-call-widget-note-message span{font-size:12px;margin-top:5px;display:inline-block;font-weight:300;color:#b45309;line-height:18px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-scheduled-on-container{border-radius:10px;margin-top:20px;padding:15px 10px;border:1px solid #ddd;border-left:5px solid var(--themeColor)}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-scheduled-on-container .sa-live-call-widget-scheduled-time-title{font-weight:600;margin-bottom:10px;font-size:16px;color:var(--themeColor)}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-scheduled-on-container .sa-live-call-widget-scheduled-meeting-details{display:flex;align-items:center;justify-content:flex-start;margin-bottom:15px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-scheduled-on-container .sa-live-call-widget-scheduled-meeting-details svg{width:16px;height:16px;fill:var(--themeColor)}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-scheduled-on-container .sa-live-call-widget-scheduled-meeting-details span{font-size:14px;line-height:20px;color:var(--themeColor);display:inline-block;margin-left:5px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container .sa-live-call-widget-scheduled-on-container .sa-live-call-widget-scheduled-meeting-details:last-child{margin:0}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-main-container .sa-live-call-widget-scheduled-time-details-container::-webkit-scrollbar{display:none}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-title{margin:0px 0px;color:var(--sa-live-call-widget-text-color-secondary)}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thank-you-message{margin:0px;font-size:12px;line-height:normal;text-align:center;color:var(--sa-live-call-widget-text-color-secondary);margin-top:10px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons{display:flex;align-items:center;justify-content:center;margin-top:20px;position:absolute;bottom:20px;gap:5px;background:#fff}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn{font-weight:bold;border:none !important;display:flex;align-items:center;justify-content:center;border-radius:10px;background-color:var(--themeColor) !important;color:var(--invertColor) !important;padding:0 10px;font-size:14px;height:40px;cursor:pointer;white-space:nowrap}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn.schedule-meeting-startover-btn{justify-content:center;margin-right:auto;border-radius:5px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn:hover,.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn:focus,.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn:active{background:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn svg{margin-right:4px;width:15px;height:15px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-thankyou-page-buttons .sa-live-call-widget-thankyou-startover-btn.invite-friends-btn{background:none !important;border:1px solid #ddd !important;color:var(--themeColor) !important}.sa-live-call-widget-thankyou-container .sa-live-call-widget-go-back-btn{position:absolute;bottom:20px;left:20px;right:20px;padding:15px;border-radius:10px;border:1px solid var(--themeColor) !important;color:var(--themeColor) !important;font-size:14px;font-weight:600;background:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-go-back-btn svg{width:15px;height:15px}.sa-live-call-widget-thankyou-container .thankyou-share-text-container{display:flex;justify-content:space-between;padding-left:10px;width:100%}.sa-live-call-widget-thankyou-container .thankyou-share-text-container .thankyou-share-text{align-self:flex-end}.sa-live-call-widget-thankyou-container .thankyou-share-text-container img{height:100px}.sa-live-call-widget-thankyou-container .thankyou-share-text{color:#010101;font-weight:600;padding-top:24px;text-align:left;font-size:14px}.sa-live-call-widget-thankyou-container .thankyou-share-text span{color:#ff7b16}.sa-live-call-widget-thankyou-container .sa-live-call-widget-bubble{width:200px;height:200px;border-radius:50%;position:absolute;opacity:.3;background-color:var(--themeColor)}.sa-live-call-widget-thankyou-container .sa-live-call-widget-bubble-position-one{top:-75px;left:-75px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-bubble-position-two{right:-110px}.sa-live-call-widget-thankyou-container .sa-live-call-widget-schedule-mail-text{font-size:10px;margin-top:4px;color:#5d5d5d}.sa-live-call-widget-feedback-form-container{position:absolute;top:0;bottom:0;left:0;right:0;z-index:100;background:var(--sa-live-call-widget-background-secondary) !important;padding:0 20px;color:var(--sa-live-call-widget-text-color-secondary);display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:inherit}#sa-live-call-widget-feedback-form{position:relative;background:var(--sa-live-call-widget-background-primary) !important;padding:24px 0 16px 0;border-radius:8px;width:100%;box-shadow:0px 3px 3px -2px rgba(0,0,0,.2),0px 3px 4px 0px rgba(0,0,0,0.1411764706),0px 1px 8px 0px rgba(0,0,0,0.1215686275);margin-top:52px;max-width:350px}#sa-live-call-widget-feedback-form .sa-live-call-widget-feedback-form-icon{position:absolute;top:-21px;padding:8px;border-radius:50%;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:center;font-size:24px;background-color:var(--themeColor);color:var(--invertColor);box-shadow:0px 3px 3px -2px rgba(0,0,0,.2),0px 3px 4px 0px rgba(0,0,0,0.1411764706),0px 1px 8px 0px rgba(0,0,0,0.1215686275)}.sa-live-call-widget-feedback-form-fields-container{width:100%;max-height:320px;overflow-y:auto;padding:0 16px}.sa-live-call-widget-feedback-form-submit-btn-wrapper{width:calc(100% - 32px);margin:12px auto 0}.sa-live-call-widget-feedback-form-submit-btn{display:block;width:100%;background-color:var(--themeColor) !important;color:var(--invertColor) !important;font-size:14px;padding:10px 20px;outline:none;border:none !important;border-radius:6px;cursor:pointer}.sa-live-call-widget-feedback-form-submit-btn:hover,.sa-live-call-widget-feedback-form-submit-btn:focus,.sa-live-call-widget-feedback-form-submit-btn:active{background-color:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-feedback-form-star-rating-title{font-size:14px;text-align:center;font-weight:600;color:var(--sa-live-call-widget-text-color-info)}.sa-live-call-widget-feedback-form-star-rating{display:flex;flex-direction:column;align-items:center;padding:24px 4px 12px 4px}.sa-live-call-widget-feedback-form-star{fill:#e0e0e0;transition:fill .3s;width:24px;height:24px;cursor:pointer}.sa-live-call-widget-feedback-form-star:hover{fill:#ff9800}.sa-live-call-widget-feedback-form-stars-wrapper{display:flex;gap:8px}.sa-live-call-widget-feedback-form-star{cursor:pointer;stroke:#aaa;transition:stroke .3s}.sa-live-call-widget-feedback-form-star:hover{stroke:#ff9800}.sa-live-call-widget-feedback-form-star polygon.filled-star{fill:#ff9800 !important}.sa-live-call-widget-feedback-form-star polygon.unfilled-star{fill:rgba(0,0,0,0) !important}.sa-live-call-widget-feedback-form-star-description{width:100%;display:flex;justify-content:space-around;padding-top:4px}.sa-live-call-widget-feedback-form-star-description p{font-size:13px;color:#909090}#sa-live-call-widget-feedback-form-comment{width:100%;border-radius:5px;padding:6px 12px;font-size:var(--sal-live-call-widget-text-sm) !important;margin-top:15px;outline:none;border:1px solid var(--sa-live-call-widget-border-color-primary)}.sa-live-call-widget-video-message-page{width:100%;height:100%;padding-bottom:10px;display:flex;flex-direction:column}.sa-live-call-widget-video-message-page .sa-live-call-widget-video-message-preview-wrapper{width:100%;height:100%;background:#1f1f1f;border-radius:8px;position:relative}.sa-live-call-widget-video-message-page .sa-live-call-widget-video-message-preview-wrapper.video-recorded{height:90% !important}.sa-live-call-widget-video-message-page .sa-live-call-widget-video-message-preview{width:100%;height:100%;object-fit:cover;border-radius:8px}.sa-live-call-widget-video-message-start-stop-recording-btn{width:50px;height:50px;border-radius:50%;border:3px solid #fff;padding:0;cursor:pointer}.sa-live-call-widget-video-message-start-stop-recording-btn-inner-wrapper{width:100%;height:100%;background:#fff;border-radius:50%;transform:scale(0.9);transition:all 300ms ease-in-out;color:red;display:grid;font-weight:700;place-items:center}.sa-live-call-widget-video-message-start-stop-recording-btn.recording .sa-live-call-widget-video-message-start-stop-recording-btn-inner-wrapper{transform:scale(0.4);background:red;border-radius:8px}.sa-live-call-widget-video-message-start-stop-recording-btn.recording{background:red;color:#fff;display:grid;place-items:center;font-weight:500;font-size:14px;border-radius:50%}.sa-live-call-widget-recorded-video-message{width:100%;height:100%;object-fit:cover;border-radius:8px;display:none}.sa-live-call-widget-video-message-toggle-recording-btn-wrapper{position:absolute;bottom:15px;left:50%;transform:translateX(-50%);display:flex;gap:5px;padding:0 5px;place-items:center;height:40px;background:rgba(0,0,0,.5);border-radius:30px}.sa-live-call-widget-video-message-toggle-recording-btn{width:40px;height:40px;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0) !important;border:none !important;border-radius:50%;cursor:pointer;transition:all 300ms ease-in-out}.sa-live-call-widget-video-message-toggle-recording-btn:hover{background:rgba(0,0,0,.5647058824) !important}.sa-live-call-widget-video-message-switch-camera-btn{display:none;justify-content:center}.sa-live-call-widget-video-message-post-recording-btn{display:flex;gap:10px}.sa-live-call-widget-video-message-post-recording-btn button{margin-top:10px !important}#sa-live-call-widget-video-message-re-record-btn,#sa-live-call-widget-video-message-submit-recording-btn{display:block;width:100%;font-size:14px;padding:12px;outline:none;border:none !important;border-radius:8px;cursor:pointer;font-size:14px;font-weight:700;text-align:center;margin:0 auto}#sa-live-call-widget-video-message-re-record-btn{background:#cdc3ff !important;color:#000 !important}#sa-live-call-widget-video-message-submit-recording-btn{background:#4285f4;color:#fff}.sa-live-call-widget-video-recording-indicator{height:10px;width:10px;border-radius:50%;background-color:#ff5252;animation:recording-animation 1.5s infinite;position:absolute;top:10px;right:10px;z-index:999;display:none}#sa-live-call-widget-video-message-upload-btn{border:none;background:#1e90ff;width:100%;padding:10px;margin-top:10px;display:flex;place-content:center;place-items:center;gap:8px;color:#fff;font-size:14px;font-weight:bold;border-radius:8px;cursor:pointer}#sa-live-call-widget-video-message-upload-btn svg{font-size:18px}@keyframes recording-animation{0%{opacity:0}70%{opacity:1}100%{opacity:0}}@media screen and (max-width: 768px){.sa-live-call-widget-video-message-switch-camera-btn{display:flex}}.sa-live-call-widget-audio-message-page{width:100%;height:100%;padding-bottom:24px}.sa-live-call-widget-audio-message-page p{font-size:18px;font-weight:700;color:#1f1f1f;opacity:.8;padding-bottom:12px}.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper{width:100%;height:85%;background:#1f1f1f;border-radius:8px;margin-bottom:12px;position:relative}.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper .sa-live-call-widget-audio-message-speaking-icon{width:20px;position:absolute;right:10px;top:10px}.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper .sa-live-call-widget-audio-message-waves{width:100%;position:absolute;top:50%;transform:translateY(-50%);display:none}.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper .sa-live-call-widget-audio-message-play-pause-btn{display:none;flex-direction:column;place-items:center;gap:2px;width:68px;box-sizing:content-box;background:#515151 !important;color:var(--sa-live-call-widget-text-color-primary) !important;border:none !important;border-radius:8px;backdrop-filter:blur(4px);font-size:10px;padding:5px 22px;position:absolute;bottom:10px;left:50%;transform:translateX(-50%);cursor:pointer}.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper .sa-live-call-widget-audio-message-play-pause-btn:hover,.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper .sa-live-call-widget-audio-message-play-pause-btn:focus,.sa-live-call-widget-audio-message-page .sa-live-call-widget-audio-message-preview-wrapper .sa-live-call-widget-audio-message-play-pause-btn:active{background:#515151 !important;color:var(--sa-live-call-widget-text-color-primary) !important;border:none !important}.sa-live-call-widget-audio-message-controls-btn-wrapper{display:flex;align-items:center;gap:10px;padding:0 16px}.sa-live-call-widget-audio-message-start-stop-recording-btn{display:block;width:100%;background-color:#4285f4;color:var(--sa-live-call-widget-text-color-primary) !important;font-size:14px;padding:12px;outline:none;border:none !important;border-radius:8px;cursor:pointer;font-size:14px;font-weight:700;text-align:center;margin:0 auto}.sa-live-call-widget-audio-message-start-stop-recording-btn:hover,.sa-live-call-widget-audio-message-start-stop-recording-btn:focus,.sa-live-call-widget-audio-message-start-stop-recording-btn:active{background-color:#4285f4;color:var(--sa-live-call-widget-text-color-primary) !important;border:none !important}.sa-live-call-widget-text-message-page-container{width:100%;height:100%;display:flex;flex-direction:column;padding-bottom:24px}.sa-live-call-widget-audio-message-textarea{min-height:80px;width:100%;resize:none;box-sizing:border-box;font-size:14px;background-image:url("https://static.saleassist.ai/images/textarea.png");background-repeat:no-repeat;background-size:50px;background-position:center;border-radius:5px;border:1px solid var(--sa-live-call-widget-border-color-primary);margin-top:16px;flex:85%;padding:6px 12px;outline:none}.sa-live-call-widget-audio-message-textarea:focus{outline:none}.sa-live-call-widget-audio-message-submit-btn{background:var(--themeColor) !important;color:var(--invertColor) !important;width:100%;border-radius:8px;border:none !important;font-size:18px;font-weight:bold;padding:10px 0;margin:15px auto 0;cursor:pointer;box-shadow:rgba(0,0,0,.2) 0px 3px 3px -2px,rgba(0,0,0,.14) 0px 3px 4px 0px,rgba(0,0,0,.12) 0px 1px 8px 0px}.sa-live-call-widget-audio-message-submit-btn:hover,.sa-live-call-widget-audio-message-submit-btn:focus,.sa-live-call-widget-audio-message-submit-btn:active{background:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-ai-chat-container{background:#f0f2f5 !important;display:flex;flex-direction:column;height:100%}.sa-ai-chat-container *{font-family:"Segoe UI" !important}#saleassistAiChatMessageInput::-webkit-calendar-picker-indicator{display:none}.sa-ai-chat-header{display:flex;align-items:center;gap:10px;background:var(--themeColor);padding:10px 16px 10px 20px;height:60px !important}.sa-ai-chat-header .ai-chat-bot-icon-wrapper{width:40px}.sa-ai-chat-header hr{width:90%;margin:auto}.sa-ai-chat-header-title{font-size:16px;font-weight:500;color:var(--invertColor)}#sa-ai-chat-typing-indicator{display:block;font-size:12px;margin-top:3px;margin-left:2px}.sa-ai-chat-title-initials{background-color:var(--invertColor);color:var(--themeColor);width:32px;height:32px;border-radius:50%;display:flex;justify-content:center;align-items:center;text-transform:uppercase}.sa-ai-chat-log{flex:1;padding:12px;box-shadow:0px 21px 10px -26px rgba(0,0,0,.5) inset,0px -21px 10px -28px rgba(0,0,0,.5) inset;overflow-y:auto}.sa-ai-chat-log .message{position:relative;padding:12px 16px;margin:5px;margin-top:2px;max-width:80%;font-size:14px;line-height:1.5;word-break:break-word;box-shadow:rgba(0,0,0,.15) 0px .6px .54px -1.33px,rgba(0,0,0,.13) 0px 2.29px 2.06px -2.67px,rgba(0,0,0,.04) 0px 10px 9px -4px;border-radius:16px;-webkit-font-smoothing:antialiased}.sa-ai-chat-log .message a{color:inherit;font-weight:500}.sa-ai-chat-log .message-meta-info{position:relative;padding:0 5px;margin:0 5px;font-size:10.5px;color:#6e6e6e;-webkit-font-smoothing:antialiased}.sa-ai-chat-log .message-meta-info span{position:absolute;left:-17px;top:50%;font-size:12px;background:var(--sa-live-call-widget-background-primary);height:20px;width:20px;display:flex;place-content:center;place-items:center;border-radius:50%;color:#007bff;transform:translateY(-50%)}.sa-ai-chat-log .sent{display:flex;flex-direction:column;place-items:end}.sa-ai-chat-log .sent .message{background-color:var(--themeColor);color:var(--invertColor);border-top-right-radius:0px}.sa-ai-chat-log .received{display:flex;flex-direction:column;place-items:start}.sa-ai-chat-log .received .message{background:var(--sa-live-call-widget-background-primary);color:var(--sa-live-call-widget-text-color-secondary);border-top-left-radius:0px}.sa-ai-chat-log .received .message ul,.sa-ai-chat-log .received .message ol{margin-left:16px}.sa-ai-chat-log .received .message ul li,.sa-ai-chat-log .received .message ol li{margin:5px 0px}.sa-ai-chat-log .received .message *{line-height:1.4;margin-bottom:8px}.sa-ai-chat-log .sender-info-wrapper{display:flex;gap:8px}.sa-ai-chat-log .sender-info-wrapper .sender-avatar{background-color:var(--themeColor);color:#fff;width:24px;height:24px;border-radius:50%;display:flex;justify-content:center;align-items:center;text-transform:uppercase;font-size:12px;overflow:hidden}.sa-ai-chat-log .sender-info-wrapper .sender-details{font-size:12px;font-weight:600;color:#71717a;display:flex;align-items:center;gap:6px}.sa-ai-chat-log .sender-info-wrapper .sender-details .message-sent-at{font-size:10px;font-weight:500;color:var(--sa-live-call-widget-placeholder-color-primary)}.sa-ai-chat-log .sender-info-wrapper .sender-details .tick{margin-left:-6px;margin-top:-3px}.sa-ai-chat-log .sent+.received{margin-top:16px}.sa-ai-chat-log .sent+.sent{margin-top:16px}.sa-ai-chat-log .received+.sent{margin-top:16px}.sa-ai-chat-log .received+.received{margin-top:16px}.sa-ai-chat-log #typing-loader-wrapper{width:64px !important;display:flex !important;justify-content:center !important;background:var(--sa-live-call-widget-background-primary);padding:12px 16px;box-shadow:rgba(0,0,0,.15) 0px .6px .54px -1.33px,rgba(0,0,0,.13) 0px 2.29px 2.06px -2.67px,rgba(0,0,0,.04) 0px 10px 9px -4px;border-radius:16px;border-top-left-radius:0px;margin-top:16px}.sa-ai-chat-log #typing-loader-wrapper .loader{width:40px;display:flex;justify-content:space-between;align-items:flex-end}.sa-ai-chat-log #typing-loader-wrapper .loader span{width:7px;height:7px;background:#101010;border-radius:50%;animation:bounce 1.2s infinite ease-in-out}.sa-ai-chat-log #typing-loader-wrapper .loader span:nth-child(1){animation-delay:0s}.sa-ai-chat-log #typing-loader-wrapper .loader span:nth-child(2){animation-delay:.2s}.sa-ai-chat-log #typing-loader-wrapper .loader span:nth-child(3){animation-delay:.4s}@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}.sa-ai-chat-log .ai-chat-offline-cta-wrapper{display:flex;justify-content:space-around;margin:16px 0px;gap:12px}.sa-ai-chat-log .ai-chat-faq-wrapper{display:flex;flex-wrap:wrap;justify-content:stretch;gap:8px;margin:24px 0px 16px}.sa-ai-chat-log .ai-chat-faq-wrapper .ai-chat-faq-btn{background:#fff;color:var(--sa-live-call-widget-text-color-secondary);padding:8px;border:1px solid var(--themeColor);border-radius:12px;cursor:pointer;transition:all 400ms ease-in-out}.sa-ai-chat-log .ai-chat-faq-wrapper .ai-chat-faq-btn:hover{background:var(--themeColor);color:var(--invertColor);border-color:var(--invertColor);scale:1.05}.sa-ai-chat-log .chat-handover-msg{background-color:#efeae2;margin:16px auto;padding:6px 12px;font-size:12px;color:#71717a;text-align:center;border-radius:6px;width:fit-content}.sa-message-not-sent-error{color:var(--sa-live-call-widget-text-color-danger);font-size:16px}.sa-ai-chat-input-box{position:relative;background:#fff;width:96%;margin:6px auto;border-radius:8px;border:1px solid #e3e3e3}.sa-ai-chat-input-box:has(#saleassistAiChatMessageInput:focus){border:2px solid var(--themeColor)}.sa-ai-chat-input-overlay{width:100%;height:100%;background:rgba(0,0,0,.75);position:absolute;top:0;left:0;display:none;place-content:center;place-items:center}.sa-ai-chat-document-preview-container{gap:5px;display:flex;flex-direction:column}.sa-ai-chat-input-container{display:flex}.sa-ai-chat-input-wrapper{flex:1;display:flex;align-items:center;border:none;border-radius:6px;color:var(--sa-live-call-widget-text-color-secondary);position:relative}#sa-ai-chat-toggle-emoji-btn{font-size:20px;cursor:pointer;margin-left:5px}#sa-ai-chat-emoji-wrapper{position:absolute;top:-50px;right:14px;display:none;align-items:center;justify-content:center;gap:10px;font-size:20px;background:#fff;padding:12px;border-radius:10px;box-shadow:rgba(0,0,0,.2) 0px 3px 3px -2px,rgba(0,0,0,.14) 0px 3px 4px 0px,rgba(0,0,0,.12) 0px 1px 8px 0px}#sa-ai-chat-emoji-wrapper.open{display:flex}#sa-ai-chat-emoji-wrapper .sa-ai-chat-emoji{cursor:pointer}#sa-ai-chat-emoji-wrapper .sa-ai-chat-emoji:hover{transform:scale(1.3)}#saleassistAiChatMessageInput{flex:1;padding:0px 0px 0px 5px;border-radius:20px;font-size:14px;border:none;background:rgba(0,0,0,0);outline:none;width:200px;color:var(--sa-live-call-widget-text-color-secondary);height:100%;padding:14px 8px}#saleassistAiChatMessageInput::placeholder{color:var(--sa-live-call-widget-placeholder-color-primary)}#saleassistAiChatMessageInput:-webkit-autofill{-webkit-box-shadow:0 0 0 1000px var(--sa-live-call-widget-background-primary) inset !important;-webkit-text-fill-color:var(--sa-live-call-widget-text-color-secondary) !important}#saleassistAiChatUploadButton{width:22px;height:35px;display:flex;place-content:center;place-items:center;font-size:22px;cursor:not-allowed}#saleassistAiChatSendButton{margin-left:0px;color:var(--themeColor) !important;border:none !important;cursor:pointer;width:25px;font-size:22px;background:rgba(0,0,0,0) !important;margin-right:8px}#saleassistAiChatSendButton:hover,#saleassistAiChatSendButton:focus,#saleassistAiChatSendButton:active{background:rgba(0,0,0,0) !important;color:var(--themeColor) !important;border:none !important}#saleassistAiChatSendButton svg{margin-left:4px;margin-top:-4px;vertical-align:middle}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper .sa-ai-chat-container) .sa-live-call-widget-logo-wrapper{display:none !important}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper .sa-ai-chat-container) .sa-live-call-widget-close-expanded-widget-btn{background:none;color:var(--sa-live-call-widget-text-color-secondary);filter:unset;top:15px;right:10px}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper .sa-ai-chat-container) .sa-live-call-widget-close-expanded-widget-btn svg{width:22px;height:22px;fill:var(--invertColor)}.sa-live-call-widget-expanded:has(.sa-live-call-widget-expanded-inner-wrapper .sa-ai-chat-container) .sa-live-call-widget-logo-wrapper{left:10px}.sa-live-call-widget-payment-request-page{padding:0 12px !important}.sa-live-call-widget-payment-request-page .sa-live-call-widget-payment-request-description{padding-bottom:12px}#sa-live-call-widget-advance-payment-btn{display:block;width:100%;background-color:var(--themeColor) !important;color:var(--invertColor) !important;font-size:14px;padding:10px 20px;outline:none;border:none !important;border-radius:6px;cursor:pointer;line-height:1}#sa-live-call-widget-advance-payment-btn:hover,#sa-live-call-widget-advance-payment-btn:focus,#sa-live-call-widget-advance-payment-btn:active{background-color:var(--themeColor) !important;color:var(--invertColor) !important;border:none !important}.sa-live-call-widget-share-widget-container{position:absolute;inset:0;background:rgba(0,0,0,.7);z-index:2147483647;display:none}.sa-live-call-widget-share-widget-inner-container{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);min-width:70%;padding:28px;border-radius:8px;display:flex;justify-content:center;align-items:center;flex-direction:column;z-index:2147483647;background-image:linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%) !important}.sa-live-call-widget-share-widget-container-heading{font-size:16px;font-weight:500;margin-bottom:8px}.sa-live-call-widget-share-widget-btn-container{display:flex;align-items:center;gap:4px}.sa-live-call-widget-share-widget-btn-container svg{cursor:pointer}.sa-live-call-widget-copy-widget-page-url-btn{display:flex;align-items:center;gap:4px;margin-top:10px;padding:5px 10px 5px 5px;border-radius:5px;cursor:pointer}.sa-live-call-widget-copy-widget-page-url-btn:hover{background:#ccc}.sa-live-call-widget-copy-widget-page-url-btn .sa-live-call-widget-copy-widget-page-url-btn-icon{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%;background:#000;color:var(--sa-live-call-widget-text-color-primary);font-size:12px}.sa-live-call-widget-copy-widget-page-url-btn .sa-live-call-widget-copy-widget-page-url-btn-text{color:#202020;font-size:14px;font-weight:400;line-height:18px;cursor:pointer;padding:5px 10px 5px 5px;border-radius:5px}.sa-live-call-widget-close-share-widget-popup-btn{position:absolute;top:2px;right:2px;cursor:pointer}.sa-live-call-widget-video-message-page{width:100%;height:100%}.sa-live-call-widget-video-message-page .sa-live-call-widget-video-preview-wrapper{width:100%;height:100%;background:#1f1f1f;border-radius:8px;margin-bottom:12px;position:relative}.sa-live-call-widget-video-message-page .sa-live-call-widget-video-preview-wrapper.video-recorded{height:90% !important}.sa-live-call-widget-video-message-page .sa-live-call-widget-video-preview{width:100%;height:100%;object-fit:cover;border-radius:8px}.sa-live-call-widget-capture-image-btn{background:#fff;color:#000;padding:10px 24px;border-radius:999px;cursor:pointer;position:absolute;left:50%;bottom:0;transform:translateX(-50%)}.sa-live-call-widget-capture-image-btn.recording .sa-live-call-widget-capture-image-btn-inner-wrapper{transform:scale(0.4);border-radius:8px}.sa-live-call-capture-image-btn-wrapper{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);display:flex;gap:5px;width:100%;padding:0 10px}.sa-live-call-widget-captured-image{width:100% !important;height:100% !important}.sa-live-call-widget-video-message-toggle-recording-btn{width:40px;height:40px;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0) !important;border:none !important;border-radius:50%;cursor:pointer;transition:all 300ms ease-in-out}.sa-live-call-widget-video-message-toggle-recording-btn:hover{background:rgba(0,0,0,.5647058824) !important}.sa-live-call-widget-switch-camera-btn{display:none;justify-content:center;position:absolute;bottom:0;right:10px}.sa-live-call-widget-post-captured-image-btn-wrapper{display:flex;gap:10px}#sa-live-call-widget-recapture-image-btn,#sa-live-call-widget-submit-captured-image-btn{display:block;width:100%;font-size:14px;padding:12px;outline:none;border:none !important;border-radius:8px;cursor:pointer;font-size:14px;font-weight:700;text-align:center;margin:0 auto}#sa-live-call-widget-recapture-image-btn{background:#cdc3ff !important;color:#000 !important}#sa-live-call-widget-submit-captured-image-btn{background:#4285f4;color:#fff}.sa-live-call-widget-video-recording-indicator{height:10px;width:10px;border-radius:50%;background-color:#ff5252;animation:recording-animation 1.5s infinite;position:absolute;top:10px;right:10px;z-index:999;display:none}@keyframes recording-animation{0%{opacity:0}70%{opacity:1}100%{opacity:0}}@media screen and (max-width: 768px){.sa-live-call-widget-switch-camera-btn{display:flex}}.saleassist-notification{position:fixed;border-style:solid;box-shadow:0px 2px 4px -1px rgba(0,0,0,.2),0px 4px 5px 0px rgba(0,0,0,.14),0px 1px 10px 0px rgba(0,0,0,.12);animation:notification-slide .3s linear forwards;z-index:2147483647 !important}.saleassist-notification.top_left{inset:0px auto auto 0px;transform:translateX(-150%)}.saleassist-notification.top_right{inset:0px 0px auto auto;transform:translateX(150%)}.saleassist-notification.bottom_left{inset:auto auto 0px 0px;transform:translateX(-150%)}.saleassist-notification.bottom_right{inset:auto 0px 0px auto;transform:translateX(150%)}.saleassist-notification.hidden{transform:translateX(0)}.saleassist-notification.top_left.hidden,.saleassist-notification.bottom_left.hidden{animation:notification-slide-left .3s linear forwards}.saleassist-notification.top_right.hidden,.saleassist-notification.bottom_right.hidden{animation:notification-slide-right .3s linear forwards}.saleassist-notification .notification-wrapper{width:100%;height:100%;display:flex;flex-direction:column;border-style:solid;animation:notification-border-blink 3s linear infinite;user-select:none}.saleassist-notification .notification-wrapper .notification-title{font-weight:600;margin:0;line-height:1}.saleassist-notification .notification-wrapper .notification-title #notification-close-btn.close-icon{display:flex;float:right;cursor:pointer}.saleassist-notification .notification-wrapper .notification-content{margin:0;line-height:normal}.saleassist-notification .notification-wrapper .notification-buttons-wrapper{display:flex}.saleassist-notification .notification-wrapper .notification-buttons-wrapper button{line-height:1;border-style:solid;cursor:pointer}@keyframes notification-slide{to{transform:translateX(0)}}@keyframes notification-slide-left{to{transform:translateX(-150%)}}@keyframes notification-slide-right{to{transform:translateX(150%)}}@keyframes notification-border-blink{0%{border-color:var(--content-border-color)}50%{border-color:rgba(0,0,0,0)}100%{border-color:var(--content-border-color)}}.saleassist-notification-btn{position:fixed;text-orientation:mixed;font-weight:500;line-height:1;border-style:solid;cursor:pointer;user-select:none;white-space:nowrap;z-index:2147483647 !important}.saleassist-notification-btn.top_left{inset:0px auto auto 0px}.saleassist-notification-btn.top_right{inset:0px 0px auto auto}.saleassist-notification-btn.bottom_left{inset:auto auto 0px 0px}.saleassist-notification-btn.bottom_right{inset:auto 0px 0px auto}.saleassist-notification-btn.hidden{display:none}.saleassist-notification-btn img,.saleassist-notification-btn video{width:100%;height:100%;border-radius:inherit}.ThomasCookCustomization .sa-live-call-widget-close-expanded-widget-btn{background:rgba(0,0,0,0);filter:unset;top:10px}.ThomasCookCustomization .sa-live-call-widget-logo-wrapper{position:relative;background:var(--themeColor)}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper{display:flex;flex-direction:column}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper #sa-live-call-widget-hls-video{height:auto !important;position:relative !important;border-radius:unset}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-mute-unmute-video-btn{right:22px !important;top:72px !important}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper{position:unset;transform:unset;gap:16px;padding:16px;overflow:auto}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-live-call-widget-cta-text{font-size:14px;font-weight:400;background:none;color:#1c1c1e;margin-bottom:0;text-align:left;line-height:normal;max-width:280px}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper-2{flex-direction:column;gap:16px}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-btn-cta-icon-box-expanded{max-width:100%;height:auto;background-color:#e6f4fb;color:#000;padding:12px;gap:16px;flex-direction:row;justify-content:flex-start;box-shadow:0px 2px 8px 0px rgba(189,190,198,.08)}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-btn-cta-icon-box-expanded .sa-live-call-widget-ball-scale-multiple{display:none}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-btn-cta-icon-box-expanded svg{width:20px;height:20px}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-btn-cta-icon-box-expanded span{font-size:14px;font-weight:600}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-btn-cta-icon-box-expanded:nth-child(1) svg{stroke:var(--themeColor)}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-expanded-cta-btn-wrapper .sa-btn-cta-icon-box-expanded:nth-child(2) svg path{fill:var(--themeColor)}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-lead-capture-form-container{padding:0px;position:relative;flex:1}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-lead-capture-form-container .sa-live-call-widget-lead-capture-form-wrapper{padding:20px 20px;flex:1}.ThomasCookCustomization .sa-live-call-widget-expanded-inner-wrapper .sa-live-call-widget-lead-capture-form-container .sa-live-call-widget-lead-capture-form-submit-btn-wrapper{width:100%}.ThomasCookCustomization .sa-live-call-widget-default-container{padding-top:5px}',""]);const s=a},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);r&&a[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),t.push(d))}},t}},3626:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},7484:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",i="second",o="minute",a="hour",s="day",c="week",l="month",d="quarter",u="year",p="date",h="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},_={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,l),o=n-i<0,a=t.clone().add(r+(o?-1:1),l);return+(-(r+(n-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:u,w:c,d:s,D:p,h:a,m:o,s:i,ms:r,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",w={};w[y]=g;var b="$isDayjsObject",E=function(e){return e instanceof R||!(!e||!e[b])},S=function e(t,n,r){var i;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();w[o]&&(i=o),n&&(w[o]=n,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;w[s]=t,i=s}return!r&&i&&(y=i),i||!r&&y},T=function(e,t){if(E(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new R(n)},C=_;C.l=S,C.i=E,C.w=function(e,t){return T(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var R=function(){function g(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[b]=!0}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return C},v.isValid=function(){return!(this.$d.toString()===h)},v.isSame=function(e,t){var n=T(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return T(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<T(e)},v.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!C.u(t)||t,d=C.p(e),h=function(e,t){var i=C.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?i:i.endOf(s)},f=function(e,t){return C.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,_="set"+(this.$u?"UTC":"");switch(d){case u:return r?h(1,0):h(31,11);case l:return r?h(1,g):h(0,g+1);case c:var y=this.$locale().weekStart||0,w=(m<y?m+7:m)-y;return h(r?v-w:v+(6-w),g);case s:case p:return f(_+"Hours",0);case a:return f(_+"Minutes",1);case o:return f(_+"Seconds",2);case i:return f(_+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,c=C.p(e),d="set"+(this.$u?"UTC":""),h=(n={},n[s]=d+"Date",n[p]=d+"Date",n[l]=d+"Month",n[u]=d+"FullYear",n[a]=d+"Hours",n[o]=d+"Minutes",n[i]=d+"Seconds",n[r]=d+"Milliseconds",n)[c],f=c===s?this.$D+(t-this.$W):t;if(c===l||c===u){var m=this.clone().set(p,1);m.$d[h](f),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[C.p(e)]()},v.add=function(r,d){var p,h=this;r=Number(r);var f=C.p(d),m=function(e){var t=T(h);return C.w(t.date(t.date()+Math.round(e*r)),h)};if(f===l)return this.set(l,this.$M+r);if(f===u)return this.set(u,this.$y+r);if(f===s)return m(1);if(f===c)return m(7);var g=(p={},p[o]=t,p[a]=n,p[i]=e,p)[f]||1,v=this.$d.getTime()+r*g;return C.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=C.z(this),o=this.$H,a=this.$m,s=this.$M,c=n.weekdays,l=n.months,d=n.meridiem,u=function(e,n,i,o){return e&&(e[n]||e(t,r))||i[n].slice(0,o)},p=function(e){return C.s(o%12||12,e,"0")},f=d||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(m,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return C.s(t.$y,4,"0");case"M":return s+1;case"MM":return C.s(s+1,2,"0");case"MMM":return u(n.monthsShort,s,l,3);case"MMMM":return u(l,s);case"D":return t.$D;case"DD":return C.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(n.weekdaysMin,t.$W,c,2);case"ddd":return u(n.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(o);case"HH":return C.s(o,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return f(o,a,!0);case"A":return f(o,a,!1);case"m":return String(a);case"mm":return C.s(a,2,"0");case"s":return String(t.$s);case"ss":return C.s(t.$s,2,"0");case"SSS":return C.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,p,h){var f,m=this,g=C.p(p),v=T(r),_=(v.utcOffset()-this.utcOffset())*t,y=this-v,w=function(){return C.m(m,v)};switch(g){case u:f=w()/12;break;case l:f=w();break;case d:f=w()/3;break;case c:f=(y-_)/6048e5;break;case s:f=(y-_)/864e5;break;case a:f=y/n;break;case o:f=y/t;break;case i:f=y/e;break;default:f=y}return h?f:C.a(f)},v.daysInMonth=function(){return this.endOf(l).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=S(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return C.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),O=R.prototype;return T.prototype=O,[["$ms",r],["$s",i],["$m",o],["$H",a],["$W",s],["$M",l],["$y",u],["$D",p]].forEach((function(e){O[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),T.extend=function(e,t){return e.$i||(e(t,R,T),e.$i=!0),T},T.locale=S,T.isDayjs=E,T.unix=function(e){return T(1e3*e)},T.en=w[y],T.Ls=w,T.p={},T}()},2025:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  id="camera-off"\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0zm0 0h24v24H0z"></path>\n  <path\n    d="M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z"\n  ></path>\n</svg>'},useData:!0})},2500:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  id="camera-on"\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0z"></path>\n  <path\n    d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"\n  ></path>\n</svg>'},useData:!0})},2832:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.708 7.755c0-1.111.488-1.753 1.319-1.753.681 0 1.138.47 1.186 1.107H7.36V7c-.052-1.186-1.024-2-2.342-2C3.414 5 2.5 6.05 2.5 7.751v.747c0 1.7.905 2.73 2.518 2.73 1.314 0 2.285-.792 2.342-1.939v-.114H6.213c-.048.615-.496 1.05-1.186 1.05-.84 0-1.319-.62-1.319-1.727v-.743zm6.14 0c0-1.111.488-1.753 1.318-1.753.682 0 1.139.47 1.187 1.107H13.5V7c-.053-1.186-1.024-2-2.342-2C9.554 5 8.64 6.05 8.64 7.751v.747c0 1.7.905 2.73 2.518 2.73 1.314 0 2.285-.792 2.342-1.939v-.114h-1.147c-.048.615-.497 1.05-1.187 1.05-.839 0-1.318-.62-1.318-1.727v-.743z"></path><path d="M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h12zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H2z"></path></svg>'},useData:!0})},7651:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 512 512"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M400 145.49L366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49z"\n  ></path>\n</svg>'},useData:!0})},5583:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="none"\n  stroke-width="2"\n  viewBox="0 0 24 24"\n  aria-hidden="true"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    stroke-linecap="round"\n    stroke-linejoin="round"\n    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"\n  ></path>\n</svg>'},useData:!0})},8738:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0z"></path>\n  <path\n    d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08a.956.956 0 01-.29-.7c0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28a11.27 11.27 0 00-2.67-1.85.996.996 0 01-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"\n  ></path>\n</svg>'},useData:!0})},429:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 384 512"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"\n  ></path>\n</svg>'},useData:!0})},296:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0z"></path>\n  <path\n    d="M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-8 13c-2.76 0-5-2.24-5-5H5l2.5-2.5L10 13H8c0 2.21 1.79 4 4 4 .58 0 1.13-.13 1.62-.35l.74.74c-.71.37-1.5.61-2.36.61zm4.5-2.5L14 13h2c0-2.21-1.79-4-4-4-.58 0-1.13.13-1.62.35l-.74-.73C10.35 8.24 11.14 8 12 8c2.76 0 5 2.24 5 5h2l-2.5 2.5z"\n  ></path>\n</svg>'},useData:!0})},6567:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 1024 1024"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 0 0 .6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0 0 46.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"\n  ></path>\n</svg>'},useData:!0})},8437:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  style="font-size: 24px;"\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"\n  ></path>\n</svg>'},useData:!0})},2012:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>'},useData:!0})},9346:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="none"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="16"\n  width="16"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path d="M3 3H9V5H5V9H3V3Z" fill="currentColor"></path>\n  <path d="M3 21H9V19H5V15H3V21Z" fill="currentColor"></path>\n  <path d="M15 21H21V15H19V19H15V21Z" fill="currentColor"></path>\n  <path d="M21 3H15V5H19V9H21V3Z" fill="currentColor"></path>\n</svg>'},useData:!0})},8073:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M20 2H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h3v3.767L13.277 18H20c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zm0 14h-7.277L9 18.233V16H4V4h16v12z"\n  ></path>\n  <path d="M7 7h10v2H7zm0 4h7v2H7z"></path>\n</svg>'},useData:!0})},8958:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  id="mic-off"\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0zm0 0h24v24H0z"></path>\n  <path\n    d="M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"\n  ></path>\n</svg>'},useData:!0})},5494:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  id="mic-on"\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0z"></path>\n  <path\n    d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"\n  >\n  </path>\n</svg>'},useData:!0})},5506:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><polyline points="4 14 10 14 10 20"></polyline><polyline points="20 10 14 10 14 4"></polyline><line x1="14" y1="10" x2="21" y2="3"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>'},useData:!0})},5321:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="none"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="16"\n  width="16"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path d="M9 9H3V7H7V3H9V9Z" fill="currentColor"></path>\n  <path d="M9 15H3V17H7V21H9V15Z" fill="currentColor"></path>\n  <path d="M21 15H15V21H17V17H21V15Z" fill="currentColor"></path>\n  <path\n    d="M15 9.00012H21V7.00012H17V3.00012H15V9.00012Z"\n    fill="currentColor"\n  ></path>\n</svg>'},useData:!0})},4925:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="none"\n  stroke-width="2"\n  viewBox="0 0 24 24"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <circle cx="12" cy="12" r="1"></circle>\n  <circle cx="19" cy="12" r="1"></circle>\n  <circle cx="5" cy="12" r="1"></circle>\n</svg>'},useData:!0})},7565:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 4C7.31 4 3.07 5.9 0 8.98L12 21 24 8.98A16.88 16.88 0 0 0 12 4zM2.92 9.07C5.51 7.08 8.67 6 12 6s6.49 1.08 9.08 3.07l-2.85 2.86A10.945 10.945 0 0 0 12 10c-2.31 0-4.46.71-6.23 1.93L2.92 9.07z"></path></svg>'},useData:!0})},9219:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="none"\n  stroke-width="2"\n  viewBox="0 0 24 24"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path\n    d="M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2"\n  ></path>\n  <path d="M20 3l0 4"></path>\n  <path d="M16 3l0 4"></path>\n</svg>'},useData:!0})},1673:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 16 16"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M8 12a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0 1A5 5 0 1 0 8 3a5 5 0 0 0 0 10z"\n  >\n  </path>\n  <path d="M10 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"></path>\n</svg>'},useData:!0})},9847:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0V0z"></path>\n  <path\n    d="M21.22 18.02l2 2H24v-2h-2.78zm.77-2l.01-10a2 2 0 00-2-2H7.22l5.23 5.23c.18-.04.36-.07.55-.1V7.02l4 3.73-1.58 1.47 5.54 5.54c.61-.33 1.03-.99 1.03-1.74zM2.39 1.73L1.11 3l1.54 1.54c-.4.36-.65.89-.65 1.48v10a2 2 0 002 2H0v2h18.13l2.71 2.71 1.27-1.27L2.39 1.73zM7 15.02c.31-1.48.92-2.95 2.07-4.06l1.59 1.59c-1.54.38-2.7 1.18-3.66 2.47z"\n  ></path>\n</svg>'},useData:!0})},710:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0V0z"></path>\n  <path\n    d="M20 18c1.1 0 1.99-.9 1.99-2L22 6a2 2 0 00-2-2H4c-1.11 0-2 .89-2 2v10a2 2 0 002 2H0v2h24v-2h-4zm-7-3.53v-2.19c-2.78 0-4.61.85-6 2.72.56-2.67 2.11-5.33 6-5.87V7l4 3.73-4 3.74z"\n  ></path>\n</svg>'},useData:!0})},8873:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 512 512"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path d="M16 464l480-208L16 48v160l320 48-320 48z"></path>\n</svg>'},useData:!0})},3618:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 1024 1024"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M512.5 390.6c-29.9 0-57.9 11.6-79.1 32.8-21.1 21.2-32.8 49.2-32.8 79.1 0 29.9 11.7 57.9 32.8 79.1 21.2 21.1 49.2 32.8 79.1 32.8 29.9 0 57.9-11.7 79.1-32.8 21.1-21.2 32.8-49.2 32.8-79.1 0-29.9-11.7-57.9-32.8-79.1a110.96 110.96 0 0 0-79.1-32.8zm412.3 235.5l-65.4-55.9c3.1-19 4.7-38.4 4.7-57.7s-1.6-38.8-4.7-57.7l65.4-55.9a32.03 32.03 0 0 0 9.3-35.2l-.9-2.6a442.5 442.5 0 0 0-79.6-137.7l-1.8-2.1a32.12 32.12 0 0 0-35.1-9.5l-81.2 28.9c-30-24.6-63.4-44-99.6-57.5l-15.7-84.9a32.05 32.05 0 0 0-25.8-25.7l-2.7-.5c-52-9.4-106.8-9.4-158.8 0l-2.7.5a32.05 32.05 0 0 0-25.8 25.7l-15.8 85.3a353.44 353.44 0 0 0-98.9 57.3l-81.8-29.1a32 32 0 0 0-35.1 9.5l-1.8 2.1a445.93 445.93 0 0 0-79.6 137.7l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.2 56.5c-3.1 18.8-4.6 38-4.6 57 0 19.2 1.5 38.4 4.6 57l-66 56.5a32.03 32.03 0 0 0-9.3 35.2l.9 2.6c18.1 50.3 44.8 96.8 79.6 137.7l1.8 2.1a32.12 32.12 0 0 0 35.1 9.5l81.8-29.1c29.8 24.5 63 43.9 98.9 57.3l15.8 85.3a32.05 32.05 0 0 0 25.8 25.7l2.7.5a448.27 448.27 0 0 0 158.8 0l2.7-.5a32.05 32.05 0 0 0 25.8-25.7l15.7-84.9c36.2-13.6 69.6-32.9 99.6-57.5l81.2 28.9a32 32 0 0 0 35.1-9.5l1.8-2.1c34.8-41.1 61.5-87.4 79.6-137.7l.9-2.6c4.3-12.4.6-26.3-9.5-35zm-412.3 52.2c-97.1 0-175.8-78.7-175.8-175.8s78.7-175.8 175.8-175.8 175.8 78.7 175.8 175.8-78.7 175.8-175.8 175.8z"\n  ></path>\n</svg>'},useData:!0})},4520:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 512 512"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M444.7 230.4l-141.1-132c-1.7-1.6-3.3-2.5-5.6-2.4-4.4.2-10 3.3-10 8v66.2c0 2-1.6 3.8-3.6 4.1C144.1 195.8 85 300.8 64.1 409.8c-.8 4.3 5 8.3 7.7 4.9 51.2-64.5 113.5-106.6 212-107.4 2.2 0 4.2 2.6 4.2 4.8v65c0 7 9.3 10.1 14.5 5.3l142.1-134.3c2.6-2.4 3.4-5.2 3.5-8.4-.1-3.2-.9-6.9-3.4-9.3z"\n  ></path>\n</svg>'},useData:!0})},7458:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><circle cx="128" cy="256" r="48" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="384" cy="112" r="48" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="384" cy="400" r="48" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="m169.83 279.53 172.34 96.94m0-240.94-172.34 96.94"></path></svg>'},useData:!0})},7339:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="none"\n  stroke-width="2"\n  viewBox="0 0 24 24"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle>\n  <path\n    d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"\n  ></path>\n</svg>'},useData:!0})},9644:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 256 256"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n  transform="rotate(-45)"\n>\n  <path\n    d="M209.66,122.34a8,8,0,0,1,0,11.32l-82.05,82a56,56,0,0,1-79.2-79.21L147.67,35.73a40,40,0,1,1,56.61,56.55L105,193A24,24,0,1,1,71,159L154.3,74.38A8,8,0,1,1,165.7,85.6L82.39,170.31a8,8,0,1,0,11.27,11.36L192.93,81A24,24,0,1,0,159,47L59.76,147.68a40,40,0,1,0,56.53,56.62l82.06-82A8,8,0,0,1,209.66,122.34Z"\n  ></path>\n</svg>'},useData:!0})},1906:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0V0z"></path>\n  <path\n    d="M9 12c1.93 0 3.5-1.57 3.5-3.5S10.93 5 9 5 5.5 6.57 5.5 8.5 7.07 12 9 12zm0-5c.83 0 1.5.67 1.5 1.5S9.83 10 9 10s-1.5-.67-1.5-1.5S8.17 7 9 7zm.05 10H4.77c.99-.5 2.7-1 4.23-1 .11 0 .23.01.34.01.34-.73.93-1.33 1.64-1.81-.73-.13-1.42-.2-1.98-.2-2.34 0-7 1.17-7 3.5V19h7v-1.5c0-.17.02-.34.05-.5zm7.45-2.5c-1.84 0-5.5 1.01-5.5 3V19h11v-1.5c0-1.99-3.66-3-5.5-3zm1.21-1.82c.76-.43 1.29-1.24 1.29-2.18a2.5 2.5 0 00-5 0c0 .94.53 1.75 1.29 2.18.36.2.77.32 1.21.32s.85-.12 1.21-.32z"\n  ></path>\n</svg>'},useData:!0})},4699:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M13.939 4.939 6.879 12l7.06 7.061 2.122-2.122L11.121 12l4.94-4.939z"\n  ></path>\n</svg>'},useData:!0})},6240:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-device-access-error-wrapper">\n  <div class="sa-device-access-error-cont">\n    <div class="sa-device-access-error-header">'+e.escapeExpression(typeof(a=null!=(a=d(n,"headerText")||(null!=t?d(t,"headerText"):t))?a:c)===l?a.call(s,{name:"headerText",hash:{},data:i,loc:{start:{line:3,column:47},end:{line:3,column:61}}}):a)+'</div>\n    <div class="sa-device-access-error-body">'+(null!=(o=typeof(a=null!=(a=d(n,"bodyText")||(null!=t?d(t,"bodyText"):t))?a:c)===l?a.call(s,{name:"bodyText",hash:{},data:i,loc:{start:{line:4,column:45},end:{line:4,column:59}}}):a)?o:"")+'</div>\n    <div class="sa-device-access-error-footer">\n      <div class="sa-device-access-error-dismiss-btn">Dismiss</div>\n    </div>\n  </div>\n</div>\n\n<style>\n.sa-device-access-error-wrapper {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  z-index: 1025;\n  background: rgb(255 255 255 / 10%);\n  backdrop-filter: blur(2px);\n}\n.sa-device-access-error-cont {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 310px;\n  background: #2d2d2d;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  border-radius: 15px;\n  box-shadow: rgba(0, 0, 0, 0.4) 0px 3px 5px -1px,\n    rgba(0, 0, 0, 0.34) 0px 6px 10px 0px, rgba(0, 0, 0, 0.32) 0px 1px 18px 0px;\n}\n\n.sa-device-access-error-header {\n  font-size: 16px;\n  font-weight: bold;\n  text-align: justify;\n  color: #e5e5e5;\n}\n\n.sa-device-access-error-body {\n  font-size: 14px;\n  text-align: justify;\n  color: #a5a5a5;\n\n  ul {\n    list-style-type: none;\n    margin: 16px 0 0;\n    padding: 8px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    border-radius: 8px;\n    background: #000;\n    border-left: 2px solid #477bae;\n  }\n\n  li {\n    .steps {\n        font-size: 12px;\n        color: #7f8c8d;\n        display: block;\n        margin-bottom: 5px;\n    }\n\n    .item {\n        font-size: 14px;\n        color: #477bae;\n\n        svg {\n            color: #7f8c8d;\n            vertical-align: bottom;\n        }\n\n        .mobile-view {\n            display: none;\n        }\n\n        @media screen and (max-width: 768px) {\n            .mobile-view {\n                display: inline;\n            }\n        }\n    }\n  }\n}\n\n.sa-device-access-error-footer {\n  display: flex;\n  place-content: flex-end;\n\n  .sa-device-access-error-dismiss-btn {\n    font-size: 14px;\n    font-weight: bold;\n    color: var(--sa-live-call-widget-text-color-danger);\n    width: max-content;\n    background: rgb(235 39 30 / 15%);\n    padding: 5px 10px;\n    border-radius: 5px;\n    cursor: pointer;\n    user-select: none;\n  }\n}\n</style>'},useData:!0})},8540:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-hold-screen-overlay-wrapper">\n  <div class="sa-hold-screen-wrapper">\n    <div class="sa-hold-screen-header">\n      <span class="sa-hold-screen-icon">'+(null!=(o="function"==typeof(a=null!=(a=s(n,"phoneHold")||(null!=t?s(t,"phoneHold"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"phoneHold",hash:{},data:i,loc:{start:{line:4,column:40},end:{line:4,column:55}}}):a)?o:"")+'</span>\n      <span class="sa-hold-screen-text">Please be on Hold,<br />We will be back\n        shortly.</span>\n    </div>\n    <div class="sa-hold-screen-body">\n      <div class="sa-hold-screen-waiting-message"></div>\n    </div>\n  </div>\n</div>'},useData:!0})},2615:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="saleassist-video-call-shopping-container sa-shopping-hidden">\n    <div class="saleassist-video-call-shopping-header">\n      <span>Shopping</span>\n      <span id="saleassistVideoShoppingCloseButton">'+(null!=(o="function"==typeof(a=null!=(a=s(n,"closeBtn")||(null!=t?s(t,"closeBtn"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"closeBtn",hash:{},data:i,loc:{start:{line:11,column:52},end:{line:11,column:66}}}):a)?o:"")+'</span>\n    </div>\n\n    <div class="saleassist-video-call-products-container">\n    </div>\n  </div>\n'},3:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="sa-video-call-top-bar">\n      <div id="videoCallShareUrlCopyButton" class="sa-video-call-top-bar-button">\n        '+(null!=(o=typeof(a=null!=(a=d(n,"shareUrl")||(null!=t?d(t,"shareUrl"):t))?a:c)===l?a.call(s,{name:"shareUrl",hash:{},data:i,loc:{start:{line:39,column:8},end:{line:39,column:22}}}):a)?o:"")+'\n      </div>\n      <div id="videoCallMaximizeButton" class="sa-video-call-top-bar-button">\n        '+(null!=(o=typeof(a=null!=(a=d(n,"maximize")||(null!=t?d(t,"maximize"):t))?a:c)===l?a.call(s,{name:"maximize",hash:{},data:i,loc:{start:{line:42,column:8},end:{line:42,column:22}}}):a)?o:"")+'\n      </div>\n      <div id="liveStreamCloseButton" class="sa-video-call-top-bar-button">\n        '+(null!=(o=typeof(a=null!=(a=d(n,"closeBtn")||(null!=t?d(t,"closeBtn"):t))?a:c)===l?a.call(s,{name:"closeBtn",hash:{},data:i,loc:{start:{line:45,column:8},end:{line:45,column:22}}}):a)?o:"")+"\n      </div>\n    </div>\n"},5:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div id="videoCallShareUrlCopyButton" class="sa-video-call-top-bar-button '+(null!=(o=d(n,"if").call(s,null!=t?d(t,"isEmbedOrJump"):t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i,loc:{start:{line:49,column:78},end:{line:49,column:116}}}))?o:"")+'">\n      '+(null!=(o=typeof(a=null!=(a=d(n,"shareUrl")||(null!=t?d(t,"shareUrl"):t))?a:c)===l?a.call(s,{name:"shareUrl",hash:{},data:i,loc:{start:{line:50,column:6},end:{line:50,column:20}}}):a)?o:"")+"\n    </div>\n"+(null!=(o=d(n,"unless").call(s,null!=t?d(t,"isEmbedOrJump"):t,{name:"unless",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i,loc:{start:{line:52,column:4},end:{line:56,column:15}}}))?o:"")+'    <div id="videoCallMaximizeButton" class="sa-video-call-top-bar-button">\n      '+(null!=(o=typeof(a=null!=(a=d(n,"maximize")||(null!=t?d(t,"maximize"):t))?a:c)===l?a.call(s,{name:"maximize",hash:{},data:i,loc:{start:{line:58,column:6},end:{line:58,column:20}}}):a)?o:"")+'\n    </div>\n    <div id="videoCallMaxTileOverlay" style="display: none;">\n'+(null!=(o=d(n,"if").call(s,null!=t?d(t,"isAudioCall"):t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i,loc:{start:{line:61,column:6},end:{line:69,column:13}}}))?o:"")+'    </div>\n    <div class="sa-video-call-action-panel"></div>\n    <div class="sa-lead-capture-prompt"></div>\n'},6:function(e,t,n,r,i){return"embed-mode"},8:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div id="videoCallMinTileButton" class="sa-video-call-top-bar-button">\n        '+(null!=(o="function"==typeof(a=null!=(a=s(n,"minTile")||(null!=t?s(t,"minTile"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"minTile",hash:{},data:i,loc:{start:{line:54,column:8},end:{line:54,column:21}}}):a)?o:"")+"\n      </div>\n"},10:function(e,t,n,r,i){return'        <div class="mic-animation">\n          <div class="bar"></div>\n          <div class="bar"></div>\n          <div class="bar"></div>\n        </div>\n'},12:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        "+(null!=(o="function"==typeof(a=null!=(a=s(n,"maxTile")||(null!=t?s(t,"maxTile"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"maxTile",hash:{},data:i,loc:{start:{line:68,column:8},end:{line:68,column:21}}}):a)?o:"")+"\n"},14:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="sa-live-stream-controls-mobile">\n      <button id="sa-live-stream-shoppingCart" class="sa-live-stream-icons">\n        '+(null!=(o=typeof(a=null!=(a=d(n,"shoppingCart")||(null!=t?d(t,"shoppingCart"):t))?a:c)===l?a.call(s,{name:"shoppingCart",hash:{},data:i,loc:{start:{line:79,column:8},end:{line:79,column:26}}}):a)?o:"")+'\n      </button>\n      <button id="sa-live-stream-message" class="sa-live-stream-icons">\n        <span class="sa-message-notification"></span>\n        '+(null!=(o=typeof(a=null!=(a=d(n,"message")||(null!=t?d(t,"message"):t))?a:c)===l?a.call(s,{name:"message",hash:{},data:i,loc:{start:{line:83,column:8},end:{line:83,column:21}}}):a)?o:"")+'\n      </button>\n      <button id="sa-live-stream-share" class="sa-live-stream-icons">\n        '+(null!=(o=typeof(a=null!=(a=d(n,"shareIcon")||(null!=t?d(t,"shareIcon"):t))?a:c)===l?a.call(s,{name:"shareIcon",hash:{},data:i,loc:{start:{line:86,column:8},end:{line:86,column:23}}}):a)?o:"")+"\n      </button>\n    </div>\n"},16:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="sa-live-stream-info-bar">\n        <div class="sa-live-stream-live-button">\n          Live\n        </div>\n        <div class="sa-live-stream-info">\n          '+(null!=(o="function"==typeof(a=null!=(a=s(n,"UserCountIcon")||(null!=t?s(t,"UserCountIcon"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"UserCountIcon",hash:{},data:i,loc:{start:{line:98,column:10},end:{line:98,column:29}}}):a)?o:"")+"\n          <span>0</span>\n        </div>\n      </div>\n"},18:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <button id="sa-shoppingCart" class="control-button">'+(null!=(o="function"==typeof(a=null!=(a=s(n,"shoppingCart")||(null!=t?s(t,"shoppingCart"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"shoppingCart",hash:{},data:i,loc:{start:{line:151,column:58},end:{line:151,column:76}}}):a)?o:"")+"</button>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="saleassist-video-call-loader">\n  '+(null!=(o=typeof(a=null!=(a=u(n,"threeDotsLoader")||(null!=t?u(t,"threeDotsLoader"):t))?a:c)===l?a.call(s,{name:"threeDotsLoader",hash:{},data:i,loc:{start:{line:2,column:2},end:{line:2,column:23}}}):a)?o:"")+'\n  <p>Getting ready...<br />You\'ll be able to join in just a moment</p>\n  <p class="permission-info">Please Click on "Allow" to Continue</p>\n</div>\n\n'+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isLiveStream"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:7,column:0},end:{line:18,column:7}}}))?o:"")+'\n<div id="videoCallContainer">\n  <div class="call-recording-indication-popup">\n    <span>This call is being recorded for future quality purpose!</span>\n  </div>\n\n  <div class="call-recording-indication-wrapper">\n    <div class="call-recording-indication">'+(null!=(o=typeof(a=null!=(a=u(n,"recordIcon")||(null!=t?u(t,"recordIcon"):t))?a:c)===l?a.call(s,{name:"recordIcon",hash:{},data:i,loc:{start:{line:26,column:43},end:{line:26,column:59}}}):a)?o:"")+'</div>\n  </div>\n\n  <div class="url-copied-indication-popup">\n    <span>URL Copied To Clipboard!</span>\n  </div>\n\n'+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isLiveStream"):t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i,loc:{start:{line:33,column:2},end:{line:73,column:9}}}))?o:"")+"\n\n"+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isLiveStream"):t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.noop,data:i,loc:{start:{line:76,column:2},end:{line:89,column:9}}}))?o:"")+'\n  <div id="videoContainer">\n'+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isLiveStream"):t,{name:"if",hash:{},fn:e.program(16,i,0),inverse:e.noop,data:i,loc:{start:{line:92,column:4},end:{line:102,column:11}}}))?o:"")+'\n    <div id="videoCallMainScreen" class="'+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isEmbedOrJump"):t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i,loc:{start:{line:104,column:41},end:{line:104,column:79}}}))?o:"")+'">\n      <div\n        id="localVideoContainer"\n        class="video-call-wrapper active-speaker-'+d(typeof(a=null!=(a=u(n,"agoraUID")||(null!=t?u(t,"agoraUID"):t))?a:c)===l?a.call(s,{name:"agoraUID",hash:{},data:i,loc:{start:{line:107,column:49},end:{line:107,column:61}}}):a)+'"\n        user-name="'+d(typeof(a=null!=(a=u(n,"user_display_name_first_letter")||(null!=t?u(t,"user_display_name_first_letter"):t))?a:c)===l?a.call(s,{name:"user_display_name_first_letter",hash:{},data:i,loc:{start:{line:108,column:19},end:{line:108,column:53}}}):a)+'"\n      >\n        <span id="localUserPlaceholder">\n          <span class="speaking-wave-effect"></span>\n          <span class="user-display-name">'+d(typeof(a=null!=(a=u(n,"user_display_name_first_letter")||(null!=t?u(t,"user_display_name_first_letter"):t))?a:c)===l?a.call(s,{name:"user_display_name_first_letter",hash:{},data:i,loc:{start:{line:112,column:42},end:{line:112,column:76}}}):a)+'</span>\n        </span>\n        <span class="mic-status-indicator" user-name="'+d(typeof(a=null!=(a=u(n,"user_display_name")||(null!=t?u(t,"user_display_name"):t))?a:c)===l?a.call(s,{name:"user_display_name",hash:{},data:i,loc:{start:{line:114,column:54},end:{line:114,column:75}}}):a)+'">\n          '+(null!=(o=typeof(a=null!=(a=u(n,"toggleAudio")||(null!=t?u(t,"toggleAudio"):t))?a:c)===l?a.call(s,{name:"toggleAudio",hash:{},data:i,loc:{start:{line:115,column:10},end:{line:115,column:27}}}):a)?o:"")+'\n        </span>\n        <span class="network-quality-info">\n          '+(null!=(o=typeof(a=null!=(a=u(n,"networkIcon")||(null!=t?u(t,"networkIcon"):t))?a:c)===l?a.call(s,{name:"networkIcon",hash:{},data:i,loc:{start:{line:121,column:10},end:{line:121,column:27}}}):a)?o:"")+'\n        </span>\n        <span class="username-indicator">'+d(typeof(a=null!=(a=u(n,"user_display_name")||(null!=t?u(t,"user_display_name"):t))?a:c)===l?a.call(s,{name:"user_display_name",hash:{},data:i,loc:{start:{line:123,column:41},end:{line:123,column:62}}}):a)+'</span>\n        <span class="volume-indicator">\n          <span id="bar1" class="bars"></span>\n          <span id="bar2" class="bars"></span>\n          <span id="bar3" class="bars"></span>\n        </span>\n      </div>\n    </div>\n\n    <div id="videoCallVideoTiles"class="video-call-video-tiles-transition"></div>\n    <div class="videoCallVideoTilesToggleBtn">'+(null!=(o=typeof(a=null!=(a=u(n,"videoCallTileToggle")||(null!=t?u(t,"videoCallTileToggle"):t))?a:c)===l?a.call(s,{name:"videoCallTileToggle",hash:{},data:i,loc:{start:{line:133,column:46},end:{line:133,column:71}}}):a)?o:"")+'</div>\n  </div>\n\n  <div class="saleassist-video-call-more-options-control">\n    <button id="screenShare" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"screenShare")||(null!=t?u(t,"screenShare"):t))?a:c)===l?a.call(s,{name:"screenShare",hash:{},data:i,loc:{start:{line:137,column:52},end:{line:137,column:69}}}):a)?o:"")+'</button>\n    <button id="sa-chat-caption" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"ccBtn")||(null!=t?u(t,"ccBtn"):t))?a:c)===l?a.call(s,{name:"ccBtn",hash:{},data:i,loc:{start:{line:138,column:56},end:{line:138,column:67}}}):a)?o:"")+'</button>\n    <button id="sa-settings" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"settings")||(null!=t?u(t,"settings"):t))?a:c)===l?a.call(s,{name:"settings",hash:{},data:i,loc:{start:{line:139,column:52},end:{line:139,column:66}}}):a)?o:"")+'</button>\n  </div>\n\n  <div id="saleassist-video-call-controls">\n    <button id="toggleCamera" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"toggleCamera")||(null!=t?u(t,"toggleCamera"):t))?a:c)===l?a.call(s,{name:"toggleCamera",hash:{},data:i,loc:{start:{line:144,column:53},end:{line:144,column:71}}}):a)?o:"")+'</button>\n    <button id="toggleAudio" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"toggleAudio")||(null!=t?u(t,"toggleAudio"):t))?a:c)===l?a.call(s,{name:"toggleAudio",hash:{},data:i,loc:{start:{line:145,column:52},end:{line:145,column:69}}}):a)?o:"")+'</button>\n    <button id="flipCamera" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"flipCamera")||(null!=t?u(t,"flipCamera"):t))?a:c)===l?a.call(s,{name:"flipCamera",hash:{},data:i,loc:{start:{line:146,column:51},end:{line:146,column:67}}}):a)?o:"")+'</button>\n    <button id="sa-message" class="control-button">\n      <span class="sa-message-notification"></span>'+(null!=(o=typeof(a=null!=(a=u(n,"message")||(null!=t?u(t,"message"):t))?a:c)===l?a.call(s,{name:"message",hash:{},data:i,loc:{start:{line:148,column:51},end:{line:148,column:64}}}):a)?o:"")+"\n    </button>\n"+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isLiveStream"):t,{name:"if",hash:{},fn:e.program(18,i,0),inverse:e.noop,data:i,loc:{start:{line:150,column:4},end:{line:152,column:11}}}))?o:"")+'    <button id="leaveButton" class="control-button">'+(null!=(o=typeof(a=null!=(a=u(n,"endCall")||(null!=t?u(t,"endCall"):t))?a:c)===l?a.call(s,{name:"endCall",hash:{},data:i,loc:{start:{line:153,column:52},end:{line:153,column:65}}}):a)?o:"")+'</button>\n    <button id="moreButton" class="more-option-button">'+(null!=(o=typeof(a=null!=(a=u(n,"moreOption")||(null!=t?u(t,"moreOption"):t))?a:c)===l?a.call(s,{name:"moreOption",hash:{},data:i,loc:{start:{line:154,column:55},end:{line:154,column:71}}}):a)?o:"")+'</button>\n  </div>\n\n  <div id="inputDeviceSettings">\n    <div class="input-device-settings-header">\n      <span>Device Setting</span>\n      <span id="inputDeviceSettingsClose">'+(null!=(o=typeof(a=null!=(a=u(n,"closeBtn")||(null!=t?u(t,"closeBtn"):t))?a:c)===l?a.call(s,{name:"closeBtn",hash:{},data:i,loc:{start:{line:160,column:42},end:{line:160,column:56}}}):a)?o:"")+'</span>\n    </div>\n    <div id="videoInputDeviceSetting" class="input-device-settings">\n      <span>'+(null!=(o=typeof(a=null!=(a=u(n,"videoInputDeivce")||(null!=t?u(t,"videoInputDeivce"):t))?a:c)===l?a.call(s,{name:"videoInputDeivce",hash:{},data:i,loc:{start:{line:163,column:12},end:{line:163,column:34}}}):a)?o:"")+'</span>\n    </div>\n    <div id="audioInputDeviceSetting" class="input-device-settings">\n      <span>'+(null!=(o=typeof(a=null!=(a=u(n,"toggleAudio")||(null!=t?u(t,"toggleAudio"):t))?a:c)===l?a.call(s,{name:"toggleAudio",hash:{},data:i,loc:{start:{line:166,column:12},end:{line:166,column:29}}}):a)?o:"")+'</span>\n    </div>\n  </div>\n\n</div>\n\n<div class="saleassist-video-call-chat-container sa-chat-hidden">\n\n  <div class="saleassist-video-call-chat-header">\n    <span>In-Call Message</span>\n    <span id="saleassistVideoChatCloseButton">'+(null!=(o=typeof(a=null!=(a=u(n,"closeBtn")||(null!=t?u(t,"closeBtn"):t))?a:c)===l?a.call(s,{name:"closeBtn",hash:{},data:i,loc:{start:{line:176,column:46},end:{line:176,column:60}}}):a)?o:"")+'</span>\n  </div>\n\n  <div class="saleassist-video-call-chat-log" id="saleassistVideoChatLog">\n    \x3c!-- Chat messages will be displayed here --\x3e\n  </div>\n\n  <div\n    class="saleassist-video-call-chat-log"\n    style="display:none"\n    id="saleassistVideoCaptionLog"\n  >\n    \x3c!-- Chat caption messages will be displayed here --\x3e\n  </div>\n\n  <div class="saleassist-video-call-chat-input-box">\n    <span class="chat-input-overlay">'+(null!=(o=typeof(a=null!=(a=u(n,"threeDotsLoader")||(null!=t?u(t,"threeDotsLoader"):t))?a:c)===l?a.call(s,{name:"threeDotsLoader",hash:{},data:i,loc:{start:{line:192,column:37},end:{line:192,column:58}}}):a)?o:"")+'</span>\n    <div class="saleassist-video-call-document-preview-container">\n      \x3c!-- Uploaded files will be displayed here --\x3e\n    </div>\n\n    <div class="saleassist-video-call-chat-input-container">\n      <div class="saleassist-video-call-chat-input-wrapper">\n        <input\n          type="text"\n          id="saleassistVideoChatMessageInput"\n          placeholder="Type Your Message"\n        />\n        <label htmlFor="upload-file">\n          <span id="saleassistVideoChatUploadButton">\n            '+(null!=(o=typeof(a=null!=(a=u(n,"uploadBtn")||(null!=t?u(t,"uploadBtn"):t))?a:c)===l?a.call(s,{name:"uploadBtn",hash:{},data:i,loc:{start:{line:206,column:12},end:{line:206,column:27}}}):a)?o:"")+'\n            <input\n              type="file"\n              id="upload-file"\n              style="display:none"\n              accept="*"\n              multiple\n            />\n          </span>\n        </label>\n      </div>\n      <button id="saleassistVideoChatSendButton">'+(null!=(o=typeof(a=null!=(a=u(n,"sendBtn")||(null!=t?u(t,"sendBtn"):t))?a:c)===l?a.call(s,{name:"sendBtn",hash:{},data:i,loc:{start:{line:217,column:49},end:{line:217,column:62}}}):a)?o:"")+"</button>\n    </div>\n  </div>\n</div>"},useData:!0})},6315:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-ai_chat-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="0 0 459.579 459.579"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M429.579,14.7H139.935c-16.569,0-30,13.431-30,30v80.993h30V44.7h289.644v183.393h-48.495v30h48.495c16.568,0,30-13.431,30-30V44.7C459.579,28.132,446.148,14.7,429.579,14.7z"\n      fill="var(--invertColor)"\n    />\n    <path\n      d="M319.644,155.693H30c-16.565,0-30,13.427-30,30v183.393c0,16.569,13.431,30,30,30h92.333l29.531,35.11c11.99,14.255,33.945,14.234,45.917,0l29.531-35.11h92.333c9.32,0,17.647-4.25,23.149-10.917c0.306-0.37,0.603-0.748,0.891-1.133c3.743-5.005,5.96-11.219,5.96-17.95V185.693C349.644,169.126,336.214,155.693,319.644,155.693z M319.644,369.086h-106.3l-38.522,45.799L136.3,369.086H30V185.693h289.644V369.086z"\n      fill="var(--invertColor)"\n    />\n    <path\n      d="M80.011,257.792h189.621c8.284,0,15-6.716,15-15s-6.716-15-15-15H80.011c-8.284,0-15,6.716-15,15S71.727,257.792,80.011,257.792z"\n      fill="var(--invertColor)"\n    />\n    <path\n      d="M80.011,325.573h77.621c8.284,0,15-6.716,15-15s-6.716-15-15-15H80.011c-8.284,0-15,6.716-15,15S71.727,325.573,80.011,325.573z"\n      fill="var(--invertColor)"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:30,column:4},end:{line:30,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},1717:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-audio_call-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <div class="sa-live-call-widget-ball-scale-multiple">\n    <div></div>\n    <div></div>\n    <div></div>\n  </div>\n  <svg\n    width="20"\n    height="20"\n    viewBox="2 2 16 16"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M6.98706 2.06589L6.27036 2.28192C4.96684 2.67484 4.00944 3.78801 3.81598 5.13565C3.519 7.20438 4.18323 9.62242 5.78368 12.3945C7.38077 15.1607 9.13867 16.9433 11.0739 17.7231C12.3435 18.2346 13.7948 17.9592 14.7886 17.018L15.3314 16.5039C16.0589 15.815 16.1643 14.694 15.5781 13.8815L14.2215 12.0014C13.8458 11.4807 13.1805 11.2569 12.5665 11.4446L10.5158 12.0716L10.4628 12.082C10.2366 12.115 9.7154 11.6259 9.06527 10.4999C8.38512 9.32181 8.24417 8.63298 8.43194 8.45541L9.47529 7.48248C10.2572 6.75332 10.4882 5.60728 10.0499 4.63213L9.38841 3.16075C8.97652 2.24451 7.94888 1.77597 6.98706 2.06589ZM8.47634 3.57077L9.13779 5.04215C9.40063 5.62682 9.26212 6.31395 8.7933 6.75113L7.74739 7.72645C7.0783 8.35918 7.29992 9.44218 8.19924 10.9999C9.04545 12.4655 9.81744 13.1898 10.6469 13.0642L10.7713 13.0376L12.8589 12.4009C13.0635 12.3383 13.2853 12.413 13.4105 12.5865L14.7671 14.4666C15.0603 14.8729 15.0076 15.4334 14.6438 15.7778L14.101 16.2919C13.3911 16.9642 12.3545 17.1609 11.4476 16.7955C9.74957 16.1113 8.14475 14.484 6.64971 11.8945C5.15161 9.29969 4.54531 7.09254 4.80583 5.27775C4.94402 4.31515 5.62787 3.52003 6.55896 3.23937L7.27566 3.02334C7.75657 2.87838 8.27039 3.11265 8.47634 3.57077Z"\n      fill="var(--invertColor)"\n    ></path>\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:23,column:4},end:{line:23,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},5801:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-audio_feedback-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="0 0 122.88 113.8"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      fill="var(--invertColor)"\n      d="M0,67.6c-.06-5.83,2.16-11,7.37-12.69l.13-.22a2.91,2.91,0,0,1,.6-.8,3.1,3.1,0,0,1,1.05-.5l.29-.11C34.7,44,46.09,30.07,52.64,20.61c0,9.29,2.33,21.4,6.43,33.12,4.21,12,10.29,23.71,17.71,31.76h0c-7.73-2.2-17.43-5-33.21-2.85a15.17,15.17,0,0,0-1.12,5.06,3.9,3.9,0,0,0,1,3l.24.22c1,.91,1.49,1.36,1.71,2.17a9.17,9.17,0,0,1-.13,3.22l-.09.67c-.37,2.93,1.05,3.53,2.46,4.13s2.51,1.08,3.08,2.69a.68.68,0,0,1,0,.4c-.58,3-2.5,4.64-4.43,6.29-.47.41-.95.82-1.36,1.21l-.06,0c-3.92,3.14-6.57,2.3-8.58-.22-1.58-2-2.68-5-3.7-7.81l-.44-1.22a122.88,122.88,0,0,1-4-15.09l-.34-1.5c-.87.24-1.78.51-2.73.79h0c-1.2.35-2.4.73-3.59,1.11l-.38.14a1.21,1.21,0,0,1-1.33,0C13.47,90,8.2,87,4.68,82a25,25,0,0,1-3.41-6.9A25.74,25.74,0,0,1,0,67.6ZM87.81,16.16a3,3,0,0,1-4.23-.6l-.07-.09a3.05,3.05,0,0,1,.63-4.19C89,7.69,93.84,4.07,98.7.56A3.09,3.09,0,0,1,100.92,0a3.06,3.06,0,0,1,2,1.21l0,.05a3,3,0,0,1,.52,2.23,3,3,0,0,1-1.21,2L87.81,16.16Zm15.79,57.7h0a3,3,0,0,1-2.11-.93,3,3,0,0,1-.85-2.14v-.07a3,3,0,0,1,3.07-3c5.37,0,10.83.2,16.2.3a3.07,3.07,0,0,1,3,3.1,3.09,3.09,0,0,1-.93,2.15,3,3,0,0,1-2.16.86l-16.19-.31Zm.47-15.71a3,3,0,0,1-3.25-2.78V55.3a3.07,3.07,0,0,1,2.77-3.23c5-.4,10.09-.83,15.1-1.15a3.06,3.06,0,0,1,3.24,2.81h0a3,3,0,0,1-.73,2.21A3.08,3.08,0,0,1,119.12,57c-4.85.48-10.18.88-15.05,1.14Zm-2.16-14.59a3.06,3.06,0,0,1-3.78-2.11v0a3,3,0,0,1,.27-2.3,3.1,3.1,0,0,1,1.83-1.46c5.21-1.37,10.4-3.05,15.61-4.45a3,3,0,0,1,2.3.27,3.08,3.08,0,0,1,1.45,1.8v0a3.07,3.07,0,0,1-2.1,3.78l-15.59,4.45Zm-6.3-14.32a3.05,3.05,0,0,1-4.09-1.37,3,3,0,0,1-.17-2.33,3.09,3.09,0,0,1,1.53-1.77l15-7.49a3,3,0,0,1,4.09,1.37,3,3,0,0,1,.16,2.33,3.07,3.07,0,0,1-1.53,1.76l-15,7.5ZM58.75,12c.13-.15.27-.29.4-.42a4.46,4.46,0,0,1,1.48-1.11h0a3.58,3.58,0,0,1,2-.08c2.25.36,4.66,2,7.11,4.51,6,6.19,12.32,18,16.82,30.41s7.2,25.36,5.85,33.77c-.51,3.13-1.57,5.66-3.31,7.33l-.09.07a5.64,5.64,0,0,1-2.47,1,2.43,2.43,0,0,0-.25-.2C80.3,83,75,75.9,70.54,67.55c1.14.22,2.6-.63,4-2.08,7-7.38,3.56-20.28-5.17-23.27C65.81,41,62.27,41,60.87,41.69l-.15.08C57.52,29.42,56.61,18,58.75,12Z"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:18,column:4},end:{line:18,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},4516:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M20 3H6.693A2.01 2.01 0 0 0 4.82 4.298l-2.757 7.351A1 1 0 0 0 2 12v2c0 1.103.897 2 2 2h5.612L8.49 19.367a2.004 2.004 0 0 0 .274 1.802c.376.52.982.831 1.624.831H12c.297 0 .578-.132.769-.36l4.7-5.64H20c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zm-8.469 17h-1.145l1.562-4.684A1 1 0 0 0 11 14H4v-1.819L6.693 5H16v9.638L11.531 20zM18 14V5h2l.001 9H18z"\n  ></path>\n</svg>'},useData:!0})},9001:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M20 8h-5.612l1.123-3.367c.202-.608.1-1.282-.275-1.802S14.253 2 13.612 2H12c-.297 0-.578.132-.769.36L6.531 8H4c-1.103 0-2 .897-2 2v9c0 1.103.897 2 2 2h13.307a2.01 2.01 0 0 0 1.873-1.298l2.757-7.351A1 1 0 0 0 22 12v-2c0-1.103-.897-2-2-2zM4 10h2v9H4v-9zm16 1.819L17.307 19H8V9.362L12.468 4h1.146l-1.562 4.683A.998.998 0 0 0 13 10h7v1.819z"\n  ></path>\n</svg>'},useData:!0})},2461:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  role="img"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <title></title>\n  <path\n    d="M11.999 0c-2.25 0-4.5.06-6.6.21a5.57 5.57 0 00-5.19 5.1c-.24 3.21-.27 6.39-.06 9.6a5.644 5.644 0 005.7 5.19h3.15v-3.9h-3.15c-.93.03-1.74-.63-1.83-1.56-.18-3-.15-6 .06-9 .06-.84.72-1.47 1.56-1.53 2.04-.15 4.2-.21 6.36-.21s4.32.09 6.36.18c.81.06 1.5.69 1.56 1.53.24 3 .24 6 .06 9-.12.93-.9 1.62-1.83 1.59h-3.15l-6 3.9V24l6-3.9h3.15c2.97.03 5.46-2.25 5.7-5.19.21-3.18.18-6.39-.03-9.57a5.57 5.57 0 00-5.19-5.1c-2.13-.18-4.38-.24-6.63-.24zm-5.04 8.76c-.36 0-.66.3-.66.66v2.34c0 .33.18.63.48.78 1.62.78 3.42 1.2 5.22 1.26 1.8-.06 3.6-.48 5.22-1.26.3-.15.48-.45.48-.78V9.42c0-.09-.03-.15-.09-.21a.648.648 0 00-.87-.36c-1.5.66-3.12 1.02-4.77 1.05-1.65-.03-3.27-.42-4.77-1.08a.566.566 0 00-.24-.06z"\n  ></path>\n</svg>'},useData:!0})},9671:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0z"></path>\n  <path\n    d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"\n  ></path>\n</svg>'},useData:!0})},8061:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="'+l(typeof(o=null!=(o=d(n,"id")||(null!=t?d(t,"id"):t))?o:s)===c?o.call(a,{name:"id",hash:{},data:i,loc:{start:{line:2,column:6},end:{line:2,column:12}}}):o)+'"\n  class="sa-btn-cta-icon-box-expanded"\n  data-capture-lead-form="'+l(typeof(o=null!=(o=d(n,"captureLeadForm")||(null!=t?d(t,"captureLeadForm"):t))?o:s)===c?o.call(a,{name:"captureLeadForm",hash:{},data:i,loc:{start:{line:4,column:26},end:{line:4,column:45}}}):o)+'"\n  data-cta-link="'+l(typeof(o=null!=(o=d(n,"link")||(null!=t?d(t,"link"):t))?o:s)===c?o.call(a,{name:"link",hash:{},data:i,loc:{start:{line:5,column:17},end:{line:5,column:25}}}):o)+'"\n>\n  <img\n    src="'+l(typeof(o=null!=(o=d(n,"icon")||(null!=t?d(t,"icon"):t))?o:s)===c?o.call(a,{name:"icon",hash:{},data:i,loc:{start:{line:8,column:9},end:{line:8,column:17}}}):o)+'"\n    alt="'+l(typeof(o=null!=(o=d(n,"title")||(null!=t?d(t,"title"):t))?o:s)===c?o.call(a,{name:"title",hash:{},data:i,loc:{start:{line:9,column:9},end:{line:9,column:18}}}):o)+'"\n    style="width: 20px; height: 20px; object-fit:cover"\n  />\n  <span>'+l(typeof(o=null!=(o=d(n,"title")||(null!=t?d(t,"title"):t))?o:s)===c?o.call(a,{name:"title",hash:{},data:i,loc:{start:{line:12,column:8},end:{line:12,column:17}}}):o)+"</span>\n</div>"},useData:!0})},1290:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="#34b7f1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">\n  <path d="M5 13l3 3l5-5" />\n  <path d="M9 13l3 3l5-5" />\n</svg>\n'},useData:!0})},8150:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">\n  <path d="M5 13l3 3l5-5" />\n  <path d="M9 13l3 3l5-5" />\n</svg>\n'},useData:!0})},6189:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="1em"\n  width="1em"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="M11.953 2C6.465 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.493 2 11.953 2zM12 20c-4.411 0-8-3.589-8-8s3.567-8 7.953-8C16.391 4 20 7.589 20 12s-3.589 8-8 8z"\n  ></path>\n  <path d="M11 7h2v7h-2zm0 8h2v2h-2z"></path>\n</svg>'},useData:!0})},6113:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-feedback_form-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="3 3 14 14"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M6.5 6C6.22386 6 6 6.22386 6 6.5C6 6.77614 6.22386 7 6.5 7H13.5C13.7761 7 14 6.77614 14 6.5C14 6.22386 13.7761 6 13.5 6H6.5ZM6 9.5C6 9.22386 6.22386 9 6.5 9H10.5C10.7761 9 11 9.22386 11 9.5C11 9.77614 10.7761 10 10.5 10H6.5C6.22386 10 6 9.77614 6 9.5ZM6.5 12C6.22386 12 6 12.2239 6 12.5C6 12.7761 6.22386 13 6.5 13H13.5C13.7761 13 14 12.7761 14 12.5C14 12.2239 13.7761 12 13.5 12H6.5ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V5.5C4 4.67157 4.67157 4 5.5 4Z"\n      fill="var(--invertColor)"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:18,column:4},end:{line:18,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},4486:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-image_message-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="1em"\n    height="1em"\n    viewBox="0 0 512 512"\n    stroke-width="0"\n    fill="currentColor"\n    stroke="var(--invertColor)"\n  ><path\n      fill="none"\n      stroke-linecap="round"\n      stroke-linejoin="round"\n      stroke-width="32"\n      d="m350.54 148.68-26.62-42.06C318.31 100.08 310.62 96 302 96h-92c-8.62 0-16.31 4.08-21.92 10.62l-26.62 42.06C155.85 155.23 148.62 160 140 160H80a32 32 0 0 0-32 32v192a32 32 0 0 0 32 32h352a32 32 0 0 0 32-32V192a32 32 0 0 0-32-32h-59c-8.65 0-16.85-4.77-22.46-11.32z"\n    ></path><circle\n      cx="256"\n      cy="272"\n      r="80"\n      fill="none"\n      stroke-miterlimit="10"\n      stroke-width="32"\n    ></circle><path\n      fill="none"\n      stroke-linecap="round"\n      stroke-linejoin="round"\n      stroke-width="32"\n      d="M124 158v-22h-24v22"\n    ></path></svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:34,column:4},end:{line:34,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},9103:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div\n      id="sa-live-call-widget-trigger-message-container"\n      class="sa-live-call-widget-trigger-message-container sa-live-call-widget-trigger-message-container-'+d(typeof(a=null!=(a=u(n,"button_position")||(null!=t?u(t,"button_position"):t))?a:c)===l?a.call(s,{name:"button_position",hash:{},data:i,loc:{start:{line:9,column:105},end:{line:9,column:124}}}):a)+'"\n    >\n      <div\n        class="sa-live-call-widget-trigger-message-cta-wrapper sa-live-call-widget-trigger-message-cta-wrapper-'+d(typeof(a=null!=(a=u(n,"button_position")||(null!=t?u(t,"button_position"):t))?a:c)===l?a.call(s,{name:"button_position",hash:{},data:i,loc:{start:{line:12,column:111},end:{line:12,column:130}}}):a)+'"\n      >\n      </div>\n      <div\n        class="sa-live-call-widget-trigger-message-wrapper sa-live-call-widget-trigger-message-wrapper-'+d(typeof(a=null!=(a=u(n,"button_position")||(null!=t?u(t,"button_position"):t))?a:c)===l?a.call(s,{name:"button_position",hash:{},data:i,loc:{start:{line:16,column:103},end:{line:16,column:122}}}):a)+'"\n      >\n        <p class="sa-live-call-widget-trigger-message"></p>\n        <div class="sa-live-call-widget-close-trigger-message-btn">\n          '+(null!=(o=typeof(a=null!=(a=u(n,"closeButton")||(null!=t?u(t,"closeButton"):t))?a:c)===l?a.call(s,{name:"closeButton",hash:{},data:i,loc:{start:{line:20,column:10},end:{line:20,column:27}}}):a)?o:"")+"\n        </div>\n      </div>\n    </div>\n"},3:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <img\n      class="sa-live-call-widget-btn sa-live-call-widget-icon-btn-'+l(typeof(o=null!=(o=d(n,"button_position")||(null!=t?d(t,"button_position"):t))?o:s)===c?o.call(a,{name:"button_position",hash:{},data:i,loc:{start:{line:27,column:66},end:{line:27,column:85}}}):o)+'"\n      src='+l(typeof(o=null!=(o=d(n,"source_image_url")||(null!=t?d(t,"source_image_url"):t))?o:s)===c?o.call(a,{name:"source_image_url",hash:{},data:i,loc:{start:{line:28,column:10},end:{line:28,column:30}}}):o)+'\n      alt="source image"\n    />\n'},5:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isStreaming"):t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.program(8,i,0),data:i,loc:{start:{line:32,column:4},end:{line:68,column:11}}}))?o:""},6:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="sa-live-call-widget-btn">\n        <iframe\n          width="100%"\n          height="100%"\n          src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"streamingUrl")||(null!=t?a(t,"streamingUrl"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"streamingUrl",hash:{},data:i,loc:{start:{line:37,column:15},end:{line:37,column:31}}}):o)+'"\n          frameborder="0"\n          allowfullscreen\n        >\n        </iframe>\n      </div>\n'},8:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isWelcomeImage"):t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.program(11,i,0),data:i,loc:{start:{line:44,column:6},end:{line:67,column:13}}}))?o:""},9:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <img\n          src="'+l(typeof(o=null!=(o=d(n,"source_welcome_video_url")||(null!=t?d(t,"source_welcome_video_url"):t))?o:s)===c?o.call(a,{name:"source_welcome_video_url",hash:{},data:i,loc:{start:{line:46,column:15},end:{line:46,column:43}}}):o)+'"\n          alt=""\n          class="sa-live-call-widget-btn sa-live-call-widget-btn-'+l(typeof(o=null!=(o=d(n,"button_position")||(null!=t?d(t,"button_position"):t))?o:s)===c?o.call(a,{name:"button_position",hash:{},data:i,loc:{start:{line:48,column:65},end:{line:48,column:84}}}):o)+'"\n        />\n'},11:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <video\n          class="sa-live-call-widget-btn"\n          src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"source_welcome_video_url")||(null!=t?a(t,"source_welcome_video_url"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"source_welcome_video_url",hash:{},data:i,loc:{start:{line:54,column:15},end:{line:54,column:43}}}):o)+'"\n          playsInline\n          autoplay\n          loop\n          muted\n          onplay="this.nextElementSibling.style.display = \'none\';"\n        >\n        </video>\n        <div class="sa-live-call-widget-loader-spinner call-btn-loader">\n          <div class="sa-live-call-widget-loader-bounce1"></div>\n          <div class="sa-live-call-widget-loader-bounce2"></div>\n          <div class="sa-live-call-widget-loader-bounce3"></div>\n        </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  class="sa-live-call-widget-btn-container sa-live-call-widget-btn-container-type-'+d(typeof(a=null!=(a=u(n,"button_type")||(null!=t?u(t,"button_type"):t))?a:c)===l?a.call(s,{name:"button_type",hash:{},data:i,loc:{start:{line:2,column:82},end:{line:2,column:97}}}):a)+"\n    "+d(typeof(a=null!=(a=u(n,"buttonPositionOldClassName")||(null!=t?u(t,"buttonPositionOldClassName"):t))?a:c)===l?a.call(s,{name:"buttonPositionOldClassName",hash:{},data:i,loc:{start:{line:3,column:4},end:{line:3,column:34}}}):a)+'" style="display:block;"\n>\n  <div class="sa-live-call-widget-close-btn">'+(null!=(o=typeof(a=null!=(a=u(n,"closeButton")||(null!=t?u(t,"closeButton"):t))?a:c)===l?a.call(s,{name:"closeButton",hash:{},data:i,loc:{start:{line:5,column:45},end:{line:5,column:62}}}):a)?o:"")+"</div>\n"+(null!=(o=u(n,"if").call(s,null!=t?u(t,"allow_trigger_messages"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:6,column:2},end:{line:24,column:9}}}))?o:"")+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isIconButton"):t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i,loc:{start:{line:25,column:2},end:{line:69,column:9}}}))?o:"")+"</div>"},useData:!0})},7289:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div>\n  <div\n    class="sa-live-call-widget-lead-capture-form-microphone-permission-icon-wrapper"\n  >\n    <svg\n      class="sa-live-call-widget-lead-capture-form-microphone-permission-icon"\n      stroke="currentColor"\n      fill="currentColor"\n      stroke-width="0"\n      viewBox="0 0 16 16"\n      height="1em"\n      width="1em"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <path d="M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0V3z"></path>\n      <path\n        d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"\n      ></path>\n    </svg>\n    <p\n      class="sa-live-call-widget-lead-capture-form-microphone-permission-icon-text"\n    >Please allow access to microphone when prompted.</p>\n  </div>\n  <button\n    type="button"\n    id="sa-live-call-widget-lead-capture-form-microphone-permission-btn"\n  >\n    Submit </button>\n</div>'},useData:!0})},5366:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-schedule_meeting-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="3 3 14 14"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z"\n      fill="var(--invertColor)"\n    ></path>\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:18,column:4},end:{line:18,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},3838:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-share_jump_page-btn"\n  class="sa-btn-cta-icon-box-expanded sa-btn-cta-icon-box-expanded-custom-style-'+l(typeof(o=null!=(o=d(n,"isCustomStyle")||(null!=t?d(t,"isCustomStyle"):t))?o:s)===c?o.call(a,{name:"isCustomStyle",hash:{},data:i,loc:{start:{line:3,column:80},end:{line:3,column:97}}}):o)+'"\n>\n  <svg\n    stroke="currentColor"\n    fill="currentColor"\n    stroke-width="0"\n    viewBox="0 0 576 512"\n    height="20px"\n    width="20px"\n    xmlns="http://www.w3.org/2000/svg"\n  ><path\n      d="M400 255.4V240 208c0-8.8-7.2-16-16-16H352 336 289.5c-50.9 0-93.9 33.5-108.3 79.6c-3.3-9.4-5.2-19.8-5.2-31.6c0-61.9 50.1-112 112-112h48 16 32c8.8 0 16-7.2 16-16V80 64.6L506 160 400 255.4zM336 240h16v48c0 17.7 14.3 32 32 32h3.7c7.9 0 15.5-2.9 21.4-8.2l139-125.1c7.6-6.8 11.9-16.5 11.9-26.7s-4.3-19.9-11.9-26.7L409.9 8.9C403.5 3.2 395.3 0 386.7 0C367.5 0 352 15.5 352 34.7V80H336 304 288c-88.4 0-160 71.6-160 160c0 60.4 34.6 99.1 63.9 120.9c5.9 4.4 11.5 8.1 16.7 11.2c4.4 2.7 8.5 4.9 11.9 6.6c3.4 1.7 6.2 3 8.2 3.9c2.2 1 4.6 1.4 7.1 1.4h2.5c9.8 0 17.8-8 17.8-17.8c0-7.8-5.3-14.7-11.6-19.5l0 0c-.4-.3-.7-.5-1.1-.8c-1.7-1.1-3.4-2.5-5-4.1c-.8-.8-1.7-1.6-2.5-2.6s-1.6-1.9-2.4-2.9c-1.8-2.5-3.5-5.3-5-8.5c-2.6-6-4.3-13.3-4.3-22.4c0-36.1 29.3-65.5 65.5-65.5H304h32zM72 32C32.2 32 0 64.2 0 104V440c0 39.8 32.2 72 72 72H408c39.8 0 72-32.2 72-72V376c0-13.3-10.7-24-24-24s-24 10.7-24 24v64c0 13.3-10.7 24-24 24H72c-13.3 0-24-10.7-24-24V104c0-13.3 10.7-24 24-24h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H72z"\n    ></path></svg>\n  <span>'+l(typeof(o=null!=(o=d(n,"title")||(null!=t?d(t,"title"):t))?o:s)===c?o.call(a,{name:"title",hash:{},data:i,loc:{start:{line:16,column:8},end:{line:16,column:17}}}):o)+"</span>\n</div>"},useData:!0})},5622:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-shoppable_video-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    fill="var(--invertColor)"\n    stroke-width="0"\n    viewBox="0 0 16 16"\n    height="1em"\n    width="1em"\n    xmlns="http://www.w3.org/2000/svg"\n  ><path\n      d="M8 1a2 2 0 0 0-2 2v2H5V3a3 3 0 1 1 6 0v2h-1V3a2 2 0 0 0-2-2zM5 5H3.36a1.5 1.5 0 0 0-1.483 1.277L.85 13.13A2.5 2.5 0 0 0 3.322 16h9.355a2.5 2.5 0 0 0 2.473-2.87l-1.028-6.853A1.5 1.5 0 0 0 12.64 5H11v1.5a.5.5 0 0 1-1 0V5H6v1.5a.5.5 0 0 1-1 0V5z"\n    ></path></svg>\n  <span>'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:15,column:8},end:{line:15,column:17}}}):o)+"</span>\n</div>"},useData:!0})},9402:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">\n  <path d="M9 13l3 3l5-5" />\n</svg>\n'},useData:!0})},8666:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button\n  type="submit"\n  class="sa-live-call-widget-lead-capture-form-submit-btn"\n>'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"label")||(null!=t?a(t,"label"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"label",hash:{},data:i,loc:{start:{line:4,column:1},end:{line:4,column:10}}}):o)+"</button>"},useData:!0})},9022:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-text_feedback-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="3 3 16 16"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M5 3C3.89543 3 3 3.89543 3 5V15C3 16.1046 3.89543 17 5 17H9.22047L9.43163 16.1553C9.44469 16.1031 9.45904 16.0513 9.47466 16H5C4.44772 16 4 15.5523 4 15V5C4 4.44772 4.44772 4 5 4H15C15.5523 4 16 4.44772 16 5V9.23163C16.3194 9.09477 16.6586 9.01856 17 9.00299V5C17 3.89543 16.1046 3 15 3H5ZM9.5 14H10.9427L11.9427 13H9.5C9.22386 13 9 13.2239 9 13.5C9 13.7761 9.22386 14 9.5 14ZM7.5 7.25C7.5 7.66421 7.16421 8 6.75 8C6.33579 8 6 7.66421 6 7.25C6 6.83579 6.33579 6.5 6.75 6.5C7.16421 6.5 7.5 6.83579 7.5 7.25ZM6.75 11C7.16421 11 7.5 10.6642 7.5 10.25C7.5 9.83579 7.16421 9.5 6.75 9.5C6.33579 9.5 6 9.83579 6 10.25C6 10.6642 6.33579 11 6.75 11ZM6.75 14C7.16421 14 7.5 13.6642 7.5 13.25C7.5 12.8358 7.16421 12.5 6.75 12.5C6.33579 12.5 6 12.8358 6 13.25C6 13.6642 6.33579 14 6.75 14ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H13.5C13.7761 8 14 7.77614 14 7.5C14 7.22386 13.7761 7 13.5 7H9.5ZM9.5 10C9.22386 10 9 10.2239 9 10.5C9 10.7761 9.22386 11 9.5 11H13.5C13.7761 11 14 10.7761 14 10.5C14 10.2239 13.7761 10 13.5 10H9.5ZM10.9798 15.3772L15.8092 10.5478C16.5395 9.81741 17.7237 9.81741 18.454 10.5478C19.1843 11.2781 19.1843 12.4622 18.454 13.1926L13.6246 18.022C13.343 18.3036 12.9902 18.5033 12.6039 18.5999L11.106 18.9744C10.4546 19.1372 9.86451 18.5472 10.0274 17.8958L10.4018 16.3979C10.4984 16.0116 10.6982 15.6588 10.9798 15.3772Z"\n      fill="var(--invertColor)"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:18,column:4},end:{line:18,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},8095:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-text_message-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="2 2 16 16"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C8.72679 18 7.49591 17.7018 6.38669 17.1393L6.266 17.075L2.62109 17.9851C2.31127 18.0625 2.02622 17.8369 2.00131 17.5438L2.00114 17.4624L2.01493 17.3787L2.925 13.735L2.86169 13.6153C2.4066 12.7186 2.12433 11.7422 2.03275 10.7283L2.00738 10.3463L2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 11.217 3.31054 12.3878 3.89352 13.4249C3.94046 13.5084 3.9621 13.603 3.95692 13.6973L3.94274 13.7912L3.187 16.812L6.21104 16.0583C6.27294 16.0429 6.33662 16.0396 6.39873 16.0479L6.4903 16.0691L6.57701 16.1075C7.61362 16.6898 8.7837 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10.5 11C10.7761 11 11 11.2239 11 11.5C11 11.7455 10.8231 11.9496 10.5899 11.9919L10.5 12H7.5C7.22386 12 7 11.7761 7 11.5C7 11.2545 7.17688 11.0504 7.41012 11.0081L7.5 11H10.5ZM12.5 8C12.7761 8 13 8.22386 13 8.5C13 8.74546 12.8231 8.94961 12.5899 8.99194L12.5 9H7.5C7.22386 9 7 8.77614 7 8.5C7 8.25454 7.17688 8.05039 7.41012 8.00806L7.5 8H12.5Z"\n      fill="var(--invertColor)"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:18,column:4},end:{line:18,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},3378:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-video_call-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <div class="sa-live-call-widget-ball-scale-multiple">\n    <div></div>\n    <div></div>\n    <div></div>\n  </div>\n  <svg\n    stroke="var(--invertColor)"\n    fill="none"\n    stroke-width="1.5"\n    viewBox="0 0 24 24"\n    aria-hidden="true"\n    height="20"\n    width="20"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      stroke-linecap="round"\n      d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"\n    ></path>\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:26,column:4},end:{line:26,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},8617:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-video_feedback-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    stroke="var(--invertColor)"\n    fill="none"\n    stroke-width="1.5"\n    viewBox="0 0 24 24"\n    aria-hidden="true"\n    height="20"\n    width="20"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      stroke-linecap="round"\n      d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"\n    ></path>\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:21,column:4},end:{line:21,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},5761:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-video_message-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    stroke="var(--invertColor)"\n    fill="none"\n    stroke-width="1.5"\n    viewBox="0 0 24 24"\n    aria-hidden="true"\n    height="20"\n    width="20"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      stroke-linecap="round"\n      d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"\n    ></path>\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:21,column:4},end:{line:21,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},3209:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-voice_message-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="2 2 16 16"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      d="M10 13C11.6569 13 13 11.6568 13 9.99998V5C13 3.34315 11.6569 2 10 2C8.34315 2 7 3.34315 7 5V9.99998C7 11.6568 8.34315 13 10 13ZM10 12C8.89543 12 8 11.1046 8 9.99998V5C8 3.89543 8.89543 3 10 3C11.1046 3 12 3.89543 12 5V9.99998C12 11.1046 11.1046 12 10 12ZM5 9.49998C5.27614 9.49998 5.5 9.72384 5.5 9.99998C5.5 12.4853 7.51472 14.5 10 14.5C12.4853 14.5 14.5 12.4853 14.5 9.99998C14.5 9.72384 14.7239 9.49998 15 9.49998C15.2761 9.49998 15.5 9.72384 15.5 9.99998C15.5 12.869 13.3033 15.2249 10.5 15.4776V17.5C10.5 17.7761 10.2761 18 10 18C9.72386 18 9.5 17.7761 9.5 17.5V15.4776C6.69675 15.2249 4.5 12.869 4.5 9.99998C4.5 9.72384 4.72386 9.49998 5 9.49998Z"\n      fill="var(--invertColor)"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:18,column:4},end:{line:18,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},8310:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  id="sa-live-call-widget-whatsapp_message-btn"\n  class="sa-btn-cta-icon-box-expanded"\n>\n  <svg\n    width="20"\n    height="20"\n    viewBox="2 2.9 15.5 14.85"\n    fill="none"\n    xmlns="http://www.w3.org/2000/svg"\n  >\n    <path\n      fill-rule="evenodd"\n      clip-rule="evenodd"\n      d="M15.3358 4.69419C14.6428 3.99659 13.8182 3.44345 12.9099 3.06681C12.0015 2.69018 11.0275 2.49752 10.0442 2.50002C5.92083 2.50002 2.56417 5.85586 2.5625 9.98086C2.5625 11.2992 2.90667 12.5859 3.56083 13.7209L2.5 17.5967L6.46583 16.5559C7.56283 17.153 8.79183 17.4661 10.0408 17.4667H10.0442C14.1667 17.4667 17.5233 14.1109 17.525 9.98586C17.5278 9.00293 17.3358 8.02918 16.9601 7.12091C16.5843 6.21263 16.0323 5.38783 15.3358 4.69419ZM10.0442 16.2042H10.0417C8.92793 16.2043 7.83469 15.9047 6.87667 15.3367L6.65 15.2017L4.29667 15.8192L4.92417 13.525L4.77667 13.29C4.15399 12.2987 3.82436 11.1515 3.82583 9.98086C3.8275 6.55252 6.61667 3.76336 10.0467 3.76336C10.8635 3.76154 11.6727 3.92176 12.4272 4.23473C13.1818 4.54771 13.8667 5.00723 14.4425 5.58669C15.0213 6.16339 15.4802 6.8491 15.7924 7.60419C16.1047 8.35927 16.2641 9.16876 16.2617 9.98586C16.26 13.4142 13.4708 16.2042 10.0442 16.2042ZM13.455 11.5467C13.2675 11.4525 12.3492 11.0009 12.1775 10.9384C12.0067 10.8759 11.8825 10.845 11.7575 11.0317C11.6325 11.2184 11.2742 11.6392 11.165 11.7642C11.0558 11.8892 10.9467 11.9042 10.76 11.8109C10.5733 11.7175 9.97083 11.52 9.25667 10.8834C8.70083 10.3875 8.32583 9.77586 8.21667 9.58836C8.1075 9.40086 8.205 9.30002 8.29917 9.20669C8.38333 9.12336 8.48583 8.98836 8.57917 8.87919C8.6725 8.77002 8.70333 8.69252 8.76583 8.56752C8.82833 8.44252 8.7975 8.33336 8.75 8.24002C8.70333 8.14586 8.32917 7.22586 8.17333 6.85169C8.0225 6.48919 7.86833 6.53752 7.75333 6.53252C7.63423 6.52765 7.51503 6.52543 7.39583 6.52586C7.30105 6.52827 7.20778 6.55025 7.12188 6.5904C7.03599 6.63055 6.95931 6.68801 6.89667 6.75919C6.725 6.94669 6.2425 7.39836 6.2425 8.31836C6.2425 9.23836 6.9125 10.1275 7.00583 10.2525C7.09917 10.3775 8.32417 12.265 10.1992 13.075C10.6458 13.2675 10.9942 13.3825 11.265 13.4692C11.7125 13.6117 12.12 13.5909 12.4425 13.5434C12.8017 13.49 13.5483 13.0917 13.7042 12.655C13.86 12.2184 13.86 11.8442 13.8133 11.7659C13.7667 11.6875 13.6408 11.64 13.455 11.5467Z"\n      fill="var(--invertColor)"\n    />\n  </svg>\n  <span>\n    '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"title")||(null!=t?a(t,"title"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:20,column:4},end:{line:20,column:13}}}):o)+"\n  </span>\n</div>"},useData:!0})},6254:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div\n  class="sa-live-call-widget-lead-capture-form-media-permission-denied-overlay"\n>\n  <div\n    class="sa-live-call-widget-lead-capture-form-media-permission-denied-overlay-card"\n  >\n    <p\n      class="sa-live-call-widget-lead-capture-form-media-permission-denied-overlay-card-title"\n    >\n      <svg\n        stroke="currentColor"\n        fill="currentColor"\n        stroke-width="0"\n        viewBox="0 0 24 24"\n        height="1em"\n        width="1em"\n        xmlns="http://www.w3.org/2000/svg"\n        style="margin-right: 5px; font-size: 18px;"\n      >\n        <path fill="none" d="M0 0h24v24H0V0z"></path>\n        <path\n          d="M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"\n        ></path>\n      </svg>\n      You denied Permission:\n    </p>\n    <p>\n      We cannot place a call without access to microphone/camera.</p>\n    <img\n      src="https://d33v4339jhl8k0.cloudfront.net/docs/assets/543e7a20e4b046886e46282c/images/5e7b98c22c7d3a7e9ae9c5ff/file-po90FSIQT6.png"\n      alt="media-permission-denied"\n      class="sa-live-call-widget-lead-capture-form-media-permission-denied-overlay-card-image"\n    /></div>\n</div>'},useData:!0})},7532:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-share-widget-container">\n  <div class="sa-live-call-widget-share-widget-inner-container">\n    <p class="sa-live-call-widget-share-widget-container-heading">Share via</p>\n    <div class="sa-live-call-widget-share-widget-btn-container">\n      <svg\n        width="32"\n        height="32"\n        style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"\n        version="1.1"\n        viewBox="0 0 512 512"\n        class="sa-live-call-widget-share-widget-on-whatsapp"\n      >\n        <g id="WhatsApp-Logo-Icon">\n          <path\n            d="M116.225,-0.001c-11.264,0.512 -26.112,1.536 -32.768,3.072c-10.24,2.048 -19.968,5.12 -27.648,9.216c-9.728,4.608 -17.92,10.752 -25.088,17.92c-7.68,7.68 -13.824,15.872 -18.432,25.6c-4.096,7.68 -7.168,17.408 -9.216,27.648c-1.536,6.656 -2.56,21.504 -2.56,32.768c-0.512,4.608 -0.512,10.752 -0.512,13.824l0,251.905l0,13.824c0.512,11.264 1.536,26.112 3.072,32.768c2.048,10.24 5.12,19.968 9.216,27.648c4.608,9.728 10.752,17.92 17.92,25.088c7.68,7.68 15.872,13.824 25.6,18.432c7.68,4.096 17.408,7.168 27.648,9.216c6.656,1.536 21.504,2.56 32.768,2.56c4.608,0.512 10.752,0.512 13.824,0.512l251.904,0l13.824,0c11.264,-0.512 26.112,-1.536 32.768,-3.072c10.24,-2.048 19.968,-5.12 27.648,-9.216c9.728,-4.608 17.92,-10.752 25.088,-17.92c7.68,-7.68 13.824,-15.872 18.432,-25.6c4.096,-7.68 7.168,-17.408 9.216,-27.648c1.536,-6.656 2.56,-21.504 2.56,-32.768c0.512,-4.608 0.512,-10.752 0.512,-13.824l0,-265.729c-0.512,-11.264 -1.536,-26.112 -3.072,-32.768c-2.048,-10.24 -5.12,-19.968 -9.216,-27.648c-4.608,-9.728 -10.752,-17.92 -17.92,-25.088c-7.68,-7.68 -15.872,-13.824 -25.6,-18.432c-7.68,-4.096 -17.408,-7.168 -27.648,-9.216c-6.656,-1.536 -21.504,-2.56 -32.768,-2.56c-4.608,-0.512 -10.752,-0.512 -13.824,-0.512l-265.728,0Z"\n            style="fill:url(#_Linear1);fill-rule:nonzero;"\n          />\n          <path\n            d="M344.754,289.698c-4.56,-2.282 -26.98,-13.311 -31.161,-14.832c-4.18,-1.521 -7.219,-2.282 -10.259,2.282c-3.041,4.564 -11.78,14.832 -14.44,17.875c-2.66,3.042 -5.32,3.423 -9.88,1.14c-4.561,-2.281 -19.254,-7.095 -36.672,-22.627c-13.556,-12.087 -22.709,-27.017 -25.369,-31.581c-2.66,-4.564 -0.283,-7.031 2,-9.304c2.051,-2.041 4.56,-5.324 6.84,-7.986c2.28,-2.662 3.04,-4.564 4.56,-7.606c1.52,-3.042 0.76,-5.705 -0.38,-7.987c-1.14,-2.282 -10.26,-24.72 -14.06,-33.848c-3.701,-8.889 -7.461,-7.686 -10.26,-7.826c-2.657,-0.132 -5.7,-0.16 -8.74,-0.16c-3.041,0 -7.98,1.141 -12.161,5.704c-4.18,4.564 -15.96,15.594 -15.96,38.032c0,22.438 16.34,44.116 18.62,47.159c2.281,3.043 32.157,49.089 77.902,68.836c10.88,4.697 19.374,7.501 25.997,9.603c10.924,3.469 20.866,2.98 28.723,1.806c8.761,-1.309 26.98,-11.029 30.781,-21.677c3.799,-10.649 3.799,-19.777 2.659,-21.678c-1.139,-1.902 -4.179,-3.043 -8.74,-5.325m-83.207,113.573l-0.061,0c-27.22,-0.011 -53.917,-7.32 -77.207,-21.137l-5.539,-3.287l-57.413,15.056l15.325,-55.959l-3.608,-5.736c-15.184,-24.145 -23.203,-52.051 -23.192,-80.704c0.033,-83.611 68.083,-151.635 151.756,-151.635c40.517,0.016 78.603,15.811 107.243,44.474c28.64,28.663 44.404,66.764 44.389,107.283c-0.035,83.617 -68.083,151.645 -151.693,151.645m129.102,-280.709c-34.457,-34.486 -80.281,-53.487 -129.103,-53.507c-100.595,0 -182.468,81.841 -182.508,182.437c-0.013,32.156 8.39,63.546 24.361,91.212l-25.892,94.545l96.75,-25.37c26.657,14.535 56.67,22.194 87.216,22.207l0.075,0c100.586,0 182.465,-81.852 182.506,-182.448c0.019,-48.751 -18.946,-94.59 -53.405,-129.076"\n            style="fill:#fff;"\n          />\n        </g>\n        <defs>\n          <linearGradient\n            gradientTransform="matrix(0,-512,-512,0,256.001,512)"\n            gradientUnits="userSpaceOnUse"\n            id="_Linear1"\n            x1="0"\n            x2="1"\n            y1="0"\n            y2="0"\n          >\n            <stop offset="0" style="stop-color:#25cf43;stop-opacity:1" />\n            <stop offset="1" style="stop-color:#61fd7d;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n      </svg>\n      <svg\n        width="32"\n        height="32"\n        style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"\n        version="1.1"\n        viewBox="0 0 512 512"\n        class="sa-live-call-widget-share-widget-on-twitter"\n      >\n        <g>\n          <path\n            d="M448,512l-384,0c-35.328,0 -64,-28.672 -64,-64l0,-384c0,-35.328 28.672,-64 64,-64l384,0c35.328,0 64,28.672 64,64l0,384c0,35.328 -28.672,64 -64,64Z"\n            id="Dark_Blue"\n            style="fill:#1da1f2;fill-rule:nonzero;"\n          />\n          <path\n            d="M196.608,386.048c120.704,0 186.752,-100.096 186.752,-186.752c0,-2.816 0,-5.632 -0.128,-8.448c12.8,-9.216 23.936,-20.864 32.768,-34.048c-11.776,5.248 -24.448,8.704 -37.76,10.368c13.568,-8.064 23.936,-20.992 28.928,-36.352c-12.672,7.552 -26.752,12.928 -41.728,15.872c-12.032,-12.8 -29.056,-20.736 -47.872,-20.736c-36.224,0 -65.664,29.44 -65.664,65.664c0,5.12 0.64,10.112 1.664,14.976c-54.528,-2.688 -102.912,-28.928 -135.296,-68.608c-5.632,9.728 -8.832,20.992 -8.832,33.024c0,22.784 11.648,42.88 29.184,54.656c-10.752,-0.384 -20.864,-3.328 -29.696,-8.192l0,0.896c0,31.744 22.656,58.368 52.608,64.384c-5.504,1.536 -11.264,2.304 -17.28,2.304c-4.224,0 -8.32,-0.384 -12.288,-1.152c8.32,26.112 32.64,45.056 61.312,45.568c-22.528,17.664 -50.816,28.16 -81.536,28.16c-5.248,0 -10.496,-0.256 -15.616,-0.896c28.928,18.432 63.488,29.312 100.48,29.312"\n            id="Logo__x2014__FIXED"\n            style="fill:#fff;fill-rule:nonzero;"\n          />\n        </g>\n      </svg>\n      <svg\n        width="32"\n        height="32"\n        style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"\n        version="1.1"\n        viewBox="0 0 512 512"\n        class="sa-live-call-widget-share-widget-on-linkedin"\n      >\n        <g id="g5891">\n          <path\n            d="M512,64c0,-35.323 -28.677,-64 -64,-64l-384,0c-35.323,0 -64,28.677 -64,64l0,384c0,35.323 28.677,64 64,64l384,0c35.323,0 64,-28.677 64,-64l0,-384Z"\n            id="background"\n            style="fill:#2867b2;"\n          />\n          <g id="shapes">\n            <rect\n              height="257.962"\n              id="rect11"\n              style="fill:#fff;"\n              width="85.76"\n              x="61.053"\n              y="178.667"\n            />\n            <path\n              d="M104.512,54.28c-29.341,0 -48.512,19.29 -48.512,44.573c0,24.752 18.588,44.574 47.377,44.574l0.554,0c29.903,0 48.516,-19.822 48.516,-44.574c-0.555,-25.283 -18.611,-44.573 -47.935,-44.573Z"\n              id="path13-0"\n              style="fill:#fff;fill-rule:nonzero;"\n            />\n            <path\n              d="M357.278,172.601c-45.49,0 -65.866,25.017 -77.276,42.589l0,-36.523l-85.738,0c1.137,24.197 0,257.961 0,257.961l85.737,0l0,-144.064c0,-7.711 0.554,-15.42 2.827,-20.931c6.188,-15.4 20.305,-31.352 43.993,-31.352c31.012,0 43.436,23.664 43.436,58.327l0,138.02l85.741,0l0,-147.93c0,-79.237 -42.305,-116.097 -98.72,-116.097Z"\n              id="path15"\n              style="fill:#fff;fill-rule:nonzero;"\n            />\n          </g>\n        </g>\n      </svg>\n      <svg\n        enable-background="new 0 0 512 512"\n        width="32"\n        height="32"\n        id="Layer_1"\n        version="1.1"\n        viewBox="0 0 512 512"\n        class="sa-live-call-widget-share-widget-on-gmail"\n      >\n        <g>\n          <path\n            d="M510.689,478.854c0,17.562-14.275,31.837-31.837,31.837H33.146c-17.561,0-31.836-14.275-31.836-31.837   V33.146c0-17.56,14.275-31.836,31.836-31.836h445.706c17.562,0,31.837,14.276,31.837,31.836V478.854z"\n            fill="#E63734"\n          />\n        </g>\n        <g>\n          <path\n            d="M110.664,130.22h290.869c15.32,0,27.82,12.5,27.82,27.817v195.93c0,15.324-12.5,27.813-27.82,27.813   H110.664c-15.522,0-28.018-12.488-28.018-27.813v-195.93C82.646,142.72,95.142,130.22,110.664,130.22L110.664,130.22z"\n            fill="#ECEADF"\n          />\n          <path\n            d="M256.002,289.861l136.461-96.348v188.266h9.07c15.32,0,27.82-12.488,27.82-27.813V167.511v-9.474   c0-12.902-8.875-23.785-20.974-27.014L256.002,238.664L103.81,131.023c-12.099,3.022-21.162,14.11-21.162,27.014v9.271v186.659   c0,15.324,12.494,27.813,28.018,27.813h8.867V193.515L256.002,289.861z"\n            fill="#E63734"\n          />\n          <polygon\n            fill="#AEAEA5"\n            points="392.463,193.515 256.002,289.861 392.256,381.779 392.463,381.779  "\n          />\n          <path\n            d="M119.531,381.779l136.471-91.918C201.371,321.916,170.127,342.271,119.531,381.779L119.531,381.779z"\n            fill="#AEAEA5"\n          />\n          <path\n            d="M392.463,193.515V381.78h9.07c15.32,0,27.82-12.488,27.82-27.813V167.511L392.463,193.515z"\n            fill="#A62323"\n          />\n        </g>\n      </svg>\n    </div>\n    <div class="sa-live-call-widget-copy-widget-page-url-btn">\n      <div class="sa-live-call-widget-copy-widget-page-url-btn-icon">\n        <svg\n          stroke="currentColor"\n          fill="currentColor"\n          stroke-width="0"\n          viewBox="0 0 512 512"\n          height="12"\n          width="12"\n          xmlns="http://www.w3.org/2000/svg"\n        >\n          <path\n            d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"\n          ></path>\n        </svg>\n      </div>\n      <span\n        class="sa-live-call-widget-copy-widget-page-url-btn-text"\n      >Copy</span>\n    </div>\n    <svg\n      class="sa-live-call-widget-close-share-widget-popup-btn"\n      height="24"\n      viewBox="0 0 48 48"\n      width="24"\n      xmlns="http://www.w3.org/2000/svg"\n    ><path\n        d="M24 4c-11.05 0-20 8.95-20 20s8.95 20 20 20 20-8.95 20-20-8.95-20-20-20zm10 27.17l-2.83 2.83-7.17-7.17-7.17 7.17-2.83-2.83 7.17-7.17-7.17-7.17 2.83-2.83 7.17 7.17 7.17-7.17 2.83 2.83-7.17 7.17 7.17 7.17z"\n      /><path d="M0 0h48v48h-48z" fill="none" /></svg>\n  </div>\n</div>'},useData:!0})},4704:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <span \n                    id="notification-close-btn" \n                    class="close-icon"\n                    style="border-radius: '+l(typeof(o=null!=(o=d(n,"closeIconBorderRadius")||(null!=t?d(t,"closeIconBorderRadius"):t))?o:s)===c?o.call(a,{name:"closeIconBorderRadius",hash:{},data:i,loc:{start:{line:9,column:42},end:{line:9,column:67}}}):o)+"px; background: "+l(typeof(o=null!=(o=d(n,"closeIconBackground")||(null!=t?d(t,"closeIconBackground"):t))?o:s)===c?o.call(a,{name:"closeIconBackground",hash:{},data:i,loc:{start:{line:9,column:83},end:{line:9,column:106}}}):o)+"; color: "+l(typeof(o=null!=(o=d(n,"closeIconColor")||(null!=t?d(t,"closeIconColor"):t))?o:s)===c?o.call(a,{name:"closeIconColor",hash:{},data:i,loc:{start:{line:9,column:115},end:{line:9,column:133}}}):o)+';"\n                >\n                    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"></path></svg>\n                </span>\n'},3:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <button id="notification-close-btn" class="close-button">'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"closeCtaText")||(null!=t?a(t,"closeCtaText"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"closeCtaText",hash:{},data:i,loc:{start:{line:19,column:73},end:{line:19,column:89}}}):o)+"</button>\n"},5:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        "+e.escapeExpression(e.lambda(null!=(o=null!=t?a(t,"notificationButtonText"):t)?a(o,"text"):o,t))+"\n"},7:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <img src="'+e.escapeExpression(e.lambda(null!=(o=null!=t?a(t,"notificationButtonText"):t)?a(o,"image"):o,t))+'" alt=""/>\n'},9:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <video src="'+e.escapeExpression(e.lambda(null!=(o=null!=t?a(t,"notificationButtonText"):t)?a(o,"video"):o,t))+'" loop playsinline autoplay muted></video>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div id="saleassist-notification-one" class="saleassist-notification '+d(typeof(a=null!=(a=u(n,"notificationPosition")||(null!=t?u(t,"notificationPosition"):t))?a:c)===l?a.call(s,{name:"notificationPosition",hash:{},data:i,loc:{start:{line:1,column:69},end:{line:1,column:93}}}):a)+'">\n    <div class="notification-wrapper">\n        <h1 class="notification-title">\n            '+d(typeof(a=null!=(a=u(n,"headerText")||(null!=t?u(t,"headerText"):t))?a:c)===l?a.call(s,{name:"headerText",hash:{},data:i,loc:{start:{line:4,column:12},end:{line:4,column:26}}}):a)+"\n"+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isCloseCtaIcon"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:5,column:12},end:{line:13,column:19}}}))?o:"")+'        </h1>\n        <p class="notification-content">'+d(typeof(a=null!=(a=u(n,"bodyText")||(null!=t?u(t,"bodyText"):t))?a:c)===l?a.call(s,{name:"bodyText",hash:{},data:i,loc:{start:{line:15,column:40},end:{line:15,column:52}}}):a)+'</p>\n        <div class="notification-buttons-wrapper">\n            <button id="notification-action-btn">'+d(typeof(a=null!=(a=u(n,"mainCtaText")||(null!=t?u(t,"mainCtaText"):t))?a:c)===l?a.call(s,{name:"mainCtaText",hash:{},data:i,loc:{start:{line:17,column:49},end:{line:17,column:64}}}):a)+"</button>\n"+(null!=(o=u(n,"unless").call(s,null!=t?u(t,"isCloseCtaIcon"):t,{name:"unless",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i,loc:{start:{line:18,column:12},end:{line:20,column:23}}}))?o:"")+'        </div>\n    </div>\n</div>\n\n<button id="saleassist-notification-btn-one" class="saleassist-notification-btn '+d(typeof(a=null!=(a=u(n,"notificationBtnPosition")||(null!=t?u(t,"notificationBtnPosition"):t))?a:c)===l?a.call(s,{name:"notificationBtnPosition",hash:{},data:i,loc:{start:{line:25,column:80},end:{line:25,column:107}}}):a)+' hidden">\n'+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isColorType"):t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i,loc:{start:{line:26,column:4},end:{line:28,column:11}}}))?o:"")+"    \n"+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isImageType"):t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i,loc:{start:{line:30,column:4},end:{line:32,column:11}}}))?o:"")+"    \n"+(null!=(o=u(n,"if").call(s,null!=t?u(t,"isVideoType"):t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i,loc:{start:{line:34,column:4},end:{line:36,column:11}}}))?o:"")+"</button>"},useData:!0})},1442:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-ai-video-call-container">\n  <div class="sa-ai-video-call-action-panel"></div>\n  <div class="sa-lead-capture-prompt"></div>\n\n  <div class="sa-ai-video-call-wrapper">\n    <video id="local-video" autoplay muted playsInline></video>\n    <video id="remote-video" autoplay playsInline></video>\n    \x3c!-- Audio element will be created automatically --\x3e\n  \n    <button id="minimize-tile">'+(null!=(o=typeof(a=null!=(a=d(n,"minimize")||(null!=t?d(t,"minimize"):t))?a:c)===l?a.call(s,{name:"minimize",hash:{},data:i,loc:{start:{line:10,column:31},end:{line:10,column:45}}}):a)?o:"")+'</button>\n    <div id="maximize-tile-overlay" style="display: none;">'+(null!=(o=typeof(a=null!=(a=d(n,"maximize")||(null!=t?d(t,"maximize"):t))?a:c)===l?a.call(s,{name:"maximize",hash:{},data:i,loc:{start:{line:11,column:59},end:{line:11,column:73}}}):a)?o:"")+'</div>\n\n    <div class="call-controls">\n      <button id="toggle-mic">'+(null!=(o=typeof(a=null!=(a=d(n,"mic")||(null!=t?d(t,"mic"):t))?a:c)===l?a.call(s,{name:"mic",hash:{},data:i,loc:{start:{line:14,column:30},end:{line:14,column:39}}}):a)?o:"")+'</button>\n      <button id="toggle-cam">'+(null!=(o=typeof(a=null!=(a=d(n,"cameraOn")||(null!=t?d(t,"cameraOn"):t))?a:c)===l?a.call(s,{name:"cameraOn",hash:{},data:i,loc:{start:{line:15,column:30},end:{line:15,column:44}}}):a)?o:"")+'</button>\n      <button id="transcript-open-btn">'+(null!=(o=typeof(a=null!=(a=d(n,"cc")||(null!=t?d(t,"cc"):t))?a:c)===l?a.call(s,{name:"cc",hash:{},data:i,loc:{start:{line:16,column:39},end:{line:16,column:47}}}):a)?o:"")+'</button>\n      <button id="leave-call">'+(null!=(o=typeof(a=null!=(a=d(n,"endCall")||(null!=t?d(t,"endCall"):t))?a:c)===l?a.call(s,{name:"endCall",hash:{},data:i,loc:{start:{line:17,column:30},end:{line:17,column:43}}}):a)?o:"")+'</button>\n    </div>\n    \n    <div class="transcript-wrapper" style="display: none;">\n      <span id="transcript-close-btn">'+(null!=(o=typeof(a=null!=(a=d(n,"closeButton")||(null!=t?d(t,"closeButton"):t))?a:c)===l?a.call(s,{name:"closeButton",hash:{},data:i,loc:{start:{line:21,column:38},end:{line:21,column:55}}}):a)?o:"")+'</span>\n      <div class="transcript-chats"></div>\n      <div class="transcript-chats-header">Transcript</div>\n    </div>\n  </div>\n</div>\n\n<div class="sa-ai-video-loader-overlay">\n  '+(null!=(o=typeof(a=null!=(a=d(n,"callWaitingPage")||(null!=t?d(t,"callWaitingPage"):t))?a:c)===l?a.call(s,{name:"callWaitingPage",hash:{},data:i,loc:{start:{line:29,column:2},end:{line:29,column:23}}}):a)?o:"")+"\n</div>\n\n<style>\n  .sa-ai-video-call-container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    z-index: 2147483611 !important;\n    height: 100%;\n    background: #fff;\n\n    video {\n      object-fit: cover;\n    }\n\n    .sa-ai-video-call-action-panel, \n    .sa-lead-capture-prompt {\n      display: none;\n      position: absolute;\n      bottom: 60px;\n      left: 10px;\n      right: 10px;\n      height: 180px;\n      padding: 4px;\n      background: rgba(255, 255, 255, 0.3);\n      backdrop-filter: blur(5px);\n      border-radius: 16px;\n      overflow: hidden;\n      z-index: 1;\n\n      img, video {\n        width: 100%;\n        height: 100%;\n        border-radius: 12px;\n        object-fit: contain;\n        background: #333;\n      }\n    }\n\n    .sa-lead-capture-prompt {\n      max-width: 320px;\n      height: max-content;\n    }\n\n    .sa-ai-video-call-wrapper {\n      height: 100%;\n      width: 100%;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n    }\n\n    #local-video {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 0;\n      transition: all 0.3s ease;\n      z-index: 1;\n    }\n\n    #local-video.local-video-small {\n      top: 10px;\n      right: 10px;\n      left: auto;\n      width: 75px;\n      height: 100px;\n      border-radius: 8px;\n    }\n\n    #remote-video {\n      position: relative;\n      width: 100%;\n      height: 100%;\n    }\n\n    #minimize-tile {\n      position: absolute;\n      top: 10px;\n      left: 10px;\n      border: none;\n      font-size: 20px;\n      border-radius: 20px;\n      width: 40px;\n      height: 40px;\n      display: flex;\n      place-content: center;\n      place-items: center;\n      background: rgba(255, 255, 255, 0.3);\n      backdrop-filter: blur(5px);\n      color: #fff;\n      cursor: pointer;\n    }\n\n    #maximize-tile-overlay {\n      position: absolute;\n      top: 0px;\n      left: 0px;\n      width: 100%;\n      height: 100%;\n      z-index: 1025;\n      cursor: pointer;\n\n      &:hover {\n        backdrop-filter: brightness(0.5);\n      }\n\n      svg {\n        position: absolute;\n        top: 8px;\n        right: 8px;\n        font-size: 22px;\n        color: #fff;\n      }\n    }\n\n    .call-controls {\n      position: absolute;\n      bottom: 10px;\n      left: 50%;\n      display: flex;\n      gap: 8px;\n      transform: translateX(-50%);\n\n      button {\n        border: none;\n        font-size: 20px;\n        border-radius: 20px;\n        width: 40px;\n        height: 40px;\n        display: flex;\n        place-content: center;\n        place-items: center;\n        background: rgba(255, 255, 255, 0.3);\n        backdrop-filter: blur(5px);\n        color: #fff;\n        cursor: pointer;\n      }\n\n      #leave-call {\n        background: rgb(255, 91, 91, 0.7);\n      }\n    }\n\n    .transcript-wrapper {\n      display: flex;\n      flex-direction: column;\n      position: absolute;\n      bottom: 60px;\n      left: 10px;\n      right: 10px;\n      height: 180px;\n      padding: 15px 10px;\n      background: rgba(255,255,255, 0.3);\n      backdrop-filter: blur(5px);\n      border-radius: 16px;\n      z-index: 1;\n    }\n\n    .transcript-chats {\n      flex: 1;\n      overflow-y: auto;\n      padding: 0 5px;\n    }\n\n    .transcript-chats::-webkit-scrollbar-thumb {\n      background: white;\n    }\n\n    .transcript-chats::-webkit-scrollbar-track {\n      background: transparent;\n      margin: 20px;\n    }\n\n    .transcript-chats-header {\n      display: flex;\n      place-content: center;\n      padding-top: 8px;\n      margin: 0 5px;\n      border-top: 1px solid #e1e1e1;\n      color: #fff;\n      font-size: 13px;\n    }\n\n    #transcript-close-btn {\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      border-radius: 50px;\n      display: flex;\n      padding: 2px;\n      background: rgb(255, 91, 91, 0.7);\n      color: #fff;\n      cursor: pointer;\n    }\n\n    #transcript-close-btn:hover {\n      color: red;\n    }\n\n    .chat-message {\n      margin: 6px 0;\n      padding: 8px 12px;\n      border-radius: 16px;\n      max-width: 75%;\n      word-wrap: break-word;\n      display: inline-block;\n      font-size: 13px;\n      line-height: normal;\n    }\n\n    .chat-left {\n      background-color: #e0f7fa;\n      align-self: flex-start;\n      text-align: left;\n    }\n\n    .chat-right {\n      background-color: #dcedc8;\n      align-self: flex-end;\n      text-align: right;\n      margin-left: auto;\n      float: right;\n    }\n  }\n\n  .sa-ai-video-loader-overlay {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    display: none;\n    z-index: 2147483612 !important;\n  }\n\n  .sa-ai-video-call-container.landscape {\n    .sa-ai-video-call-action-panel {\n      width: 30%;\n      height: 35%;\n      left: 50%;\n      right: unset;\n      transform: translateX(-50%);\n    }\n\n    #local-video.local-video-small {\n      top: unset;\n      right: unset;\n      bottom: 10px;\n      left: 10px;\n      width: 160px;\n      height: 90px;\n    }\n\n    .transcript-wrapper {\n      width: 300px;\n      left: unset;\n      top: 10px;\n      bottom: 10px;\n      height: auto;\n    }\n  }\n</style>"},useData:!0})},1587:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="ai-chat-bot-icon-wrapper">\n        <img src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"chatBotIcon")||(null!=t?a(t,"chatBotIcon"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"chatBotIcon",hash:{},data:i,loc:{start:{line:5,column:18},end:{line:5,column:33}}}):o)+'" alt="chat bot icon" class="ai-chat-bot-icon" />\n      </div>\n'},3:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"chatBotInitials"):t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.program(6,i,0),data:i,loc:{start:{line:8,column:6},end:{line:26,column:13}}}))?o:""},4:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="sa-ai-chat-title-initials">'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"chatBotInitials")||(null!=t?a(t,"chatBotInitials"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"chatBotInitials",hash:{},data:i,loc:{start:{line:9,column:46},end:{line:9,column:65}}}):o)+"</span>\n"},6:function(e,t,n,r,i){return'      <svg\n        stroke="var(--invertColor)"\n        fill="var(--invertColor)"\n        stroke-width="0"\n        role="img"\n        viewBox="0 0 24 24"\n        height="1em"\n        width="1em"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <title></title>\n        <path\n          d="M11.999 0c-2.25 0-4.5.06-6.6.21a5.57 5.57 0 00-5.19 5.1c-.24 3.21-.27 6.39-.06 9.6a5.644 5.644 0 005.7 5.19h3.15v-3.9h-3.15c-.93.03-1.74-.63-1.83-1.56-.18-3-.15-6 .06-9 .06-.84.72-1.47 1.56-1.53 2.04-.15 4.2-.21 6.36-.21s4.32.09 6.36.18c.81.06 1.5.69 1.56 1.53.24 3 .24 6 .06 9-.12.93-.9 1.62-1.83 1.59h-3.15l-6 3.9V24l6-3.9h3.15c2.97.03 5.46-2.25 5.7-5.19.21-3.18.18-6.39-.03-9.57a5.57 5.57 0 00-5.19-5.1c-2.13-.18-4.38-.24-6.63-.24zm-5.04 8.76c-.36 0-.66.3-.66.66v2.34c0 .33.18.63.48.78 1.62.78 3.42 1.2 5.22 1.26 1.8-.06 3.6-.48 5.22-1.26.3-.15.48-.45.48-.78V9.42c0-.09-.03-.15-.09-.21a.648.648 0 00-.87-.36c-1.5.66-3.12 1.02-4.77 1.05-1.65-.03-3.27-.42-4.77-1.08a.566.566 0 00-.24-.06z"\n        ></path>\n      </svg>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-ai-chat-container">\n  <div class="sa-ai-chat-header">\n'+(null!=(o=d(n,"if").call(s,null!=t?d(t,"chatBotIcon"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i,loc:{start:{line:3,column:4},end:{line:27,column:11}}}))?o:"")+'    <div class="sa-ai-chat-header-title">\n      '+e.escapeExpression(typeof(a=null!=(a=d(n,"chatBotName")||(null!=t?d(t,"chatBotName"):t))?a:c)===l?a.call(s,{name:"chatBotName",hash:{},data:i,loc:{start:{line:29,column:6},end:{line:29,column:21}}}):a)+'\n      <span id="sa-ai-chat-typing-indicator">online</span>\n    </div>\n    \n  </div>\n\n  <div class="sa-ai-chat-log" id="saleassistAiChatLog">\n    \x3c!-- Chat messages will be displayed here --\x3e\n  </div>\n\n  <div class="sa-ai-chat-input-box">\n    <span class="sa-ai-chat-input-overlay">\n      '+(null!=(o=typeof(a=null!=(a=d(n,"threeDotsLoader")||(null!=t?d(t,"threeDotsLoader"):t))?a:c)===l?a.call(s,{name:"threeDotsLoader",hash:{},data:i,loc:{start:{line:41,column:6},end:{line:41,column:27}}}):a)?o:"")+'\n    </span>\n\n    <div class="sa-ai-chat-document-preview-container">\n      \x3c!-- Uploaded files will be displayed here --\x3e\n    </div>\n\n    <div class="sa-ai-chat-input-container">\n      <div class="sa-ai-chat-input-wrapper">\n        <svg\n          stroke="currentColor"\n          fill="currentColor"\n          stroke-width="0"\n          viewBox="0 0 24 24"\n          height="1em"\n          width="1em"\n          xmlns="http://www.w3.org/2000/svg"\n          id="sa-ai-chat-toggle-emoji-btn"\n        ><path fill="none" d="M0 0h24v24H0z"></path><circle\n            cx="15.5"\n            cy="9.5"\n            r="1.5"\n          ></circle><circle cx="8.5" cy="9.5" r="1.5"></circle><path\n            d="M12 18c2.28 0 4.22-1.66 5-4H7c.78 2.34 2.72 4 5 4z"\n          ></path><path\n            d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"\n          ></path></svg>\n        <div id="sa-ai-chat-emoji-wrapper">\n          <span class="sa-ai-chat-emoji">&#128150;</span>\n          <span class="sa-ai-chat-emoji">&#128077;</span>\n          <span class="sa-ai-chat-emoji">&#127881;</span>\n          <span class="sa-ai-chat-emoji">&#128079;</span>\n          <span class="sa-ai-chat-emoji">&#128514;</span>\n          <span class="sa-ai-chat-emoji">&#128558;</span>\n          <span class="sa-ai-chat-emoji">&#128549;</span>\n          <span class="sa-ai-chat-emoji">&#129300;</span>\n          <span class="sa-ai-chat-emoji">&#128078;</span>\n        </div>\n        <input\n          type="text"\n          id="saleassistAiChatMessageInput"\n          placeholder="Ask me anything"\n        />\n        <label htmlFor="ai-chat-upload-file">\n          <span id="saleassistAiChatUploadButton">\n            '+(null!=(o=typeof(a=null!=(a=d(n,"uploadBtn")||(null!=t?d(t,"uploadBtn"):t))?a:c)===l?a.call(s,{name:"uploadBtn",hash:{},data:i,loc:{start:{line:86,column:12},end:{line:86,column:27}}}):a)?o:"")+'\n            <input\n              type="file"\n              id="ai-chat-upload-file"\n              style="display:none"\n              accept="*"\n              multiple\n              disabled\n            />\n          </span>\n        </label>\n      </div>\n      <button id="saleassistAiChatSendButton">\n        '+(null!=(o=typeof(a=null!=(a=d(n,"sendBtn")||(null!=t?d(t,"sendBtn"):t))?a:c)===l?a.call(s,{name:"sendBtn",hash:{},data:i,loc:{start:{line:99,column:8},end:{line:99,column:21}}}):a)?o:"")+"\n      </button>\n    </div>\n  </div>\n</div>"},useData:!0})},7685:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-default-container">\n  <div class="sa-live-call-widget-audio-message-page">\n    <div class="sa-live-call-widget-audio-message-preview-wrapper">\n      <img\n        src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/speaking-icon.png"\n        alt="speaking"\n        class="sa-live-call-widget-audio-message-speaking-icon"\n      />\n      <img\n        src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/audio-waves.png"\n        alt="audio-waves"\n        class="sa-live-call-widget-audio-message-waves"\n      />\n      <button class="sa-live-call-widget-audio-message-play-pause-btn"><svg\n          stroke="currentColor"\n          fill="currentColor"\n          stroke-width="0"\n          viewBox="0 0 16 16"\n          height="24"\n          width="24"\n          xmlns="http://www.w3.org/2000/svg"\n        ><path\n            d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"\n          ></path></svg>Play</button>\n    </div>\n    <div class="sa-live-call-widget-audio-message-controls-btn-wrapper">\n      <button\n        class="sa-live-call-widget-audio-message-start-stop-recording-btn"\n      >Start Recording</button>\n    </div>\n  </div>\n</div>'},useData:!0})},3525:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <iframe\n        src="https://bigtrunk.g2afse.com/success.php?afstatus=1&afgoal=video_call_ scheduled&custom_field1='+l(typeof(o=null!=(o=d(n,"mobileNumber")||(null!=t?d(t,"mobileNumber"):t))?o:s)===c?o.call(a,{name:"mobileNumber",hash:{},data:i,loc:{start:{line:8,column:107},end:{line:8,column:123}}}):o)+"&custom_field2="+l(typeof(o=null!=(o=d(n,"affiliateId")||(null!=t?d(t,"affiliateId"):t))?o:s)===c?o.call(a,{name:"affiliateId",hash:{},data:i,loc:{start:{line:8,column:138},end:{line:8,column:153}}}):o)+"&custom_field3="+l(typeof(o=null!=(o=d(n,"peopleId")||(null!=t?d(t,"peopleId"):t))?o:s)===c?o.call(a,{name:"peopleId",hash:{},data:i,loc:{start:{line:8,column:168},end:{line:8,column:180}}}):o)+'"\n        height="1"\n        width="1"\n      />\n      \x3c!-- End Offer Conversion --\x3e\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  class="sa-live-call-widget-thankyou-wrapper sa-live-call-widget-call-timeout-page"\n>\n  <div class="sa-live-call-widget-thankyou-container">\n'+(null!=(o=d(n,"if").call(s,null!=t?d(t,"addOrraPixel"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:6,column:4},end:{line:13,column:11}}}))?o:"")+'    <div\n      class="sa-live-call-widget-bubble sa-live-call-widget-bubble-position-one"\n    >\n    </div>\n    <div\n      class="sa-live-call-widget-bubble sa-live-call-widget-bubble-position-two"\n    >\n    </div>\n    <svg\n      stroke="currentColor"\n      fill="currentColor"\n      stroke-width="0"\n      version="1"\n      viewBox="0 0 48 48"\n      enableBackground="new 0 0 48 48"\n      height="1em"\n      width="1em"\n      xmlns="http://www.w3.org/2000/svg"\n      style="font-size: 38px;"\n    ><g fill="#F44336"><polygon\n          points="30.3,12.9 24,19.2 15.7,10.9 12.9,13.7 24,24.8 33.1,15.7"\n        ></polygon><polygon points="36,19 27,10 36,10"></polygon></g><path\n        fill="#009688"\n        d="M44.5,30.8l-2.4-2.4c-8.5-8.3-28.9-7.1-36.2,0l-2.4,2.4c-0.7,0.7-0.7,1.7,0,2.4l4.8,4.7 c0.7,0.7,1.7,0.7,2.4,0l5.3-5.1l-0.4-5.6c1.7-1.7,15.1-1.7,16.8,0L32.1,33l5.1,4.9c0.7,0.7,1.7,0.7,2.4,0l4.8-4.7 C45.2,32.5,45.2,31.4,44.5,30.8z"\n      ></path></svg>\n    <h2 class="sa-live-call-widget-thank-you-title">We Missed You!</h2>\n    <p class="sa-live-call-widget-thank-you-message">'+e.escapeExpression(typeof(a=null!=(a=d(n,"timeoutMessage")||(null!=t?d(t,"timeoutMessage"):t))?a:c)===l?a.call(s,{name:"timeoutMessage",hash:{},data:i,loc:{start:{line:40,column:53},end:{line:40,column:71}}}):a)+'</p>\n    <div style="padding-top: 48px;">\n      <p class="sa-live-call-widget-call-timeout-cta-text">'+(null!=(o=typeof(a=null!=(a=d(n,"ctaText")||(null!=t?d(t,"ctaText"):t))?a:c)===l?a.call(s,{name:"ctaText",hash:{},data:i,loc:{start:{line:42,column:59},end:{line:42,column:72}}}):a)?o:"")+'</p>\n      <div class="sa-live-call-widget-expanded-cta-btn-wrapper-2">\n      </div>\n    </div>\n  </div>\n</div>\n\n<style>\n  .sa-live-call-widget-call-timeout-cta-text {\n  padding-bottom: 12px;\n  font-size: 14px;\n  font-weight: bold;\n  text-align: center;\n  color: #6d6d6d;\n  margin: 0 20px;\n}\n</style>'},useData:!0})},3903:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <iframe\n        src="https://bigtrunk.g2afse.com/success.php?afstatus=1&afgoal=video_call_ scheduled&custom_field1='+l(typeof(o=null!=(o=d(n,"mobileNumber")||(null!=t?d(t,"mobileNumber"):t))?o:s)===c?o.call(a,{name:"mobileNumber",hash:{},data:i,loc:{start:{line:8,column:107},end:{line:8,column:123}}}):o)+"&custom_field2="+l(typeof(o=null!=(o=d(n,"affiliateId")||(null!=t?d(t,"affiliateId"):t))?o:s)===c?o.call(a,{name:"affiliateId",hash:{},data:i,loc:{start:{line:8,column:138},end:{line:8,column:153}}}):o)+"&custom_field3="+l(typeof(o=null!=(o=d(n,"peopleId")||(null!=t?d(t,"peopleId"):t))?o:s)===c?o.call(a,{name:"peopleId",hash:{},data:i,loc:{start:{line:8,column:168},end:{line:8,column:180}}}):o)+'"\n        height="1"\n        width="1"\n      />\n      \x3c!-- End Offer Conversion --\x3e\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div\n  class="sa-live-call-widget-call-waiting-container sa-live-call-widget-call-waiting-container-'+e.escapeExpression("function"==typeof(a=null!=(a=c(n,"messageType")||(null!=t?c(t,"messageType"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"messageType",hash:{},data:i,loc:{start:{line:2,column:95},end:{line:2,column:110}}}):a)+'"\n>\n  <div class="sa-live-call-widget-call-waiting-wrapper">\n'+(null!=(o=c(n,"if").call(s,null!=t?c(t,"addOrraPixel"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:6,column:4},end:{line:13,column:11}}}))?o:"")+'    <div class="sa-live-call-widget-call-waiting-wrapper-content">\n      <div class="sa-live-call-widget-call-waiting-dialing">\n        <span class="text">Connecting.</span>\n        <span class="dots">...</span>\n      </div>\n      <div class="sa-live-call-widget-call-waiting-title">\n      </div>\n      <div class="sa-lead-capture-prompt"></div>\n    </div>\n  </div>\n  <div class="sa-live-call-widget-call-waiting-content"></div>\n</div>'},useData:!0})},4475:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-default-container">\n  <div class="sa-live-call-widget-video-message-page">\n    <div class="sa-live-call-widget-video-preview-wrapper">\n      <video\n        autoplay\n        muted\n        playsinline\n        class="sa-live-call-widget-video-preview"\n      ></video>\n      <div class="sa-live-call-capture-image-btn-wrapper">\n        <div class="sa-live-call-widget-capture-image-btn">\n          Capture\n        </div>\n        <button\n          class="sa-live-call-widget-video-message-toggle-recording-btn sa-live-call-widget-switch-camera-btn"\n        >\n          <svg\n            fill="none"\n            viewBox="0 0 20 20"\n            height="24"\n            width="24"\n            xmlns="http://www.w3.org/2000/svg"\n          ><path\n              d="M14.8536 2.14645C14.6583 1.95118 14.3417 1.95118 14.1464 2.14645C13.9512 2.34171 13.9512 2.65829 14.1464 2.85355L15.2929 4H4C2.89543 4 2 4.89543 2 6V12.5C2 12.7761 2.22386 13 2.5 13C2.77614 13 3 12.7761 3 12.5V6C3 5.44772 3.44772 5 4 5H15.2929L14.1464 6.14645C13.9512 6.34171 13.9512 6.65829 14.1464 6.85355C14.3417 7.04882 14.6583 7.04882 14.8536 6.85355L16.8536 4.85355C17.0488 4.65829 17.0488 4.34171 16.8536 4.14645L14.8536 2.14645ZM16 15C16.5523 15 17 14.5523 17 14V7.5C17 7.22386 17.2239 7 17.5 7C17.7761 7 18 7.22386 18 7.5V14C18 15.1046 17.1046 16 16 16H4.70711L5.85355 17.1464C6.04882 17.3417 6.04882 17.6583 5.85355 17.8536C5.65829 18.0488 5.34171 18.0488 5.14645 17.8536L3.14645 15.8536C2.95118 15.6583 2.95118 15.3417 3.14645 15.1464L5.14645 13.1464C5.34171 12.9512 5.65829 12.9512 5.85355 13.1464C6.04882 13.3417 6.04882 13.6583 5.85355 13.8536L4.70711 15H16ZM13 10C13 11.6569 11.6569 13 10 13C8.34315 13 7 11.6569 7 10C7 8.34315 8.34315 7 10 7C11.6569 7 13 8.34315 13 10ZM12 10C12 8.89543 11.1046 8 10 8C8.89543 8 8 8.89543 8 10C8 11.1046 8.89543 12 10 12C11.1046 12 12 11.1046 12 10Z"\n              fill="#fff"\n            /></svg>\n        </button>\n      </div>\n    </div>\n    <div class="sa-live-call-widget-post-captured-image-btn-wrapper"></div>\n  </div>\n</div>'},useData:!0})},753:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="strike-incoming-call-popup '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"positionClass")||(null!=t?a(t,"positionClass"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"positionClass",hash:{},data:i,loc:{start:{line:1,column:39},end:{line:1,column:56}}}):o)+'">\n    <div class="strike-header">\n        <span class="strike-header-icon">\n            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M144 464a16 16 0 0 1-16-16v-64h-24a72.08 72.08 0 0 1-72-72V120a72.08 72.08 0 0 1 72-72h304a72.08 72.08 0 0 1 72 72v192a72.08 72.08 0 0 1-72 72H245.74l-91.49 76.29A16.05 16.05 0 0 1 144 464z"></path></svg>\n        </span>\n        <span class="strike-header-title">\n            <span>Chat with Us</span>\n            <button id="popup-close">\n                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49z"></path></svg>\n            </button>\n        </span>\n    </div>\n    <div class="strike-message">\n        Live chat with our Travel Experts for Best Offers.\n    </div>\n    <div class="strike-footer">\n        <button id="popup-whatsapp">Start Chat</button>\n    </div>\n</div>\n\n<style>\n  .strike-incoming-call-popup {\n    position: fixed;\n    width: 305px;\n    display: flex;\n    flex-direction: column;\n    margin: 10px;\n    border-radius: 8px;\n    background: #fff;\n    box-shadow: 0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n    overflow: hidden;\n    z-index: 214748361000 !important;\n  }\n\n  .bottom-right {\n    bottom: 10px;\n    right: 10px;\n  }\n\n  .bottom-left {\n    bottom: 10px;\n    left: 10px;\n  }\n\n  .top-right {\n    top: 10px;\n    right: 10px;\n  }\n\n  .top-left {\n    top: 10px;\n    left: 10px;\n  }\n\n  .strike-header {\n    display: flex;\n    place-items: center;\n    gap: 10px;\n    padding: 15px;\n    background: #16a34a;\n    color: #fff;\n  }\n\n  .strike-header-icon {\n    display: flex;\n    font-size: 22px;\n  }\n\n  .strike-header-title {\n    display: flex;\n    place-content: space-between;\n    place-items: center;\n    flex: 1;\n    margin-top: -2px;\n    font-size: 16px;\n    font-weight: 600;\n    line-height: 1;\n  }\n\n  .strike-message {\n    padding: 15px 15px 6px;\n    font-size: 14px;\n  }\n\n  .strike-footer {\n    display: flex;\n    place-content: end;\n    padding: 6px 15px 15px;\n  }\n\n  .strike-footer #popup-whatsapp {\n    display: flex;\n    padding: 8px 16px;\n    font-size: 12px;\n    border: none;\n    border-radius: 50px;\n    background: #16a34a;\n    color: #fff;\n    cursor: pointer;\n  }\n\n  .strike-header-title #popup-close {\n    display: flex;\n    padding: 0;\n    font-size: 20px;\n    background: transparent;\n    border: none;\n    color: inherit;\n    cursor: pointer;\n  }\n\n  @media screen and (max-width: 500px) {\n    .strike-incoming-call-popup {\n      width: 200px;\n      height: 150px;\n    }\n\n    .strike-header {\n      gap: 6px;\n      padding: 10px;\n    }\n\n    .strike-header-icon {\n      font-size: 18px;\n    }\n\n    .strike-header-title {\n      font-size: 14px;\n    }\n\n    .strike-header-title #popup-close {\n      font-size: 18px;\n    }\n\n    .strike-message {\n      padding: 10px 10px 5px;\n      font-size: 12.5px;\n      flex: 1;\n    }\n\n    .strike-footer {\n      padding: 5px 10px 10px;\n    }\n\n    .strike-footer #popup-whatsapp {\n      padding: 6px 12px;\n      font-size: 11px;\n    }\n  }\n</style>'},useData:!0})},866:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="strike-incoming-call-popup '+l(typeof(o=null!=(o=d(n,"positionClass")||(null!=t?d(t,"positionClass"):t))?o:s)===c?o.call(a,{name:"positionClass",hash:{},data:i,loc:{start:{line:1,column:39},end:{line:1,column:56}}}):o)+'">\n  <div class="strike-live-assistant-message">\n    <p class="strike-live-assistant-title">Live Assistant</p>\n    <p class="strike-live-assistant-prompt">Can we Speak?</p>\n  </div>\n  <div class="strike-video-container">\n    <video id="welcome-video" autoplay muted loop>\n      <source src="'+l(typeof(o=null!=(o=d(n,"videoUrl")||(null!=t?d(t,"videoUrl"):t))?o:s)===c?o.call(a,{name:"videoUrl",hash:{},data:i,loc:{start:{line:8,column:19},end:{line:8,column:31}}}):o)+'" type="video/mp4">\n      Your browser does not support the video tag.\n    </video>\n  </div>\n  <div class="strike-overlay">\n    <div class="strike-message">Need any help?</div>\n    <div class="strike-buttons">\n      <button id="popup-whatsapp" class="strike-btn strike-btn-accept">\n        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style=""><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M416 128 192 384l-96-96"></path></svg>\n        Yes\n      </button>\n      <button id="popup-close" class="strike-btn strike-btn-reject">\n        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style="font-size: 14px;"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 368 144 144m224 0L144 368"></path></svg>\n        No\n      </button>\n    </div>\n    <div class="strike-live-tag"><span></span> Live Assistant</div>\n  </div>\n</div>\n\n<style>\n  .strike-incoming-call-popup {\n    position: fixed;\n    width: 150px;\n    height: 220px;\n    margin: 10px;\n    border-radius: 22px;\n    border: 4px solid #fff;\n    box-shadow: 0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n    z-index: 214748361000 !important;\n  }\n\n.bottom-right {\n    bottom: 10px;\n    right: 10px;\n  }\n  .bottom-left {\n    bottom: 10px;\n    left: 10px;\n  }\n  .top-right {\n    top: 10px;\n    right: 10px;\n  }\n\n  .top-left {\n    top: 10px;\n    left: 10px;\n  }\n\n  .strike-video-container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    border-radius: 20px;\n    overflow: hidden;\n  }\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .strike-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: end;\n    padding: 10px;\n    border-radius: 20px;\n    box-sizing: border-box;\n    background: linear-gradient(to top, black 10% , transparent 50%);\n    \n  }\n\n  .strike-live-assistant-message {\n    display: none;\n    position: absolute;\n    width: 100%;\n    top: -64px;\n    right: 0;\n    padding: 5px;\n    text-align: left;\n    margin-bottom: 5px;\n    margin-left: 2px;\n    border-radius: 8px 8px 0 8px;\n    border: 4px solid white;\n    background: #e7eaef;\n    box-shadow: -3px 3px 3px -2px rgba(0, 0, 0, 0.2), 0px 3px 4px 0px rgba(0, 0, 0, 0.14), 0 1px 8px 0 rgba(0, 0, 0, 0.12);\n    z-index: 1;\n  }\n\n  .strike-live-assistant-message::before {\n    content: \'\';\n    position: absolute;\n    right: 0;\n    bottom: -7px;\n    border-left: 8px solid transparent;\n    border-top: 8px solid #e7eaef;\n    z-index: 1;\n  }\n\n  .strike-live-assistant-message::after {\n    content: \'\';\n    position: absolute;\n    right: -4px;\n    bottom: -15px;\n    border-left: 13px solid transparent;\n    border-top: 12px solid white;\n    filter: drop-shadow(0 6px 4px rgba(0, 0, 0, 0.3));\n  }\n\n  .strike-live-assistant-title {\n    font-size: 12px;\n    font-weight: bold;\n    margin: 0;\n    color: black;\n  }\n\n  .strike-live-assistant-prompt {\n    font-size: 10px;\n    margin: 0;\n    color: black;\n  }\n\n  .strike-live-tag {\n    display: flex;\n    place-items: center;\n    place-content: center;\n    gap: 4px;\n    font-size: 11px;\n    font-weight: 600;\n    color: white;\n    margin-top: 8px;\n    line-height: normal;\n  }\n\n  .strike-live-tag span {\n    width: 4px;\n    height: 4px;\n    border-radius: 50%;\n    background: #f44336;\n    border: 2px solid white;\n    box-sizing: content-box;\n  }\n\n  .strike-message {\n    font-size: 14px;\n    font-weight: 600;\n    margin-bottom: 8px;\n    color: white;\n    text-align: center;\n    line-height: normal;\n  }\n\n  .strike-buttons {\n    display: flex;\n    gap: 10px;\n  }\n\n  button.strike-btn {\n    flex: 50%;\n    display: flex;\n    place-items: center;\n    gap: 4px;\n    padding: 4px 8px;\n    border: none;\n    border-radius: 10px;\n    font-size: 12px;\n    font-weight: 400;\n    font-family: inherit;\n    text-transform: capitalize;\n    line-height: normal;\n    margin: 0;\n    cursor: pointer;\n  }\n\n  button.strike-btn-accept {\n    background-color: #4CAF50;\n    color: white;\n  }\n\n  button.strike-btn-reject {\n    background-color: #f44336;\n    color: white;\n  }\n</style>'},useData:!0})},5382:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="strike-incoming-call-popup '+l(typeof(o=null!=(o=d(n,"positionClass")||(null!=t?d(t,"positionClass"):t))?o:s)===c?o.call(a,{name:"positionClass",hash:{},data:i,loc:{start:{line:1,column:39},end:{line:1,column:56}}}):o)+'">\n  <div class="strike-live-assistant-message">\n    <p class="strike-live-assistant-title">Live Assistant</p>\n    <p class="strike-live-assistant-prompt">Can we Speak?</p>\n  </div>\n  <div class="strike-video-container">\n    <video id="welcome-video" autoplay muted loop>\n      <source src="'+l(typeof(o=null!=(o=d(n,"videoUrl")||(null!=t?d(t,"videoUrl"):t))?o:s)===c?o.call(a,{name:"videoUrl",hash:{},data:i,loc:{start:{line:8,column:19},end:{line:8,column:31}}}):o)+'" type="video/mp4">\n      Your browser does not support the video tag.\n    </video>\n  </div>\n  <div class="strike-overlay">\n    <div class="strike-message">Need any help?</div>\n    <div class="strike-buttons">\n      <button id="popup-yes" class="strike-btn strike-btn-accept">\n        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style=""><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M416 128 192 384l-96-96"></path></svg>\n        Yes\n      </button>\n      <button id="popup-no" class="strike-btn strike-btn-reject">\n        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style="font-size: 14px;"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 368 144 144m224 0L144 368"></path></svg>\n        No\n      </button>\n    </div>\n    <div class="strike-live-tag"><span></span> Live Assistant</div>\n  </div>\n</div>\n\n<style>\n  .strike-incoming-call-popup {\n    position: fixed;\n    width: 150px;\n    height: 220px;\n    margin: 20px;\n    border-radius: 22px;\n    border: 4px solid #fff;\n    box-shadow: 0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n    z-index: 214748361000 !important;\n  }\n\n  .bottom-right {\n    bottom: 10px;\n    right: 10px;\n  }\n\n  .bottom-left {\n    bottom: 10px;\n    left: 10px;\n  }\n\n  .top-right {\n    top: 10px;\n    right: 10px;\n  }\n\n  .top-left {\n    top: 10px;\n    left: 10px;\n  }\n\n  .strike-video-container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    border-radius: 20px;\n    overflow: hidden;\n  }\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .strike-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: end;\n    padding: 10px;\n    border-radius: 20px;\n    box-sizing: border-box;\n    background: linear-gradient(to top, black 10% , transparent 50%);\n    \n  }\n\n  .strike-live-assistant-message {\n    display: none;\n    position: absolute;\n    width: 100%;\n    top: -64px;\n    right: 0;\n    padding: 5px;\n    text-align: left;\n    margin-bottom: 5px;\n    margin-left: 2px;\n    border-radius: 8px 8px 0 8px;\n    border: 4px solid white;\n    background: #e7eaef;\n    box-shadow: -3px 3px 3px -2px rgba(0, 0, 0, 0.2), 0px 3px 4px 0px rgba(0, 0, 0, 0.14), 0 1px 8px 0 rgba(0, 0, 0, 0.12);\n    z-index: 1;\n  }\n\n  .strike-live-assistant-message::before {\n    content: \'\';\n    position: absolute;\n    right: 0;\n    bottom: -7px;\n    border-left: 8px solid transparent;\n    border-top: 8px solid #e7eaef;\n    z-index: 1;\n  }\n\n  .strike-live-assistant-message::after {\n    content: \'\';\n    position: absolute;\n    right: -4px;\n    bottom: -15px;\n    border-left: 13px solid transparent;\n    border-top: 12px solid white;\n    filter: drop-shadow(0 6px 4px rgba(0, 0, 0, 0.3));\n  }\n\n  .strike-live-assistant-title {\n    font-size: 12px;\n    font-weight: bold;\n    margin: 0;\n    color: black;\n  }\n\n  .strike-live-assistant-prompt {\n    font-size: 10px;\n    margin: 0;\n    color: black;\n  }\n\n  .strike-live-tag {\n    display: flex;\n    place-items: center;\n    place-content: center;\n    gap: 4px;\n    font-size: 11px;\n    font-weight: 600;\n    color: white;\n    margin-top: 8px;\n  }\n\n  .strike-live-tag span {\n    width: 4px;\n    height: 4px;\n    border-radius: 50%;\n    background: #f44336;\n    border: 2px solid white;\n  }\n\n  .strike-message {\n    font-size: 14px;\n    font-weight: 600;\n    margin-bottom: 8px;\n    color: white;\n    text-align: center;\n  }\n\n  .strike-buttons {\n    display: flex;\n    gap: 10px;\n  }\n\n  .strike-btn {\n    flex: 50%;\n    display: flex;\n    place-items: center;\n    gap: 4px;\n    padding: 4px 8px;\n    border: none;\n    border-radius: 10px;\n    font-size: 12px;\n    cursor: pointer;\n  }\n\n  .strike-btn-accept {\n    background-color: #4CAF50;\n    color: white;\n  }\n\n  .strike-btn-reject {\n    background-color: #f44336;\n    color: white;\n  }\n</style>'},useData:!0})},4271:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div id="meeting-iframe-container" class="hidden">\n  <iframe id="meeting-iframe" style="width: 100%; height: 100%;" frameborder="0" allow="camera *; microphone *"></iframe>\n</div>\n\n<style>\n  @keyframes slideIn {\n    from {\n      transform: translateY(100%);\n    }\n    to {\n      transform: translateY(0);\n    }\n  }\n\n  @keyframes wave {\n    0% {\n      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.3), 0 0 0 0 rgba(255, 255, 255, 0.2), 0 0 0 0 rgba(255, 255, 255, 0.1);\n    }\n    50% {\n      box-shadow: 0 0 0 5px rgba(255, 255, 255, 0.3), 0 0 0 10px rgba(255, 255, 255, 0.2), 0 0 0 15px rgba(255, 255, 255, 0.1);\n    }\n    100% {\n      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.3), 0 0 0 0 rgba(255, 255, 255, 0.2), 0 0 0 0 rgba(255, 255, 255, 0.1);\n    }\n  }\n\n  @keyframes iconShake {\n    0% { transform: rotate(0deg); }\n    25% { transform: rotate(5deg); }\n    50% { transform: rotate(0deg); }\n    75% { transform: rotate(-5deg); }\n    100% { transform: rotate(0deg); }\n  }\n\n  .incoming-call-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: space-between;\n    text-align: center;\n    padding: 20px;\n    background: linear-gradient(to bottom, #2C3E50, #4CA1AF);\n    color: white;\n    width: 100%;\n    height: 100%;\n    box-sizing: border-box;\n    animation: slideIn 0.5s ease-out;\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n  }\n\n  .meeting-iframe-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: space-between;\n    text-align: center;\n    padding: 20px;\n    background: linear-gradient(to bottom, #2C3E50, #4CA1AF);\n    color: white;\n    width: 100%;\n    height: 100%;\n    box-sizing: border-box;\n    animation: slideIn 0.5s ease-out;\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n  }\n\n  .incoming-call-header {\n    margin-top: 20px;\n  }\n\n  .incoming-call-header h2 {\n    font-size: 24px;\n    margin-bottom: 10px;\n  }\n\n  .incoming-call-content {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    flex-grow: 1;\n  }\n\n  .person-icon {\n    margin-bottom: 10px;\n    animation: iconShake 0.5s infinite;\n  }\n\n  .call-description {\n    font-size: 18px;\n    margin-bottom: 10px;\n  }\n\n  .call-prompt {\n    font-size: 16px;\n    margin-bottom: 20px;\n  }\n\n  .incoming-call-buttons {\n    display: flex;\n    justify-content: space-around;\n    width: 100%;\n    margin-bottom: 20px;\n  }\n\n  .button-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .btn {\n    padding: 15px;\n    cursor: pointer;\n    border: none;\n    border-radius: 50%;\n    font-size: 24px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: transform 0.2s, box-shadow 0.2s;\n    width: 60px;\n    height: 60px;\n    background-color: white;\n    animation: wave 2s infinite;\n  }\n\n  .btn:hover {\n    transform: scale(1.1);\n    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n  }\n\n  .btn-accept svg {\n    animation: iconShake 0.2s infinite;\n  }\n\n  .btn-reject svg {\n    animation: iconShake 0.2s infinite;\n  }\n\n  .button-text {\n    margin-top: 10px;\n    font-size: 14px;\n  }\n\n   .hidden {\n    display: none;\n  }\n\n  #meeting-iframe-container {\n    width: 100%;\n    height: 100%;\n  }\n</style>'},useData:!0})},1562:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-thankyou-wrapper">\n  <div class="sa-live-call-widget-thankyou-container">\n    <div\n      class="sa-live-call-widget-bubble sa-live-call-widget-bubble-position-one"\n    ></div>\n    <div\n      class="sa-live-call-widget-bubble sa-live-call-widget-bubble-position-two"\n    ></div>\n    <p class="sa-live-call-widget-thank-you-message">'+l(typeof(o=null!=(o=d(n,"defaultMessage")||(null!=t?d(t,"defaultMessage"):t))?o:s)===c?o.call(a,{name:"defaultMessage",hash:{},data:i,loc:{start:{line:10,column:53},end:{line:10,column:71}}}):o)+"<br\n      /><span>"+l(typeof(o=null!=(o=d(n,"thankyouMessage")||(null!=t?d(t,"thankyouMessage"):t))?o:s)===c?o.call(a,{name:"thankyouMessage",hash:{},data:i,loc:{start:{line:11,column:14},end:{line:11,column:33}}}):o)+'</span></p>\n    <button\n      class="sa-live-call-widget-thankyou-startover-btn marginTop50 sa-live-call-widget-go-back-btn"\n    >\n      <span>\n        Go back\n      </span>\n    </button>\n  </div>\n</div>'},useData:!0})},8345:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-thankyou-wrapper">\n  <div\n    class="sa-live-call-widget-thankyou-container sa-live-call-widget-payment-request-page"\n  >\n    <div\n      class="sa-live-call-widget-bubble sa-live-call-widget-bubble-position-one"\n    ></div>\n    <div\n      class="sa-live-call-widget-bubble sa-live-call-widget-bubble-position-two"\n    ></div>\n    <h2 class="sa-live-call-widget-thank-you-title">Premium paid service</h2>\n    <p\n      class="sa-live-call-widget-thank-you-message sa-live-call-widget-payment-request-description"\n    >Please make a payment while we try to connect you.</p>\n    <button id="sa-live-call-widget-advance-payment-btn">Pay\n      '+l(typeof(o=null!=(o=d(n,"paymentCurrency")||(null!=t?d(t,"paymentCurrency"):t))?o:s)===c?o.call(a,{name:"paymentCurrency",hash:{},data:i,loc:{start:{line:16,column:6},end:{line:16,column:25}}}):o)+"\n      "+l(typeof(o=null!=(o=d(n,"paymentAmount")||(null!=t?d(t,"paymentAmount"):t))?o:s)===c?o.call(a,{name:"paymentAmount",hash:{},data:i,loc:{start:{line:17,column:6},end:{line:17,column:23}}}):o)+"</button>\n  </div>\n</div>"},useData:!0})},7549:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-thankyou-wrapper sa-live-call-widget-call-timeout-page">\n  <div class="sa-live-call-widget-thankyou-container">\n    <div class="sa-live-call-widget-video-overlay">\n      <video id="missed-call-video" autoplay muted loop>\n        <source src="'+l(typeof(o=null!=(o=d(n,"videoUrl")||(null!=t?d(t,"videoUrl"):t))?o:s)===c?o.call(a,{name:"videoUrl",hash:{},data:i,loc:{start:{line:5,column:21},end:{line:5,column:33}}}):o)+'" type="video/mp4">\n        Your browser does not support the video tag.\n      </video>\n    </div>\n    <div class="sa-live-call-widget-gradient-overlay"></div>\n    <div class="sa-live-call-widget-content">\n      <div class="sa-live-call-widget-header">\n        <span class="sa-live-call-widget-live-badge">LIVE</span>\n      </div>\n      <div class="sa-live-call-widget-text-wrapper">\n        <h2 class="sa-live-call-widget-thank-you-title">'+l(typeof(o=null!=(o=d(n,"title")||(null!=t?d(t,"title"):t))?o:s)===c?o.call(a,{name:"title",hash:{},data:i,loc:{start:{line:15,column:56},end:{line:15,column:65}}}):o)+'</h2>\n        <p class="sa-live-call-widget-thank-you-message">'+l(typeof(o=null!=(o=d(n,"subject")||(null!=t?d(t,"subject"):t))?o:s)===c?o.call(a,{name:"subject",hash:{},data:i,loc:{start:{line:16,column:57},end:{line:16,column:68}}}):o)+'</p>\n      </div>\n      <div class="sa-live-call-widget-expanded-cta-btn-wrapper">\n        <button id="schedule-meeting" class="btn btn-schedule">\n           Schedule Call\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<style>\n  .sa-live-call-widget-thankyou-wrapper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n  }\n\n  .sa-live-call-widget-video-overlay {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: -2;\n  }\n\n  .sa-live-call-widget-gradient-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.8) 90%, rgba(0, 0, 0, 1) 100%);\n    z-index: -1;\n  }\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n\n  .sa-live-call-widget-thankyou-container {\n    position: relative;\n    z-index: 1;\n    text-align: center;\n    color: white;\n    padding: 20px;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n  }\n\n  .sa-live-call-widget-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    width: 100%;\n    padding: 10px;\n    box-sizing: border-box;\n    position: absolute;\n    top: 0;\n    z-index: 2;\n  }\n\n  .sa-live-call-widget-live-badge {\n    background-color: red;\n    padding: 5px 10px;\n    border-radius: 5px;\n    font-size: 12px;\n    margin-left: 30px;\n  }\n\n  .sa-live-call-widget-content {\n    margin-top: auto;\n    padding-bottom: 20px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 2;\n  }\n\n  .sa-live-call-widget-text-wrapper {\n    text-align: center;\n    margin-bottom: 20px;\n    z-index: 3;\n  }\n\n  .sa-live-call-widget-thank-you-title {\n    font-size: 24px;\n    margin: 10px 0;\n    color: white;\n  }\n\n  .sa-live-call-widget-thank-you-message {\n    font-size: 18px;\n    margin: 10px 0 20px 0;\n    color: white;\n  }\n\n  .sa-live-call-widget-expanded-cta-btn-wrapper {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    align-items: center;\n    z-index: 3;\n  }\n\n  .btn {\n    padding: 10px 20px;\n    border: none;\n    border-radius: 30px;\n    font-size: 16px;\n    cursor: pointer;\n    width: 70%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 10px;\n  }\n\n  .btn-schedule {\n    background-color: #4CAF50;\n    color: white;\n  }\n</style>\n'},useData:!0})},4582:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-default-container">\n  <div class="sa-live-call-widget-schedule-meeting-container">\n    <div class="sa-live-call-widget-schedule-meeting-title">\n      '+l(typeof(o=null!=(o=d(n,"title")||(null!=t?d(t,"title"):t))?o:s)===c?o.call(a,{name:"title",hash:{},data:i,loc:{start:{line:4,column:6},end:{line:4,column:15}}}):o)+'\n    </div>\n    <div class="sa-live-call-widget-schedule-meeting-caption">\n      '+l(typeof(o=null!=(o=d(n,"caption")||(null!=t?d(t,"caption"):t))?o:s)===c?o.call(a,{name:"caption",hash:{},data:i,loc:{start:{line:7,column:6},end:{line:7,column:17}}}):o)+"\n      <br />\n      <span>Timezone: "+l(typeof(o=null!=(o=d(n,"timeZone")||(null!=t?d(t,"timeZone"):t))?o:s)===c?o.call(a,{name:"timeZone",hash:{},data:i,loc:{start:{line:9,column:22},end:{line:9,column:34}}}):o)+'</span>\n    </div>\n    <div class="sa-live-call-widget-schedule-meeting-date-container"></div>\n    <div class="sa-live-call-widget-schedule-meeting-divider"></div>\n    <div class="sa-live-call-widget-schedule-meeting-time-container"></div>\n    <div class="sa-live-call-widget-schedule-meeting-divider"></div>\n    <div class="sa-live-call-widget-schedule-meeting-invite-friends-container">\n      <div\n        class="sa-live-call-widget-schedule-meeting-invite-friends-text"\n      >Invite Friends & Family</div>\n      <img\n        src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/invite-friends-family.jpeg"\n        alt="invite freinds & family"\n      />\n      <textarea\n        class="sa-live-call-widget-schedule-meeting-invite-friends-textarea"\n        placeholder="Enter emails, numbers by comma separated."\n      ></textarea>\n    </div>\n    <p class="sa-live-call-widget-schedule-meeting-error-text"></p>\n    <button class="sa-live-call-widget-schedule-meeting-confirm-btn">Confirm\n      Slot</button>\n  </div>\n</div>'},useData:!0})},8141:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-default-container">\n  <div class="sa-live-call-widget-text-message-page-container">\n    <textarea\n      placeholder="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"placeholder")||(null!=t?a(t,"placeholder"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"placeholder",hash:{},data:i,loc:{start:{line:4,column:19},end:{line:4,column:34}}}):o)+'"\n      class="sa-live-call-widget-audio-message-textarea"\n    ></textarea>\n    <button class="sa-live-call-widget-audio-message-submit-btn">Submit</button>\n  </div>\n</div>'},useData:!0})},8922:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){return" "},3:function(e,t,n,r,i){return" height: 100%; margin-bottom: 100px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; display: flex; flex-direction: column; justify-content: center; gap: 10px; "},5:function(e,t,n,r,i){return"<span>Your meeting has been scheduled successfully.</span>"},7:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\n          <span>"+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"thankyouMessage")||(null!=t?a(t,"thankyouMessage"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"thankyouMessage",hash:{},data:i,loc:{start:{line:54,column:16},end:{line:54,column:35}}}):o)+"</span>\n"},9:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,l="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="sa-live-call-widget-scheduled-time-details-container">\n        <div class="sa-live-call-widget-note-message-box">\n           <p class="sa-live-call-widget-note-message">Important Note:<br\n          /><span>You\'ll receive the meeting join link via WhatsApp and email shortly.</span></p>\n      </div>\n'+(null!=(o=u(n,"if").call(s,null!=t?u(t,"addOrraPixel"):t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i,loc:{start:{line:65,column:6},end:{line:73,column:13}}}))?o:"")+'      <div class="sa-live-call-widget-scheduled-on-container">\n        <p class="sa-live-call-widget-scheduled-time-title">Product Demo Call</p>\n        <div class="sa-live-call-widget-scheduled-meeting-details">\n          <svg \n          id="Layer_1" \n          enable-background="new 0 0 512 512" \n          height="16" \n          viewBox="0 0 512 512" \n          width="16" \n          xmlns="http://www.w3.org/2000/svg"><g><path d="m446 40h-46v-24c0-8.836-7.163-16-16-16s-16 7.164-16 16v24h-224v-24c0-8.836-7.163-16-16-16s-16 7.164-16 16v24h-46c-36.393 0-66 29.607-66 66v340c0 36.393 29.607 66 66 66h380c36.393 0 66-29.607 66-66v-340c0-36.393-29.607-66-66-66zm-380 32h46v16c0 8.836 7.163 16 16 16s16-7.164 16-16v-16h224v16c0 8.836 7.163 16 16 16s16-7.164 16-16v-16h46c18.748 0 34 15.252 34 34v38h-448v-38c0-18.748 15.252-34 34-34zm380 408h-380c-18.748 0-34-15.252-34-34v-270h448v270c0 18.748-15.252 34-34 34z"/></g>\n          </svg><span>'+d(typeof(a=null!=(a=u(n,"scheduledDate")||(null!=t?u(t,"scheduledDate"):t))?a:c)===l?a.call(s,{name:"scheduledDate",hash:{},data:i,loc:{start:{line:84,column:22},end:{line:84,column:39}}}):a)+" </br>"+d(typeof(a=null!=(a=u(n,"timeZoneText")||(null!=t?u(t,"timeZoneText"):t))?a:c)===l?a.call(s,{name:"timeZoneText",hash:{},data:i,loc:{start:{line:84,column:45},end:{line:84,column:61}}}):a)+'</span>\n        </div>\n         <div class="sa-live-call-widget-scheduled-meeting-details">\n          <svg \n          enable-background="new 0 0 359.286 359.286" \n          height="16" \n          viewBox="0 0 359.286 359.286" \n          width="16" \n          xmlns="http://www.w3.org/2000/svg"><g><g><path d="m179.643 359.286c99.043 0 179.643-80.6 179.643-179.643s-80.599-179.643-179.643-179.643-179.643 80.6-179.643 179.643 80.6 179.643 179.643 179.643zm0-335.334c85.869 0 155.691 69.821 155.691 155.691s-69.821 155.691-155.691 155.691-155.691-69.821-155.691-155.691 69.822-155.691 155.691-155.691z"/><path d="m232.039 236.89c2.216 1.796 4.85 2.635 7.485 2.635 3.533 0 7.006-1.557 9.341-4.491 4.132-5.15 3.293-12.695-1.856-16.827l-55.39-44.312v-90.061c0-6.587-5.389-11.976-11.976-11.976s-11.976 5.389-11.976 11.976v95.81c0 3.653 1.677 7.066 4.491 9.341z"/></g></g>\n          </svg><span>'+d(typeof(a=null!=(a=u(n,"scheduledTime")||(null!=t?u(t,"scheduledTime"):t))?a:c)===l?a.call(s,{name:"scheduledTime",hash:{},data:i,loc:{start:{line:93,column:22},end:{line:93,column:39}}}):a)+'</span>\n        </div>\n      </div> \n    </div>\n    <div class="sa-live-call-widget-thankyou-page-buttons"> \n      <button\n      id="sa-live-call-widget-add-to-calendar"\n      class="sa-live-call-widget-thankyou-startover-btn schedule-meeting-startover-btn marginTop50 "\n      >\n          <svg \n            xmlns="http://www.w3.org/2000/svg" \n            shape-rendering="geometricPrecision" \n            text-rendering="geometricPrecision" \n            image-rendering="optimizeQuality" \n            stroke="var(--invertColor)"\n            fill="var(--invertColor)"\n            height="16"\n            width="16"\n            fill-rule="evenodd" clip-rule="evenodd" \n            viewBox="0 0 512 506.49">\n          <path fill-rule="nonzero" d="M294.24 17.11C294.24 7.69 303.53 0 315.1 0s20.87 7.65 20.87 17.11v74.85c0 9.42-9.3 17.11-20.87 17.11s-20.86-7.65-20.86-17.11V17.11zm145.02 345.22v19.94c0 4.69-3.91 8.61-8.6 8.61h-34.24v34.26c0 4.67-3.92 8.59-8.61 8.59h-19.96c-4.67 0-8.59-3.86-8.59-8.59v-34.26h-34.27c-4.69 0-8.61-3.87-8.61-8.61v-19.94c0-4.74 3.88-8.61 8.61-8.61h34.27v-34.26c0-4.73 3.86-8.59 8.59-8.59h19.96c4.74 0 8.61 3.92 8.61 8.59v34.26h34.24c4.74 0 8.6 3.97 8.6 8.61zm-61.44-124.22c36.98 0 70.56 15.04 94.83 39.35C496.96 301.7 512 335.25 512 372.31c0 36.99-15.04 70.56-39.3 94.83-24.32 24.31-57.89 39.35-94.88 39.35-37.03 0-70.56-15.04-94.84-39.3-24.32-24.27-39.34-57.86-39.34-94.88 0-37.06 15.04-70.61 39.31-94.89l.69-.63c24.24-23.9 57.53-38.68 94.18-38.68zm78.74 55.41c-20.09-20.11-47.96-32.58-78.74-32.58-30.5 0-58.14 12.25-78.19 32.02l-.55.6c-20.15 20.14-32.62 48-32.62 78.75s12.46 58.6 32.61 78.75c20.1 20.13 47.98 32.6 78.75 32.6 30.76 0 58.65-12.47 78.77-32.58 20.11-20.12 32.58-48.01 32.58-78.77 0-30.75-12.47-58.61-32.61-78.79zM56.81 242.28c-1.18 0-2.24-5.2-2.24-11.57 0-6.38.94-11.53 2.24-11.53h56.94c1.19 0 2.25 5.2 2.25 11.53 0 6.39-.94 11.57-2.25 11.57H56.81zm90.78 0c-1.19 0-2.24-5.2-2.24-11.57 0-6.38.93-11.53 2.24-11.53h56.94c1.18 0 2.24 5.2 2.24 11.53 0 6.39-.94 11.57-2.24 11.57h-56.94zm90.77 0c-1.18 0-2.24-5.2-2.24-11.57 0-6.38.93-11.53 2.24-11.53h56.94c1.18 0 2.24 5.15 2.24 11.49a175.09 175.09 0 0 0-16.44 11.61h-42.74zM56.94 308.52c-1.18 0-2.24-5.2-2.24-11.57 0-6.39.93-11.58 2.24-11.58h56.94c1.18 0 2.24 5.19 2.24 11.58 0 6.37-.93 11.57-2.24 11.57H56.94zm90.77 0c-1.18 0-2.24-5.2-2.24-11.57 0-6.39.93-11.58 2.24-11.58h56.94c1.18 0 2.24 5.19 2.24 11.58 0 6.37-.93 11.57-2.24 11.57h-56.94zM57.06 374.8c-1.18 0-2.24-5.2-2.24-11.59 0-6.36.94-11.56 2.24-11.56H114c1.19 0 2.25 5.2 2.25 11.56 0 6.39-.94 11.59-2.25 11.59H57.06zm90.78 0c-1.19 0-2.25-5.2-2.25-11.59 0-6.36.94-11.56 2.25-11.56h56.94c1.18 0 2.24 5.2 2.24 11.56 0 6.39-.94 11.59-2.24 11.59h-56.94zM106.83 17.11c0-9.42 9.29-17.11 20.86-17.11s20.86 7.65 20.86 17.11v74.85c0 9.42-9.32 17.11-20.86 17.11-11.57 0-20.86-7.65-20.86-17.11V17.11zM22.98 163.64h397.39V77.46c0-5.79-4.73-10.51-10.52-10.51h-38.1c-6.39 0-11.57-5.2-11.57-11.57 0-6.38 5.18-11.58 11.57-11.58h38.1c18.59 0 33.7 15.12 33.7 33.71v136.81c-7.59-2.62-15.41-4.73-23.44-6.29v-21.38h.26H22.98v223.16c0 5.78 4.72 10.51 10.51 10.51h188.86c2.15 8.02 4.86 15.84 8.12 23.36H33.71C15.13 443.68 0 428.61 0 410.02V77.55c0-18.6 15.1-33.71 33.71-33.71h40.67c6.38 0 11.58 5.21 11.58 11.57 0 6.39-5.2 11.59-11.58 11.59H33.71c-5.79 0-10.53 4.7-10.53 10.51v86.16h-.2v-.03zm158.94-96.69c-6.37 0-11.57-5.2-11.57-11.57 0-6.38 5.2-11.58 11.57-11.58h77.55c6.39 0 11.59 5.2 11.59 11.58 0 6.37-5.2 11.57-11.59 11.57h-77.55z"/>\n          </svg>\n        <span>\n          Add to Calendar\n        </span>\n      </button>\n      <button\n        id="sa-live-call-widget-share-meeting-btn"\n        class="sa-live-call-widget-thankyou-startover-btn schedule-meeting-startover-btn invite-friends-btn"\n      >\n        <svg\n          stroke="var(--themeColor)"\n          fill="var(--themeColor)"\n          stroke-width="0"\n          viewBox="0 0 448 512"\n          height="16"\n          width="16"\n          xmlns="http://www.w3.org/2000/svg"\n        ><path\n            d="M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"\n          ></path></svg>\n        <span>\n          Invite Friends\n        </span>\n      </button> \n    </div>\n    </div>\n'},10:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        \x3c!--Offer Conversion: Orra Jewellery --\x3e\n        <iframe\n          src="https://bigtrunk.g2afse.com/success.php?afstatus=1&afgoal=Book_Appointment&custom_field1='+l(typeof(o=null!=(o=d(n,"mobileNumber")||(null!=t?d(t,"mobileNumber"):t))?o:s)===c?o.call(a,{name:"mobileNumber",hash:{},data:i,loc:{start:{line:68,column:104},end:{line:68,column:120}}}):o)+"&custom_field2="+l(typeof(o=null!=(o=d(n,"affiliateId")||(null!=t?d(t,"affiliateId"):t))?o:s)===c?o.call(a,{name:"affiliateId",hash:{},data:i,loc:{start:{line:68,column:135},end:{line:68,column:150}}}):o)+"&custom_field3="+l(typeof(o=null!=(o=d(n,"peopleId")||(null!=t?d(t,"peopleId"):t))?o:s)===c?o.call(a,{name:"peopleId",hash:{},data:i,loc:{start:{line:68,column:165},end:{line:68,column:177}}}):o)+'"\n          height="1"\n          width="1"\n        />\n        \x3c!-- End Offer Conversion --\x3e\n'},12:function(e,t,n,r,i){return'      <button\n        class="sa-live-call-widget-thankyou-startover-btn marginTop50 sa-live-call-widget-go-back-btn"\n      >\n      <svg \n      version="1.1" \n      id="Capa_1" \n      xmlns="http://www.w3.org/2000/svg" \n      viewBox="0 0 447.243 447.243" \n      stroke="var(--themeColor)"\n      fill="var(--themeColor)"\n      stroke-width="0"\n      viewBox="0 0 448 512"\n      height="16"\n      width="16"  >\n      <g>\n        <g>\n          <path d="M420.361,192.229c-1.83-0.297-3.682-0.434-5.535-0.41H99.305l6.88-3.2c6.725-3.183,12.843-7.515,18.08-12.8l88.48-88.48\n            c11.653-11.124,13.611-29.019,4.64-42.4c-10.441-14.259-30.464-17.355-44.724-6.914c-1.152,0.844-2.247,1.764-3.276,2.754\n            l-160,160C-3.119,213.269-3.13,233.53,9.36,246.034c0.008,0.008,0.017,0.017,0.025,0.025l160,160\n            c12.514,12.479,32.775,12.451,45.255-0.063c0.982-0.985,1.899-2.033,2.745-3.137c8.971-13.381,7.013-31.276-4.64-42.4\n            l-88.32-88.64c-4.695-4.7-10.093-8.641-16-11.68l-9.6-4.32h314.24c16.347,0.607,30.689-10.812,33.76-26.88\n            C449.654,211.494,437.806,195.059,420.361,192.229z"/>\n        </g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      <g>\n      </g>\n      </svg>\n        <span>\n          Go back\n        </span>\n      </button>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-thankyou-wrapper">\n  <div class="sa-live-call-widget-thankyou-container">\n    <div class="sa-live-call-widget-thank-you-main-container">\n      <div class="sa-live-call-widget-thank-you-message-container"\n       style="'+(null!=(o=s(n,"if").call(a,null!=t?s(t,"scheduleMeeting"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i,loc:{start:{line:5,column:14},end:{line:5,column:232}}}))?o:"")+'" >\n        <div class="sa-live-call-widget-thank-you-single-tick">\n          <svg version="1.1" id="Layer_1" \n            xmlns="http://www.w3.org/2000/svg" \n            x="0px" y="0px"\n            viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">\n          <g>\n            <g>\n              <path d="M504.502,75.496c-9.997-9.998-26.205-9.998-36.204,0L161.594,382.203L43.702,264.311c-9.997-9.998-26.205-9.997-36.204,0\n                c-9.998,9.997-9.998,26.205,0,36.203l135.994,135.992c9.994,9.997,26.214,9.99,36.204,0L504.502,111.7\n                C514.5,101.703,514.499,85.494,504.502,75.496z"/>\n            </g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          <g>\n          </g>\n          </svg>\n        </div>\n        <h2 class="sa-live-call-widget-thank-you-title">Thank You</h2>\n        <p class="sa-live-call-widget-thank-you-message">\n          '+(null!=(o=s(n,"if").call(a,null!=t?s(t,"scheduleMeeting"):t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.program(7,i,0),data:i,loc:{start:{line:53,column:10},end:{line:55,column:17}}}))?o:"")+"          </p>\n      </div>\n"+(null!=(o=s(n,"if").call(a,null!=t?s(t,"scheduleMeeting"):t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.program(12,i,0),data:i,loc:{start:{line:58,column:4},end:{line:200,column:11}}}))?o:"")+"  </div>\n</div>"},useData:!0})},1223:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div id="saleassist-video-call-app"></div>'},useData:!0})},289:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-default-container">\n  <div class="sa-live-call-widget-video-message-page">\n    <div class="sa-live-call-widget-video-message-preview-wrapper"> \n      <div class="sa-live-call-widget-video-recording-indicator"></div>\n      \n      <video class="sa-live-call-widget-video-message-preview"></video>\n      \n      <div class="sa-live-call-widget-video-message-toggle-recording-btn-wrapper">\n        <button class="sa-live-call-widget-video-message-toggle-recording-btn sa-live-call-widget-video-message-toggle-screen-recording-btn">\n          <svg stroke="currentColor" fill="#fff" stroke-width="0" viewBox="0 0 24 24" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M20 18c1.1 0 1.99-.9 1.99-2L22 6a2 2 0 0 0-2-2H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2H0v2h24v-2h-4zM4 16V6h16v10.01L4 16zm9-6.87c-3.89.54-5.44 3.2-6 5.87 1.39-1.87 3.22-2.72 6-2.72v2.19l4-3.74L13 7v2.13z"></path></svg>\n        </button>\n        <div class="sa-live-call-widget-video-message-start-stop-recording-btn">\n          <div class="sa-live-call-widget-video-message-start-stop-recording-btn-inner-wrapper">REC</div>\n        </div>\n        <button class="sa-live-call-widget-video-message-toggle-recording-btn sa-live-call-widget-video-message-switch-camera-btn">\n          <svg fill="none" viewBox="0 0 20 20" height="24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M14.8536 2.14645C14.6583 1.95118 14.3417 1.95118 14.1464 2.14645C13.9512 2.34171 13.9512 2.65829 14.1464 2.85355L15.2929 4H4C2.89543 4 2 4.89543 2 6V12.5C2 12.7761 2.22386 13 2.5 13C2.77614 13 3 12.7761 3 12.5V6C3 5.44772 3.44772 5 4 5H15.2929L14.1464 6.14645C13.9512 6.34171 13.9512 6.65829 14.1464 6.85355C14.3417 7.04882 14.6583 7.04882 14.8536 6.85355L16.8536 4.85355C17.0488 4.65829 17.0488 4.34171 16.8536 4.14645L14.8536 2.14645ZM16 15C16.5523 15 17 14.5523 17 14V7.5C17 7.22386 17.2239 7 17.5 7C17.7761 7 18 7.22386 18 7.5V14C18 15.1046 17.1046 16 16 16H4.70711L5.85355 17.1464C6.04882 17.3417 6.04882 17.6583 5.85355 17.8536C5.65829 18.0488 5.34171 18.0488 5.14645 17.8536L3.14645 15.8536C2.95118 15.6583 2.95118 15.3417 3.14645 15.1464L5.14645 13.1464C5.34171 12.9512 5.65829 12.9512 5.85355 13.1464C6.04882 13.3417 6.04882 13.6583 5.85355 13.8536L4.70711 15H16ZM13 10C13 11.6569 11.6569 13 10 13C8.34315 13 7 11.6569 7 10C7 8.34315 8.34315 7 10 7C11.6569 7 13 8.34315 13 10ZM12 10C12 8.89543 11.1046 8 10 8C8.89543 8 8 8.89543 8 10C8 11.1046 8.89543 12 10 12C11.1046 12 12 11.1046 12 10Z" fill="#fff"/></svg>\n        </button>\n      </div>\n      \n      <video controls muted autoplay loop playsinline src="" class="sa-live-call-widget-recorded-video-message"></video>\n    </div>\n\n    <div class="sa-live-call-widget-video-message-upload-wrapper">\n      <input\n        type="file"\n        id="sa-live-call-widget-video-message-upload-input"\n        accept="video/*"\n        style="display: none;"\n      />\n      \n      <button id="sa-live-call-widget-video-message-upload-btn">\n        <svg stroke="currentColor" fill="#fff" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"></path></svg>\n        Upload Video\n      </button>\n    </div>\n    \n    <div class="sa-live-call-widget-video-message-post-recording-btn"></div>\n  </div>\n</div>'},useData:!0})},6269:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    \x3c!--Offer Conversion: Orra Jewellery --\x3e\n    <iframe\n      src="https://bigtrunk.g2afse.com/success.php?afstatus=1&afgoal=video_call_completed&custom_field1='+l(typeof(o=null!=(o=d(n,"mobileNumber")||(null!=t?d(t,"mobileNumber"):t))?o:s)===c?o.call(a,{name:"mobileNumber",hash:{},data:i,loc:{start:{line:6,column:104},end:{line:6,column:120}}}):o)+"&custom_field2="+l(typeof(o=null!=(o=d(n,"affiliateId")||(null!=t?d(t,"affiliateId"):t))?o:s)===c?o.call(a,{name:"affiliateId",hash:{},data:i,loc:{start:{line:6,column:135},end:{line:6,column:150}}}):o)+"&custom_field3="+l(typeof(o=null!=(o=d(n,"peopleId")||(null!=t?d(t,"peopleId"):t))?o:s)===c?o.call(a,{name:"peopleId",hash:{},data:i,loc:{start:{line:6,column:165},end:{line:6,column:177}}}):o)+'"\n      height="1"\n      width="1"\n    />\n    \x3c!-- End Offer Conversion --\x3e\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div>\n"+(null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"addOrraPixel"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:3,column:2},end:{line:11,column:9}}}))?o:"")+'  <p class="sa-live-call-widget-feedback-form-star-rating-title">How was your\n    experience with us?</p>\n  <div class="sa-live-call-widget-feedback-form-star-rating">\n    <div class="sa-live-call-widget-feedback-form-stars-wrapper">\n      <svg\n        class="sa-live-call-widget-feedback-form-star"\n        xmlns="http://www.w3.org/2000/svg"\n        width="24"\n        height="24"\n        viewBox="0 0 24 24"\n        data-star="1"\n      >\n        <polygon\n          points="12 2 14.61 7.68 20.49 8.78 16.42 12.72 17.54 18.61 12 16.34 6.46 18.61 7.58 12.72 3.51 8.78 9.39 7.68 12 2"\n          fill="transparent"\n        />\n      </svg>\n      <svg\n        class="sa-live-call-widget-feedback-form-star"\n        xmlns="http://www.w3.org/2000/svg"\n        width="24"\n        height="24"\n        viewBox="0 0 24 24"\n        data-star="2"\n      >\n        <polygon\n          points="12 2 14.61 7.68 20.49 8.78 16.42 12.72 17.54 18.61 12 16.34 6.46 18.61 7.58 12.72 3.51 8.78 9.39 7.68 12 2"\n          fill="transparent"\n        />\n      </svg><svg\n        class="sa-live-call-widget-feedback-form-star"\n        xmlns="http://www.w3.org/2000/svg"\n        width="24"\n        height="24"\n        viewBox="0 0 24 24"\n        data-star="3"\n      >\n        <polygon\n          points="12 2 14.61 7.68 20.49 8.78 16.42 12.72 17.54 18.61 12 16.34 6.46 18.61 7.58 12.72 3.51 8.78 9.39 7.68 12 2"\n          fill="transparent"\n        />\n      </svg><svg\n        class="sa-live-call-widget-feedback-form-star"\n        xmlns="http://www.w3.org/2000/svg"\n        width="24"\n        height="24"\n        viewBox="0 0 24 24"\n        data-star="4"\n      >\n        <polygon\n          points="12 2 14.61 7.68 20.49 8.78 16.42 12.72 17.54 18.61 12 16.34 6.46 18.61 7.58 12.72 3.51 8.78 9.39 7.68 12 2"\n          fill="transparent"\n        />\n      </svg><svg\n        class="sa-live-call-widget-feedback-form-star"\n        xmlns="http://www.w3.org/2000/svg"\n        width="24"\n        height="24"\n        viewBox="0 0 24 24"\n        data-star="5"\n      >\n        <polygon\n          points="12 2 14.61 7.68 20.49 8.78 16.42 12.72 17.54 18.61 12 16.34 6.46 18.61 7.58 12.72 3.51 8.78 9.39 7.68 12 2"\n          fill="transparent"\n        />\n      </svg>\n    </div>\n    <div class="sa-live-call-widget-feedback-form-star-description">\n      <p>Very poor</p>\n      <p>Very good</p>\n    </div>\n    <textarea\n    name="sa-live-call-widget-feedback-form-comment"\n    id="sa-live-call-widget-feedback-form-comment"\n    placeholder="Enter your feedback (optional)"\n    rows="4"\n    ></textarea>\n  </div>\n</div>'},useData:!0})},53:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-feedback-form-container">\n  <form id="sa-live-call-widget-feedback-form">\n    <div class="sa-live-call-widget-feedback-form-fields-container">\n      <div class="sa-live-call-widget-feedback-form-icon">\n        <svg\n          stroke="currentColor"\n          fill="currentColor"\n          stroke-width="0"\n          viewBox="0 0 24 24"\n          height="1em"\n          width="1em"\n          xmlns="http://www.w3.org/2000/svg"\n        ><path\n            d="M20 2H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h3v3.767L13.277 18H20c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zm0 14h-7.277L9 18.233V16H4V4h16v12z"\n          >\n          </path>\n          <path\n            d="m13.803 9.189-1.399-1.398-3.869 3.864v1.399h1.399zm.327-3.123 1.398 1.399-1.066 1.066-1.399-1.398z"\n          >\n          </path>\n        </svg>\n      </div>\n    </div>\n    <div class="sa-live-call-widget-feedback-form-submit-btn-wrapper">\n      <button\n        type="submit"\n        class="sa-live-call-widget-feedback-form-submit-btn"\n      >Submit</button>\n    </div>\n  </form>\n</div>'},useData:!0})},9004:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-lead-capture-form-container">\n  <form id="sa-live-call-widget-lead-capture-form">\n    <div class="sa-live-call-widget-lead-capture-form-fields-container">\n      <div class="sa-live-call-widget-lead-capture-form-fields-main-container">\n      </div>\n    </div>\n    <p class="sa-live-call-widget-required-field-error">Required fields can\'t be\n      empty.\n    </p>\n    <div class="sa-live-call-widget-lead-capture-form-submit-btn-wrapper">\n      <button type="submit" class="sa-live-call-widget-lead-capture-form-submit-btn">Submit</button>\n    </div>\n    <div class="sa-live-call-widget-terms-n-conditions"></div>\n  </form>\n</div>'},useData:!0})},715:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-lead-capture-form-container">\n  <img\n    id="sa-live-call-widget-hls-video"\n    src="https://client-static.saleassist.ai/8ead8374-f88b-4e7a-a2e2-7a8ae5b1f40f/'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"conversationName")||(null!=t?a(t,"conversationName"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"conversationName",hash:{},data:i,loc:{start:{line:4,column:82},end:{line:4,column:102}}}):o)+'.png"\n    alt=""\n  />\n  <div class="sa-live-call-widget-lead-capture-form-wrapper">\n    <form id="sa-live-call-widget-lead-capture-form">\n        <div class="sa-live-call-widget-lead-capture-form-fields-main-container"></div>\n        <p class="sa-live-call-widget-required-field-error">Required fields can\'t be\n        empty.\n        </p>\n        <div class="sa-live-call-widget-lead-capture-form-submit-btn-wrapper">\n        <button\n            type="submit"\n            class="sa-live-call-widget-lead-capture-form-submit-btn"\n        >Submit</button>\n        </div>\n        <div class="sa-live-call-widget-terms-n-conditions"></div>\n    </form>\n  </div>\n</div>'},useData:!0})},9923:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="sa-live-call-widget-live-video">\n    <iframe\n      width="100%"\n      height="100%"\n      src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"streamingUrl")||(null!=t?a(t,"streamingUrl"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"streamingUrl",hash:{},data:i,loc:{start:{line:6,column:11},end:{line:6,column:27}}}):o)+'"\n      frameborder="0"\n      allowfullscreen\n    >\n    </iframe>\n  </div>\n'},3:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isWelcomeImage"):t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.program(6,i,0),data:i,loc:{start:{line:13,column:2},end:{line:29,column:9}}}))?o:""},4:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <img\n      id="sa-live-call-widget-hls-video"\n      src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"sourceWelcomeVideo")||(null!=t?a(t,"sourceWelcomeVideo"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"sourceWelcomeVideo",hash:{},data:i,loc:{start:{line:16,column:11},end:{line:16,column:33}}}):o)+'"\n      alt=""\n    />\n'},6:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <video\n      id="sa-live-call-widget-hls-video"\n      class="sa-live-call-widget-video-fade"\n      src="'+l(typeof(o=null!=(o=d(n,"sourceWelcomeVideo")||(null!=t?d(t,"sourceWelcomeVideo"):t))?o:s)===c?o.call(a,{name:"sourceWelcomeVideo",hash:{},data:i,loc:{start:{line:24,column:11},end:{line:24,column:33}}}):o)+'"\n      loop\n      playsinline\n      '+l(typeof(o=null!=(o=d(n,"isMuted")||(null!=t?d(t,"isMuted"):t))?o:s)===c?o.call(a,{name:"isMuted",hash:{},data:i,loc:{start:{line:27,column:6},end:{line:27,column:17}}}):o)+"\n    ></video>\n"},8:function(e,t,n,r,i){return""},10:function(e,t,n,r,i){return'\n  <button class="sa-live-call-widget-mute-unmute-video-btn">\n    <svg\n      stroke="currentColor"\n      fill="none"\n      stroke-width="2"\n      viewBox="0 0 24 24"\n      aria-hidden="true"\n      height="22"\n      width="22"\n      xmlns="http://www.w3.org/2000/svg"\n      class="sa-live-call-widget-mute-icon"\n    ><path\n        stroke-linecap="round"\n        stroke-linejoin="round"\n        d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"\n      ></path></svg>\n    <svg\n      stroke="currentColor"\n      fill="none"\n      stroke-width="2"\n      viewBox="0 0 24 24"\n      aria-hidden="true"\n      height="22"\n      width="22"\n      xmlns="http://www.w3.org/2000/svg"\n      class="sa-live-call-widget-unmute-icon"\n    ><path\n        stroke-linecap="round"\n        stroke-linejoin="round"\n        d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"\n        clip-rule="evenodd"\n      ></path><path\n        stroke-linecap="round"\n        stroke-linejoin="round"\n        d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"\n      ></path></svg>\n  </button>\n  <button\n    class="sa-live-call-widget-play-video-btn sa-live-call-widget-d-hidden"\n  >\n    <svg\n      width="20"\n      height="20"\n      viewBox="0 0 20 23"\n      fill="none"\n      xmlns="http://www.w3.org/2000/svg"\n      class="sa-live-call-widget-play-icon"\n    ><path\n        d="M18.7691 11.0709L1.62084 0.290562C1.52697 0.231639 1.41606 0.19634 1.30041 0.188579C1.18475 0.180818 1.06887 0.200898 0.965613 0.246592C0.862352 0.292286 0.775744 0.361811 0.715386 0.447459C0.655028 0.533106 0.62328 0.631531 0.623661 0.731824L0.623661 22.2925C0.623847 22.3926 0.655943 22.4908 0.716421 22.5761C0.776899 22.6614 0.863417 22.7307 0.966471 22.7763C1.06952 22.8219 1.18512 22.8421 1.30057 22.8346C1.41601 22.8271 1.52682 22.7922 1.62084 22.7338L18.7691 11.9467C18.8501 11.8971 18.9162 11.8315 18.9618 11.7553C19.0074 11.6791 19.0312 11.5946 19.0312 11.5088C19.0312 11.423 19.0074 11.3385 18.9618 11.2623C18.9162 11.1861 18.8501 11.1205 18.7691 11.0709Z"\n        fill="black"\n        fill-opacity="0.8"\n      ></path></svg>\n  </button>\n  <button\n    class="sa-live-call-widget-pause-video-btn sa-live-call-widget-d-hidden"\n  >\n    <svg\n      width="16"\n      height="16"\n      viewBox="0 0 20 20"\n      fill="none"\n      xmlns="http://www.w3.org/2000/svg"\n      class="sa-live-call-widget-pause-icon"\n    ><path d="M0 0H7.5V20H0V0ZM12.5 0H20V20H12.5V0Z" fill="black"></path></svg>\n  </button>\n'},12:function(e,t,n,r,i){return'  <p class="sa-live-call-widget-intent-title"></p>\n'},14:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div\n      class="sa-live-call-widget-intent-container '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"verticalContainerClass")||(null!=t?a(t,"verticalContainerClass"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"verticalContainerClass",hash:{},data:i,loc:{start:{line:104,column:50},end:{line:104,column:76}}}):o)+'"\n    >\n      <div\n        class="sa-live-call-widget-intent-box sa-live-call-widget-intent-box-home"\n      >\n        <span class="sa-live-call-widget-intent-number">\n          <svg\n            stroke="currentColor"\n            fill="currentColor"\n            stroke-width="0"\n            viewBox="0 0 512 512"\n            height="1em"\n            width="1em"\n            xmlns="http://www.w3.org/2000/svg"\n          ><path\n              fill="none"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              stroke-width="48"\n              d="M244 400 100 256l144-144M120 256h292"\n            ></path>\n          </svg>\n        </span>\n        Back\n      </div>\n      <div\n        class="sa-live-call-widget-intent-box sa-live-call-widget-intent-box-back"\n      >\n        <span class="sa-live-call-widget-intent-number">\n          <svg\n            stroke="currentColor"\n            fill="currentColor"\n            stroke-width="0"\n            viewBox="0 0 512 512"\n            height="1em"\n            width="1em"\n            xmlns="http://www.w3.org/2000/svg"\n          ><path\n              fill="none"\n              stroke-linecap="round"\n              stroke-linejoin="round"\n              stroke-width="48"\n              d="M244 400 100 256l144-144M120 256h292"\n            ></path></svg>\n        </span>\n        Back\n      </div>\n    </div>\n'},16:function(e,t,n,r,i){return'    <div>\n      <button\n        id="sa-live-call-widget-watch-live-stream-btn"\n        class="sa-live-call-widget-watch-live-stream-btn"\n      >\n        <svg\n          stroke="currentColor"\n          fill="currentColor"\n          stroke-width="0"\n          viewBox="0 0 24 24"\n          height="20"\n          width="20"\n          xmlns="http://www.w3.org/2000/svg"\n        >\n          <path\n            d="M16 4C16.5523 4 17 4.44772 17 5V9.2L22.2133 5.55071C22.4395 5.39235 22.7513 5.44737 22.9096 5.6736C22.9684 5.75764 23 5.85774 23 5.96033V18.0397C23 18.3158 22.7761 18.5397 22.5 18.5397C22.3974 18.5397 22.2973 18.5081 22.2133 18.4493L17 14.8V19C17 19.5523 16.5523 20 16 20H2C1.44772 20 1 19.5523 1 19V5C1 4.44772 1.44772 4 2 4H16ZM15 6H3V18H15V6ZM7.4 8.82867C7.47607 8.82867 7.55057 8.85036 7.61475 8.8912L11.9697 11.6625C12.1561 11.7811 12.211 12.0284 12.0924 12.2148C12.061 12.2641 12.0191 12.306 11.9697 12.3375L7.61475 15.1088C7.42837 15.2274 7.18114 15.1725 7.06254 14.9861C7.02169 14.9219 7 14.8474 7 14.7713V9.22867C7 9.00776 7.17909 8.82867 7.4 8.82867ZM21 8.84131L17 11.641V12.359L21 15.1587V8.84131Z"\n          ></path>\n        </svg>\n        Watch Live\n      </button>\n    </div>\n'},18:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div>\n      <button\n        id="sa-live-call-widget-chat-first-approach-btn"\n        class="sa-live-call-widget-chat-first-approach-btn"\n      >\n        <svg\n          focusable="false"\n          width="20"\n          height="20"\n          viewBox="-3 -3 20 20"\n          xmlns="http://www.w3.org/2000/svg"\n          style="vertical-align: top;"\n        >\n          <g transform="translate(-24.000000, -12.000000)"><path\n              d="M25.4036262,27.3409362 C24.4176893,27.8509036 23.8195834,27.3951055 24.0683403,26.3201996 L25.0887779,21.910776 C25.2131242,21.3734618 25.7510472,20.8884231 26.3078778,20.8254187 L32.503417,20.1244045 C34.151155,19.9379658 34.1569707,19.6389088 32.503417,19.4549971 L26.3078778,18.7659164 C25.7589338,18.7048617 25.2129433,18.217839 25.0887779,17.6798715 L24.0683403,13.2586546 C23.8198614,12.1820783 24.408944,11.7182276 25.4036262,12.2327184 L38.22304,18.8634497 C39.208977,19.373417 39.2177223,20.1957141 38.22304,20.7102049 L25.4036262,27.3409362 Z"\n              fill="#ffffff"\n            ></path></g></svg>\n        '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"chatFirstApproachMessage")||(null!=t?a(t,"chatFirstApproachMessage"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"chatFirstApproachMessage",hash:{},data:i,loc:{start:{line:194,column:8},end:{line:194,column:36}}}):o)+"\n      </button>\n    </div>\n"},20:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <h5 class="sa-live-call-widget-cta-text">'+(null!=(o="function"==typeof(a=null!=(a=s(n,"ctaText")||(null!=t?s(t,"ctaText"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"ctaText",hash:{},data:i,loc:{start:{line:199,column:45},end:{line:199,column:58}}}):a)?o:"")+"</h5>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(o=s(n,"if").call(a,null!=t?s(t,"isStreaming"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i,loc:{start:{line:1,column:0},end:{line:30,column:7}}}))?o:"")+(null!=(o=s(n,"if").call(a,null!=t?s(t,"isWelcomeImage"):t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(10,i,0),data:i,loc:{start:{line:31,column:0},end:{line:97,column:7}}}))?o:"")+(null!=(o=s(n,"if").call(a,null!=t?s(t,"intents"):t,{name:"if",hash:{},fn:e.program(12,i,0),inverse:e.noop,data:i,loc:{start:{line:98,column:0},end:{line:100,column:7}}}))?o:"")+'<div class="sa-live-call-widget-expanded-cta-btn-wrapper">\n'+(null!=(o=s(n,"if").call(a,null!=t?s(t,"intents"):t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.noop,data:i,loc:{start:{line:102,column:2},end:{line:152,column:9}}}))?o:"")+(null!=(o=s(n,"if").call(a,null!=t?s(t,"isStreaming"):t,{name:"if",hash:{},fn:e.program(16,i,0),inverse:e.noop,data:i,loc:{start:{line:153,column:2},end:{line:175,column:9}}}))?o:"")+(null!=(o=s(n,"if").call(a,null!=t?s(t,"chatFirstApproach"):t,{name:"if",hash:{},fn:e.program(18,i,0),inverse:e.noop,data:i,loc:{start:{line:176,column:2},end:{line:197,column:9}}}))?o:"")+(null!=(o=s(n,"if").call(a,null!=t?s(t,"ctaText"):t,{name:"if",hash:{},fn:e.program(20,i,0),inverse:e.noop,data:i,loc:{start:{line:198,column:2},end:{line:200,column:9}}}))?o:"")+'  <div class="sa-live-call-widget-expanded-cta-btn-wrapper-2">\n  </div>\n</div>'},useData:!0})},8001:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({1:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="sa-live-call-widget-logo-wrapper">\n      <img src='+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"logo")||(null!=t?a(t,"logo"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"logo",hash:{},data:i,loc:{start:{line:4,column:15},end:{line:4,column:23}}}):o)+' alt="" class="sa-live-call-widget-logo" />\n    </div>\n'},3:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="sa-live-call-widget-live-video">\n        <iframe\n          width="100%"\n          height="100%"\n          src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"streamingUrl")||(null!=t?a(t,"streamingUrl"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"streamingUrl",hash:{},data:i,loc:{start:{line:15,column:15},end:{line:15,column:31}}}):o)+'"\n          frameborder="0"\n          allowfullscreen\n        >\n        </iframe>\n      </div>\n'},5:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isWelcomeImage"):t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.program(8,i,0),data:i,loc:{start:{line:22,column:6},end:{line:38,column:13}}}))?o:""},6:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <img\n          id="sa-live-call-widget-hls-video"\n          src="'+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"sourceWelcomeVideo")||(null!=t?a(t,"sourceWelcomeVideo"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"sourceWelcomeVideo",hash:{},data:i,loc:{start:{line:25,column:15},end:{line:25,column:37}}}):o)+'"\n          alt=""\n        />\n'},8:function(e,t,n,r,i){var o,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c="function",l=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <video\n          id="sa-live-call-widget-hls-video"\n          class="sa-live-call-widget-video-fade"\n          src="'+l(typeof(o=null!=(o=d(n,"sourceWelcomeVideo")||(null!=t?d(t,"sourceWelcomeVideo"):t))?o:s)===c?o.call(a,{name:"sourceWelcomeVideo",hash:{},data:i,loc:{start:{line:32,column:15},end:{line:32,column:37}}}):o)+'"\n          autoplay\n          loop\n          playsinline\n          '+l(typeof(o=null!=(o=d(n,"isMuted")||(null!=t?d(t,"isMuted"):t))?o:s)===c?o.call(a,{name:"isMuted",hash:{},data:i,loc:{start:{line:36,column:10},end:{line:36,column:21}}}):o)+"\n        ></video>\n"},10:function(e,t,n,r,i){return""},12:function(e,t,n,r,i){return'\n      <div class="unmute-helper-animation">\n        <span>Tap to unmute</span>\n      </div>\n\n      <button class="sa-live-call-widget-mute-unmute-video-btn">\n        <svg\n          stroke="currentColor"\n          fill="none"\n          stroke-width="2"\n          viewBox="0 0 24 24"\n          aria-hidden="true"\n          height="22"\n          width="22"\n          xmlns="http://www.w3.org/2000/svg"\n          class="sa-live-call-widget-mute-icon"\n        ><path\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"\n          ></path></svg>\n        <svg\n          stroke="currentColor"\n          fill="none"\n          stroke-width="2"\n          viewBox="0 0 24 24"\n          aria-hidden="true"\n          height="22"\n          width="22"\n          xmlns="http://www.w3.org/2000/svg"\n          class="sa-live-call-widget-unmute-icon"\n        ><path\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"\n            clip-rule="evenodd"\n          ></path><path\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"\n          ></path></svg>\n      </button>\n      <button\n        class="sa-live-call-widget-play-video-btn sa-live-call-widget-d-hidden"\n      >\n        <svg\n          width="20"\n          height="20"\n          viewBox="0 0 20 23"\n          fill="none"\n          xmlns="http://www.w3.org/2000/svg"\n          class="sa-live-call-widget-play-icon"\n        ><path\n            d="M18.7691 11.0709L1.62084 0.290562C1.52697 0.231639 1.41606 0.19634 1.30041 0.188579C1.18475 0.180818 1.06887 0.200898 0.965613 0.246592C0.862352 0.292286 0.775744 0.361811 0.715386 0.447459C0.655028 0.533106 0.62328 0.631531 0.623661 0.731824L0.623661 22.2925C0.623847 22.3926 0.655943 22.4908 0.716421 22.5761C0.776899 22.6614 0.863417 22.7307 0.966471 22.7763C1.06952 22.8219 1.18512 22.8421 1.30057 22.8346C1.41601 22.8271 1.52682 22.7922 1.62084 22.7338L18.7691 11.9467C18.8501 11.8971 18.9162 11.8315 18.9618 11.7553C19.0074 11.6791 19.0312 11.5946 19.0312 11.5088C19.0312 11.423 19.0074 11.3385 18.9618 11.2623C18.9162 11.1861 18.8501 11.1205 18.7691 11.0709Z"\n            fill="black"\n            fill-opacity="0.8"\n          ></path></svg>\n      </button>\n      <button\n        class="sa-live-call-widget-pause-video-btn sa-live-call-widget-d-hidden"\n      >\n        <svg\n          width="16"\n          height="16"\n          viewBox="0 0 20 20"\n          fill="none"\n          xmlns="http://www.w3.org/2000/svg"\n          class="sa-live-call-widget-pause-icon"\n        ><path\n            d="M0 0H7.5V20H0V0ZM12.5 0H20V20H12.5V0Z"\n            fill="black"\n          ></path></svg>\n      </button>\n'},14:function(e,t,n,r,i){return'      <p class="sa-live-call-widget-intent-title"></p>\n'},16:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div\n          class="sa-live-call-widget-intent-container\n            '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"verticalContainerClass")||(null!=t?a(t,"verticalContainerClass"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"verticalContainerClass",hash:{},data:i,loc:{start:{line:121,column:12},end:{line:121,column:38}}}):o)+'"\n        >\n          <div\n            class="sa-live-call-widget-intent-box sa-live-call-widget-intent-box-home"\n          >\n            <span class="sa-live-call-widget-intent-number">\n              <svg\n                stroke="currentColor"\n                fill="currentColor"\n                stroke-width="0"\n                viewBox="0 0 512 512"\n                height="1em"\n                width="1em"\n                xmlns="http://www.w3.org/2000/svg"\n              ><path\n                  fill="none"\n                  stroke-linecap="round"\n                  stroke-linejoin="round"\n                  stroke-width="48"\n                  d="M244 400 100 256l144-144M120 256h292"\n                ></path>\n              </svg>\n            </span>\n            Back\n          </div>\n          <div\n            class="sa-live-call-widget-intent-box sa-live-call-widget-intent-box-back"\n          >\n            <span class="sa-live-call-widget-intent-number">\n              <svg\n                stroke="currentColor"\n                fill="currentColor"\n                stroke-width="0"\n                viewBox="0 0 512 512"\n                height="1em"\n                width="1em"\n                xmlns="http://www.w3.org/2000/svg"\n              ><path\n                  fill="none"\n                  stroke-linecap="round"\n                  stroke-linejoin="round"\n                  stroke-width="48"\n                  d="M244 400 100 256l144-144M120 256h292"\n                ></path></svg>\n            </span>\n            Back\n          </div>\n        </div>\n'},18:function(e,t,n,r,i){return'        <div>\n          <button\n            id="sa-live-call-widget-watch-live-stream-btn"\n            class="sa-live-call-widget-watch-live-stream-btn"\n          >\n            <svg\n              stroke="currentColor"\n              fill="currentColor"\n              stroke-width="0"\n              viewBox="0 0 24 24"\n              height="20"\n              width="20"\n              xmlns="http://www.w3.org/2000/svg"\n            >\n              <path\n                d="M16 4C16.5523 4 17 4.44772 17 5V9.2L22.2133 5.55071C22.4395 5.39235 22.7513 5.44737 22.9096 5.6736C22.9684 5.75764 23 5.85774 23 5.96033V18.0397C23 18.3158 22.7761 18.5397 22.5 18.5397C22.3974 18.5397 22.2973 18.5081 22.2133 18.4493L17 14.8V19C17 19.5523 16.5523 20 16 20H2C1.44772 20 1 19.5523 1 19V5C1 4.44772 1.44772 4 2 4H16ZM15 6H3V18H15V6ZM7.4 8.82867C7.47607 8.82867 7.55057 8.85036 7.61475 8.8912L11.9697 11.6625C12.1561 11.7811 12.211 12.0284 12.0924 12.2148C12.061 12.2641 12.0191 12.306 11.9697 12.3375L7.61475 15.1088C7.42837 15.2274 7.18114 15.1725 7.06254 14.9861C7.02169 14.9219 7 14.8474 7 14.7713V9.22867C7 9.00776 7.17909 8.82867 7.4 8.82867ZM21 8.84131L17 11.641V12.359L21 15.1587V8.84131Z"\n              ></path>\n            </svg>\n            Watch Live\n          </button>\n        </div>\n'},20:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div>\n          <button\n            id="sa-live-call-widget-chat-first-approach-btn"\n            class="sa-live-call-widget-chat-first-approach-btn"\n          >\n            <svg\n              focusable="false"\n              width="20"\n              height="20"\n              viewBox="-3 -3 20 20"\n              xmlns="http://www.w3.org/2000/svg"\n              style="vertical-align: top;"\n            >\n              <g transform="translate(-24.000000, -12.000000)"><path\n                  d="M25.4036262,27.3409362 C24.4176893,27.8509036 23.8195834,27.3951055 24.0683403,26.3201996 L25.0887779,21.910776 C25.2131242,21.3734618 25.7510472,20.8884231 26.3078778,20.8254187 L32.503417,20.1244045 C34.151155,19.9379658 34.1569707,19.6389088 32.503417,19.4549971 L26.3078778,18.7659164 C25.7589338,18.7048617 25.2129433,18.217839 25.0887779,17.6798715 L24.0683403,13.2586546 C23.8198614,12.1820783 24.408944,11.7182276 25.4036262,12.2327184 L38.22304,18.8634497 C39.208977,19.373417 39.2177223,20.1957141 38.22304,20.7102049 L25.4036262,27.3409362 Z"\n                  fill="#ffffff"\n                ></path></g></svg>\n            '+e.escapeExpression("function"==typeof(o=null!=(o=a(n,"chatFirstApproachMessage")||(null!=t?a(t,"chatFirstApproachMessage"):t))?o:e.hooks.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"chatFirstApproachMessage",hash:{},data:i,loc:{start:{line:211,column:12},end:{line:211,column:40}}}):o)+"\n          </button>\n        </div>\n"},22:function(e,t,n,r,i){var o,a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <h5 class="sa-live-call-widget-cta-text">'+(null!=(o="function"==typeof(a=null!=(a=s(n,"ctaText")||(null!=t?s(t,"ctaText"):t))?a:e.hooks.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"ctaText",hash:{},data:i,loc:{start:{line:216,column:49},end:{line:216,column:62}}}):a)?o:"")+"</h5>\n"},24:function(e,t,n,r,i){var o,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"customPoweredBy"):t,{name:"if",hash:{},fn:e.program(25,i,0),inverse:e.program(27,i,0),data:i,loc:{start:{line:239,column:4},end:{line:260,column:11}}}))?o:""},25:function(e,t,n,r,i){var o,a=e.lambda,s=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span\n        class="sa-live-call-widget-powered-by-strip"\n      >\n        <a\n          href="'+s(a(null!=(o=null!=t?c(t,"customPoweredByData"):t)?c(o,"domain_url"):o,t))+'"\n          target="_blank"\n          class="sa-live-call-widget-bold"\n        >'+s(a(null!=(o=null!=t?c(t,"customPoweredByData"):t)?c(o,"domain_name"):o,t))+"</a>\n      </span>\n"},27:function(e,t,n,r,i){return'      <span\n        class="sa-live-call-widget-powered-by-strip"\n      >\n        <img\n          src="https://www.saleassist.ai/logo.png"\n          class="sa-live-call-widget-powered-by-strip-saleassist-logo"\n        />\n        Powered by&nbsp;\n        <a href="https://www.saleassist.ai/" target="_blank" class="sa-live-call-widget-bold">SaleAssist.ai</a>\n      </span>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){var o,a,s=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sa-live-call-widget-expanded" style="display: flex">\n'+(null!=(o=c(n,"if").call(s,null!=t?c(t,"logo"):t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:2,column:2},end:{line:6,column:9}}}))?o:"")+'  <div\n    class="sa-live-call-widget-expanded-inner-wrapper sa-live-call-widget-powered-by-'+e.escapeExpression("function"==typeof(a=null!=(a=c(n,"poweredBy")||(null!=t?c(t,"poweredBy"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"poweredBy",hash:{},data:i,loc:{start:{line:8,column:85},end:{line:8,column:98}}}):a)+'"\n  >\n'+(null!=(o=c(n,"if").call(s,null!=t?c(t,"isStreaming"):t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i,loc:{start:{line:10,column:4},end:{line:39,column:11}}}))?o:"")+"    "+(null!=(o=c(n,"if").call(s,null!=t?c(t,"isWelcomeImage"):t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i,loc:{start:{line:40,column:4},end:{line:113,column:11}}}))?o:"")+(null!=(o=c(n,"if").call(s,null!=t?c(t,"intents"):t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.noop,data:i,loc:{start:{line:114,column:4},end:{line:116,column:11}}}))?o:"")+'    <div class="sa-live-call-widget-expanded-cta-btn-wrapper">\n'+(null!=(o=c(n,"if").call(s,null!=t?c(t,"intents"):t,{name:"if",hash:{},fn:e.program(16,i,0),inverse:e.noop,data:i,loc:{start:{line:118,column:6},end:{line:169,column:13}}}))?o:"")+(null!=(o=c(n,"if").call(s,null!=t?c(t,"isStreaming"):t,{name:"if",hash:{},fn:e.program(18,i,0),inverse:e.noop,data:i,loc:{start:{line:170,column:6},end:{line:192,column:13}}}))?o:"")+(null!=(o=c(n,"if").call(s,null!=t?c(t,"chatFirstApproach"):t,{name:"if",hash:{},fn:e.program(20,i,0),inverse:e.noop,data:i,loc:{start:{line:193,column:6},end:{line:214,column:13}}}))?o:"")+(null!=(o=c(n,"if").call(s,null!=t?c(t,"ctaText"):t,{name:"if",hash:{},fn:e.program(22,i,0),inverse:e.noop,data:i,loc:{start:{line:215,column:6},end:{line:217,column:13}}}))?o:"")+'      <div class="sa-live-call-widget-expanded-cta-btn-wrapper-2">\n      </div>\n    </div>\n  </div>\n  <div class="sa-live-call-widget-close-expanded-widget-btn">\n    <svg\n      stroke="currentColor"\n      fill="currentColor"\n      stroke-width="0"\n      viewBox="0 0 24 24"\n      height="1em"\n      width="1em"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <path fill="none" d="M0 0h24v24H0z"></path>\n      <path\n        d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"\n      ></path>\n    </svg>\n  </div>\n'+(null!=(o=c(n,"if").call(s,null!=t?c(t,"poweredBy"):t,{name:"if",hash:{},fn:e.program(24,i,0),inverse:e.noop,data:i,loc:{start:{line:238,column:2},end:{line:261,column:9}}}))?o:"")+"</div>"},useData:!0})},3585:(e,t,n)=>{var r=n(202);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,i){return'<div class="sa-live-call-widget-loader-spinner">\n  <div class="sa-live-call-widget-loader-bounce1"></div>\n  <div class="sa-live-call-widget-loader-bounce2"></div>\n  <div class="sa-live-call-widget-loader-bounce3"></div>\n</div>'},useData:!0})},6834:(e,t,n)=>{"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.__esModule=!0;var o=i(n(2067)),a=r(n(5558)),s=r(n(8728)),c=i(n(2392)),l=i(n(1628)),d=r(n(3982));function u(){var e=new o.HandlebarsEnvironment;return c.extend(e,o),e.SafeString=a.default,e.Exception=s.default,e.Utils=c,e.escapeExpression=c.escapeExpression,e.VM=l,e.template=function(t){return l.template(t,e)},e}var p=u();p.create=u,d.default(p),p.default=p,t.default=p,e.exports=t.default},2067:(e,t,n)=>{"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.HandlebarsEnvironment=u;var i=n(2392),o=r(n(8728)),a=n(2638),s=n(881),c=r(n(8037)),l=n(6293);t.VERSION="4.7.7";t.COMPILER_REVISION=8;t.LAST_COMPATIBLE_COMPILER_REVISION=7;t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var d="[object Object]";function u(e,t,n){this.helpers=e||{},this.partials=t||{},this.decorators=n||{},a.registerDefaultHelpers(this),s.registerDefaultDecorators(this)}u.prototype={constructor:u,logger:c.default,log:c.default.log,registerHelper:function(e,t){if(i.toString.call(e)===d){if(t)throw new o.default("Arg not supported with multiple helpers");i.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(i.toString.call(e)===d)i.extend(this.partials,e);else{if(void 0===t)throw new o.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(i.toString.call(e)===d){if(t)throw new o.default("Arg not supported with multiple decorators");i.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var p=c.default.log;t.log=p,t.createFrame=i.createFrame,t.logger=c.default},881:(e,t,n)=>{"use strict";t.__esModule=!0,t.registerDefaultDecorators=function(e){o.default(e)};var r,i=n(5670),o=(r=i)&&r.__esModule?r:{default:r}},5670:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(2392);t.default=function(e){e.registerDecorator("inline",(function(e,t,n,i){var o=e;return t.partials||(t.partials={},o=function(i,o){var a=n.partials;n.partials=r.extend({},a,t.partials);var s=e(i,o);return n.partials=a,s}),t.partials[i.args[0]]=i.fn,o}))},e.exports=t.default},8728:(e,t)=>{"use strict";t.__esModule=!0;var n=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function r(e,t){var i=t&&t.loc,o=void 0,a=void 0,s=void 0,c=void 0;i&&(o=i.start.line,a=i.end.line,s=i.start.column,c=i.end.column,e+=" - "+o+":"+s);for(var l=Error.prototype.constructor.call(this,e),d=0;d<n.length;d++)this[n[d]]=l[n[d]];Error.captureStackTrace&&Error.captureStackTrace(this,r);try{i&&(this.lineNumber=o,this.endLineNumber=a,Object.defineProperty?(Object.defineProperty(this,"column",{value:s,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:c,enumerable:!0})):(this.column=s,this.endColumn=c))}catch(e){}}r.prototype=new Error,t.default=r,e.exports=t.default},2638:(e,t,n)=>{"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.registerDefaultHelpers=function(e){i.default(e),o.default(e),a.default(e),s.default(e),c.default(e),l.default(e),d.default(e)},t.moveHelperToHooks=function(e,t,n){e.helpers[t]&&(e.hooks[t]=e.helpers[t],n||delete e.helpers[t])};var i=r(n(7342)),o=r(n(6822)),a=r(n(4905)),s=r(n(7405)),c=r(n(5702)),l=r(n(7593)),d=r(n(3978))},7342:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(2392);t.default=function(e){e.registerHelper("blockHelperMissing",(function(t,n){var i=n.inverse,o=n.fn;if(!0===t)return o(this);if(!1===t||null==t)return i(this);if(r.isArray(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var a=r.createFrame(n.data);a.contextPath=r.appendContextPath(n.data.contextPath,n.name),n={data:a}}return o(t,n)}))},e.exports=t.default},6822:(e,t,n)=>{"use strict";t.__esModule=!0;var r,i=n(2392),o=n(8728),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("each",(function(e,t){if(!t)throw new a.default("Must pass iterator to #each");var r,o=t.fn,s=t.inverse,c=0,l="",d=void 0,u=void 0;function p(t,n,r){d&&(d.key=t,d.index=n,d.first=0===n,d.last=!!r,u&&(d.contextPath=u+t)),l+=o(e[t],{data:d,blockParams:i.blockParams([e[t],t],[u+t,null])})}if(t.data&&t.ids&&(u=i.appendContextPath(t.data.contextPath,t.ids[0])+"."),i.isFunction(e)&&(e=e.call(this)),t.data&&(d=i.createFrame(t.data)),e&&"object"==typeof e)if(i.isArray(e))for(var h=e.length;c<h;c++)c in e&&p(c,c,c===e.length-1);else if(n.g.Symbol&&e[n.g.Symbol.iterator]){for(var f=[],m=e[n.g.Symbol.iterator](),g=m.next();!g.done;g=m.next())f.push(g.value);for(h=(e=f).length;c<h;c++)p(c,c,c===e.length-1)}else r=void 0,Object.keys(e).forEach((function(e){void 0!==r&&p(r,c-1),r=e,c++})),void 0!==r&&p(r,c-1,!0);return 0===c&&(l=s(this)),l}))},e.exports=t.default},4905:(e,t,n)=>{"use strict";t.__esModule=!0;var r,i=n(8728),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},e.exports=t.default},7405:(e,t,n)=>{"use strict";t.__esModule=!0;var r,i=n(2392),o=n(8728),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("if",(function(e,t){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return i.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||i.isEmpty(e)?t.inverse(this):t.fn(this)})),e.registerHelper("unless",(function(t,n){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return e.helpers.if.call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}))},e.exports=t.default},5702:(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("log",(function(){for(var t=[void 0],n=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)t.push(arguments[r]);var i=1;null!=n.hash.level?i=n.hash.level:n.data&&null!=n.data.level&&(i=n.data.level),t[0]=i,e.log.apply(e,t)}))},e.exports=t.default},7593:(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("lookup",(function(e,t,n){return e?n.lookupProperty(e,t):e}))},e.exports=t.default},3978:(e,t,n)=>{"use strict";t.__esModule=!0;var r,i=n(2392),o=n(8728),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("with",(function(e,t){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");i.isFunction(e)&&(e=e.call(this));var n=t.fn;if(i.isEmpty(e))return t.inverse(this);var r=t.data;return t.data&&t.ids&&((r=i.createFrame(t.data)).contextPath=i.appendContextPath(t.data.contextPath,t.ids[0])),n(e,{data:r,blockParams:i.blockParams([e],[r&&r.contextPath])})}))},e.exports=t.default},8572:(e,t,n)=>{"use strict";t.__esModule=!0,t.createNewLookupObject=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.extend.apply(void 0,[Object.create(null)].concat(t))};var r=n(2392)},6293:(e,t,n)=>{"use strict";t.__esModule=!0,t.createProtoAccessControl=function(e){var t=Object.create(null);t.constructor=!1,t.__defineGetter__=!1,t.__defineSetter__=!1,t.__lookupGetter__=!1;var n=Object.create(null);return n.__proto__=!1,{properties:{whitelist:r.createNewLookupObject(n,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:r.createNewLookupObject(t,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},t.resultIsAllowed=function(e,t,n){return a("function"==typeof e?t.methods:t.properties,n)},t.resetLoggedProperties=function(){Object.keys(o).forEach((function(e){delete o[e]}))};var r=n(8572),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(8037)),o=Object.create(null);function a(e,t){return void 0!==e.whitelist[t]?!0===e.whitelist[t]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==o[e]&&(o[e]=!0,i.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(t),!1)}},5005:(e,t)=>{"use strict";t.__esModule=!0,t.wrapHelper=function(e,t){if("function"!=typeof e)return e;return function(){return arguments[arguments.length-1]=t(arguments[arguments.length-1]),e.apply(this,arguments)}}},8037:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(2392),i={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=r.indexOf(i.methodMap,e.toLowerCase());e=t>=0?t:parseInt(e,10)}return e},log:function(e){if(e=i.lookupLevel(e),"undefined"!=typeof console&&i.lookupLevel(i.level)<=e){var t=i.methodMap[e];console[t]||(t="log");for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];console[t].apply(console,r)}}};t.default=i,e.exports=t.default},3982:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){var t=void 0!==n.g?n.g:window,r=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=r),e}},e.exports=t.default},1628:(e,t,n)=>{"use strict";t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,n=s.COMPILER_REVISION;if(t>=s.LAST_COMPATIBLE_COMPILER_REVISION&&t<=s.COMPILER_REVISION)return;if(t<s.LAST_COMPATIBLE_COMPILER_REVISION){var r=s.REVISION_CHANGES[n],i=s.REVISION_CHANGES[t];throw new a.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new a.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")},t.template=function(e,t){if(!t)throw new a.default("No environment passed to template");if(!e||!e.main)throw new a.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var n=e.compiler&&7===e.compiler[0];var r={strict:function(e,t,n){if(!e||!(t in e))throw new a.default('"'+t+'" not defined in '+e,{loc:n});return r.lookupProperty(e,t)},lookupProperty:function(e,t){var n=e[t];return null==n||Object.prototype.hasOwnProperty.call(e,t)||d.resultIsAllowed(n,r.protoAccessControl,t)?n:void 0},lookup:function(e,t){for(var n=e.length,i=0;i<n;i++){if(null!=(e[i]&&r.lookupProperty(e[i],t)))return e[i][t]}},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:i.escapeExpression,invokePartial:function(n,r,o){o.hash&&(r=i.extend({},r,o.hash),o.ids&&(o.ids[0]=!0)),n=t.VM.resolvePartial.call(this,n,r,o);var s=i.extend({},o,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),c=t.VM.invokePartial.call(this,n,r,s);if(null==c&&t.compile&&(o.partials[o.name]=t.compile(n,e.compilerOptions,t),c=o.partials[o.name](r,s)),null!=c){if(o.indent){for(var l=c.split("\n"),d=0,u=l.length;d<u&&(l[d]||d+1!==u);d++)l[d]=o.indent+l[d];c=l.join("\n")}return c}throw new a.default("The partial "+o.name+" could not be compiled when running in runtime-only mode")},fn:function(t){var n=e[t];return n.decorator=e[t+"_d"],n},programs:[],program:function(e,t,n,r,i){var o=this.programs[e],a=this.fn(e);return t||i||r||n?o=u(this,e,a,t,n,r,i):o||(o=this.programs[e]=u(this,e,a)),o},data:function(e,t){for(;e&&t--;)e=e._parent;return e},mergeIfNeeded:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=i.extend({},t,e)),n},nullContext:Object.seal({}),noop:t.VM.noop,compilerInfo:e.compiler};function o(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=n.data;o._setup(n),!n.partial&&e.useData&&(i=function(e,t){t&&"root"in t||((t=t?s.createFrame(t):{}).root=e);return t}(t,i));var a=void 0,c=e.useBlockParams?[]:void 0;function l(t){return""+e.main(r,t,r.helpers,r.partials,i,c,a)}return e.useDepths&&(a=n.depths?t!=n.depths[0]?[t].concat(n.depths):n.depths:[t]),(l=h(e.main,l,r,n.depths||[],i,c))(t,n)}return o.isTop=!0,o._setup=function(o){if(o.partial)r.protoAccessControl=o.protoAccessControl,r.helpers=o.helpers,r.partials=o.partials,r.decorators=o.decorators,r.hooks=o.hooks;else{var a=i.extend({},t.helpers,o.helpers);!function(e,t){Object.keys(e).forEach((function(n){var r=e[n];e[n]=function(e,t){var n=t.lookupProperty;return l.wrapHelper(e,(function(e){return i.extend({lookupProperty:n},e)}))}(r,t)}))}(a,r),r.helpers=a,e.usePartial&&(r.partials=r.mergeIfNeeded(o.partials,t.partials)),(e.usePartial||e.useDecorators)&&(r.decorators=i.extend({},t.decorators,o.decorators)),r.hooks={},r.protoAccessControl=d.createProtoAccessControl(o);var s=o.allowCallsToHelperMissing||n;c.moveHelperToHooks(r,"helperMissing",s),c.moveHelperToHooks(r,"blockHelperMissing",s)}},o._child=function(t,n,i,o){if(e.useBlockParams&&!i)throw new a.default("must pass block params");if(e.useDepths&&!o)throw new a.default("must pass parent depths");return u(r,t,e[t],n,0,i,o)},o},t.wrapProgram=u,t.resolvePartial=function(e,t,n){e?e.call||n.name||(n.name=e,e=n.partials[e]):e="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name];return e},t.invokePartial=function(e,t,n){var r=n.data&&n.data["partial-block"];n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var o=void 0;n.fn&&n.fn!==p&&function(){n.data=s.createFrame(n.data);var e=n.fn;o=n.data["partial-block"]=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return n.data=s.createFrame(n.data),n.data["partial-block"]=r,e(t,n)},e.partials&&(n.partials=i.extend({},n.partials,e.partials))}();void 0===e&&o&&(e=o);if(void 0===e)throw new a.default("The partial "+n.name+" could not be found");if(e instanceof Function)return e(t,n)},t.noop=p;var r,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2392)),o=n(8728),a=(r=o)&&r.__esModule?r:{default:r},s=n(2067),c=n(2638),l=n(5005),d=n(6293);function u(e,t,n,r,i,o,a){function s(t){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=a;return!a||t==a[0]||t===e.nullContext&&null===a[0]||(s=[t].concat(a)),n(e,t,e.helpers,e.partials,i.data||r,o&&[i.blockParams].concat(o),s)}return(s=h(n,s,e,a,r,o)).program=t,s.depth=a?a.length:0,s.blockParams=i||0,s}function p(){return""}function h(e,t,n,r,o,a){if(e.decorator){var s={};t=e.decorator(t,s,n,r&&r[0],o,a,r),i.extend(t,s)}return t}},5558:(e,t)=>{"use strict";function n(e){this.string=e}t.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},t.default=n,e.exports=t.default},2392:(e,t)=>{"use strict";t.__esModule=!0,t.extend=a,t.indexOf=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}if(!i.test(e))return e;return e.replace(r,o)},t.isEmpty=function(e){return!e&&0!==e||!(!l(e)||0!==e.length)},t.createFrame=function(e){var t=a({},e);return t._parent=e,t},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},r=/[&<>"'`=]/g,i=/[&<>"'`=]/;function o(e){return n[e]}function a(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}var s=Object.prototype.toString;t.toString=s;var c=function(e){return"function"==typeof e};c(/x/)&&(t.isFunction=c=function(e){return"function"==typeof e&&"[object Function]"===s.call(e)}),t.isFunction=c;var l=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===s.call(e)};t.isArray=l},202:(e,t,n)=>{e.exports=n(6834).default},4492:(e,t,n)=>{"use strict";e.exports=n(8836)},3996:(e,t,n)=>{"use strict";var r=t,i=n(7025),o=n(9935);function a(e,t,n,r){var o=!1;if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",r);for(var a=t.resolvedType.values,s=Object.keys(a),c=0;c<s.length;++c)a[s[c]]!==t.typeDefault||o||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),t.repeated||e("break"),o=!0),e("case%j:",s[c])("case %i:",a[s[c]])("m%s=%j",r,a[s[c]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var l=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,l)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function s(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,n,r,r,n,r,r):e("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,o?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),c=o.safeProp(s.name);s.map?(n("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),a(n,s,r,c+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),a(n,s,r,c+"[i]")("}")("}")):(s.resolvedType instanceof i||n("if(d%s!=null){",c),a(n,s,r,c),s.resolvedType instanceof i||n("}"))}return n("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var n=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],a=[],c=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?r:t[l].map?a:c).push(t[l]);if(r.length){for(n("if(o.arrays||o.defaults){"),l=0;l<r.length;++l)n("d%s=[]",o.safeProp(r[l].name));n("}")}if(a.length){for(n("if(o.objects||o.defaults){"),l=0;l<a.length;++l)n("d%s={}",o.safeProp(a[l].name));n("}")}if(c.length){for(n("if(o.defaults){"),l=0;l<c.length;++l){var d=c[l],u=o.safeProp(d.name);if(d.resolvedType instanceof i)n("d%s=o.enums===String?%j:%j",u,d.resolvedType.valuesById[d.typeDefault],d.typeDefault);else if(d.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",d.typeDefault.low,d.typeDefault.high,d.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,d.typeDefault.toString(),d.typeDefault.toNumber());else if(d.bytes){var p="["+Array.prototype.slice.call(d.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,d.typeDefault))("else{")("d%s=%s",u,p)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")}else n("d%s=%j",u,d.typeDefault)}n("}")}var h=!1;for(l=0;l<t.length;++l){d=t[l];var f=e._fieldsArray.indexOf(d);u=o.safeProp(d.name);d.map?(h||(h=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){"),s(n,d,f,u+"[ks2[j]]")("}")):d.repeated?(n("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u),s(n,d,f,u+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",u,d.name),s(n,d,f,u),d.partOf&&n("if(o.oneofs)")("d%s=%j",o.safeProp(d.partOf.name),d.name)),n("}")}return n("return d")}},5305:(e,t,n)=>{"use strict";e.exports=function(e){for(var t=o.codegen(["r","l","e"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),n=0;n<e.fieldsArray.length;++n){var s=e._fieldsArray[n].resolve(),c=s.resolvedType instanceof r?"int32":s.type,l="m"+o.safeProp(s.name);t("case %i: {",s.id),s.map?(t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos"),void 0!==i.defaults[s.keyType]?t("k=%j",i.defaults[s.keyType]):t("k=null"),void 0!==i.defaults[c]?t("value=%j",i.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),void 0===i.basic[c]?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==i.long[s.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',l):t("%s[k]=value",l)):s.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),void 0!==i.packed[c]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,c)("}else"),void 0===i.basic[c]?t(s.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",l,n):t("%s.push(r.%s())",l,c)):void 0===i.basic[c]?t(s.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",l,n):t("%s=r.%s()",l,c),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var d=e._fieldsArray[n];d.required&&t("if(!m.hasOwnProperty(%j))",d.name)("throw util.ProtocolError(%j,{instance:m})",a(d))}return t("return m")};var r=n(7025),i=n(7063),o=n(9935);function a(e){return"missing required '"+e.name+"'"}},4928:(e,t,n)=>{"use strict";e.exports=function(e){for(var t,n=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(o.compareFieldsById),c=0;c<s.length;++c){var l=s[c].resolve(),d=e._fieldsArray.indexOf(l),u=l.resolvedType instanceof r?"int32":l.type,p=i.basic[u];t="m"+o.safeProp(l.name),l.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|i.mapKey[l.keyType],l.keyType),void 0===p?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",d,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|p,u,t),n("}")("}")):l.repeated?(n("if(%s!=null&&%s.length){",t,t),l.packed&&void 0!==i.packed[u]?n("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",u,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),void 0===p?a(n,l,d,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(l.id<<3|p)>>>0,u,t)),n("}")):(l.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,l.name),void 0===p?a(n,l,d,t):n("w.uint32(%i).%s(%s)",(l.id<<3|p)>>>0,u,t))}return n("return w")};var r=n(7025),i=n(7063),o=n(9935);function a(e,t,n,r){return t.delimited?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}},7025:(e,t,n)=>{"use strict";e.exports=a;var r=n(3243);((a.prototype=Object.create(r.prototype)).constructor=a).className="Enum";var i=n(9313),o=n(9935);function a(e,t,n,i,o,a){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=o||{},this.valuesOptions=a,this._valuesFeatures={},this.reserved=void 0,t)for(var s=Object.keys(t),c=0;c<s.length;++c)"number"==typeof t[s[c]]&&(this.valuesById[this.values[s[c]]=t[s[c]]]=s[c])}a.prototype._resolveFeatures=function(e){return e=this._edition||e,r.prototype._resolveFeatures.call(this,e),Object.keys(this.values).forEach((e=>{var t=Object.assign({},this._features);this._valuesFeatures[e]=Object.assign(t,this.valuesOptions&&this.valuesOptions[e]&&this.valuesOptions[e].features)})),this},a.fromJSON=function(e,t){var n=new a(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,t.edition&&(n._edition=t.edition),n._defaultEdition="proto3",n},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,n,r){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=n||null,this},a.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},a.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},3548:(e,t,n)=>{"use strict";e.exports=l;var r=n(3243);((l.prototype=Object.create(r.prototype)).constructor=l).className="Field";var i,o=n(7025),a=n(7063),s=n(9935),c=/^required|optional|repeated$/;function l(e,t,n,i,o,l,d){if(s.isObject(i)?(d=o,l=i,i=o=void 0):s.isObject(o)&&(d=l,l=o,o=void 0),r.call(this,e,l),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(n))throw TypeError("type must be a string");if(void 0!==i&&!c.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!s.isString(o))throw TypeError("extend must be a string");"proto3_optional"===i&&(i="optional"),this.rule=i&&"optional"!==i?i:void 0,this.type=n,this.id=t,this.extend=o||void 0,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&void 0!==a.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=d}l.fromJSON=function(e,t){var n=new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment);return t.edition&&(n._edition=t.edition),n._defaultEdition="proto3",n},Object.defineProperty(l.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(l.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(l.prototype,"delimited",{get:function(){return this.resolvedType instanceof i&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(l.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(l.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),l.prototype.setOption=function(e,t,n){return r.prototype.setOption.call(this,e,t,n)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},l.prototype._inferLegacyProtoFeatures=function(e){if("proto2"!==e&&"proto3"!==e)return{};var t={};if("required"===this.rule&&(t.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===a.defaults[this.type]){var n=this.parent.get(this.type.split(".").pop());n&&n instanceof i&&n.group&&(t.message_encoding="DELIMITED")}return!0===this.getOption("packed")?t.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(t.repeated_field_encoding="EXPANDED"),t},l.prototype._resolveFeatures=function(e){return r.prototype._resolveFeatures.call(this,this._edition||e)},l.d=function(e,t,n,r){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(i,o){s.decorateType(i.constructor).add(new l(o,e,t,n,{default:r}))}},l._configure=function(e){i=e}},8836:(e,t,n)=>{"use strict";var r=e.exports=n(9482);r.build="light",r.load=function(e,t,n){return"function"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=n(4928),r.decoder=n(5305),r.verifier=n(4497),r.converter=n(3996),r.ReflectionObject=n(3243),r.Namespace=n(9313),r.Root=n(9424),r.Enum=n(7025),r.Type=n(7645),r.Field=n(3548),r.OneOf=n(7598),r.MapField=n(6039),r.Service=n(7513),r.Method=n(4429),r.Message=n(8368),r.wrappers=n(1667),r.types=n(7063),r.util=n(9935),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},9482:(e,t,n)=>{"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(1173),r.BufferWriter=n(3155),r.Reader=n(1408),r.BufferReader=n(593),r.util=n(9693),r.rpc=n(5994),r.roots=n(5054),r.configure=i,i()},6039:(e,t,n)=>{"use strict";e.exports=a;var r=n(3548);((a.prototype=Object.create(r.prototype)).constructor=a).className="MapField";var i=n(7063),o=n(9935);function a(e,t,n,i,a,s){if(r.call(this,e,t,i,void 0,void 0,a,s),!o.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=o.decorateType(n).name:n&&"object"==typeof n&&(n=o.decorateEnum(n).name),function(r,i){o.decorateType(r.constructor).add(new a(i,e,t,n))}}},8368:(e,t,n)=>{"use strict";e.exports=i;var r=n(9693);function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},4429:(e,t,n)=>{"use strict";e.exports=o;var r=n(3243);((o.prototype=Object.create(r.prototype)).constructor=o).className="Method";var i=n(9935);function o(e,t,n,o,a,s,c,l,d){if(i.isObject(a)?(c=a,a=s=void 0):i.isObject(s)&&(c=s,s=void 0),void 0!==t&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(o))throw TypeError("responseType must be a string");r.call(this,e,c),this.type=t||"rpc",this.requestType=n,this.requestStream=!!a||void 0,this.responseType=o,this.responseStream=!!s||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l,this.parsedOptions=d}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},9313:(e,t,n)=>{"use strict";e.exports=u;var r=n(3243);((u.prototype=Object.create(r.prototype)).constructor=u).className="Namespace";var i,o,a,s=n(3548),c=n(9935),l=n(7598);function d(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function u(e,t){r.call(this,e,t),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function p(e){e._nestedArray=null,e._lookupCache={};for(var t=e;t=t.parent;)t._lookupCache={};return e}u.fromJSON=function(e,t){return new u(e,t.options).addJSON(t.nested)},u.arrayToJSON=d,u.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},u.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(u.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),u.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",d(this.nestedArray,e)])},u.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((void 0!==t.fields?i.fromJSON:void 0!==t.values?a.fromJSON:void 0!==t.methods?o.fromJSON:void 0!==t.id?s.fromJSON:u.fromJSON)(n[r],t));return this},u.prototype.get=function(e){return this.nested&&this.nested[e]||null},u.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},u.prototype.add=function(e){if(!(e instanceof s&&void 0!==e.extend||e instanceof i||e instanceof l||e instanceof a||e instanceof o||e instanceof u))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof u&&e instanceof u)||t instanceof i||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};this.nested[e.name]=e,this instanceof i||this instanceof o||this instanceof a||this instanceof s||e._edition||(e._edition=e._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var c=this;c=c.parent;)c._needsRecursiveFeatureResolution=!0,c._needsRecursiveResolve=!0;return e.onAdd(this),p(this)},u.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),p(this)},u.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof u))throw Error("path conflicts with non-namespace objects")}else n.add(n=new u(r))}return t&&n.addJSON(t),n},u.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var e=this.nestedArray,t=0;for(this.resolve();t<e.length;)e[t]instanceof u?e[t++].resolveAll():e[t++].resolve();return this._needsRecursiveResolve=!1,this},u.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(this._needsRecursiveFeatureResolution=!1,e=this._edition||e,r.prototype._resolveFeaturesRecursive.call(this,e),this.nestedArray.forEach((t=>{t._resolveFeaturesRecursive(e)})),this):this},u.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;var r=e.join(".");if(""===e[0])return this.root.lookup(e.slice(1),t);var i=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+r];if(i&&(!t||t.indexOf(i.constructor)>-1))return i;if((i=this._lookupImpl(e,r))&&(!t||t.indexOf(i.constructor)>-1))return i;if(n)return null;for(var o=this;o.parent;){if((i=o.parent._lookupImpl(e,r))&&(!t||t.indexOf(i.constructor)>-1))return i;o=o.parent}return null},u.prototype._lookupImpl=function(e,t){if(Object.prototype.hasOwnProperty.call(this._lookupCache,t))return this._lookupCache[t];var n=this.get(e[0]),r=null;if(n)1===e.length?r=n:n instanceof u&&(e=e.slice(1),r=n._lookupImpl(e,e.join(".")));else for(var i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof u&&(n=this._nestedArray[i]._lookupImpl(e,t))&&(r=n);return this._lookupCache[t]=r,r},u.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},u.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},u.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},u.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},u._configure=function(e,t,n){i=e,o=t,a=n}},3243:(e,t,n)=>{"use strict";e.exports=l,l.className="ReflectionObject";const r=n(7598);var i,o=n(9935),a={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},s={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},c={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function l(e,t){if(!o.isString(e))throw TypeError("name must be a string");if(t&&!o.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(l.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),l.prototype.toJSON=function(){throw Error()},l.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof i&&t._handleAdd(this)},l.prototype.onRemove=function(e){var t=e.root;t instanceof i&&t._handleRemove(this),this.parent=null,this.resolved=!1},l.prototype.resolve=function(){return this.resolved||this.root instanceof i&&(this.resolved=!0),this},l.prototype._resolveFeaturesRecursive=function(e){return this._resolveFeatures(this._edition||e)},l.prototype._resolveFeatures=function(e){if(!this._featuresResolved){var t={};if(!e)throw new Error("Unknown edition for "+this.fullName);var n=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(e));if(this._edition){if("proto2"===e)t=Object.assign({},s);else if("proto3"===e)t=Object.assign({},c);else{if("2023"!==e)throw new Error("Unknown edition: "+e);t=Object.assign({},a)}return this._features=Object.assign(t,n||{}),void(this._featuresResolved=!0)}if(this.partOf instanceof r){var i=Object.assign({},this.partOf._features);this._features=Object.assign(i,n||{})}else if(this.declaringField);else{if(!this.parent)throw new Error("Unable to find a parent for "+this.fullName);var o=Object.assign({},this.parent._features);this._features=Object.assign(o,n||{})}this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},l.prototype._inferLegacyProtoFeatures=function(){return{}},l.prototype.getOption=function(e){if(this.options)return this.options[e]},l.prototype.setOption=function(e,t,n){return this.options||(this.options={}),/^features\./.test(e)?o.setProperty(this.options,e,t,n):n&&void 0!==this.options[e]||(this.getOption(e)!==t&&(this.resolved=!1),this.options[e]=t),this},l.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var i=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(i){var a=i[e];o.setProperty(a,n,t)}else(i={})[e]=o.setProperty({},n,t),r.push(i)}else{var s={};s[e]=t,r.push(s)}return this},l.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},l.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},l.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},l._configure=function(e){i=e}},7598:(e,t,n)=>{"use strict";e.exports=a;var r=n(3243);((a.prototype=Object.create(r.prototype)).constructor=a).className="OneOf";var i=n(3548),o=n(9935);function a(e,t,n,i){if(Array.isArray(t)||(n=t,t=void 0),r.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},a.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}s(this)},a.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},Object.defineProperty(a.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var e=this.fieldsArray[0];return null!=e.options&&!0===e.options.proto3_optional}}),a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){o.decorateType(t.constructor).add(new a(n,e)),Object.defineProperty(t,n,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},1408:(e,t,n)=>{"use strict";e.exports=c;var r,i=n(9693),o=i.LongBits,a=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,d="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):d(e)})(e)}:d};function p(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw s(this,8);return new o(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var r=i.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=u(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return p.call(this)[t](!1)},uint64:function(){return p.call(this)[t](!0)},sint64:function(){return p.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},593:(e,t,n)=>{"use strict";e.exports=o;var r=n(1408);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(9693);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},9424:(e,t,n)=>{"use strict";e.exports=u;var r=n(9313);((u.prototype=Object.create(r.prototype)).constructor=u).className="Root";var i,o,a,s=n(3548),c=n(7025),l=n(7598),d=n(9935);function u(e){r.call(this,"",e),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function p(){}u.fromJSON=function(e,t){return t||(t=new u),e.options&&t.setOptions(e.options),t.addJSON(e.nested).resolveAll()},u.prototype.resolvePath=d.path.resolve,u.prototype.fetch=d.fetch,u.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=void 0);var i=this;if(!r)return d.asPromise(e,i,t,n);var s=r===p;function c(e,t){if(r){if(s)throw e;t&&t.resolveAll();var n=r;r=null,n(e,t)}}function l(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in a)return n}return null}function u(e,t){try{if(d.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),d.isString(t)){o.filename=e;var r,a=o(t,i,n),u=0;if(a.imports)for(;u<a.imports.length;++u)(r=l(a.imports[u])||i.resolvePath(e,a.imports[u]))&&h(r);if(a.weakImports)for(u=0;u<a.weakImports.length;++u)(r=l(a.weakImports[u])||i.resolvePath(e,a.weakImports[u]))&&h(r,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}s||f||c(null,i)}function h(e,t){if(e=l(e)||e,!(i.files.indexOf(e)>-1))if(i.files.push(e),e in a)s?u(e,a[e]):(++f,setTimeout((function(){--f,u(e,a[e])})));else if(s){var n;try{n=d.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}u(e,n)}else++f,i.fetch(e,(function(n,o){--f,r&&(n?t?f||c(null,i):c(n):u(e,o))}))}var f=0;d.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=i.resolvePath("",t[g]))&&h(m);return s?(i.resolveAll(),i):(f||c(null,i),i)},u.prototype.loadSync=function(e,t){if(!d.isNode)throw Error("not supported");return this.load(e,t,p)},u.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var h=/^[A-Z]/;function f(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new s(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.get(r.name)||(r.declaringField=t,t.extensionField=r,n.add(r)),!0}return!1}u.prototype._handleAdd=function(e){if(e instanceof s)void 0===e.extend||e.extensionField||f(0,e)||this.deferred.push(e);else if(e instanceof c)h.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof i)for(var t=0;t<this.deferred.length;)f(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);h.test(e.name)&&(e.parent[e.name]=e)}(e instanceof i||e instanceof c||e instanceof s)&&(this._fullyQualifiedObjects[e.fullName]=e)},u.prototype._handleRemove=function(e){if(e instanceof s){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)h.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);h.test(e.name)&&delete e.parent[e.name]}delete this._fullyQualifiedObjects[e.fullName]},u._configure=function(e,t,n){i=e,o=t,a=n}},5054:e=>{"use strict";e.exports={}},5994:(e,t,n)=>{"use strict";t.Service=n(7948)},7948:(e,t,n)=>{"use strict";e.exports=i;var r=n(9693);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},7513:(e,t,n)=>{"use strict";e.exports=s;var r=n(9313);((s.prototype=Object.create(r.prototype)).constructor=s).className="Service";var i=n(4429),o=n(9935),a=n(5994);function s(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var n=new s(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),o=0;o<r.length;++o)n.add(i.fromJSON(r[o],t.methods[r[o]]));return t.nested&&n.addJSON(t.nested),t.edition&&(n._edition=t.edition),n.comment=t.comment,n._defaultEdition="proto3",n},s.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return o.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},s.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;r.prototype.resolve.call(this);for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return this},s.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,r.prototype._resolveFeaturesRecursive.call(this,e),this.methodsArray.forEach((t=>{t._resolveFeaturesRecursive(e)})),this):this},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,c(this)):r.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return r.prototype.remove.call(this,e)},s.prototype.create=function(e,t,n){for(var r,i=new a.Service(e,t,n),s=0;s<this.methodsArray.length;++s){var c=o.lcFirst((r=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return i}},7645:(e,t,n)=>{"use strict";e.exports=_;var r=n(9313);((_.prototype=Object.create(r.prototype)).constructor=_).className="Type";var i=n(7025),o=n(7598),a=n(3548),s=n(6039),c=n(7513),l=n(8368),d=n(1408),u=n(1173),p=n(9935),h=n(4928),f=n(5305),m=n(4497),g=n(3996),v=n(1667);function _(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function y(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(_.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=p.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=p.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=_.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,p.merge(e.prototype,t)),e.$type=e.prototype.$type=this,p.merge(e,l,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:p.oneOfGetter(this._oneofsArray[n].oneof),set:p.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),_.generateConstructor=function(e){for(var t,n=p.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n("this%s={}",p.safeProp(t.name)):t.repeated&&n("this%s=[]",p.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},_.fromJSON=function(e,t){var n=new _(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var l=Object.keys(t.fields),d=0;d<l.length;++d)n.add((void 0!==t.fields[l[d]].keyType?s.fromJSON:a.fromJSON)(l[d],t.fields[l[d]]));if(t.oneofs)for(l=Object.keys(t.oneofs),d=0;d<l.length;++d)n.add(o.fromJSON(l[d],t.oneofs[l[d]]));if(t.nested)for(l=Object.keys(t.nested),d=0;d<l.length;++d){var u=t.nested[l[d]];n.add((void 0!==u.id?a.fromJSON:void 0!==u.fields?_.fromJSON:void 0!==u.values?i.fromJSON:void 0!==u.methods?c.fromJSON:r.fromJSON)(l[d],u))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),t.edition&&(n._edition=t.edition),n._defaultEdition="proto3",n},_.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return p.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},_.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;r.prototype.resolveAll.call(this);var e=this.oneofsArray;for(n=0;n<e.length;)e[n++].resolve();for(var t=this.fieldsArray,n=0;n<t.length;)t[n++].resolve();return this},_.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,r.prototype._resolveFeaturesRecursive.call(this,e),this.oneofsArray.forEach((t=>{t._resolveFeatures(e)})),this.fieldsArray.forEach((t=>{t._resolveFeatures(e)})),this):this},_.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},_.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),y(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),y(this)):r.prototype.add.call(this,e)},_.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),y(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),y(this)}return r.prototype.remove.call(this,e)},_.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},_.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},_.prototype.create=function(e){return new this.ctor(e)},_.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=h(this)({Writer:u,types:t,util:p}),this.decode=f(this)({Reader:d,types:t,util:p}),this.verify=m(this)({types:t,util:p}),this.fromObject=g.fromObject(this)({types:t,util:p}),this.toObject=g.toObject(this)({types:t,util:p});var r=v[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},_.prototype.encode=function(e,t){return this.setup().encode(e,t)},_.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},_.prototype.decode=function(e,t){return this.setup().decode(e,t)},_.prototype.decodeDelimited=function(e){return e instanceof d||(e=d.create(e)),this.decode(e,e.uint32())},_.prototype.verify=function(e){return this.setup().verify(e)},_.prototype.fromObject=function(e){return this.setup().fromObject(e)},_.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},_.d=function(e){return function(t){p.decorateType(t,e)}}},7063:(e,t,n)=>{"use strict";var r=t,i=n(9935),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var n=0,r={};for(t|=0;n<e.length;)r[o[n+t]]=e[n++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},9935:(e,t,n)=>{"use strict";var r,i,o=e.exports=n(9693),a=n(5054);o.codegen=n(5124),o.fetch=n(9054),o.path=n(8626),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},o.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];void 0!==i&&(t[r]=i)}return t};var s=/\\/g,c=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(s,"\\\\").replace(c,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;r||(r=n(7645));var i=new r(t||e.name);return o.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var d=0;o.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=n(7025));var t=new i("Enum"+d++,e);return o.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},o.setProperty=function(e,t,n,r){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,n,i){var o=n.shift();if("__proto__"===o||"prototype"===o)return t;if(n.length>0)t[o]=e(t[o]||{},n,i);else{var a=t[o];if(a&&r)return t;a&&(i=[].concat(a).concat(i)),t[o]=i}return t}(e,t=t.split("."),n)},Object.defineProperty(o,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(n(9424)))}})},1945:(e,t,n)=>{"use strict";e.exports=i;var r=n(9693);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?o:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},9693:function(e,t,n){"use strict";var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=n(4537),r.base64=n(7419),r.EventEmitter=n(9211),r.float=n(945),r.inquire=n(7199),r.utf8=n(4997),r.pool=n(6662),r.LongBits=n(1945),r.isNode=Boolean(void 0!==n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},4497:(e,t,n)=>{"use strict";e.exports=function(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n=e.oneofsArray,r={};n.length&&t("var p={}");for(var c=0;c<e.fieldsArray.length;++c){var l=e._fieldsArray[c].resolve(),d="m"+i.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",d,l.name),l.map)t("if(!util.isObject(%s))",d)("return%j",o(l,"object"))("var k=Object.keys(%s)",d)("for(var i=0;i<k.length;++i){"),s(t,l,"k[i]"),a(t,l,c,d+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",d)("return%j",o(l,"array"))("for(var i=0;i<%s.length;++i){",d),a(t,l,c,d+"[i]")("}");else{if(l.partOf){var u=i.safeProp(l.partOf.name);1===r[l.partOf.name]&&t("if(p%s===1)",u)("return%j",l.partOf.name+": multiple values"),r[l.partOf.name]=1,t("p%s=1",u)}a(t,l,c,d)}l.optional&&t("}")}return t("return null")};var r=n(7025),i=n(9935);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,i){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",i)("default:")("return%j",o(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),s=0;s<a.length;++s)e("case %i:",t.resolvedType.values[a[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",o(t,"buffer"))}return e}function s(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",o(t,"boolean key"))}return e}},1667:(e,t,n)=>{"use strict";var r=t,i=n(8368);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var r="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(r);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var a=e.$type.toObject(e,t);return""===n&&(n="type.googleapis.com/"),r=n+("."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName),a["@type"]=r,a}return this.toObject(e,t)}}},1173:(e,t,n)=>{"use strict";e.exports=u;var r,i=n(9693),o=i.LongBits,a=i.base64,s=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function d(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var p=function(){return i.Buffer?function(){return(u.create=function(){return new r})()}:function(){return new u}};function h(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}u.create=p(),u.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(u.alloc=i.pool(u.alloc,i.Array.prototype.subarray)),u.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},u.prototype.bool=function(e){return this._push(h,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(i.isString(e)){var n=u.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},u.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(h,1,0)},u.prototype.fork=function(){return this.states=new d(this),this.head=this.tail=new c(l,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},u._configure=function(e){r=e,u.create=p(),r._configure()}},3155:(e,t,n)=>{"use strict";e.exports=o;var r=n(1173);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(9693);function o(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},3379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},a=[],s=0;s<e.length;s++){var c=e[s],l=r.base?c[0]+r.base:c[0],d=o[l]||0,u="".concat(l," ").concat(d);o[l]=d+1;var p=n(u),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=i(h,r);r.byIndex=s,t.splice(s,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function i(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var s=n(o[a]);t[s].references--}for(var c=r(e,i),l=0;l<o.length;l++){var d=n(o[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=c}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8090:e=>{"use strict";e.exports="data:image/svg+xml;charset=UTF-8, %3csvg stroke=%27%23fff%27 fill=%27none%27 stroke-width=%271.5%27 viewBox=%270 0 24 24%27 aria-hidden=%27true%27 height=%2728%27 width=%2728%27 xmlns=%27http://www.w3.org/2000/svg%27 %3e%3cpath stroke-linecap=%27round%27 d=%27M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z%27 %3e%3c/path%3e%3c/svg%3e"},1568:e=>{"use strict";e.exports="data:image/svg+xml;charset=UTF-8, %3csvg width=%2728%27 height=%2728%27 viewBox=%272 2 16 16%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27 %3e%3cpath d=%27M6.98706 2.06589L6.27036 2.28192C4.96684 2.67484 4.00944 3.78801 3.81598 5.13565C3.519 7.20438 4.18323 9.62242 5.78368 12.3945C7.38077 15.1607 9.13867 16.9433 11.0739 17.7231C12.3435 18.2346 13.7948 17.9592 14.7886 17.018L15.3314 16.5039C16.0589 15.815 16.1643 14.694 15.5781 13.8815L14.2215 12.0014C13.8458 11.4807 13.1805 11.2569 12.5665 11.4446L10.5158 12.0716L10.4628 12.082C10.2366 12.115 9.7154 11.6259 9.06527 10.4999C8.38512 9.32181 8.24417 8.63298 8.43194 8.45541L9.47529 7.48248C10.2572 6.75332 10.4882 5.60728 10.0499 4.63213L9.38841 3.16075C8.97652 2.24451 7.94888 1.77597 6.98706 2.06589ZM8.47634 3.57077L9.13779 5.04215C9.40063 5.62682 9.26212 6.31395 8.7933 6.75113L7.74739 7.72645C7.0783 8.35918 7.29992 9.44218 8.19924 10.9999C9.04545 12.4655 9.81744 13.1898 10.6469 13.0642L10.7713 13.0376L12.8589 12.4009C13.0635 12.3383 13.2853 12.413 13.4105 12.5865L14.7671 14.4666C15.0603 14.8729 15.0076 15.4334 14.6438 15.7778L14.101 16.2919C13.3911 16.9642 12.3545 17.1609 11.4476 16.7955C9.74957 16.1113 8.14475 14.484 6.64971 11.8945C5.15161 9.29969 4.54531 7.09254 4.80583 5.27775C4.94402 4.31515 5.62787 3.52003 6.55896 3.23937L7.27566 3.02334C7.75657 2.87838 8.27039 3.11265 8.47634 3.57077Z%27 fill=%27%23fff%27 %3e%3c/path%3e%3c/svg%3e"}},__webpack_module_cache__={},inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>e+".widget.js",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="webpack-starter:",__webpack_require__.l=(e,t,n,r)=>{if(inProgress[e])inProgress[e].push(t);else{var i,o;if(void 0!==n)for(var a=document.getElementsByTagName("script"),s=0;s<a.length;s++){var c=a[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==dataWebpackPrefix+n){i=c;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.setAttribute("data-webpack",dataWebpackPrefix+n),i.src=e),inProgress[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(d);var r=inProgress[e];if(delete inProgress[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(n))),t)return t(n)},d=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),o&&document.head.appendChild(i)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={179:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),a=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",a.name="ChunkLoadError",a.type=i,a.request=o,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,[o,a,s]=n,c=0;if(o.some((t=>0!==e[t]))){for(r in a)__webpack_require__.o(a,r)&&(__webpack_require__.m[r]=a[r]);if(s)s(__webpack_require__)}for(t&&t(n);c<o.length;c++)i=o[c],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkwebpack_starter=self.webpackChunkwebpack_starter||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),__webpack_require__.nc=void 0;var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__);var e={};__webpack_require__.r(e),__webpack_require__.d(e,{Decoder:()=>rY,Encoder:()=>tY,PacketType:()=>eY,protocol:()=>$K});var t="https://sources.saleassist.ai",n={saleassist:"#3684F2",primary:"#545cd8",secondary:"#6c757d",success:"#4BBF73",info:"#1F9BCF",warning:"#f0ad4e",danger:"#d9534f",focus:"#444054",alternate:"#83588a",light:"#f8f9fa",dark:"#495057",white:"#fff",text:"#6d6d6d",title:"#1f1f1f"},r={BASE:t,SOCKET_URL:"https://sockets.saleassist.ai",BILLING:t+"/billing",CLIENT_USER_MAPPINGS:t+"/client_user_mappings",CLIENTS:t+"/clients",CONSUMPTION_LOGS:t+"/consumption_logs",CONVERSATIONS:t+"/conversations",EVENTS:t+"/events",FORMS:t+"/forms",FORM:t+"/form",SOURCES:t+"/sources",SOURCE:t+"/source",EVENT:"https://sources.saleassist.ai",MEETING_TOKENS:t+"/meeting_tokens",MEETINGS:t+"/meetings",MISSED_CALLS:t+"/missed_calls",PAYMENT_PLANS:t+"/payment_plans",PAYMENTS:t+"/payments",STORAGE:t+"/storage",MEDIA:t+"/media",USERS:t+"/users",WEBHOOKS:t+"/webhooks",ACTIONS:t+"/actions",STRIKE_SOCKET:"https://strike-sockets.saleassist.ai"},i={nudge:"nudge",icon:"icon",video_icon:"video_icon",shoppable_video:"shoppable_video",share_button:"share_button",video_call_button:"video_call_button",audio_call_button:"audio_call_button",video_message_button:"video_message_button",voice_message_button:"voice_message_button",text_message_button:"text_message_button",ai_chat_button:"ai_chat_button",live_message_button:"live_message_button",whatsapp_message_button:"whatsapp_message_button",live_chat_button:"live_chat_button",schedule_meeting_button:"schedule_meeting_button",close_window:"close_window",call_to_action_link:"call_to_action_link",audio_feedback_button:"audio_feedback_button",video_feedback_button:"video_feedback_button",text_feedback_button:"text_feedback_button",form_feedback_button:"form_feedback_button",sound_alert_on:!0,widget_close_btn_sound_on:!0},o={url:r,clicked_on:i,colors:n,razorpay_key_id:t.startsWith("http://localhost:")?"rzp_test_6qMDYgeHkcDSNX":"rzp_live_lRWsGAT43CwVBu",razorpay_key_secret:"ktpf01IfB8d4PBBLYkXYDlpN"};function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(){s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var o=t&&t.prototype instanceof f?t:f,a=Object.create(o.prototype),s=new O(i||[]);return r(a,"_invoke",{value:S(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h={};function f(){}function m(){}function g(){}var v={};d(v,o,(function(){return this}));var _=Object.getPrototypeOf,y=_&&_(_(I([])));y&&y!==t&&n.call(y,o)&&(v=y);var w=g.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function i(r,o,s,c){var l=p(e[r],e,o);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==a(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,s,c)}),(function(e){i("throw",e,s,c)})):t.resolve(u).then((function(e){d.value=e,s(d)}),(function(e){return i("throw",e,s,c)}))}c(l.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function S(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function T(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=p(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function I(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return m.prototype=g,r(w,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:m,configurable:!0}),m.displayName=d(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(E.prototype),d(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new E(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(w),d(w,l,"Generator"),d(w,o,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function c(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var l={get:function(e,t){return d.apply(this,arguments)},post:function(e,t,n){return new Promise((function(r,i){var o=e+t,a={method:"POST",headers:{"Content-Type":"application/json",referrer:window.location.href},body:JSON.stringify(n)};fetch(o,a).then(u).then((function(e){return r(e)})).catch((function(e){return i(e)}))}))}};function d(){return d=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){c(o,r,i,a,s,"next",e)}function s(e){c(o,r,i,a,s,"throw",e)}a(void 0)}))}}(s().mark((function e(t,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var i=t+n,o={method:"GET",headers:{referrer:window.location.href}};fetch(i,o).then(u).then((function(t){return e(t)})).catch((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function u(e){return e.text().then((function(t){var n=t&&JSON.parse(t);if(!e.ok){var r=n&&(n.message||n.detail)||e.statusText;return Promise.reject(r)}return n}))}var p=__webpack_require__(3379),h=__webpack_require__.n(p),f=__webpack_require__(7795),m=__webpack_require__.n(f),g=__webpack_require__(569),v=__webpack_require__.n(g),_=__webpack_require__(3565),y=__webpack_require__.n(_),w=__webpack_require__(9216),b=__webpack_require__.n(w),E=__webpack_require__(4589),S=__webpack_require__.n(E),T=__webpack_require__(7892),C={};C.styleTagTransform=S(),C.setAttributes=y(),C.insert=v().bind(null,"head"),C.domAPI=m(),C.insertStyleElement=b();h()(T.Z,C);T.Z&&T.Z.locals&&T.Z.locals;function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}var O=function(e){return"object"===R(e)&&null!==e&&!Array.isArray(e)};function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===I(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L={},N={},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O(e)?L=k(k({},L),e):console.error("Data is not an object.")},D=function(){return L},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O(e)?N=k(k({},N),e):console.error("Data is not an object.")},U=function(){return N},j=function(e){return e?(e=e.replace(/_([a-z])/g,(function(e){return" "+e[1].toUpperCase()})),e.charAt(0).toUpperCase()+e.slice(1)):e},V=function(e){return e.replace(/ /g,"_")},B=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{var i,o=new Date;i="user_data_e3c419fb-5fa7-446c-b5f4-85f731e25997"===e||"form_data_e3c419fb-5fa7-446c-b5f4-85f731e25997"===e?12e4:1e3*n*60*(r?1:60);var a={value:t,expiry:o.getTime()+i};return window.localStorage.setItem(e,JSON.stringify(a)),t}catch(e){return null}},F=function(e){try{var t=window.localStorage.getItem(e);if(!t)return null;var n=JSON.parse(t);return(new Date).getTime()>n.expiry?(window.localStorage.removeItem(e),null):n.value}catch(e){return null}},G=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))};const H=[{name:"Afghanistan",code:"AF",dial_code:"+93"},{name:"Albania",code:"AL",dial_code:"+355"},{name:"Algeria",code:"DZ",dial_code:"+213"},{name:"Andorra",code:"AD",dial_code:"+376"},{name:"Angola",code:"AO",dial_code:"+244"},{name:"Antigua and Barbuda",code:"AG",dial_code:"+1268"},{name:"Argentina",code:"AR",dial_code:"+54"},{name:"Armenia",code:"AM",dial_code:"+374"},{name:"Aruba",code:"AW",dial_code:"+297"},{name:"Australia",code:"AU",dial_code:"+61"},{name:"Austria",code:"AT",dial_code:"+43"},{name:"Azerbaijan",code:"AZ",dial_code:"+994"},{name:"Bahamas",code:"BS",dial_code:"+1242"},{name:"Bahrain",code:"BH",dial_code:"+973"},{name:"Bangladesh",code:"BD",dial_code:"+880"},{name:"Barbados",code:"BB",dial_code:"+1246"},{name:"Belarus",code:"BY",dial_code:"+375"},{name:"Belgium",code:"BE",dial_code:"+32"},{name:"Belize",code:"BZ",dial_code:"+501"},{name:"Benin",code:"BJ",dial_code:"+229"},{name:"Bhutan",code:"BT",dial_code:"+975"},{name:"Bolivia",code:"BO",dial_code:"+591"},{name:"Bosnia and Herzegovina",code:"BA",dial_code:"+387"},{name:"Botswana",code:"BW",dial_code:"+267"},{name:"Brazil",code:"BR",dial_code:"+55"},{name:"British Indian Ocean Territory",code:"IO",dial_code:"+246"},{name:"Brunei",code:"BN",dial_code:"+673"},{name:"Bulgaria",code:"BG",dial_code:"+359"},{name:"Burkina Faso",code:"BF",dial_code:"+226"},{name:"Burundi",code:"BI",dial_code:"+257"},{name:"Cambodia",code:"KH",dial_code:"+855"},{name:"Cameroon",code:"CM",dial_code:"+237"},{name:"Canada",code:"CA",dial_code:"+1"},{name:"Cape Verde",code:"CV",dial_code:"+238"},{name:"Cayman Islands",code:"KY",dial_code:"+345"},{name:"Central African Republic",code:"CF",dial_code:"+236"},{name:"Chad",code:"TD",dial_code:"+235"},{name:"Chile",code:"CL",dial_code:"+56"},{name:"China",code:"CN",dial_code:"+86"},{name:"Colombia",code:"CO",dial_code:"+57"},{name:"Comoros",code:"KM",dial_code:"+269"},{name:"Congo",code:"CG",dial_code:"+242"},{name:"Congo, The Democratic Republic of the Congo",code:"CD",dial_code:"+243"},{name:"Cote d'Ivoire",code:"CI",dial_code:"+225"},{name:"Croatia",code:"HR",dial_code:"+385"},{name:"Cuba",code:"CU",dial_code:"+53"},{name:"Cyprus",code:"CY",dial_code:"+357"},{name:"Czech Republic",code:"CZ",dial_code:"+420"},{name:"Denmark",code:"DK",dial_code:"+45"},{name:"Djibouti",code:"DJ",dial_code:"+253"},{name:"Dominica",code:"DM",dial_code:"+1767"},{name:"Dominican Republic",code:"DO",dial_code:"+1849"},{name:"Ecuador",code:"EC",dial_code:"+593"},{name:"Egypt",code:"EG",dial_code:"+20"},{name:"El Salvador",code:"SV",dial_code:"+503"},{name:"Equatorial Guinea",code:"GQ",dial_code:"+240"},{name:"Eritrea",code:"ER",dial_code:"+291"},{name:"Estonia",code:"EE",dial_code:"+372"},{name:"Ethiopia",code:"ET",dial_code:"+251"},{name:"Falkland Islands (Malvinas)",code:"FK",dial_code:"+500"},{name:"Faroe Islands",code:"FO",dial_code:"+298"},{name:"Fiji",code:"FJ",dial_code:"+679"},{name:"Finland",code:"FI",dial_code:"+358"},{name:"France",code:"FR",dial_code:"+33"},{name:"French Guiana",code:"GF",dial_code:"+594"},{name:"French Polynesia",code:"PF",dial_code:"+689"},{name:"French Southern Territories",code:"TF",dial_code:"+262"},{name:"Gabon",code:"GA",dial_code:"+241"},{name:"Gambia",code:"GM",dial_code:"+220"},{name:"Georgia",code:"GE",dial_code:"+995"},{name:"Germany",code:"DE",dial_code:"+49"},{name:"Ghana",code:"GH",dial_code:"+233"},{name:"Gibraltar",code:"GI",dial_code:"+350"},{name:"Greece",code:"GR",dial_code:"+30"},{name:"Greenland",code:"GL",dial_code:"+299"},{name:"Grenada",code:"GD",dial_code:"+1473"},{name:"Guadeloupe",code:"GP",dial_code:"+590"},{name:"Guam",code:"GU",dial_code:"+1671"},{name:"Guatemala",code:"GT",dial_code:"+502"},{name:"Guinea",code:"GN",dial_code:"+224"},{name:"Guinea-Bissau",code:"GW",dial_code:"+245"},{name:"Guyana",code:"GY",dial_code:"+592"},{name:"Haiti",code:"HT",dial_code:"+509"},{name:"Heard Island and Mcdonald Islands",code:"HM",dial_code:"+672"},{name:"Hong Kong",code:"HK",dial_code:"+852"},{name:"Hungary",code:"HU",dial_code:"+36"},{name:"Iceland",code:"IS",dial_code:"+354"},{name:"India",code:"IN",dial_code:"+91"},{name:"Indonesia",code:"ID",dial_code:"+62"},{name:"Iran, Islamic Republic of Persian Gulf",code:"IR",dial_code:"+98"},{name:"Iraq",code:"IQ",dial_code:"+964"},{name:"Ireland",code:"IE",dial_code:"+353"},{name:"Isle of Man",code:"IM",dial_code:"+44"},{name:"Israel",code:"IL",dial_code:"+972"},{name:"Italy",code:"IT",dial_code:"+39"},{name:"Jamaica",code:"JM",dial_code:"+1876"},{name:"Japan",code:"JP",dial_code:"+81"},{name:"Jordan",code:"JO",dial_code:"+962"},{name:"Kazakhstan",code:"KZ",dial_code:"+7"},{name:"Kenya",code:"KE",dial_code:"+254"},{name:"Kiribati",code:"KI",dial_code:"+686"},{name:"Korea, Democratic People's Republic of Korea",code:"KP",dial_code:"+850"},{name:"Korea, Republic of South Korea",code:"KR",dial_code:"+82"},{name:"Kosovo",code:"XK",dial_code:"+383"},{name:"Kuwait",code:"KW",dial_code:"+965"},{name:"Kyrgyzstan",code:"KG",dial_code:"+996"},{name:"Laos",code:"LA",dial_code:"+856"},{name:"Latvia",code:"LV",dial_code:"+371"},{name:"Lebanon",code:"LB",dial_code:"+961"},{name:"Lesotho",code:"LS",dial_code:"+266"},{name:"Liberia",code:"LR",dial_code:"+231"},{name:"Libyan Arab Jamahiriya",code:"LY",dial_code:"+218"},{name:"Liechtenstein",code:"LI",dial_code:"+423"},{name:"Lithuania",code:"LT",dial_code:"+370"},{name:"Luxembourg",code:"LU",dial_code:"+352"},{name:"Macao",code:"MO",dial_code:"+853"},{name:"Macedonia",code:"MK",dial_code:"+389"},{name:"Madagascar",code:"MG",dial_code:"+261"},{name:"Malawi",code:"MW",dial_code:"+265"},{name:"Malaysia",code:"MY",dial_code:"+60"},{name:"Maldives",code:"MV",dial_code:"+960"},{name:"Mali",code:"ML",dial_code:"+223"},{name:"Malta",code:"MT",dial_code:"+356"},{name:"Marshall Islands",code:"MH",dial_code:"+692"},{name:"Martinique",code:"MQ",dial_code:"+596"},{name:"Mauritania",code:"MR",dial_code:"+222"},{name:"Mauritius",code:"MU",dial_code:"+230"},{name:"Mexico",code:"MX",dial_code:"+52"},{name:"Moldova",code:"MD",dial_code:"+373"},{name:"Monaco",code:"MC",dial_code:"+377"},{name:"Mongolia",code:"MN",dial_code:"+976"},{name:"Montenegro",code:"ME",dial_code:"+382"},{name:"Montserrat",code:"MS",dial_code:"+1664"},{name:"Morocco",code:"MA",dial_code:"+212"},{name:"Mozambique",code:"MZ",dial_code:"+258"},{name:"Myanmar",code:"MM",dial_code:"+95"},{name:"Namibia",code:"NA",dial_code:"+264"},{name:"Nauru",code:"NR",dial_code:"+674"},{name:"Nepal",code:"NP",dial_code:"+977"},{name:"Netherlands",code:"NL",dial_code:"+31"},{name:"New Zealand",code:"NZ",dial_code:"+64"},{name:"Nicaragua",code:"NI",dial_code:"+505"},{name:"Niger",code:"NE",dial_code:"+227"},{name:"Nigeria",code:"NG",dial_code:"+234"},{name:"Niue",code:"NU",dial_code:"+683"},{name:"Norfolk Island",code:"NF",dial_code:"+672"},{name:"Norway",code:"NO",dial_code:"+47"},{name:"Oman",code:"OM",dial_code:"+968"},{name:"Pakistan",code:"PK",dial_code:"+92"},{name:"Palau",code:"PW",dial_code:"+680"},{name:"Palestinian Territory, Occupied",code:"PS",dial_code:"+970"},{name:"Panama",code:"PA",dial_code:"+507"},{name:"Papua New Guinea",code:"PG",dial_code:"+675"},{name:"Paraguay",code:"PY",dial_code:"+595"},{name:"Peru",code:"PE",dial_code:"+51"},{name:"Philippines",code:"PH",dial_code:"+63"},{name:"Pitcairn",code:"PN",dial_code:"+64"},{name:"Poland",code:"PL",dial_code:"+48"},{name:"Portugal",code:"PT",dial_code:"+351"},{name:"Puerto Rico",code:"PR",dial_code:"+1939"},{name:"Qatar",code:"QA",dial_code:"+974"},{name:"Romania",code:"RO",dial_code:"+40"},{name:"Russia",code:"RU",dial_code:"+7"},{name:"Rwanda",code:"RW",dial_code:"+250"},{name:"Reunion",code:"RE",dial_code:"+262"},{name:"Saint Barthelemy",code:"BL",dial_code:"+590"},{name:"Saint Helena, Ascension and Tristan Da Cunha",code:"SH",dial_code:"+290"},{name:"San Marino",code:"SM",dial_code:"+378"},{name:"Sao Tome and Principe",code:"ST",dial_code:"+239"},{name:"Saudi Arabia",code:"SA",dial_code:"+966"},{name:"Senegal",code:"SN",dial_code:"+221"},{name:"Seychelles",code:"SC",dial_code:"+248"},{name:"Sierra Leone",code:"SL",dial_code:"+232"},{name:"Singapore",code:"SG",dial_code:"+65"},{name:"Slovakia",code:"SK",dial_code:"+421"},{name:"Slovenia",code:"SI",dial_code:"+386"},{name:"Solomon Islands",code:"SB",dial_code:"+677"},{name:"Somalia",code:"SO",dial_code:"+252"},{name:"South Africa",code:"ZA",dial_code:"+27"},{name:"South Sudan",code:"SS",dial_code:"+211"},{name:"South Georgia and the South Sandwich Islands",code:"GS",dial_code:"+500"},{name:"Sudan",code:"SD",dial_code:"+249"},{name:"Suriname",code:"SR",dial_code:"+597"},{name:"Svalbard and Jan Mayen",code:"SJ",dial_code:"+47"},{name:"Swaziland",code:"SZ",dial_code:"+268"},{name:"Sweden",code:"SE",dial_code:"+46"},{name:"Syrian Arab Republic",code:"SY",dial_code:"+963"},{name:"Taiwan",code:"TW",dial_code:"+886"},{name:"Tajikistan",code:"TJ",dial_code:"+992"},{name:"Tanzania, United Republic of Tanzania",code:"TZ",dial_code:"+255"},{name:"Thailand",code:"TH",dial_code:"+66"},{name:"Timor-Leste",code:"TL",dial_code:"+670"},{name:"Togo",code:"TG",dial_code:"+228"},{name:"Tokelau",code:"TK",dial_code:"+690"},{name:"Tonga",code:"TO",dial_code:"+676"},{name:"Trinidad and Tobago",code:"TT",dial_code:"+1868"},{name:"Tunisia",code:"TN",dial_code:"+216"},{name:"Turkey",code:"TR",dial_code:"+90"},{name:"Turkmenistan",code:"TM",dial_code:"+993"},{name:"Turks and Caicos Islands",code:"TC",dial_code:"+1649"},{name:"Tuvalu",code:"TV",dial_code:"+688"},{name:"Uganda",code:"UG",dial_code:"+256"},{name:"Ukraine",code:"UA",dial_code:"+380"},{name:"United Arab Emirates",code:"AE",dial_code:"+971"},{name:"United Kingdom",code:"GB",dial_code:"+44"},{name:"United States",code:"US",dial_code:"+1"},{name:"Uruguay",code:"UY",dial_code:"+598"},{name:"Uzbekistan",code:"UZ",dial_code:"+998"},{name:"Vanuatu",code:"VU",dial_code:"+678"},{name:"Venezuela, Bolivarian Republic of Venezuela",code:"VE",dial_code:"+58"},{name:"Vietnam",code:"VN",dial_code:"+84"},{name:"Virgin Islands, British",code:"VG",dial_code:"+1284"},{name:"Virgin Islands, U.S.",code:"VI",dial_code:"+1340"},{name:"Wallis and Futuna",code:"WF",dial_code:"+681"},{name:"Zimbabwe",code:"ZW",dial_code:"+263"}];var q=function(e){var t="",n="";H.forEach((function(e){n+="<li\n      data-country-code=".concat(e.code,"\n      data-country-dial-code=").concat(e.dial_code,'\n      class="sa-live-call-widget-country"\n    >\n      ').concat(e.name," ").concat(e.dial_code,"\n    </li>")}));var r=function(e){return"mobile_number"===e.name?'<div\n          class="sa-live-call-widget-mobile-number-input-wrapper"\n        >\n          <div class="sa-live-call-widget-selected-country-wrapper">\n            <p class="sa-live-call-widget-selected-country">+91</p>\n            <div class="sa-live-call-widget-select-country-arrow"></div>\n          </div>\n          <div class="sa-live-call-widget-mobile-number-input-box">\n          <svg width="16px" height="16px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M21.97 18.33C21.97 18.69 21.89 19.06 21.72 19.42C21.55 19.78 21.33 20.12 21.04 20.44C20.55 20.98 20.01 21.37 19.4 21.62C18.8 21.87 18.15 22 17.45 22C16.43 22 15.34 21.76 14.19 21.27C13.04 20.78 11.89 20.12 10.75 19.29C9.6 18.45 8.51 17.52 7.47 16.49C6.44 15.45 5.51 14.36 4.68 13.22C3.86 12.08 3.2 10.94 2.72 9.81C2.24 8.67 2 7.58 2 6.54C2 5.86 2.12 5.21 2.36 4.61C2.6 4 2.98 3.44 3.51 2.94C4.15 2.31 4.85 2 5.59 2C5.87 2 6.15 2.06 6.4 2.18C6.66 2.3 6.89 2.48 7.07 2.74L9.39 6.01C9.57 6.26 9.7 6.49 9.79 6.71C9.88 6.92 9.93 7.13 9.93 7.32C9.93 7.56 9.86 7.8 9.72 8.03C9.59 8.26 9.4 8.5 9.16 8.74L8.4 9.53C8.29 9.64 8.24 9.77 8.24 9.93C8.24 10.01 8.25 10.08 8.27 10.16C8.3 10.24 8.33 10.3 8.35 10.36C8.53 10.69 8.84 11.12 9.28 11.64C9.73 12.16 10.21 12.69 10.73 13.22C11.27 13.75 11.79 14.24 12.32 14.69C12.84 15.13 13.27 15.43 13.61 15.61C13.66 15.63 13.72 15.66 13.79 15.69C13.87 15.72 13.95 15.73 14.04 15.73C14.21 15.73 14.34 15.67 14.45 15.56L15.21 14.81C15.46 14.56 15.7 14.37 15.93 14.25C16.16 14.11 16.39 14.04 16.64 14.04C16.83 14.04 17.03 14.08 17.25 14.17C17.47 14.26 17.7 14.39 17.95 14.56L21.26 16.91C21.52 17.09 21.7 17.3 21.81 17.55C21.91 17.8 21.97 18.05 21.97 18.33Z" stroke-width="1.5" stroke-miterlimit="10"/>\n          </svg>\n          <input\n            type="number"\n            id="'.concat(e.name,'"\n            name="').concat(e.name,'"\n            value="').concat(e.value||"",'"\n            placeholder="').concat(e.placeholder?e.placeholder:"",'"\n            ').concat(e.required?" required ":" ",'\n            class="sa-live-call-widget-lead-capture-form-field sa-live-call-widget-mobile-number-input"\n          />\n        </div>\n        </div>\n        <ul\n          class="sa-live-call-widget-country-list sa-live-call-widget-d-hidden"\n        >\n          ').concat(n,"\n        </ul> "):"name"===e.name?'<div\n          class="sa-live-call-widget-lead-capture-form-field-box-group"\n        >\n          <svg width="16px" height="16px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n          <title/><g id="Complete"><g id="user"><g>\n            <path d="M20,21V19a4,4,0,0,0-4-4H8a4,4,0,0,0-4,4v2" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>\n            <circle cx="12" cy="7" fill="none" r="4" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></g></g></g></svg>\n          <input\n              type="'.concat(e.subtype?e.subtype:e.type,'"\n              id="').concat(e.name,'"\n              name="').concat(e.name,'"\n              value="').concat(e.value||"",'"\n              maxlength="').concat(e.maxlength||"",'"\n              placeholder="').concat(e.placeholder?e.placeholder:"",'"\n              ').concat(e.required?" required ":" ",'\n              class="sa-live-call-widget-lead-capture-form-field"\n              }\n            />\n        </div> '):"email"===e.type||"email"===e.subtype?'<div\n          class="sa-live-call-widget-lead-capture-form-field-box-group"\n        >\n          <svg width="16px" height="16px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M4 7.00005L10.2 11.65C11.2667 12.45 12.7333 12.45 13.8 11.65L20 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n          <rect x="3" y="5" width="18" height="14" rx="2" stroke-width="2" stroke-linecap="round"/>\n          </svg>\n          <input\n              type="'.concat(e.subtype?e.subtype:e.type,'"\n              id="').concat(e.name,'"\n              name="').concat(e.name,'"\n              value="').concat(e.value||"",'"\n              maxlength="').concat(e.maxlength||"",'"\n              placeholder="').concat(e.placeholder?e.placeholder:"",'"\n              ').concat(e.required?" required ":" ",'\n              class="sa-live-call-widget-lead-capture-form-field"\n              }\n            />\n        </div> '):"password"===e.type||"password"===e.subtype?'<div\n          class="sa-live-call-widget-lead-capture-form-field-box-group"\n        >\n          <svg width="16px" height="16px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <rect x="3" y="11" width="18" height="11" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            <path d="M7 10.9999V6.99988C7 4.23845 9.23858 1.99988 12 1.99988V1.99988C14.7614 1.99988 17 4.23845 17 6.99988V10.9999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n          <input\n              type="'.concat(e.subtype?e.subtype:e.type,'"\n              id="').concat(e.name,'"\n              name="').concat(e.name,'"\n              value="').concat(e.value||"",'"\n              maxlength="').concat(e.maxlength||"",'"\n              placeholder="').concat(e.placeholder?e.placeholder:"",'"\n              ').concat(e.required?" required ":" ",'\n              class="sa-live-call-widget-lead-capture-form-field"\n              }\n            />\n        </div> '):"date"===e.type?'<div\n          class="sa-live-call-widget-lead-capture-form-field-box-group sa-live-call-widget-lead-capture-form-field-box-group-date" style="padding:0px 0px 0px 12px"\n        >\n          <div class="date-picker-container" id="date-picker-container-main">\n            <div class="date-input-wrapper">\n            <svg xmlns="http://www.w3.org/2000/svg"\n                  width="16" height="16" viewBox="0 0 24 24"\n                  fill="none" stroke="currentColor" stroke-width="2"\n                  stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">\n                  <rect x="3" y="4" width="18" height="18" rx="2"></rect>\n                  <line x1="16" y1="2" x2="16" y2="6"></line>\n                  <line x1="8" y1="2" x2="8" y2="6"></line>\n                  <line x1="3" y1="10" x2="21" y2="10"></line>\n                  </svg> \n              <input \n                type="text"\n                name="'.concat(e.name,'"\n                class="sa-live-call-widget-lead-capture-form-field date-input"\n                id="').concat(e.name,'"\n                readonly \n                placeholder="').concat(e.placeholder?e.placeholder:"Pick a date",'"\n              />\n              <button type="button" class="clear-btn" id="clearBtn">&times;</button>\n            </div>\n            <div class="calendar" id="calendar">\n              <div class="calendar-header">\n                <button type="button" id="prevMonth">\n                <svg fill="#000000" height="800px" width="800px" \n                version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" \n                xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 477.175 477.175" xml:space="preserve">\n                <g><path d="M145.188,238.575l215.5-215.5c5.3-5.3,5.3-13.8,0-19.1s-13.8-5.3-19.1,0l-225.1,225.1c-5.3,5.3-5.3,13.8,0,19.1l225.1,225\n\t\tc2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4c5.3-5.3,5.3-13.8,0-19.1L145.188,238.575z"/></g> </svg>\n                </button>\n                  <span id="monthYear"></span>\n                  <button type="button" id="nextMonth">\n                  <svg fill="#000000" \n                  height="800px" width="800px" \n                  version="1.1" id="Capa_1" \n                  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 477.175 477.175" xml:space="preserve">\n                  <g><path d="M360.731,229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l215.5,215.5l-215.5,215.5\n                      c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-4l225.1-225.1C365.931,242.875,365.931,234.275,360.731,229.075z\n                      "/></g></svg>\n                </button>\n              </div>\n              <div class="weekdays">\n                <div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div>\n              </div>\n              <div class="days" id="days"></div>\n            </div>\n          </div>\n        </div> '):'<input\n        type="'.concat(e.subtype?e.subtype:e.type,'"\n        id="').concat(e.name,'"\n        name="').concat(e.name,'"\n        value="').concat(e.value||"",'"\n        maxlength="').concat(e.maxlength||"",'"\n        placeholder="').concat(e.placeholder?e.placeholder:"",'"\n        ').concat(e.required?" required ":" ",'\n        class="sa-live-call-widget-lead-capture-form-field"\n        }\n      />')};return e.forEach((function(e){if(e.name){if("text"===e.type&&(t+='<div\n          class="sa-live-call-widget-lead-capture-form-group"\n          id='.concat("mobile_number"===e.name?"input-field-number":"",'\n        >\n          <label\n            for="').concat(e.name,'"\n            class="sa-live-call-widget-lead-capture-form-field-label"\n          >\n            ').concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"","</span\n            >\n          </label>\n          ").concat(r(e),'\n          <span\n            class="sa-live-call-widget-lead-capture-form-error-message"\n            data-name="').concat(e.name,'"\n            >Please enter your ').concat(e.label,"</span\n          >\n        </div>")),"number"===e.type&&(t+='<div\n          class="sa-live-call-widget-lead-capture-form-group"\n        >\n          <label\n            for="'.concat(e.name,'"\n            class="sa-live-call-widget-lead-capture-form-field-label"\n          >\n            ').concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"",'</span\n            >\n          </label>\n          <input\n            type="').concat(e.type,'"\n            id="').concat(e.name,'"\n            name="').concat(e.name,'"\n            value="').concat(e.value,'"\n            min="').concat(e.min||"",'"\n            max="').concat(e.max||"",'"\n            step="').concat(e.step||"",'"\n            placeholder="').concat(e.placeholder?e.placeholder:"",'"\n            ').concat(e.required?" required ":" ",'\n            class="sa-live-call-widget-lead-capture-form-field"\n          />\n          <span\n            class="sa-live-call-widget-lead-capture-form-error-message"\n            data-name="').concat(e.name,'"\n            >Please enter your ').concat(e.label,"</span\n          >\n        </div>")),"textarea"===e.type&&(t+='<div class="sa-live-call-widget-lead-capture-form-group">\n          <label\n            for="'.concat(e.name,'"\n            class="sa-live-call-widget-lead-capture-form-field-label"\n          >\n            ').concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"",'</span\n            >\n          </label>\n          <textarea\n            id="').concat(e.name,'"\n            name="').concat(e.name,'"\n            placeholder="').concat(e.placeholder?e.placeholder:"",'"\n            rows="').concat(e.rows||"",'"\n            maxlength="').concat(e.maxlength||"",'"\n            ').concat(e.required?" required ":" ",'\n            class="sa-live-call-widget-lead-capture-form-field"\n          >\n').concat(e.value||"",'</textarea\n          >\n          <span\n            class="sa-live-call-widget-lead-capture-form-error-message"\n            data-name="').concat(e.name,'"\n            >Please enter your ').concat(e.label,"</span\n          >\n        </div>")),"select"===e.type){var n,i="";null===(n=e.values)||void 0===n||n.map((function(e){i+='<option value="'.concat(e.value,'">\n            ').concat(e.label,"\n          </option>")})),t+='<div class="sa-live-call-widget-lead-capture-form-group">\n          <label\n            for="'.concat(e.name,'"\n            class="sa-live-call-widget-lead-capture-form-field-label"\n          >\n            ').concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"",'</span\n            >\n          </label>\n          <select\n            name="').concat(e.name,'"\n            id="').concat(e.name,'"\n            ').concat(e.required?" required ":" ","\n            ").concat(e.multiple?" multiple ":" ",'\n            class="sa-live-call-widget-lead-capture-form-field"\n          >\n            ').concat(i,"\n          </select>\n        </div>")}if("radio-group"===e.type){var o,a="";null===(o=e.values)||void 0===o||o.map((function(t){a+='<label class="sa-live-call-widget-lead-capture-form-radio-form-fields-box" for="'.concat(t.value,'">\n            <input\n              type="radio"\n              id="').concat(t.value,'"\n              name="').concat(e.name,'"\n              value="').concat(t.value,'"\n              ').concat(t.selected?"checked":"",'\n              class="sa-live-call-widget-lead-capture-form-field-radio"\n            />\n            <div class="sa-live-call-widget-lead-capture-form-radio-label">').concat(t.label,"</div>\n          </label>")})),t+='<div class="sa-live-call-widget-lead-capture-form-group">\n          <p class="sa-live-call-widget-lead-capture-form-field-label">\n            '.concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"",'</span\n            >\n          </p>\n          <div\n            class="sa-live-call-widget-lead-capture-form-radio-fields-wrapper"\n          >\n            ').concat(a,"\n          </div>\n        </div>")}if("checkbox-group"===e.type){var s,c="";null===(s=e.values)||void 0===s||s.map((function(t){c+='<label\n            class="sa-live-call-widget-lead-capture-form-checkbox-wrapper"\n            for="checkbox-'.concat(t.value,'"\n          >\n            <input\n              type="checkbox"\n              id="checkbox-').concat(t.value,'"\n              name="').concat(e.name,'"\n              value="').concat(t.value,'"\n              ').concat(t.selected?"checked":"",'\n              class="sa-live-call-widget-lead-capture-form-field-checkbox"\n            />\n            <div\n              class="sa-live-call-widget-lead-capture-form-checkbox-field-label"\n              >').concat(t.label,"</div>\n          </label>")})),t+='<div class="sa-live-call-widget-lead-capture-form-group">\n          <p\n            class="sa-live-call-widget-lead-capture-form-field-label"\n          >\n            '.concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"","</span\n            >\n          </p>\n         ").concat(c,"\n        </div>")}"date"===e.type&&(t+='<div\n          class="sa-live-call-widget-lead-capture-form-group"\n        >\n          <label\n            for="'.concat(e.name,'"\n            class="sa-live-call-widget-lead-capture-form-field-label"\n          >\n            ').concat(e.label,'<span class="sa-form-input-required"\n              >').concat(e.required?" *":"","</span\n            >\n          </label>\n          ").concat(r(e),'\n          <span\n            class="sa-live-call-widget-lead-capture-form-error-message"\n            data-name="').concat(e.name,'"\n            >Please enter your ').concat(e.label,"</span\n          >\n        </div>"))}"hidden"===e.type&&(t+='<div\n        class="sa-live-call-widget-lead-capture-form-group"\n        style="display: none"\n      >\n        <input\n          type="'.concat(e.type,'"\n          id="').concat(e.name,'"\n          name="').concat(e.name,'"\n          value="').concat(e.value||"",'"\n          class="sa-live-call-widget-lead-capture-form-field"\n        />\n      </div>')),"paragraph"===e.type&&(t+='<div class="sa-live-call-widget-lead-capture-form-group">\n        <p class="sa-live-call-widget-lead-capture-form-field-label sa-live-call-widget-lead-peragraph-text">\n          '.concat(e.label,"\n        </p>\n      </div>"))})),t},W=function(e,t){var n=t.querySelector(".sa-live-call-widget-slider"),r=n.querySelector(".sa-live-call-widget-slider-track"),i=n.querySelectorAll(".sa-live-call-widget-slide"),o=n.querySelector(".sa-live-call-widget-slider-nav.prev"),a=n.querySelector(".sa-live-call-widget-slider-nav.next"),s=i[0].offsetWidth,c=3,l=0,d=s+10;o.addEventListener("click",(function(e){e.preventDefault(),l=Math.max(l-1,0),h()})),a.addEventListener("click",(function(e){e.preventDefault(),l=Math.min(l+1,i.length-c),h()})),n.addEventListener("touchstart",(function(e){u=e.touches[0].clientX}),!1),n.addEventListener("touchmove",(function(e){p=e.touches[0].clientX}),!1),n.addEventListener("touchend",(function(){u-p>50?l=Math.min(l+1,i.length-c):p-u>50&&(l=Math.max(l-1,0));h()}),!1);var u=0,p=0;function h(){var e=-l*d;r.style.transform="translateX("+e+"px)"}window.addEventListener("resize",(function(){s=i[0].offsetWidth,d=s+10,l=Math.min(l,i.length-c),h()})),h()},z=function(e,t){var n=function(e){var t="",n=[];if(void 0===e?t=(n=(e=window.location.search).substring(1).split("&"))[0]:void 0!==(t=e.split("?")[1])&&(n=t.split("&")),void 0!==t&&""!==t){for(var r={},i=0;i<n.length;i++){var o=n[i].split("=");if(void 0!==o[0]&&""!==o[0]){var a=o[1];void 0===a&&(a=""),r[o[0]]=a}}return r}return{}}(t);return void 0===n[e]?"":n[e]};function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Y(){Y=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==K(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==K(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===K(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ee(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function te(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ee(o,r,i,a,s,"next",e)}function s(e){ee(o,r,i,a,s,"throw",e)}a(void 0)}))}}var ne=__webpack_require__(8922),re=__webpack_require__(4582),ie=__webpack_require__(1562),oe=__webpack_require__(3585),ae=function(){var e=te(Y().mark((function e(t,n,r){var i,a,s,c,d,u,p,h,f,m,g,v;return Y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=D()[n],a=U()[n],s="",c="",d=[],u=Intl.DateTimeFormat().resolvedOptions().timeZone,p=new Intl.DateTimeFormat("en-US",{timeZone:u,timeZoneName:"short"}).format(new Date).split(" ").pop(),e.next=9,l.get(o.url.SOURCE,"/".concat(n,"/get_available_slots_v2?timezone=").concat(u));case 9:if(h=e.sent,Object.keys(h).length){e.next=14;break}return t.innerHTML=ie({defaultMessage:"Unfortunately, there are no available meeting slots at the moment.",thankyouMessage:"Thank you for your understanding!"}),M5(n,r),e.abrupt("return");case 14:f="",m=Object.keys(h).filter((function(e){return h[e].length>0})),s=m[0],c=h[s][0],m.map((function(e){var t=new Date(e);f+="<div\n                  data-date=".concat(e,'\n                  id="sa-live-call-widget-slide-').concat(null==e?void 0:e.replaceAll("/","-"),'"\n                  class="sa-live-call-widget-slide ').concat(s==e?"sa-live-call-widget-slide-active":"",'"\n                >\n                  <div class="sa-live-call-widget-slide-content">\n                    <p>').concat(t.toString().split(" ")[0],"</p>\n                    <h1>").concat(t.toString().split(" ")[2],"</h1>\n                  </div>\n                </div>")})),t.innerHTML=re({title:"Schedule Meeting",caption:"When would you like to take this call?",timeZone:"".concat(u," (").concat(p,")")}),r.querySelector(".sa-live-call-widget-schedule-meeting-date-container").innerHTML='<div class="sa-live-call-widget-slider">\n    <div class="sa-live-call-widget-slider-wrapper">\n      <div class="sa-live-call-widget-slider-track">\n        '.concat(f,'\n      </div>\n    </div>\n    <button class="sa-live-call-widget-slider-nav prev">\n      &lt;\n    </button>\n    <button class="sa-live-call-widget-slider-nav next">\n      &gt;\n    </button>\n  </div>'),W(0,r),g=function(e,t){var n=r.querySelector(".sa-live-call-widget-schedule-meeting-time-container");var o=e[t].map((function(e){var t=function(e,t){var n=Q(e.split(" "),2),r=n[0],i=n[1],o=Q(r.split(":").map(Number),2),a=o[0];"PM"===i&&12!==a&&(a+=12),"AM"===i&&12===a&&(a=0);var s=60*a+o[1]+t,c=Math.floor(s/60)%24,l=c>=12?"PM":"AM",d=(c+11)%12+1,u=String(s%60).padStart(2,"0");return"".concat(d,":").concat(u," ").concat(l)}(e,i.schedule_meet_working_hours_day_wise.schedule_slot_mins);return'<option value="'.concat(e,'">').concat(e," - ").concat(t,"</option>")}));n.innerHTML='<label\n        class="sa-live-call-widget-time-custom-select-label"\n        >Available Slots</label\n      >\n      <select\n        id="sa-schedule-meeting-custom-select"\n        class="sa-live-call-widget-time-custom-select"\n        name="time-slots"\n      >\n        '.concat(o.filter(Boolean).join(""),"\n      </select>"),r.querySelector("#sa-schedule-meeting-custom-select").addEventListener("change",(function(e){c=e.target.value}))},g(h,s),r.querySelectorAll(".sa-live-call-widget-slide").forEach((function(e){e.addEventListener("click",(function(){var t;r.querySelector("#sa-live-call-widget-slide-".concat(null===(t=s)||void 0===t?void 0:t.replaceAll("/","-"))).classList.remove("sa-live-call-widget-slide-active"),s=e.getAttribute("data-date"),c=h[s][0],e.classList.add("sa-live-call-widget-slide-active"),g(h,s)}))})),r.querySelector(".sa-live-call-widget-schedule-meeting-invite-friends-textarea").addEventListener("change",(function(e){d=e.target.value.split(",").map((function(e){return e.trim()}))})),v=r.querySelector(".sa-live-call-widget-schedule-meeting-confirm-btn"),r.querySelector(".sa-live-call-widget-schedule-meeting-error-text"),v.addEventListener("click",function(){var e=te(Y().mark((function e(p){var h,f,m,g,v,_,y,w,b,E,S,T,C,R,O,I;return Y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.target.disabled=!0,p.target.innerHTML=oe({}),p.target.style.cursor="not-allowed",h=F("form_data_".concat(n)),f=F("user_data_".concat(n))||{},e.prev=5,e.next=8,l.post(o.url.SOURCE,"/".concat(n,"/schedule_meeting_v3"),{meta:[{message:""}],timezone:u,date:s,time:c,invite_friends:d,form_id:h.form_id,session_id:h.session_id,people_id:h.people_id,unique_field_value:h.unique_field_value,user_data:f,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href});case 8:(m=e.sent)&&(y=function(e){return null!=e&&e.meta&&Array.isArray(null==e?void 0:e.meta)?null==e?void 0:e.meta.filter((function(e){return(null==e?void 0:e.date)&&(null==e?void 0:e.time)&&(null==e?void 0:e.timezone)})).map((function(e){var t=new Date("".concat(e.date," ").concat(e.time," GMT+0530"));if(isNaN(t))return console.error(" Invalid Date:",e.date,e.time,e.timezone),{formattedDate:"Invalid Date",formattedTime:"Invalid Time"};var n=t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric",timeZone:"Asia/Kolkata"}),r=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"}),i=new Date(t.getTime()+6e4*(e.duration||0)),o=i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"});return{formattedDate:n,formattedTime:"".concat(r," - ").concat(o," (Asia/Kolkata (A/C))"),startTimeISO:t.toISOString(),endTimeISO:i.toISOString(),meetingName:e.meeting_name||"Meeting"}})):[]},w=y(m),b=w.map((function(e){return e.formattedDate})),E=w.map((function(e){return e.formattedTime})),M(Z({},n,X(X({},a),{},{message:"Your meeting has been scheduled.",scheduled_on_date:b,scheduled_on_time:(null===(g=m.meta[0])||void 0===g?void 0:g.time)||"",meeting_id:m.meeting_id,widgetName:"thankyouMessage"}))),S=b||(null===(v=m.meta[0])||void 0===v?void 0:v.date)||"",T=E||(null===(_=m.meta[0])||void 0===_?void 0:_.time)||"",t.innerHTML=ne({scheduleMeeting:!0,defaultMessage:i.message,thankyouMessage:i.thankyou_message,scheduledDate:S,scheduledTime:T,addOrraPixel:"2d776e4a-ca8b-454d-9ceb-aab964ae4ebf"===n,mobileNumber:f.mobile_number,affiliateId:z("utm_medium"),peopleId:h.people_id}),r.querySelector("#sa-live-call-widget-share-meeting-btn").addEventListener("click",(function(){var e="Your friend has invited you for group shopping on ".concat(T),t="".concat(o.url.ACTIONS,"/join_meeting/").concat(i.meeting_id,"/ask");window.open("https://api.whatsapp.com/send?text=".concat(e," ").concat(encodeURIComponent(t)),"_blank","noopener")})),C=w[0],R=C.startTimeISO,O=C.endTimeISO,I=C.meetingName,r.querySelector("#sa-live-call-widget-add-to-calendar").addEventListener("click",(function(){var e="https://www.google.com/calendar/render?action=TEMPLATE&text=".concat(encodeURIComponent(I),"&dates=").concat(R.replace(/[-:]/g,"").split(".")[0],"/").concat(O.replace(/[-:]/g,"").split(".")[0],"&details=").concat(encodeURIComponent("Meeting Scheduled"),"&location=Online&sf=true&output=xml");window.open(e,"_blank")}))),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(5);case 14:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}());case 32:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var se="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ce(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var le=function(e){try{return!!e()}catch(e){return!0}},de=!le((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),ue=de,pe=Function.prototype,he=pe.call,fe=ue&&pe.bind.bind(he,he),me=ue?fe:function(e){return function(){return he.apply(e,arguments)}},ge=me({}.isPrototypeOf),ve=function(e){return e&&e.Math==Math&&e},_e=ve("object"==typeof globalThis&&globalThis)||ve("object"==typeof window&&window)||ve("object"==typeof self&&self)||ve("object"==typeof se&&se)||function(){return this}()||se||Function("return this")(),ye=de,we=Function.prototype,be=we.apply,Ee=we.call,Se="object"==typeof Reflect&&Reflect.apply||(ye?Ee.bind(be):function(){return Ee.apply(be,arguments)}),Te=me,Ce=Te({}.toString),Re=Te("".slice),Oe=function(e){return Re(Ce(e),8,-1)},Ie=Oe,Ae=me,ke=function(e){if("Function"===Ie(e))return Ae(e)},xe="object"==typeof document&&document.all,Le={all:xe,IS_HTMLDDA:void 0===xe&&void 0!==xe},Ne=Le.all,Pe=Le.IS_HTMLDDA?function(e){return"function"==typeof e||e===Ne}:function(e){return"function"==typeof e},De={},Me=!le((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Ue=de,je=Function.prototype.call,Ve=Ue?je.bind(je):function(){return je.apply(je,arguments)},Be={},Fe={}.propertyIsEnumerable,Ge=Object.getOwnPropertyDescriptor,He=Ge&&!Fe.call({1:2},1);Be.f=He?function(e){var t=Ge(this,e);return!!t&&t.enumerable}:Fe;var qe,We,ze=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Ke=le,Ye=Oe,Je=Object,Xe=me("".split),Ze=Ke((function(){return!Je("z").propertyIsEnumerable(0)}))?function(e){return"String"==Ye(e)?Xe(e,""):Je(e)}:Je,Qe=function(e){return null==e},$e=Qe,et=TypeError,tt=function(e){if($e(e))throw et("Can't call method on "+e);return e},nt=Ze,rt=tt,it=function(e){return nt(rt(e))},ot=Pe,at=Le.all,st=Le.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:ot(e)||e===at}:function(e){return"object"==typeof e?null!==e:ot(e)},ct={},lt=ct,dt=_e,ut=Pe,pt=function(e){return ut(e)?e:void 0},ht=function(e,t){return arguments.length<2?pt(lt[e])||pt(dt[e]):lt[e]&&lt[e][t]||dt[e]&&dt[e][t]},ft="undefined"!=typeof navigator&&String(navigator.userAgent)||"",mt=_e,gt=ft,vt=mt.process,_t=mt.Deno,yt=vt&&vt.versions||_t&&_t.version,wt=yt&&yt.v8;wt&&(We=(qe=wt.split("."))[0]>0&&qe[0]<4?1:+(qe[0]+qe[1])),!We&&gt&&(!(qe=gt.match(/Edge\/(\d+)/))||qe[1]>=74)&&(qe=gt.match(/Chrome\/(\d+)/))&&(We=+qe[1]);var bt=We,Et=bt,St=le,Tt=_e.String,Ct=!!Object.getOwnPropertySymbols&&!St((function(){var e=Symbol();return!Tt(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Et&&Et<41})),Rt=Ct&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Ot=ht,It=Pe,At=ge,kt=Object,xt=Rt?function(e){return"symbol"==typeof e}:function(e){var t=Ot("Symbol");return It(t)&&At(t.prototype,kt(e))},Lt=String,Nt=function(e){try{return Lt(e)}catch(e){return"Object"}},Pt=Pe,Dt=Nt,Mt=TypeError,Ut=function(e){if(Pt(e))return e;throw Mt(Dt(e)+" is not a function")},jt=Ut,Vt=Qe,Bt=function(e,t){var n=e[t];return Vt(n)?void 0:jt(n)},Ft=Ve,Gt=Pe,Ht=st,qt=TypeError,Wt={exports:{}},zt=_e,Kt=Object.defineProperty,Yt="__core-js_shared__",Jt=_e[Yt]||function(e,t){try{Kt(zt,e,{value:t,configurable:!0,writable:!0})}catch(n){zt[e]=t}return t}(Yt,{}),Xt=Jt;(Wt.exports=function(e,t){return Xt[e]||(Xt[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Zt=Wt.exports,Qt=tt,$t=Object,en=function(e){return $t(Qt(e))},tn=en,nn=me({}.hasOwnProperty),rn=Object.hasOwn||function(e,t){return nn(tn(e),t)},on=me,an=0,sn=Math.random(),cn=on(1..toString),ln=function(e){return"Symbol("+(void 0===e?"":e)+")_"+cn(++an+sn,36)},dn=Zt,un=rn,pn=ln,hn=Ct,fn=Rt,mn=_e.Symbol,gn=dn("wks"),vn=fn?mn.for||mn:mn&&mn.withoutSetter||pn,_n=function(e){return un(gn,e)||(gn[e]=hn&&un(mn,e)?mn[e]:vn("Symbol."+e)),gn[e]},yn=Ve,wn=st,bn=xt,En=Bt,Sn=TypeError,Tn=_n("toPrimitive"),Cn=function(e,t){if(!wn(e)||bn(e))return e;var n,r=En(e,Tn);if(r){if(void 0===t&&(t="default"),n=yn(r,e,t),!wn(n)||bn(n))return n;throw Sn("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,r;if("string"===t&&Gt(n=e.toString)&&!Ht(r=Ft(n,e)))return r;if(Gt(n=e.valueOf)&&!Ht(r=Ft(n,e)))return r;if("string"!==t&&Gt(n=e.toString)&&!Ht(r=Ft(n,e)))return r;throw qt("Can't convert object to primitive value")}(e,t)},Rn=xt,On=function(e){var t=Cn(e,"string");return Rn(t)?t:t+""},In=st,An=_e.document,kn=In(An)&&In(An.createElement),xn=function(e){return kn?An.createElement(e):{}},Ln=xn,Nn=!Me&&!le((function(){return 7!=Object.defineProperty(Ln("div"),"a",{get:function(){return 7}}).a})),Pn=Me,Dn=Ve,Mn=Be,Un=ze,jn=it,Vn=On,Bn=rn,Fn=Nn,Gn=Object.getOwnPropertyDescriptor;De.f=Pn?Gn:function(e,t){if(e=jn(e),t=Vn(t),Fn)try{return Gn(e,t)}catch(e){}if(Bn(e,t))return Un(!Dn(Mn.f,e,t),e[t])};var Hn=le,qn=Pe,Wn=/#|\.prototype\./,zn=function(e,t){var n=Yn[Kn(e)];return n==Xn||n!=Jn&&(qn(t)?Hn(t):!!t)},Kn=zn.normalize=function(e){return String(e).replace(Wn,".").toLowerCase()},Yn=zn.data={},Jn=zn.NATIVE="N",Xn=zn.POLYFILL="P",Zn=zn,Qn=Ut,$n=de,er=ke(ke.bind),tr=function(e,t){return Qn(e),void 0===t?e:$n?er(e,t):function(){return e.apply(t,arguments)}},nr={},rr=Me&&le((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ir=st,or=String,ar=TypeError,sr=function(e){if(ir(e))return e;throw ar(or(e)+" is not an object")},cr=Me,lr=Nn,dr=rr,ur=sr,pr=On,hr=TypeError,fr=Object.defineProperty,mr=Object.getOwnPropertyDescriptor,gr="enumerable",vr="configurable",_r="writable";nr.f=cr?dr?function(e,t,n){if(ur(e),t=pr(t),ur(n),"function"==typeof e&&"prototype"===t&&"value"in n&&_r in n&&!n[_r]){var r=mr(e,t);r&&r[_r]&&(e[t]=n.value,n={configurable:vr in n?n[vr]:r[vr],enumerable:gr in n?n[gr]:r[gr],writable:!1})}return fr(e,t,n)}:fr:function(e,t,n){if(ur(e),t=pr(t),ur(n),lr)try{return fr(e,t,n)}catch(e){}if("get"in n||"set"in n)throw hr("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var yr=nr,wr=ze,br=Me?function(e,t,n){return yr.f(e,t,wr(1,n))}:function(e,t,n){return e[t]=n,e},Er=_e,Sr=Se,Tr=ke,Cr=Pe,Rr=De.f,Or=Zn,Ir=ct,Ar=tr,kr=br,xr=rn,Lr=function(e){var t=function(n,r,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,i)}return Sr(e,this,arguments)};return t.prototype=e.prototype,t},Nr=function(e,t){var n,r,i,o,a,s,c,l,d,u=e.target,p=e.global,h=e.stat,f=e.proto,m=p?Er:h?Er[u]:(Er[u]||{}).prototype,g=p?Ir:Ir[u]||kr(Ir,u,{})[u],v=g.prototype;for(o in t)r=!(n=Or(p?o:u+(h?".":"#")+o,e.forced))&&m&&xr(m,o),s=g[o],r&&(c=e.dontCallGetSet?(d=Rr(m,o))&&d.value:m[o]),a=r&&c?c:t[o],r&&typeof s==typeof a||(l=e.bind&&r?Ar(a,Er):e.wrap&&r?Lr(a):f&&Cr(a)?Tr(a):a,(e.sham||a&&a.sham||s&&s.sham)&&kr(l,"sham",!0),kr(g,o,l),f&&(xr(Ir,i=u+"Prototype")||kr(Ir,i,{}),kr(Ir[i],o,a),e.real&&v&&(n||!v[o])&&kr(v,o,a)))},Pr=Math.ceil,Dr=Math.floor,Mr=Math.trunc||function(e){var t=+e;return(t>0?Dr:Pr)(t)},Ur=Mr,jr=function(e){var t=+e;return t!=t||0===t?0:Ur(t)},Vr=jr,Br=Math.max,Fr=Math.min,Gr=function(e,t){var n=Vr(e);return n<0?Br(n+t,0):Fr(n,t)},Hr=jr,qr=Math.min,Wr=function(e){return e>0?qr(Hr(e),9007199254740991):0},zr=Wr,Kr=function(e){return zr(e.length)},Yr=it,Jr=Gr,Xr=Kr,Zr=function(e){return function(t,n,r){var i,o=Yr(t),a=Xr(o),s=Jr(r,a);if(e&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},Qr={includes:Zr(!0),indexOf:Zr(!1)},$r=Qr.includes;Nr({target:"Array",proto:!0,forced:le((function(){return!Array(1).includes()}))},{includes:function(e){return $r(this,e,arguments.length>1?arguments[1]:void 0)}});var ei=ct,ti=function(e){return ei[e+"Prototype"]},ni=ti("Array").includes,ri=st,ii=Oe,oi=_n("match"),ai=function(e){var t;return ri(e)&&(void 0!==(t=e[oi])?!!t:"RegExp"==ii(e))},si=ai,ci=TypeError,li={};li[_n("toStringTag")]="z";var di="[object z]"===String(li),ui=di,pi=Pe,hi=Oe,fi=_n("toStringTag"),mi=Object,gi="Arguments"==hi(function(){return arguments}()),vi=ui?hi:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=mi(e),fi))?n:gi?hi(t):"Object"==(r=hi(t))&&pi(t.callee)?"Arguments":r},_i=vi,yi=String,wi=function(e){if("Symbol"===_i(e))throw TypeError("Cannot convert a Symbol value to a string");return yi(e)},bi=_n("match"),Ei=Nr,Si=tt,Ti=wi,Ci=me("".indexOf);Ei({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[bi]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~Ci(Ti(Si(this)),Ti(function(e){if(si(e))throw ci("The method doesn't accept regular expressions");return e}(e)),arguments.length>1?arguments[1]:void 0)}});var Ri=ti("String").includes,Oi=ge,Ii=ni,Ai=Ri,ki=Array.prototype,xi=String.prototype,Li=ce((function(e){var t=e.includes;return e===ki||Oi(ki,e)&&t===ki.includes?Ii:"string"==typeof e||e===xi||Oi(xi,e)&&t===xi.includes?Ai:t})),Ni=Ut,Pi=en,Di=Ze,Mi=Kr,Ui=TypeError,ji=function(e){return function(t,n,r,i){Ni(n);var o=Pi(t),a=Di(o),s=Mi(o),c=e?s-1:0,l=e?-1:1;if(r<2)for(;;){if(c in a){i=a[c],c+=l;break}if(c+=l,e?c<0:s<=c)throw Ui("Reduce of empty array with no initial value")}for(;e?c>=0:s>c;c+=l)c in a&&(i=n(i,a[c],c,o));return i}},Vi={left:ji(!1),right:ji(!0)},Bi=le,Fi=function(e,t){var n=[][e];return!!n&&Bi((function(){n.call(null,t||function(){return 1},1)}))},Gi="undefined"!=typeof process&&"process"==Oe(process),Hi=Vi.left;Nr({target:"Array",proto:!0,forced:!Gi&&bt>79&&bt<83||!Fi("reduce")},{reduce:function(e){var t=arguments.length;return Hi(this,e,t,t>1?arguments[1]:void 0)}});var qi=ti("Array").reduce,Wi=ge,zi=qi,Ki=Array.prototype,Yi=function(e){var t=e.reduce;return e===Ki||Wi(Ki,e)&&t===Ki.reduce?zi:t},Ji=ce(Yi);let Xi=!0,Zi=!0;function Qi(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function $i(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function eo(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Xi=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function to(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Zi=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function no(){if("object"==typeof window){if(Xi)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function ro(e,t){Zi&&console.warn(e+" is deprecated, please use "+t+" instead.")}function io(e){return"[object Object]"===Object.prototype.toString.call(e)}function oo(e){var t;return io(e)?Ji(t=Object.keys(e)).call(t,(function(t,n){const r=io(e[n]),i=r?oo(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function ao(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((r=>{r.endsWith("Id")?ao(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((t=>{ao(e,e.get(t),n)}))})))}function so(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&ao(e,n,i)}))})),i}var co=ln,lo=Zt("keys"),uo=function(e){return lo[e]||(lo[e]=co(e))},po=!le((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ho=rn,fo=Pe,mo=en,go=po,vo=uo("IE_PROTO"),_o=Object,yo=_o.prototype,wo=go?_o.getPrototypeOf:function(e){var t=mo(e);if(ho(t,vo))return t[vo];var n=t.constructor;return fo(n)&&t instanceof n?n.prototype:t instanceof _o?yo:null},bo=me,Eo=Ut,So=Pe,To=String,Co=TypeError,Ro=sr,Oo=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=function(e,t,n){try{return bo(Eo(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return Ro(n),function(e){if("object"==typeof e||So(e))return e;throw Co("Can't set "+To(e)+" as a prototype")}(r),t?e(n,r):n.__proto__=r,n}}():void 0),Io={},Ao={},ko=rn,xo=it,Lo=Qr.indexOf,No=Ao,Po=me([].push),Do=function(e,t){var n,r=xo(e),i=0,o=[];for(n in r)!ko(No,n)&&ko(r,n)&&Po(o,n);for(;t.length>i;)ko(r,n=t[i++])&&(~Lo(o,n)||Po(o,n));return o},Mo=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Uo=Do,jo=Mo.concat("length","prototype");Io.f=Object.getOwnPropertyNames||function(e){return Uo(e,jo)};var Vo={};Vo.f=Object.getOwnPropertySymbols;var Bo=ht,Fo=Io,Go=Vo,Ho=sr,qo=me([].concat),Wo=Bo("Reflect","ownKeys")||function(e){var t=Fo.f(Ho(e)),n=Go.f;return n?qo(t,n(e)):t},zo=rn,Ko=Wo,Yo=De,Jo=nr,Xo={},Zo=Do,Qo=Mo,$o=Object.keys||function(e){return Zo(e,Qo)},ea=Me,ta=rr,na=nr,ra=sr,ia=it,oa=$o;Xo.f=ea&&!ta?Object.defineProperties:function(e,t){ra(e);for(var n,r=ia(t),i=oa(t),o=i.length,a=0;o>a;)na.f(e,n=i[a++],r[n]);return e};var aa,sa=ht("document","documentElement"),ca=sr,la=Xo,da=Mo,ua=Ao,pa=sa,ha=xn,fa="prototype",ma="script",ga=uo("IE_PROTO"),va=function(){},_a=function(e){return"<"+ma+">"+e+"</"+ma+">"},ya=function(e){e.write(_a("")),e.close();var t=e.parentWindow.Object;return e=null,t},wa=function(){try{aa=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;wa="undefined"!=typeof document?document.domain&&aa?ya(aa):(t=ha("iframe"),n="java"+ma+":",t.style.display="none",pa.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(_a("document.F=Object")),e.close(),e.F):ya(aa);for(var r=da.length;r--;)delete wa[fa][da[r]];return wa()};ua[ga]=!0;var ba=Object.create||function(e,t){var n;return null!==e?(va[fa]=ca(e),n=new va,va[fa]=null,n[ga]=e):n=wa(),void 0===t?n:la.f(n,t)},Ea=st,Sa=br,Ta=Error,Ca=me("".replace),Ra=String(Ta("zxcasd").stack),Oa=/\n\s*at [^:]*:[^\n]*/,Ia=Oa.test(Ra),Aa=ze,ka=!le((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Aa(1,7)),7!==e.stack)})),xa=br,La=ka,Na=Error.captureStackTrace,Pa={},Da=Pa,Ma=_n("iterator"),Ua=Array.prototype,ja=function(e){return void 0!==e&&(Da.Array===e||Ua[Ma]===e)},Va=vi,Ba=Bt,Fa=Qe,Ga=Pa,Ha=_n("iterator"),qa=function(e){if(!Fa(e))return Ba(e,Ha)||Ba(e,"@@iterator")||Ga[Va(e)]},Wa=Ve,za=Ut,Ka=sr,Ya=Nt,Ja=qa,Xa=TypeError,Za=function(e,t){var n=arguments.length<2?Ja(e):t;if(za(n))return Ka(Wa(n,e));throw Xa(Ya(e)+" is not iterable")},Qa=Ve,$a=sr,es=Bt,ts=function(e,t,n){var r,i;$a(e);try{if(!(r=es(e,"return"))){if("throw"===t)throw n;return n}r=Qa(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return $a(r),n},ns=tr,rs=Ve,is=sr,os=Nt,as=ja,ss=Kr,cs=ge,ls=Za,ds=qa,us=ts,ps=TypeError,hs=function(e,t){this.stopped=e,this.result=t},fs=hs.prototype,ms=function(e,t,n){var r,i,o,a,s,c,l,d=n&&n.that,u=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_RECORD),h=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),m=ns(t,d),g=function(e){return r&&us(r,"normal",e),new hs(!0,e)},v=function(e){return u?(is(e),f?m(e[0],e[1],g):m(e[0],e[1])):f?m(e,g):m(e)};if(p)r=e.iterator;else if(h)r=e;else{if(!(i=ds(e)))throw ps(os(e)+" is not iterable");if(as(i)){for(o=0,a=ss(e);a>o;o++)if((s=v(e[o]))&&cs(fs,s))return s;return new hs(!1)}r=ls(e,i)}for(c=p?e.next:r.next;!(l=rs(c,r)).done;){try{s=v(l.value)}catch(e){us(r,"throw",e)}if("object"==typeof s&&s&&cs(fs,s))return s}return new hs(!1)},gs=wi,vs=Nr,_s=ge,ys=wo,ws=Oo,bs=ba,Es=br,Ss=ze,Ts=function(e,t,n,r){La&&(Na?Na(e,t):xa(e,"stack",function(e,t){if(Ia&&"string"==typeof e&&!Ta.prepareStackTrace)for(;t--;)e=Ca(e,Oa,"");return e}(n,r)))},Cs=ms,Rs=_n("toStringTag"),Os=Error,Is=[].push,As=function(e,t){var n,r=_s(ks,this);ws?n=ws(Os(),r?ys(this):ks):(n=r?this:bs(ks),Es(n,Rs,"Error")),void 0!==t&&Es(n,"message",function(e,t){return void 0===e?arguments.length<2?"":t:gs(e)}(t)),Ts(n,As,n.stack,1),arguments.length>2&&function(e,t){Ea(t)&&"cause"in t&&Sa(e,"cause",t.cause)}(n,arguments[2]);var i=[];return Cs(e,Is,{that:i}),Es(n,"errors",i),n};ws?ws(As,Os):function(e,t,n){for(var r=Ko(t),i=Jo.f,o=Yo.f,a=0;a<r.length;a++){var s=r[a];zo(e,s)||n&&zo(n,s)||i(e,s,o(t,s))}}(As,Os,{name:!0});var ks=As.prototype=bs(Os.prototype,{constructor:Ss(1,As),message:Ss(1,""),name:Ss(1,"AggregateError")});vs({global:!0,constructor:!0,arity:2},{AggregateError:As});var xs,Ls,Ns,Ps=Pe,Ds=_e.WeakMap,Ms=Ps(Ds)&&/native code/.test(String(Ds)),Us=_e,js=st,Vs=br,Bs=rn,Fs=Jt,Gs=uo,Hs=Ao,qs="Object already initialized",Ws=Us.TypeError,zs=Us.WeakMap;if(Ms||Fs.state){var Ks=Fs.state||(Fs.state=new zs);Ks.get=Ks.get,Ks.has=Ks.has,Ks.set=Ks.set,xs=function(e,t){if(Ks.has(e))throw Ws(qs);return t.facade=e,Ks.set(e,t),t},Ls=function(e){return Ks.get(e)||{}},Ns=function(e){return Ks.has(e)}}else{var Ys=Gs("state");Hs[Ys]=!0,xs=function(e,t){if(Bs(e,Ys))throw Ws(qs);return t.facade=e,Vs(e,Ys,t),t},Ls=function(e){return Bs(e,Ys)?e[Ys]:{}},Ns=function(e){return Bs(e,Ys)}}var Js,Xs,Zs,Qs={set:xs,get:Ls,has:Ns,enforce:function(e){return Ns(e)?Ls(e):xs(e,{})},getterFor:function(e){return function(t){var n;if(!js(t)||(n=Ls(t)).type!==e)throw Ws("Incompatible receiver, "+e+" required");return n}}},$s=Me,ec=rn,tc=Function.prototype,nc=$s&&Object.getOwnPropertyDescriptor,rc=ec(tc,"name"),ic={EXISTS:rc,PROPER:rc&&"something"===function(){}.name,CONFIGURABLE:rc&&(!$s||$s&&nc(tc,"name").configurable)},oc=br,ac=function(e,t,n,r){return r&&r.enumerable?e[t]=n:oc(e,t,n),e},sc=le,cc=Pe,lc=st,dc=ba,uc=wo,pc=ac,hc=_n("iterator"),fc=!1;[].keys&&("next"in(Zs=[].keys())?(Xs=uc(uc(Zs)))!==Object.prototype&&(Js=Xs):fc=!0);var mc=!lc(Js)||sc((function(){var e={};return Js[hc].call(e)!==e}));cc((Js=mc?{}:dc(Js))[hc])||pc(Js,hc,(function(){return this}));var gc={IteratorPrototype:Js,BUGGY_SAFARI_ITERATORS:fc},vc=vi,_c=di?{}.toString:function(){return"[object "+vc(this)+"]"},yc=di,wc=nr.f,bc=br,Ec=rn,Sc=_c,Tc=_n("toStringTag"),Cc=function(e,t,n,r){if(e){var i=n?e:e.prototype;Ec(i,Tc)||wc(i,Tc,{configurable:!0,value:t}),r&&!yc&&bc(i,"toString",Sc)}},Rc=gc.IteratorPrototype,Oc=ba,Ic=ze,Ac=Cc,kc=Pa,xc=function(){return this},Lc=function(e,t,n,r){var i=t+" Iterator";return e.prototype=Oc(Rc,{next:Ic(+!r,n)}),Ac(e,i,!1,!0),kc[i]=xc,e},Nc=Nr,Pc=Ve,Dc=Lc,Mc=wo,Uc=Cc,jc=ac,Vc=Pa,Bc=ic.PROPER,Fc=gc.BUGGY_SAFARI_ITERATORS,Gc=_n("iterator"),Hc="keys",qc="values",Wc="entries",zc=function(){return this},Kc=function(e,t,n,r,i,o,a){Dc(n,t,r);var s,c,l,d=function(e){if(e===i&&m)return m;if(!Fc&&e in h)return h[e];switch(e){case Hc:case qc:case Wc:return function(){return new n(this,e)}}return function(){return new n(this)}},u=t+" Iterator",p=!1,h=e.prototype,f=h[Gc]||h["@@iterator"]||i&&h[i],m=!Fc&&f||d(i),g="Array"==t&&h.entries||f;if(g&&(s=Mc(g.call(new e)))!==Object.prototype&&s.next&&(Uc(s,u,!0,!0),Vc[u]=zc),Bc&&i==qc&&f&&f.name!==qc&&(p=!0,m=function(){return Pc(f,this)}),i)if(c={values:d(qc),keys:o?m:d(Hc),entries:d(Wc)},a)for(l in c)(Fc||p||!(l in h))&&jc(h,l,c[l]);else Nc({target:t,proto:!0,forced:Fc||p},c);return a&&h[Gc]!==m&&jc(h,Gc,m,{name:i}),Vc[t]=m,c},Yc=function(e,t){return{value:e,done:t}},Jc=it,Xc=Pa,Zc=Qs;nr.f;var Qc=Kc,$c=Yc,el="Array Iterator",tl=Zc.set,nl=Zc.getterFor(el);Qc(Array,"Array",(function(e,t){tl(this,{type:el,target:Jc(e),index:0,kind:t})}),(function(){var e=nl(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,$c(void 0,!0)):$c("keys"==n?r:"values"==n?t[r]:[r,t[r]],!1)}),"values"),Xc.Arguments=Xc.Array;var rl=nr,il=function(e,t,n){return rl.f(e,t,n)},ol=ht,al=il,sl=Me,cl=_n("species"),ll=ge,dl=TypeError,ul=function(e,t){if(ll(t,e))return e;throw dl("Incorrect invocation")},pl=Pe,hl=Jt,fl=me(Function.toString);pl(hl.inspectSource)||(hl.inspectSource=function(e){return fl(e)});var ml=hl.inspectSource,gl=me,vl=le,_l=Pe,yl=vi,wl=ml,bl=function(){},El=[],Sl=ht("Reflect","construct"),Tl=/^\s*(?:class|function)\b/,Cl=gl(Tl.exec),Rl=!Tl.exec(bl),Ol=function(e){if(!_l(e))return!1;try{return Sl(bl,El,e),!0}catch(e){return!1}},Il=function(e){if(!_l(e))return!1;switch(yl(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rl||!!Cl(Tl,wl(e))}catch(e){return!0}};Il.sham=!0;var Al,kl,xl,Ll,Nl=!Sl||vl((function(){var e;return Ol(Ol.call)||!Ol(Object)||!Ol((function(){e=!0}))||e}))?Il:Ol,Pl=Nl,Dl=Nt,Ml=TypeError,Ul=sr,jl=Qe,Vl=_n("species"),Bl=function(e,t){var n,r=Ul(e).constructor;return void 0===r||jl(n=Ul(r)[Vl])?t:function(e){if(Pl(e))return e;throw Ml(Dl(e)+" is not a constructor")}(n)},Fl=me([].slice),Gl=TypeError,Hl=function(e,t){if(e<t)throw Gl("Not enough arguments");return e},ql=/(?:ipad|iphone|ipod).*applewebkit/i.test(ft),Wl=_e,zl=Se,Kl=tr,Yl=Pe,Jl=rn,Xl=le,Zl=sa,Ql=Fl,$l=xn,ed=Hl,td=ql,nd=Gi,rd=Wl.setImmediate,id=Wl.clearImmediate,od=Wl.process,ad=Wl.Dispatch,sd=Wl.Function,cd=Wl.MessageChannel,ld=Wl.String,dd=0,ud={},pd="onreadystatechange";Xl((function(){Al=Wl.location}));var hd=function(e){if(Jl(ud,e)){var t=ud[e];delete ud[e],t()}},fd=function(e){return function(){hd(e)}},md=function(e){hd(e.data)},gd=function(e){Wl.postMessage(ld(e),Al.protocol+"//"+Al.host)};rd&&id||(rd=function(e){ed(arguments.length,1);var t=Yl(e)?e:sd(e),n=Ql(arguments,1);return ud[++dd]=function(){zl(t,void 0,n)},kl(dd),dd},id=function(e){delete ud[e]},nd?kl=function(e){od.nextTick(fd(e))}:ad&&ad.now?kl=function(e){ad.now(fd(e))}:cd&&!td?(Ll=(xl=new cd).port2,xl.port1.onmessage=md,kl=Kl(Ll.postMessage,Ll)):Wl.addEventListener&&Yl(Wl.postMessage)&&!Wl.importScripts&&Al&&"file:"!==Al.protocol&&!Xl(gd)?(kl=gd,Wl.addEventListener("message",md,!1)):kl=pd in $l("script")?function(e){Zl.appendChild($l("script"))[pd]=function(){Zl.removeChild(this),hd(e)}}:function(e){setTimeout(fd(e),0)});var vd={set:rd,clear:id},_d=function(){this.head=null,this.tail=null};_d.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var yd,wd,bd,Ed,Sd,Td=_d,Cd=/ipad|iphone|ipod/i.test(ft)&&"undefined"!=typeof Pebble,Rd=/web0s(?!.*chrome)/i.test(ft),Od=_e,Id=tr,Ad=De.f,kd=vd.set,xd=Td,Ld=ql,Nd=Cd,Pd=Rd,Dd=Gi,Md=Od.MutationObserver||Od.WebKitMutationObserver,Ud=Od.document,jd=Od.process,Vd=Od.Promise,Bd=Ad(Od,"queueMicrotask"),Fd=Bd&&Bd.value;if(!Fd){var Gd=new xd,Hd=function(){var e,t;for(Dd&&(e=jd.domain)&&e.exit();t=Gd.get();)try{t()}catch(e){throw Gd.head&&yd(),e}e&&e.enter()};Ld||Dd||Pd||!Md||!Ud?!Nd&&Vd&&Vd.resolve?((Ed=Vd.resolve(void 0)).constructor=Vd,Sd=Id(Ed.then,Ed),yd=function(){Sd(Hd)}):Dd?yd=function(){jd.nextTick(Hd)}:(kd=Id(kd,Od),yd=function(){kd(Hd)}):(wd=!0,bd=Ud.createTextNode(""),new Md(Hd).observe(bd,{characterData:!0}),yd=function(){bd.data=wd=!wd}),Fd=function(e){Gd.head||yd(),Gd.add(e)}}var qd=Fd,Wd=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},zd=_e.Promise,Kd="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Yd=!Kd&&!Gi&&"object"==typeof window&&"object"==typeof document,Jd=_e,Xd=zd,Zd=Pe,Qd=Zn,$d=ml,eu=_n,tu=Yd,nu=Kd,ru=bt,iu=Xd&&Xd.prototype,ou=eu("species"),au=!1,su=Zd(Jd.PromiseRejectionEvent),cu=Qd("Promise",(function(){var e=$d(Xd),t=e!==String(Xd);if(!t&&66===ru)return!0;if(!iu.catch||!iu.finally)return!0;if(!ru||ru<51||!/native code/.test(e)){var n=new Xd((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((n.constructor={})[ou]=r,!(au=n.then((function(){}))instanceof r))return!0}return!t&&(tu||nu)&&!su})),lu={CONSTRUCTOR:cu,REJECTION_EVENT:su,SUBCLASSING:au},du={},uu=Ut,pu=TypeError,hu=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw pu("Bad Promise constructor");t=e,n=r})),this.resolve=uu(t),this.reject=uu(n)};du.f=function(e){return new hu(e)};var fu,mu,gu=Nr,vu=Gi,_u=_e,yu=Ve,wu=ac,bu=Cc,Eu=Ut,Su=Pe,Tu=st,Cu=ul,Ru=Bl,Ou=vd.set,Iu=qd,Au=Wd,ku=Td,xu=Qs,Lu=zd,Nu=du,Pu="Promise",Du=lu.CONSTRUCTOR,Mu=lu.REJECTION_EVENT,Uu=xu.getterFor(Pu),ju=xu.set,Vu=Lu&&Lu.prototype,Bu=Lu,Fu=Vu,Gu=_u.TypeError,Hu=_u.document,qu=_u.process,Wu=Nu.f,zu=Wu,Ku=!!(Hu&&Hu.createEvent&&_u.dispatchEvent),Yu="unhandledrejection",Ju=function(e){var t;return!(!Tu(e)||!Su(t=e.then))&&t},Xu=function(e,t){var n,r,i,o=t.value,a=1==t.state,s=a?e.ok:e.fail,c=e.resolve,l=e.reject,d=e.domain;try{s?(a||(2===t.rejection&&tp(t),t.rejection=1),!0===s?n=o:(d&&d.enter(),n=s(o),d&&(d.exit(),i=!0)),n===e.promise?l(Gu("Promise-chain cycle")):(r=Ju(n))?yu(r,n,c,l):c(n)):l(o)}catch(e){d&&!i&&d.exit(),l(e)}},Zu=function(e,t){e.notified||(e.notified=!0,Iu((function(){for(var n,r=e.reactions;n=r.get();)Xu(n,e);e.notified=!1,t&&!e.rejection&&$u(e)})))},Qu=function(e,t,n){var r,i;Ku?((r=Hu.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),_u.dispatchEvent(r)):r={promise:t,reason:n},!Mu&&(i=_u["on"+e])?i(r):e===Yu&&function(e,t){try{1==arguments.length?console.error(e):console.error(e,t)}catch(e){}}("Unhandled promise rejection",n)},$u=function(e){yu(Ou,_u,(function(){var t,n=e.facade,r=e.value;if(ep(e)&&(t=Au((function(){vu?qu.emit("unhandledRejection",r,n):Qu(Yu,n,r)})),e.rejection=vu||ep(e)?2:1,t.error))throw t.value}))},ep=function(e){return 1!==e.rejection&&!e.parent},tp=function(e){yu(Ou,_u,(function(){var t=e.facade;vu?qu.emit("rejectionHandled",t):Qu("rejectionhandled",t,e.value)}))},np=function(e,t,n){return function(r){e(t,r,n)}},rp=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Zu(e,!0))},ip=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Gu("Promise can't be resolved itself");var r=Ju(t);r?Iu((function(){var n={done:!1};try{yu(r,t,np(ip,n,e),np(rp,n,e))}catch(t){rp(n,t,e)}})):(e.value=t,e.state=1,Zu(e,!1))}catch(t){rp({done:!1},t,e)}}};Du&&(Fu=(Bu=function(e){Cu(this,Fu),Eu(e),yu(fu,this);var t=Uu(this);try{e(np(ip,t),np(rp,t))}catch(e){rp(t,e)}}).prototype,(fu=function(e){ju(this,{type:Pu,done:!1,notified:!1,parent:!1,reactions:new ku,rejection:!1,state:0,value:void 0})}).prototype=wu(Fu,"then",(function(e,t){var n=Uu(this),r=Wu(Ru(this,Bu));return n.parent=!0,r.ok=!Su(e)||e,r.fail=Su(t)&&t,r.domain=vu?qu.domain:void 0,0==n.state?n.reactions.add(r):Iu((function(){Xu(r,n)})),r.promise})),mu=function(){var e=new fu,t=Uu(e);this.promise=e,this.resolve=np(ip,t),this.reject=np(rp,t)},Nu.f=Wu=function(e){return e===Bu||void 0===e?new mu(e):zu(e)}),gu({global:!0,constructor:!0,wrap:!0,forced:Du},{Promise:Bu}),bu(Bu,Pu,!1,!0),function(e){var t=ol(e);sl&&t&&!t[cl]&&al(t,cl,{configurable:!0,get:function(){return this}})}(Pu);var op=_n("iterator"),ap=!1;try{var sp=0,cp={next:function(){return{done:!!sp++}},return:function(){ap=!0}};cp[op]=function(){return this},Array.from(cp,(function(){throw 2}))}catch(e){}var lp=zd,dp=lu.CONSTRUCTOR||!function(e,t){if(!t&&!ap)return!1;var n=!1;try{var r={};r[op]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}((function(e){lp.all(e).then(void 0,(function(){}))})),up=Ve,pp=Ut,hp=du,fp=Wd,mp=ms;Nr({target:"Promise",stat:!0,forced:dp},{all:function(e){var t=this,n=hp.f(t),r=n.resolve,i=n.reject,o=fp((function(){var n=pp(t.resolve),o=[],a=0,s=1;mp(e,(function(e){var c=a++,l=!1;s++,up(n,t,e).then((function(e){l||(l=!0,o[c]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise}});var gp=Nr,vp=lu.CONSTRUCTOR;zd&&zd.prototype,gp({target:"Promise",proto:!0,forced:vp,real:!0},{catch:function(e){return this.then(void 0,e)}});var _p=Ve,yp=Ut,wp=du,bp=Wd,Ep=ms;Nr({target:"Promise",stat:!0,forced:dp},{race:function(e){var t=this,n=wp.f(t),r=n.reject,i=bp((function(){var i=yp(t.resolve);Ep(e,(function(e){_p(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var Sp=Ve,Tp=du;Nr({target:"Promise",stat:!0,forced:lu.CONSTRUCTOR},{reject:function(e){var t=Tp.f(this);return Sp(t.reject,void 0,e),t.promise}});var Cp=sr,Rp=st,Op=du,Ip=function(e,t){if(Cp(e),Rp(t)&&t.constructor===e)return t;var n=Op.f(e);return(0,n.resolve)(t),n.promise},Ap=Nr,kp=zd,xp=lu.CONSTRUCTOR,Lp=Ip,Np=ht("Promise"),Pp=!xp;Ap({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return Lp(Pp&&this===Np?kp:this,e)}});var Dp=Ve,Mp=Ut,Up=du,jp=Wd,Vp=ms;Nr({target:"Promise",stat:!0,forced:dp},{allSettled:function(e){var t=this,n=Up.f(t),r=n.resolve,i=n.reject,o=jp((function(){var n=Mp(t.resolve),i=[],o=0,a=1;Vp(e,(function(e){var s=o++,c=!1;a++,Dp(n,t,e).then((function(e){c||(c=!0,i[s]={status:"fulfilled",value:e},--a||r(i))}),(function(e){c||(c=!0,i[s]={status:"rejected",reason:e},--a||r(i))}))})),--a||r(i)}));return o.error&&i(o.value),n.promise}});var Bp=Ve,Fp=Ut,Gp=ht,Hp=du,qp=Wd,Wp=ms,zp="No one promise resolved";Nr({target:"Promise",stat:!0,forced:dp},{any:function(e){var t=this,n=Gp("AggregateError"),r=Hp.f(t),i=r.resolve,o=r.reject,a=qp((function(){var r=Fp(t.resolve),a=[],s=0,c=1,l=!1;Wp(e,(function(e){var d=s++,u=!1;c++,Bp(r,t,e).then((function(e){u||l||(l=!0,i(e))}),(function(e){u||l||(u=!0,a[d]=e,--c||o(new n(a,zp)))}))})),--c||o(new n(a,zp))}));return a.error&&o(a.value),r.promise}});var Kp=Nr,Yp=zd,Jp=le,Xp=ht,Zp=Pe,Qp=Bl,$p=Ip,eh=Yp&&Yp.prototype;Kp({target:"Promise",proto:!0,real:!0,forced:!!Yp&&Jp((function(){eh.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=Qp(this,Xp("Promise")),n=Zp(e);return this.then(n?function(n){return $p(t,e()).then((function(){return n}))}:e,n?function(n){return $p(t,e()).then((function(){throw n}))}:e)}});var th=me,nh=jr,rh=wi,ih=tt,oh=th("".charAt),ah=th("".charCodeAt),sh=th("".slice),ch=function(e){return function(t,n){var r,i,o=rh(ih(t)),a=nh(n),s=o.length;return a<0||a>=s?e?"":void 0:(r=ah(o,a))<55296||r>56319||a+1===s||(i=ah(o,a+1))<56320||i>57343?e?oh(o,a):r:e?sh(o,a,a+2):i-56320+(r-55296<<10)+65536}},lh={codeAt:ch(!1),charAt:ch(!0)},dh=lh.charAt,uh=wi,ph=Qs,hh=Kc,fh=Yc,mh="String Iterator",gh=ph.set,vh=ph.getterFor(mh);hh(String,"String",(function(e){gh(this,{type:mh,string:uh(e),index:0})}),(function(){var e,t=vh(this),n=t.string,r=t.index;return r>=n.length?fh(void 0,!0):(e=dh(n,r),t.index+=e.length,fh(e,!1))}));var _h=ct.Promise,yh=_e,wh=vi,bh=br,Eh=Pa,Sh=_n("toStringTag");for(var Th in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Ch=yh[Th],Rh=Ch&&Ch.prototype;Rh&&wh(Rh)!==Sh&&bh(Rh,Sh,Th),Eh[Th]=Eh.Array}var Oh=_h,Ih=ce(Oh);const Ah=no;function kh(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const a=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let a=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>{var n;return Li(n=e.label.toLowerCase()).call(n,t)}))));return!a&&n.length&&Li(t).call(t,"back")&&(a=n[n.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=r(e.video),Ah("chrome: "+JSON.stringify(e)),i(e)}))}e.video=r(e.video)}return Ah("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Ih.reject(o(e))))))}}}function xh(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Lh(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else $i(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function Nh(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Ph(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Ih(((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])})).then(n,r)}}function Dh(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>so(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),$i(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>so(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?Ih.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Ih.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Mh(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function Uh(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Mh(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find((e=>e.track===t));if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Ih.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function jh(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function Vh(e,t){$i(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var Bh=Object.freeze({__proto__:null,fixNegotiationNeeded:Vh,shimAddTrackRemoveTrack:Uh,shimAddTrackRemoveTrackWithNative:Mh,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:Nh,shimGetStats:Ph,shimGetUserMedia:kh,shimMediaStream:xh,shimOnTrack:Lh,shimPeerConnection:jh,shimSenderReceiverGetStats:Dh});function Fh(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){ro("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function Gh(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Hh(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,o)}}function qh(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Ih.resolve(new Map)}}function Wh(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),$i(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function zh(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){ro("removeStream","removeTrack"),this.getSenders().forEach((t=>{var n;t.track&&Li(n=e.getTracks()).call(n,t.track)&&this.removeTrack(t)}))})}function Kh(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Yh(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function Jh(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Xh(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ih.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Zh(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ih.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var Qh=Object.freeze({__proto__:null,shimAddTransceiver:Yh,shimCreateAnswer:Zh,shimCreateOffer:Xh,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Ih.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:Jh,shimGetUserMedia:Fh,shimOnTrack:Gh,shimPeerConnection:Hh,shimRTCDataChannel:Kh,shimReceiverGetStats:Wh,shimRemoveStream:zh,shimSenderGetStats:qh});function $h(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n;this._localStreams||(this._localStreams=[]),Li(n=this._localStreams).call(n,e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r&&r.forEach((e=>{var t;this._localStreams?Li(t=this._localStreams).call(t,e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{Li(n).call(n,e.track)&&this.removeTrack(e)}))})}}function ef(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{var t;if(this._remoteStreams||(this._remoteStreams=[]),Li(t=this._remoteStreams).call(t,e))return;this._remoteStreams.push(e);const n=new Event("addstream");n.stream=e,this.dispatchEvent(n)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function tf(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Ih.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Ih.resolve()):i};let s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Ih.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Ih.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),Ih.resolve()):r},t.addIceCandidate=s}function nf(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(rf(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function rf(e){return e&&void 0!==e.video?Object.assign({},e,{video:oo(e.video)}):e}function of(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(ro("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function af(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function sf(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function cf(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var lf=Object.freeze({__proto__:null,shimAudioContext:cf,shimCallbacksAPI:tf,shimConstraints:rf,shimCreateOfferLegacy:sf,shimGetUserMedia:nf,shimLocalStreamsAPI:$h,shimRTCIceServerUrls:of,shimRemoteStreamsAPI:ef,shimTrackEventTransceiver:af}),df="\t\n\v\f\r \u2028\u2029\ufeff",uf=tt,pf=wi,hf=df,ff=me("".replace),mf=RegExp("^["+hf+"]+"),gf=RegExp("(^|[^"+hf+"])["+hf+"]+$"),vf=function(e){return function(t){var n=pf(uf(t));return 1&e&&(n=ff(n,mf,"")),2&e&&(n=ff(n,gf,"$1")),n}},_f={start:vf(1),end:vf(2),trim:vf(3)},yf=ic.PROPER,wf=le,bf=df,Ef=_f.trim;Nr({target:"String",proto:!0,forced:function(e){return wf((function(){return!!bf[e]()||""!==""[e]()||yf&&bf[e].name!==e}))}("trim")},{trim:function(){return Ef(this)}});var Sf=ti("String").trim,Tf=ge,Cf=Sf,Rf=String.prototype,Of=ce((function(e){var t=e.trim;return"string"==typeof e||e===Rf||Tf(Rf,e)&&t===Rf.trim?Cf:t})),If={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const r=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<r.length;e++)n=r[e].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substring(12),password:i.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" ");n.profile=r[2];for(let i=3;i<r.length;i++){const o=r[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){const r=t.parseRtpMap(a),i=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(r.parameters=i.length?t.parseFmtp(i[0]):{},r.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(r),r.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(r.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const i=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{i.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));let i=0;return n.codecs.forEach((e=>{e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){const n=[],r=t.parseRtpParameters(e),i=-1!==r.fecMechanisms.indexOf("RED"),o=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),r.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),i&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&s&&n.push({ssrc:s});let d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substring(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=d}))),n},t.parseRtcpParameters=function(e){const n={},r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const r=t.matchPrefix(e,"a=msid:");if(1===r.length)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return i.length>0?(n=i[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");let i;r.length>0&&(i=parseInt(r[0].substring(19),10)),isNaN(i)&&(i=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:i};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:i}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,r){let i;const o=void 0!==n?n:2;return i=e||t.generateSessionId(),"v=0\r\no="+(r||"thisisadapterortc")+" "+i+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const r=t.splitLines(e);for(let e=0;e<r.length;e++)switch(r[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[e].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let e=0;e<n.length;e++)if(n[e].length<2||"="!==n[e].charAt(1))return!1;return!0},e.exports=t}(If);var Af=If.exports,kf=ce(Af),xf=function(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}({__proto__:null,default:kf},[Af]);function Lf(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=kf.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,$i(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Nf(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||$i(e,"icecandidate",(e=>{if(e.candidate){const t=kf.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function Pf(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},r=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=kf.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=kf.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=kf.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),t=n(e),i=r(arguments[0],e);let o;o=0===t&&0===i?Number.POSITIVE_INFINITY:0===t||0===i?Math.max(t,i):Math.min(t,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>o}),this._sctp=a}return i.apply(this,arguments)}}function Df(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},$i(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Mf(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Uf(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==Of(e).call(e))).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function jf(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Ih.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Ih.resolve())})}function Vf(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}var Bf=Object.freeze({__proto__:null,removeExtmapAllowMixed:Uf,shimAddIceCandidateNullOrEmpty:jf,shimConnectionState:Mf,shimMaxMessageSize:Pf,shimParameterlessSetLocalDescription:Vf,shimRTCIceCandidate:Lf,shimRTCIceCandidateRelayProtocol:Nf,shimSendThrowTypeError:Df});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=no,r=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Qi(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Qi(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Qi(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:Bf,extractVersion:Qi,disableLog:eo,disableWarnings:to,sdp:xf};switch(r.browser){case"chrome":if(!Bh||!jh||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Bh,jf(e,r),Vf(e),kh(e,r),xh(e),jh(e,r),Lh(e),Uh(e,r),Nh(e),Ph(e),Dh(e),Vh(e,r),Lf(e),Nf(e),Mf(e),Pf(e,r),Df(e),Uf(e,r);break;case"firefox":if(!Qh||!Hh||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Qh,jf(e,r),Vf(e),Fh(e,r),Hh(e,r),Gh(e),zh(e),qh(e),Wh(e),Kh(e),Yh(e),Jh(e),Xh(e),Zh(e),Lf(e),Mf(e),Pf(e,r),Df(e);break;case"safari":if(!lf||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=lf,jf(e,r),Vf(e),of(e),sf(e),tf(e),$h(e),ef(e),af(e),nf(e),cf(e),Lf(e),Nf(e),Pf(e,r),Df(e),Uf(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var Ff=ti("Array").keys,Gf=vi,Hf=rn,qf=ge,Wf=Ff,zf=Array.prototype,Kf={DOMTokenList:!0,NodeList:!0},Yf=ce((function(e){var t=e.keys;return e===zf||qf(zf,e)&&t===zf.keys||Hf(Kf,Gf(e))?Wf:t})),Jf=Nt,Xf=TypeError,Zf=On,Qf=nr,$f=ze,em=function(e,t,n){var r=Zf(t);r in e?Qf.f(e,r,$f(0,n)):e[r]=n},tm=Gr,nm=Kr,rm=em,im=Array,om=Math.max,am=function(e,t,n){for(var r=nm(e),i=tm(t,r),o=tm(void 0===n?r:n,r),a=im(om(o-i,0)),s=0;i<o;i++,s++)rm(a,s,e[i]);return a.length=s,a},sm=am,cm=Math.floor,lm=function(e,t){var n=e.length,r=cm(n/2);return n<8?dm(e,t):um(e,lm(sm(e,0,r),t),lm(sm(e,r),t),t)},dm=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},um=function(e,t,n,r){for(var i=t.length,o=n.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?r(t[a],n[s])<=0?t[a++]:n[s++]:a<i?t[a++]:n[s++];return e},pm=lm,hm=ft.match(/firefox\/(\d+)/i),fm=!!hm&&+hm[1],mm=/MSIE|Trident/.test(ft),gm=ft.match(/AppleWebKit\/(\d+)\./),vm=!!gm&&+gm[1],_m=Nr,ym=me,wm=Ut,bm=en,Em=Kr,Sm=function(e,t){if(!delete e[t])throw Xf("Cannot delete property "+Jf(t)+" of "+Jf(e))},Tm=wi,Cm=le,Rm=pm,Om=Fi,Im=fm,Am=mm,km=bt,xm=vm,Lm=[],Nm=ym(Lm.sort),Pm=ym(Lm.push),Dm=Cm((function(){Lm.sort(void 0)})),Mm=Cm((function(){Lm.sort(null)})),Um=Om("sort"),jm=!Cm((function(){if(km)return km<70;if(!(Im&&Im>3)){if(Am)return!0;if(xm)return xm<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)Lm.push({k:t+r,v:n})}for(Lm.sort((function(e,t){return t.v-e.v})),r=0;r<Lm.length;r++)t=Lm[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));_m({target:"Array",proto:!0,forced:Dm||!Mm||!Um||!jm},{sort:function(e){void 0!==e&&wm(e);var t=bm(this);if(jm)return void 0===e?Nm(t):Nm(t,e);var n,r,i=[],o=Em(t);for(r=0;r<o;r++)r in t&&Pm(i,t[r]);for(Rm(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:Tm(t)>Tm(n)?1:-1}}(e)),n=Em(i),r=0;r<n;)t[r]=i[r++];for(;r<o;)Sm(t,r++);return t}});var Vm,Bm,Fm=ti("Array").sort,Gm=ge,Hm=Fm,qm=Array.prototype,Wm=ce((function(e){var t=e.sort;return e===qm||Gm(qm,e)&&t===qm.sort?Hm:t})),zm={exports:{}};Vm=zm,Bm=zm.exports,function(e,t){var n="function",r="undefined",i="object",o="string",a="major",s="model",c="name",l="type",d="vendor",u="version",p="architecture",h="console",f="mobile",m="tablet",g="smarttv",v="wearable",_="embedded",y="Amazon",w="Apple",b="ASUS",E="BlackBerry",S="Browser",T="Chrome",C="Firefox",R="Google",O="Huawei",I="LG",A="Microsoft",k="Motorola",x="Opera",L="Samsung",N="Sharp",P="Sony",D="Xiaomi",M="Zebra",U="Facebook",j="Chromium OS",V="Mac OS",B=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},F=function(e,t){return typeof e===o&&-1!==G(t).indexOf(G(e))},G=function(e){return e.toLowerCase()},H=function(e,t){if(typeof e===o)return e=e.replace(/^\s\s*/,""),typeof t===r?e:e.substring(0,350)},q=function(e,r){for(var o,a,s,c,l,d,u=0;u<r.length&&!l;){var p=r[u],h=r[u+1];for(o=a=0;o<p.length&&!l&&p[o];)if(l=p[o++].exec(e))for(s=0;s<h.length;s++)d=l[++a],typeof(c=h[s])===i&&c.length>0?2===c.length?typeof c[1]==n?this[c[0]]=c[1].call(this,d):this[c[0]]=c[1]:3===c.length?typeof c[1]!==n||c[1].exec&&c[1].test?this[c[0]]=d?d.replace(c[1],c[2]):t:this[c[0]]=d?c[1].call(this,d,c[2]):t:4===c.length&&(this[c[0]]=d?c[3].call(this,d.replace(c[1],c[2])):t):this[c]=d||t;u+=2}},W=function(e,n){for(var r in n)if(typeof n[r]===i&&n[r].length>0){for(var o=0;o<n[r].length;o++)if(F(n[r][o],e))return"?"===r?t:r}else if(F(n[r],e))return"?"===r?t:r;return e},z={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},K={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[u,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[u,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,u],[/opios[\/ ]+([\w\.]+)/i],[u,[c,x+" Mini"]],[/\bopr\/([\w\.]+)/i],[u,[c,x]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,u],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[u,[c,"UC"+S]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[u,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[u,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[u,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[u,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[u,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure "+S],u],[/\bfocus\/([\w\.]+)/i],[u,[c,C+" Focus"]],[/\bopt\/([\w\.]+)/i],[u,[c,x+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[u,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[u,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[u,[c,x+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[u,[c,"MIUI "+S]],[/fxios\/([-\w\.]+)/i],[u,[c,C]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 "+S]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 "+S],u],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],u],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[c,u],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,U],u],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[c,u],[/\bgsa\/([\w\.]+) .*safari\//i],[u,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[u,[c,T+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,T+" WebView"],u],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[u,[c,"Android "+S]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,u],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[u,[c,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[u,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[u,W,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[c,u],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],u],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[u,[c,C+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[c,u],[/(cobalt)\/([\w\.]+)/i],[c,[u,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,G]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[s,[d,L],[l,m]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[s,[d,L],[l,f]],[/\((ip(?:hone|od)[\w ]*);/i],[s,[d,w],[l,f]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[s,[d,w],[l,m]],[/(macintosh);/i],[s,[d,w]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[s,[d,N],[l,f]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[s,[d,O],[l,m]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[s,[d,O],[l,f]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[s,/_/g," "],[d,D],[l,f]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[s,/_/g," "],[d,D],[l,m]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[s,[d,"OPPO"],[l,f]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[s,[d,"Vivo"],[l,f]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[s,[d,"Realme"],[l,f]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[s,[d,k],[l,f]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[s,[d,k],[l,m]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[s,[d,I],[l,m]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[s,[d,I],[l,f]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[s,[d,"Lenovo"],[l,m]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[s,/_/g," "],[d,"Nokia"],[l,f]],[/(pixel c)\b/i],[s,[d,R],[l,m]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[s,[d,R],[l,f]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[d,P],[l,f]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[s,"Xperia Tablet"],[d,P],[l,m]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[s,[d,"OnePlus"],[l,f]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[s,[d,y],[l,m]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[s,/(.+)/g,"Fire Phone $1"],[d,y],[l,f]],[/(playbook);[-\w\),; ]+(rim)/i],[s,d,[l,m]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[s,[d,E],[l,f]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[s,[d,b],[l,m]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[s,[d,b],[l,f]],[/(nexus 9)/i],[s,[d,"HTC"],[l,m]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[s,/_/g," "],[l,f]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[s,[d,"Acer"],[l,m]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[s,[d,"Meizu"],[l,f]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,s,[l,f]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,s,[l,m]],[/(surface duo)/i],[s,[d,A],[l,m]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[s,[d,"Fairphone"],[l,f]],[/(u304aa)/i],[s,[d,"AT&T"],[l,f]],[/\bsie-(\w*)/i],[s,[d,"Siemens"],[l,f]],[/\b(rct\w+) b/i],[s,[d,"RCA"],[l,m]],[/\b(venue[\d ]{2,7}) b/i],[s,[d,"Dell"],[l,m]],[/\b(q(?:mv|ta)\w+) b/i],[s,[d,"Verizon"],[l,m]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[s,[d,"Barnes & Noble"],[l,m]],[/\b(tm\d{3}\w+) b/i],[s,[d,"NuVision"],[l,m]],[/\b(k88) b/i],[s,[d,"ZTE"],[l,m]],[/\b(nx\d{3}j) b/i],[s,[d,"ZTE"],[l,f]],[/\b(gen\d{3}) b.+49h/i],[s,[d,"Swiss"],[l,f]],[/\b(zur\d{3}) b/i],[s,[d,"Swiss"],[l,m]],[/\b((zeki)?tb.*\b) b/i],[s,[d,"Zeki"],[l,m]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],s,[l,m]],[/\b(ns-?\w{0,9}) b/i],[s,[d,"Insignia"],[l,m]],[/\b((nxa|next)-?\w{0,9}) b/i],[s,[d,"NextBook"],[l,m]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],s,[l,f]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],s,[l,f]],[/\b(ph-1) /i],[s,[d,"Essential"],[l,f]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[s,[d,"Envizen"],[l,m]],[/\b(trio[-\w\. ]+) b/i],[s,[d,"MachSpeed"],[l,m]],[/\btu_(1491) b/i],[s,[d,"Rotor"],[l,m]],[/(shield[\w ]+) b/i],[s,[d,"Nvidia"],[l,m]],[/(sprint) (\w+)/i],[d,s,[l,f]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[d,A],[l,f]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[s,[d,M],[l,m]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[s,[d,M],[l,f]],[/smart-tv.+(samsung)/i],[d,[l,g]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[d,L],[l,g]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,I],[l,g]],[/(apple) ?tv/i],[d,[s,w+" TV"],[l,g]],[/crkey/i],[[s,T+"cast"],[d,R],[l,g]],[/droid.+aft(\w)( bui|\))/i],[s,[d,y],[l,g]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[s,[d,N],[l,g]],[/(bravia[\w ]+)( bui|\))/i],[s,[d,P],[l,g]],[/(mitv-\w{5}) bui/i],[s,[d,D],[l,g]],[/Hbbtv.*(technisat) (.*);/i],[d,s,[l,g]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,H],[s,H],[l,g]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,g]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,s,[l,h]],[/droid.+; (shield) bui/i],[s,[d,"Nvidia"],[l,h]],[/(playstation [345portablevi]+)/i],[s,[d,P],[l,h]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[s,[d,A],[l,h]],[/((pebble))app/i],[d,s,[l,v]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[s,[d,w],[l,v]],[/droid.+; (glass) \d/i],[s,[d,R],[l,v]],[/droid.+; (wt63?0{2,3})\)/i],[s,[d,M],[l,v]],[/(quest( 2| pro)?)/i],[s,[d,U],[l,v]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[l,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[s,[l,f]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[s,[l,m]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,m]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[l,f]],[/(android[-\w\. ]{0,9});.+buil/i],[s,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[u,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[u,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[c,u],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[u,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,u],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[c,[u,W,z]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[c,"Windows"],[u,W,z]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[u,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,V],[u,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[u,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,u],[/\(bb(10);/i],[u,[c,E]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[u,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[u,[c,C+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[u,[c,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[u,[c,"watchOS"]],[/crkey\/([\d\.]+)/i],[u,[c,T+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[c,j],u],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,u],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],u],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[c,u]]},Y=function(h,g){if(typeof h===i&&(g=h,h=t),!(this instanceof Y))return new Y(h,g).getResult();var v=typeof e!==r&&e.navigator?e.navigator:t,_=h||(v&&v.userAgent?v.userAgent:""),y=v&&v.userAgentData?v.userAgentData:t,w=g?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(K,g):K;return this.getBrowser=function(){var e={};return e[c]=t,e[u]=t,q.call(e,_,w.browser),e[a]=function(e){return typeof e===o?e.replace(/[^\d\.]/g,"").split(".")[0]:t}(e[u]),v&&v.brave&&typeof v.brave.isBrave==n&&(e[c]="Brave"),e},this.getCPU=function(){var e={};return e[p]=t,q.call(e,_,w.cpu),e},this.getDevice=function(){var e={};return e[d]=t,e[s]=t,e[l]=t,q.call(e,_,w.device),!e[l]&&y&&y.mobile&&(e[l]=f),"Macintosh"==e[s]&&v&&typeof v.standalone!==r&&v.maxTouchPoints&&v.maxTouchPoints>2&&(e[s]="iPad",e[l]=m),e},this.getEngine=function(){var e={};return e[c]=t,e[u]=t,q.call(e,_,w.engine),e},this.getOS=function(){var e={};return e[c]=t,e[u]=t,q.call(e,_,w.os),!e[c]&&y&&"Unknown"!=y.platform&&(e[c]=y.platform.replace(/chrome os/i,j).replace(/macos/i,V)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return _},this.setUA=function(e){return _=typeof e===o&&e.length>350?H(e,350):e,this},this.setUA(_),this};Y.VERSION="0.7.34",Y.BROWSER=B([c,u,a]),Y.CPU=B([p]),Y.DEVICE=B([s,d,l,h,f,g,m,v,_]),Y.ENGINE=Y.OS=B([c,u]),Vm.exports&&(Bm=Vm.exports=Y),Bm.UAParser=Y;var J=typeof e!==r&&(e.jQuery||e.Zepto);if(J&&!J.ua){var X=new Y;J.ua=X.getResult(),J.ua.get=function(){return X.getUA()},J.ua.set=function(e){X.setUA(e);var t=X.getResult();for(var n in t)J.ua[n]=t[n]}}}("object"==typeof window?window:se);var Km=ce(zm.exports),Ym=vi,Jm=rn,Xm=Qe,Zm=Pa,Qm=_n("iterator"),$m=Object,eg=ce((function(e){if(Xm(e))return!1;var t=$m(e);return void 0!==t[Qm]||"@@iterator"in t||Jm(Zm,Ym(t))})),tg=_e;Nr({global:!0,forced:tg.globalThis!==tg},{globalThis:tg});var ng=ce(_e);function rg(e,t){return function(){return e.apply(t,arguments)}}const{toString:ig}=Object.prototype,{getPrototypeOf:og}=Object,ag=(sg=Object.create(null),e=>{const t=ig.call(e);return sg[t]||(sg[t]=t.slice(8,-1).toLowerCase())});var sg;const cg=e=>(e=e.toLowerCase(),t=>ag(t)===e),lg=e=>t=>typeof t===e,{isArray:dg}=Array,ug=lg("undefined"),pg=cg("ArrayBuffer"),hg=lg("string"),fg=lg("function"),mg=lg("number"),gg=e=>null!==e&&"object"==typeof e,vg=e=>{if("object"!==ag(e))return!1;const t=og(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||eg(e))},_g=cg("Date"),yg=cg("File"),wg=cg("Blob"),bg=cg("FileList"),Eg=cg("URLSearchParams");function Sg(e,t){let n,r,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e)if("object"!=typeof e&&(e=[e]),dg(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=i?Object.getOwnPropertyNames(e):Object.keys(e),o=r.length;let a;for(n=0;n<o;n++)a=r[n],t.call(null,e[a],a,e)}}function Tg(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const Cg=void 0!==ng?ng:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Rg=e=>!ug(e)&&e!==Cg,Og=(Ig="undefined"!=typeof Uint8Array&&og(Uint8Array),e=>Ig&&e instanceof Ig);var Ig;const Ag=cg("HTMLFormElement"),kg=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),xg=cg("RegExp"),Lg=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Sg(n,((n,i)=>{let o;!1!==(o=t(n,i,e))&&(r[i]=o||n)})),Object.defineProperties(e,r)},Ng="abcdefghijklmnopqrstuvwxyz",Pg="0123456789",Dg={DIGIT:Pg,ALPHA:Ng,ALPHA_DIGIT:Ng+Ng.toUpperCase()+Pg},Mg=cg("AsyncFunction");var Ug={isArray:dg,isArrayBuffer:pg,isBuffer:function(e){return null!==e&&!ug(e)&&null!==e.constructor&&!ug(e.constructor)&&fg(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||fg(e.append)&&("formdata"===(t=ag(e))||"object"===t&&fg(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&pg(e.buffer),t},isString:hg,isNumber:mg,isBoolean:e=>!0===e||!1===e,isObject:gg,isPlainObject:vg,isUndefined:ug,isDate:_g,isFile:yg,isBlob:wg,isRegExp:xg,isFunction:fg,isStream:e=>gg(e)&&fg(e.pipe),isURLSearchParams:Eg,isTypedArray:Og,isFileList:bg,forEach:Sg,merge:function e(){const{caseless:t}=Rg(this)&&this||{},n={},r=(r,i)=>{const o=t&&Tg(n,i)||i;vg(n[o])&&vg(r)?n[o]=e(n[o],r):vg(r)?n[o]=e({},r):dg(r)?n[o]=r.slice():n[o]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&Sg(arguments[e],r);return n},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Sg(t,((t,r)=>{n&&fg(t)?e[r]=rg(t,n):e[r]=t}),{allOwnKeys:r}),e},trim:e=>Of(e)?Of(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,o,a;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)a=i[o],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&og(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:ag,kindOfTest:cg,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(dg(e))return e;let t=e.length;if(!mg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Ag,hasOwnProperty:kg,hasOwnProp:kg,reduceDescriptors:Lg,freezeMethods:e=>{Lg(e,((t,n)=>{if(fg(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];fg(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return dg(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:Tg,global:Cg,isContextDefined:Rg,ALPHABET:Dg,generateString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dg.ALPHA_DIGIT,n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&fg(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(gg(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const i=dg(e)?[]:{};return Sg(e,((e,t)=>{const o=n(e,r+1);!ug(o)&&(i[t]=o)})),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:Mg,isThenable:e=>e&&(gg(e)||fg(e))&&fg(e.then)&&fg(e.catch)};function jg(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}Ug.inherits(jg,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ug.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Vg=jg.prototype,Bg={};function Fg(e){return Ug.isPlainObject(e)||Ug.isArray(e)}function Gg(e){return Ug.endsWith(e,"[]")?e.slice(0,-2):e}function Hg(e,t,n){return e?e.concat(t).map((function(e,t){return e=Gg(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Bg[e]={value:e}})),Object.defineProperties(jg,Bg),Object.defineProperty(Vg,"isAxiosError",{value:!0}),jg.from=(e,t,n,r,i,o)=>{const a=Object.create(Vg);return Ug.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),jg.call(a,e.message,t,n,r,i),a.cause=e,a.name=e.name,o&&Object.assign(a,o),a};const qg=Ug.toFlatObject(Ug,{},null,(function(e){return/^is[A-Z]/.test(e)}));function Wg(e,t,n){if(!Ug.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=Ug.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Ug.isUndefined(t[e])}))).metaTokens,i=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Ug.isSpecCompliantForm(t);if(!Ug.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Ug.isDate(e))return e.toISOString();if(!s&&Ug.isBlob(e))throw new jg("Blob is not supported. Use a Buffer instead.");return Ug.isArrayBuffer(e)||Ug.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,i){let s=e;if(e&&!i&&"object"==typeof e)if(Ug.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(Ug.isArray(e)&&function(e){return Ug.isArray(e)&&!e.some(Fg)}(e)||(Ug.isFileList(e)||Ug.endsWith(n,"[]"))&&(s=Ug.toArray(e)))return n=Gg(n),s.forEach((function(e,r){!Ug.isUndefined(e)&&null!==e&&t.append(!0===a?Hg([n],r,o):null===a?n:n+"[]",c(e))})),!1;return!!Fg(e)||(t.append(Hg(i,n,o),c(e)),!1)}const d=[],u=Object.assign(qg,{defaultVisitor:l,convertValue:c,isVisitable:Fg});if(!Ug.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!Ug.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),Ug.forEach(n,(function(n,o){!0===(!(Ug.isUndefined(n)||null===n)&&i.call(t,n,Ug.isString(o)?Of(o).call(o):o,r,u))&&e(n,r?r.concat(o):[o])})),d.pop()}}(e),t}function zg(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Kg(e,t){this._pairs=[],e&&Wg(e,this,t)}const Yg=Kg.prototype;function Jg(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Xg(e,t,n){if(!t)return e;const r=n&&n.encode||Jg,i=n&&n.serialize;let o;if(o=i?i(t,n):Ug.isURLSearchParams(t)?t.toString():new Kg(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}Yg.append=function(e,t){this._pairs.push([e,t])},Yg.toString=function(e){const t=e?function(t){return e.call(this,t,zg)}:zg;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var Zg=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ug.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Qg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$g={exports:{}},ev=Nr,tv=Me,nv=nr.f;ev({target:"Object",stat:!0,forced:Object.defineProperty!==nv,sham:!tv},{defineProperty:nv});var rv=ct.Object,iv=$g.exports=function(e,t,n){return rv.defineProperty(e,t,n)};rv.defineProperty.sham&&(iv.sham=!0);var ov=ce($g.exports),av=Oe,sv=Array.isArray||function(e){return"Array"==av(e)},cv=TypeError,lv=sv,dv=Nl,uv=st,pv=_n("species"),hv=Array,fv=function(e,t){return new(function(e){var t;return lv(e)&&(t=e.constructor,(dv(t)&&(t===hv||lv(t.prototype))||uv(t)&&null===(t=t[pv]))&&(t=void 0)),void 0===t?hv:t}(e))(0===t?0:t)},mv=le,gv=bt,vv=_n("species"),_v=function(e){return gv>=51||!mv((function(){var t=[];return(t.constructor={})[vv]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},yv=Nr,wv=le,bv=sv,Ev=st,Sv=en,Tv=Kr,Cv=function(e){if(e>9007199254740991)throw cv("Maximum allowed index exceeded");return e},Rv=em,Ov=fv,Iv=_v,Av=bt,kv=_n("isConcatSpreadable"),xv=Av>=51||!wv((function(){var e=[];return e[kv]=!1,e.concat()[0]!==e})),Lv=function(e){if(!Ev(e))return!1;var t=e[kv];return void 0!==t?!!t:bv(e)};yv({target:"Array",proto:!0,arity:1,forced:!xv||!Iv("concat")},{concat:function(e){var t,n,r,i,o,a=Sv(this),s=Ov(a,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(Lv(o=-1===t?a:arguments[t]))for(i=Tv(o),Cv(c+i),n=0;n<i;n++,c++)n in o&&Rv(s,c,o[n]);else Cv(c+1),Rv(s,c++,o);return s.length=c,s}});var Nv={},Pv=Oe,Dv=it,Mv=Io.f,Uv=am,jv="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Nv.f=function(e){return jv&&"Window"==Pv(e)?function(e){try{return Mv(e)}catch(e){return Uv(jv)}}(e):Mv(Dv(e))};var Vv={},Bv=_n;Vv.f=Bv;var Fv=ct,Gv=rn,Hv=Vv,qv=nr.f,Wv=function(e){var t=Fv.Symbol||(Fv.Symbol={});Gv(t,e)||qv(t,e,{value:Hv.f(e)})},zv=Ve,Kv=ht,Yv=_n,Jv=ac,Xv=function(){var e=Kv("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,r=Yv("toPrimitive");t&&!t[r]&&Jv(t,r,(function(e){return zv(n,this)}),{arity:1})},Zv=tr,Qv=Ze,$v=en,e_=Kr,t_=fv,n_=me([].push),r_=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(c,l,d,u){for(var p,h,f=$v(c),m=Qv(f),g=Zv(l,d),v=e_(m),_=0,y=u||t_,w=t?y(c,v):n||a?y(c,0):void 0;v>_;_++)if((s||_ in m)&&(h=g(p=m[_],_,f),e))if(t)w[_]=h;else if(h)switch(e){case 3:return!0;case 5:return p;case 6:return _;case 2:n_(w,p)}else switch(e){case 4:return!1;case 7:n_(w,p)}return o?-1:r||i?i:w}},i_={forEach:r_(0),map:r_(1),filter:r_(2),some:r_(3),every:r_(4),find:r_(5),findIndex:r_(6),filterReject:r_(7)},o_=Nr,a_=_e,s_=Ve,c_=me,l_=Me,d_=Ct,u_=le,p_=rn,h_=ge,f_=sr,m_=it,g_=On,v_=wi,__=ze,y_=ba,w_=$o,b_=Io,E_=Nv,S_=Vo,T_=De,C_=nr,R_=Xo,O_=Be,I_=ac,A_=il,k_=Zt,x_=Ao,L_=ln,N_=_n,P_=Vv,D_=Wv,M_=Xv,U_=Cc,j_=Qs,V_=i_.forEach,B_=uo("hidden"),F_="Symbol",G_="prototype",H_=j_.set,q_=j_.getterFor(F_),W_=Object[G_],z_=a_.Symbol,K_=z_&&z_[G_],Y_=a_.TypeError,J_=a_.QObject,X_=T_.f,Z_=C_.f,Q_=E_.f,$_=O_.f,ey=c_([].push),ty=k_("symbols"),ny=k_("op-symbols"),ry=k_("wks"),iy=!J_||!J_[G_]||!J_[G_].findChild,oy=l_&&u_((function(){return 7!=y_(Z_({},"a",{get:function(){return Z_(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=X_(W_,t);r&&delete W_[t],Z_(e,t,n),r&&e!==W_&&Z_(W_,t,r)}:Z_,ay=function(e,t){var n=ty[e]=y_(K_);return H_(n,{type:F_,tag:e,description:t}),l_||(n.description=t),n},sy=function(e,t,n){e===W_&&sy(ny,t,n),f_(e);var r=g_(t);return f_(n),p_(ty,r)?(n.enumerable?(p_(e,B_)&&e[B_][r]&&(e[B_][r]=!1),n=y_(n,{enumerable:__(0,!1)})):(p_(e,B_)||Z_(e,B_,__(1,{})),e[B_][r]=!0),oy(e,r,n)):Z_(e,r,n)},cy=function(e,t){f_(e);var n=m_(t),r=w_(n).concat(py(n));return V_(r,(function(t){l_&&!s_(ly,n,t)||sy(e,t,n[t])})),e},ly=function(e){var t=g_(e),n=s_($_,this,t);return!(this===W_&&p_(ty,t)&&!p_(ny,t))&&(!(n||!p_(this,t)||!p_(ty,t)||p_(this,B_)&&this[B_][t])||n)},dy=function(e,t){var n=m_(e),r=g_(t);if(n!==W_||!p_(ty,r)||p_(ny,r)){var i=X_(n,r);return!i||!p_(ty,r)||p_(n,B_)&&n[B_][r]||(i.enumerable=!0),i}},uy=function(e){var t=Q_(m_(e)),n=[];return V_(t,(function(e){p_(ty,e)||p_(x_,e)||ey(n,e)})),n},py=function(e){var t=e===W_,n=Q_(t?ny:m_(e)),r=[];return V_(n,(function(e){!p_(ty,e)||t&&!p_(W_,e)||ey(r,ty[e])})),r};d_||(I_(K_=(z_=function(){if(h_(K_,this))throw Y_("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?v_(arguments[0]):void 0,t=L_(e),n=function(e){this===W_&&s_(n,ny,e),p_(this,B_)&&p_(this[B_],t)&&(this[B_][t]=!1),oy(this,t,__(1,e))};return l_&&iy&&oy(W_,t,{configurable:!0,set:n}),ay(t,e)})[G_],"toString",(function(){return q_(this).tag})),I_(z_,"withoutSetter",(function(e){return ay(L_(e),e)})),O_.f=ly,C_.f=sy,R_.f=cy,T_.f=dy,b_.f=E_.f=uy,S_.f=py,P_.f=function(e){return ay(N_(e),e)},l_&&A_(K_,"description",{configurable:!0,get:function(){return q_(this).description}})),o_({global:!0,constructor:!0,wrap:!0,forced:!d_,sham:!d_},{Symbol:z_}),V_(w_(ry),(function(e){D_(e)})),o_({target:F_,stat:!0,forced:!d_},{useSetter:function(){iy=!0},useSimple:function(){iy=!1}}),o_({target:"Object",stat:!0,forced:!d_,sham:!l_},{create:function(e,t){return void 0===t?y_(e):cy(y_(e),t)},defineProperty:sy,defineProperties:cy,getOwnPropertyDescriptor:dy}),o_({target:"Object",stat:!0,forced:!d_},{getOwnPropertyNames:uy}),M_(),U_(z_,F_),x_[B_]=!0;var hy=Ct&&!!Symbol.for&&!!Symbol.keyFor,fy=Nr,my=ht,gy=rn,vy=wi,_y=Zt,yy=hy,wy=_y("string-to-symbol-registry"),by=_y("symbol-to-string-registry");fy({target:"Symbol",stat:!0,forced:!yy},{for:function(e){var t=vy(e);if(gy(wy,t))return wy[t];var n=my("Symbol")(t);return wy[t]=n,by[n]=t,n}});var Ey=Nr,Sy=rn,Ty=xt,Cy=Nt,Ry=hy,Oy=Zt("symbol-to-string-registry");Ey({target:"Symbol",stat:!0,forced:!Ry},{keyFor:function(e){if(!Ty(e))throw TypeError(Cy(e)+" is not a symbol");if(Sy(Oy,e))return Oy[e]}});var Iy=sv,Ay=Pe,ky=Oe,xy=wi,Ly=me([].push),Ny=Nr,Py=ht,Dy=Se,My=Ve,Uy=me,jy=le,Vy=Pe,By=xt,Fy=Fl,Gy=Ct,Hy=String,qy=Py("JSON","stringify"),Wy=Uy(/./.exec),zy=Uy("".charAt),Ky=Uy("".charCodeAt),Yy=Uy("".replace),Jy=Uy(1..toString),Xy=/[\uD800-\uDFFF]/g,Zy=/^[\uD800-\uDBFF]$/,Qy=/^[\uDC00-\uDFFF]$/,$y=!Gy||jy((function(){var e=Py("Symbol")();return"[null]"!=qy([e])||"{}"!=qy({a:e})||"{}"!=qy(Object(e))})),ew=jy((function(){return'"\\udf06\\ud834"'!==qy("\udf06\ud834")||'"\\udead"'!==qy("\udead")})),tw=function(e,t){var n=Fy(arguments),r=function(e){if(Ay(e))return e;if(Iy(e)){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];"string"==typeof i?Ly(n,i):"number"!=typeof i&&"Number"!=ky(i)&&"String"!=ky(i)||Ly(n,xy(i))}var o=n.length,a=!0;return function(e,t){if(a)return a=!1,t;if(Iy(this))return t;for(var r=0;r<o;r++)if(n[r]===e)return t}}}(t);if(Vy(r)||void 0!==e&&!By(e))return n[1]=function(e,t){if(Vy(r)&&(t=My(r,this,Hy(e),t)),!By(t))return t},Dy(qy,null,n)},nw=function(e,t,n){var r=zy(n,t-1),i=zy(n,t+1);return Wy(Zy,e)&&!Wy(Qy,i)||Wy(Qy,e)&&!Wy(Zy,r)?"\\u"+Jy(Ky(e,0),16):e};qy&&Ny({target:"JSON",stat:!0,arity:3,forced:$y||ew},{stringify:function(e,t,n){var r=Fy(arguments),i=Dy($y?tw:qy,null,r);return ew&&"string"==typeof i?Yy(i,Xy,nw):i}});var rw=Vo,iw=en;Nr({target:"Object",stat:!0,forced:!Ct||le((function(){rw.f(1)}))},{getOwnPropertySymbols:function(e){var t=rw.f;return t?t(iw(e)):[]}}),Wv("asyncIterator"),Wv("hasInstance"),Wv("isConcatSpreadable"),Wv("iterator"),Wv("match"),Wv("matchAll"),Wv("replace"),Wv("search"),Wv("species"),Wv("split");var ow=Xv;Wv("toPrimitive"),ow();var aw=ht,sw=Cc;Wv("toStringTag"),sw(aw("Symbol"),"Symbol"),Wv("unscopables"),Cc(_e.JSON,"JSON",!0);var cw=ct.Symbol,lw=_n,dw=nr.f,uw=lw("metadata"),pw=Function.prototype;void 0===pw[uw]&&dw(pw,uw,{value:null}),Wv("dispose"),Wv("metadata");var hw=cw;Wv("asyncDispose");var fw=me,mw=ht("Symbol"),gw=mw.keyFor,vw=fw(mw.prototype.valueOf),_w=mw.isRegisteredSymbol||function(e){try{return void 0!==gw(vw(e))}catch(e){return!1}};Nr({target:"Symbol",stat:!0},{isRegisteredSymbol:_w});for(var yw=Zt,ww=ht,bw=me,Ew=xt,Sw=_n,Tw=ww("Symbol"),Cw=Tw.isWellKnownSymbol,Rw=ww("Object","getOwnPropertyNames"),Ow=bw(Tw.prototype.valueOf),Iw=yw("wks"),Aw=0,kw=Rw(Tw),xw=kw.length;Aw<xw;Aw++)try{var Lw=kw[Aw];Ew(Tw[Lw])&&Sw(Lw)}catch(e){}var Nw=function(e){if(Cw&&Cw(e))return!0;try{for(var t=Ow(e),n=0,r=Rw(Iw),i=r.length;n<i;n++)if(Iw[r[n]]==t)return!0}catch(e){}return!1};Nr({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:Nw}),Wv("matcher"),Wv("observable"),Nr({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:_w}),Nr({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:Nw}),Wv("metadataKey"),Wv("patternMatch"),Wv("replaceAll");var Pw=ce(hw),Dw=ce(Vv.f("iterator"));function Mw(e){return Mw="function"==typeof Pw&&"symbol"==typeof Dw?function(e){return typeof e}:function(e){return e&&"function"==typeof Pw&&e.constructor===Pw&&e!==Pw.prototype?"symbol":typeof e},Mw(e)}var Uw=ce(Vv.f("toPrimitive"));function jw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Mw(e)||null===e)return e;var n=e[Uw];if(void 0!==n){var r=n.call(e,"string");if("object"!==Mw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Mw(t)?t:String(t)}(t))in e?ov(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vw=le,Bw=_n("iterator"),Fw=!Vw((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2"),r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),n.delete("a",2),!e.toJSON||!n.has("a",1)||n.has("a",2)||!t.size&&!0||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Bw]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),Gw=ac,Hw=Nr,qw=_e,Ww=Ve,zw=me,Kw=Me,Yw=Fw,Jw=ac,Xw=il,Zw=Cc,Qw=Lc,$w=Qs,eb=ul,tb=Pe,nb=rn,rb=tr,ib=vi,ob=sr,ab=st,sb=wi,cb=ba,lb=ze,db=Za,ub=qa,pb=Hl,hb=pm,fb=_n("iterator"),mb="URLSearchParams",gb=mb+"Iterator",vb=$w.set,_b=$w.getterFor(mb),yb=$w.getterFor(gb),wb=Object.getOwnPropertyDescriptor,bb=function(e){if(!Kw)return qw[e];var t=wb(qw,e);return t&&t.value},Eb=bb("fetch"),Sb=bb("Request"),Tb=bb("Headers"),Cb=Sb&&Sb.prototype,Rb=Tb&&Tb.prototype,Ob=qw.RegExp,Ib=qw.TypeError,Ab=qw.decodeURIComponent,kb=qw.encodeURIComponent,xb=zw("".charAt),Lb=zw([].join),Nb=zw([].push),Pb=zw("".replace),Db=zw([].shift),Mb=zw([].splice),Ub=zw("".split),jb=zw("".slice),Vb=/\+/g,Bb=Array(4),Fb=function(e){return Bb[e-1]||(Bb[e-1]=Ob("((?:%[\\da-f]{2}){"+e+"})","gi"))},Gb=function(e){try{return Ab(e)}catch(t){return e}},Hb=function(e){var t=Pb(e,Vb," "),n=4;try{return Ab(t)}catch(e){for(;n;)t=Pb(t,Fb(n--),Gb);return t}},qb=/[!'()~]|%20/g,Wb={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},zb=function(e){return Wb[e]},Kb=function(e){return Pb(kb(e),qb,zb)},Yb=Qw((function(e,t){vb(this,{type:gb,iterator:db(_b(e).entries),kind:t})}),"Iterator",(function(){var e=yb(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),Jb=function(e){this.entries=[],this.url=null,void 0!==e&&(ab(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===xb(e,0)?jb(e,1):e:sb(e)))};Jb.prototype={type:mb,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,o,a,s,c=ub(e);if(c)for(n=(t=db(e,c)).next;!(r=Ww(n,t)).done;){if(o=(i=db(ob(r.value))).next,(a=Ww(o,i)).done||(s=Ww(o,i)).done||!Ww(o,i).done)throw Ib("Expected sequence with length 2");Nb(this.entries,{key:sb(a.value),value:sb(s.value)})}else for(var l in e)nb(e,l)&&Nb(this.entries,{key:l,value:sb(e[l])})},parseQuery:function(e){if(e)for(var t,n,r=Ub(e,"&"),i=0;i<r.length;)(t=r[i++]).length&&(n=Ub(t,"="),Nb(this.entries,{key:Hb(Db(n)),value:Hb(Lb(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],Nb(n,Kb(e.key)+"="+Kb(e.value));return Lb(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Xb=function(){eb(this,Zb);var e=vb(this,new Jb(arguments.length>0?arguments[0]:void 0));Kw||(this.size=e.entries.length)},Zb=Xb.prototype;if(function(e,t,n){for(var r in t)n&&n.unsafe&&e[r]?e[r]=t[r]:Gw(e,r,t[r],n)}(Zb,{append:function(e,t){var n=_b(this);pb(arguments.length,2),Nb(n.entries,{key:sb(e),value:sb(t)}),Kw||this.length++,n.updateURL()},delete:function(e){for(var t=_b(this),n=pb(arguments.length,1),r=t.entries,i=sb(e),o=n<2?void 0:arguments[1],a=void 0===o?o:sb(o),s=0;s<r.length;){var c=r[s];if(c.key!==i||void 0!==a&&c.value!==a)s++;else if(Mb(r,s,1),void 0!==a)break}Kw||(this.size=r.length),t.updateURL()},get:function(e){var t=_b(this).entries;pb(arguments.length,1);for(var n=sb(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){var t=_b(this).entries;pb(arguments.length,1);for(var n=sb(e),r=[],i=0;i<t.length;i++)t[i].key===n&&Nb(r,t[i].value);return r},has:function(e){for(var t=_b(this).entries,n=pb(arguments.length,1),r=sb(e),i=n<2?void 0:arguments[1],o=void 0===i?i:sb(i),a=0;a<t.length;){var s=t[a++];if(s.key===r&&(void 0===o||s.value===o))return!0}return!1},set:function(e,t){var n=_b(this);pb(arguments.length,1);for(var r,i=n.entries,o=!1,a=sb(e),s=sb(t),c=0;c<i.length;c++)(r=i[c]).key===a&&(o?Mb(i,c--,1):(o=!0,r.value=s));o||Nb(i,{key:a,value:s}),Kw||(this.size=i.length),n.updateURL()},sort:function(){var e=_b(this);hb(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=_b(this).entries,r=rb(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new Yb(this,"keys")},values:function(){return new Yb(this,"values")},entries:function(){return new Yb(this,"entries")}},{enumerable:!0}),Jw(Zb,fb,Zb.entries,{name:"entries"}),Jw(Zb,"toString",(function(){return _b(this).serialize()}),{enumerable:!0}),Kw&&Xw(Zb,"size",{get:function(){return _b(this).entries.length},configurable:!0,enumerable:!0}),Zw(Xb,mb),Hw({global:!0,constructor:!0,forced:!Yw},{URLSearchParams:Xb}),!Yw&&tb(Tb)){var Qb=zw(Rb.has),$b=zw(Rb.set),eE=function(e){if(ab(e)){var t,n=e.body;if(ib(n)===mb)return t=e.headers?new Tb(e.headers):new Tb,Qb(t,"content-type")||$b(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),cb(e,{body:lb(0,sb(n)),headers:lb(0,t)})}return e};if(tb(Eb)&&Hw({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return Eb(e,arguments.length>1?eE(arguments[1]):{})}}),tb(Sb)){var tE=function(e){return eb(this,Cb),new Sb(e,arguments.length>1?eE(arguments[1]):{})};Cb.constructor=tE,tE.prototype=Cb,Hw({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:tE})}}var nE={URLSearchParams:Xb,getState:_b},rE=ce(ct.URLSearchParams),iE={isBrowser:!0,classes:{URLSearchParams:void 0!==rE?rE:Kg,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const oE="undefined"!=typeof window&&"undefined"!=typeof document,aE=(sE="undefined"!=typeof navigator&&navigator.product,oE&&["ReactNative","NativeScript","NS"].indexOf(sE)<0);var sE;const cE="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts;function lE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lE(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uE=dE(dE({},Object.freeze({__proto__:null,hasBrowserEnv:oE,hasStandardBrowserEnv:aE,hasStandardBrowserWebWorkerEnv:cE})),iE),pE=sr,hE=Ve,fE=rn,mE=ge,gE=function(){var e=pE(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},vE=RegExp.prototype,_E=function(e){var t=e.flags;return void 0!==t||"flags"in vE||fE(e,"flags")||!mE(vE,e)?t:hE(gE,e)},yE=lh.charAt,wE=Ve,bE=sr,EE=Pe,SE=Oe,TE=/./.exec,CE=TypeError,RE=Nr,OE=Ve,IE=ke,AE=Lc,kE=Yc,xE=tt,LE=Wr,NE=wi,PE=sr,DE=Qe,ME=Oe,UE=ai,jE=_E,VE=Bt,BE=le,FE=Bl,GE=Qs,HE=_n("matchAll"),qE="RegExp String",WE=qE+" Iterator",zE=GE.set,KE=GE.getterFor(WE),YE=TypeError,JE=IE("".indexOf),XE=IE("".matchAll),ZE=!!XE&&!BE((function(){XE("a",/./)})),QE=AE((function(e,t,n,r){zE(this,{type:WE,regexp:e,string:t,global:n,unicode:r,done:!1})}),qE,(function(){var e=KE(this);if(e.done)return kE(void 0,!0);var t=e.regexp,n=e.string,r=function(e,t){var n=e.exec;if(EE(n)){var r=wE(n,e,t);return null!==r&&bE(r),r}if("RegExp"===SE(e))return wE(TE,e,t);throw CE("RegExp#exec called on incompatible receiver")}(t,n);return null===r?(e.done=!0,kE(void 0,!0)):e.global?(""===NE(r[0])&&(t.lastIndex=function(e,t,n){return t+(n?yE(e,t).length:1)}(n,LE(t.lastIndex),e.unicode)),kE(r,!1)):(e.done=!0,kE(r,!1))})),$E=function(e){var t,n,r,i=PE(this),o=NE(e),a=FE(i,RegExp),s=NE(jE(i));return t=new a(a===RegExp?i.source:i,s),n=!!~JE(s,"g"),r=!!~JE(s,"u"),t.lastIndex=LE(i.lastIndex),new QE(t,o,n,r)};RE({target:"String",proto:!0,forced:ZE},{matchAll:function(e){var t,n,r,i,o=xE(this);if(DE(e)){if(ZE)return XE(o,e)}else{if(UE(e)&&(t=NE(xE(jE(e))),!~JE(t,"g")))throw YE("`.matchAll` does not allow non-global regexes");if(ZE)return XE(o,e);if(void 0===(r=VE(e,HE))&&"RegExp"==ME(e)&&(r=$E),r)return OE(r,e,o)}return n=NE(o),i=new RegExp(e,"g"),OE($E,i,n)}});var eS=ti("String").matchAll,tS=ge,nS=eS,rS=String.prototype,iS=ce((function(e){var t=e.matchAll;return"string"==typeof e||e===rS||tS(rS,e)&&t===rS.matchAll?nS:t}));function oS(e){function t(e,n,r,i){let o=e[i++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),s=i>=e.length;return o=!o&&Ug.isArray(r)?r.length:o,s?(Ug.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!a):(r[o]&&Ug.isObject(r[o])||(r[o]=[]),t(e,n,r[o],i)&&Ug.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}(r[o])),!a)}if(Ug.isFormData(e)&&Ug.isFunction(e.entries)){const n={};return Ug.forEachEntry(e,((e,r)=>{t(function(e){return iS(Ug).call(Ug,/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null}const aS={transitional:Qg,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=Ug.isObject(e);if(i&&Ug.isHTMLForm(e)&&(e=new FormData(e)),Ug.isFormData(e))return r?JSON.stringify(oS(e)):e;if(Ug.isArrayBuffer(e)||Ug.isBuffer(e)||Ug.isStream(e)||Ug.isFile(e)||Ug.isBlob(e))return e;if(Ug.isArrayBufferView(e))return e.buffer;if(Ug.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Wg(e,new uE.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return uE.isNode&&Ug.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=Ug.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Wg(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(Ug.isString(e))try{return(0,JSON.parse)(e),Of(Ug).call(Ug,e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||aS.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&Ug.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw jg.from(e,jg.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:uE.classes.FormData,Blob:uE.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ug.forEach(["delete","get","head","post","put","patch"],(e=>{aS.headers[e]={}}));var sS=aS;const cS=Ug.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),lS=Symbol("internals");function dS(e){var t;return e&&Of(t=String(e)).call(t).toLowerCase()}function uS(e){return!1===e||null==e?e:Ug.isArray(e)?e.map(uS):String(e)}function pS(e,t,n,r,i){return Ug.isFunction(r)?r.call(this,t,n):(i&&(t=n),Ug.isString(t)?Ug.isString(r)?-1!==t.indexOf(r):Ug.isRegExp(r)?r.test(t):void 0:void 0)}class hS{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=dS(t);if(!i)throw new Error("header name must be a non-empty string");const o=Ug.findKey(r,i);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=uS(e))}const o=(e,t)=>Ug.forEach(e,((e,n)=>i(e,n,t)));var a;return Ug.isPlainObject(e)||e instanceof this.constructor?o(e,t):Ug.isString(e)&&(e=Of(e).call(e))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Of(a=e).call(a))?o((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach((function(e){var o,a;i=e.indexOf(":"),n=Of(o=e.substring(0,i)).call(o).toLowerCase(),r=Of(a=e.substring(i+1)).call(a),!n||t[n]&&cS[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&i(t,e,n),this}get(e,t){if(e=dS(e)){const n=Ug.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(Ug.isFunction(t))return t.call(this,e,n);if(Ug.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=dS(e)){const n=Ug.findKey(this,e);return!(!n||void 0===this[n]||t&&!pS(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=dS(e)){const i=Ug.findKey(n,e);!i||t&&!pS(0,n[i],i,t)||(delete n[i],r=!0)}}return Ug.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!pS(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return Ug.forEach(this,((r,i)=>{var o;const a=Ug.findKey(n,i);if(a)return t[a]=uS(r),void delete t[i];const s=e?function(e){return Of(e).call(e).toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(i):Of(o=String(i)).call(o);s!==i&&delete t[i],t[s]=uS(r),n[s]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Ug.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&Ug.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,n]=e;return t+": "+n})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[lS]=this[lS]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=dS(e);t[r]||(function(e,t){const n=Ug.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})}))}(n,e),t[r]=!0)}return Ug.isArray(e)?e.forEach(r):r(e),this}}hS.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ug.reduceDescriptors(hS.prototype,((e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}})),Ug.freezeMethods(hS);var fS=hS;function mS(e,t){const n=this||sS,r=t||n,i=fS.from(r.headers);let o=r.data;return Ug.forEach(e,(function(e){o=e.call(n,o,i.normalize(),t?t.status:void 0)})),i.normalize(),o}function gS(e){return!(!e||!e.__CANCEL__)}function vS(e,t,n){jg.call(this,null==e?"canceled":e,jg.ERR_CANCELED,t,n),this.name="CanceledError"}Ug.inherits(vS,jg,{__CANCEL__:!0});var _S=uE.hasStandardBrowserEnv?{write(e,t,n,r,i,o){const a=[e+"="+encodeURIComponent(t)];Ug.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),Ug.isString(r)&&a.push("path="+r),Ug.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function yS(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var wS=uE.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=Ug.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};function bS(e,t){let n=0;const r=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];i||(i=c),n[o]=s,r[o]=c;let d=a,u=0;for(;d!==o;)u+=n[d++],d%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),c-i<t)return;const p=l&&c-l;return p?Math.round(1e3*u/p):void 0}}(50,250);return i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,s=o-n,c=r(s);n=o;const l={loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&o<=a?(a-o)/c:void 0,event:i};l[t?"download":"upload"]=!0,e(l)}}var ES="undefined"!=typeof XMLHttpRequest&&function(e){return new Ih((function(t,n){let r=e.data;const i=fS.from(e.headers).normalize();let o,a,{responseType:s,withXSRFToken:c}=e;function l(){e.cancelToken&&e.cancelToken.unsubscribe(o),e.signal&&e.signal.removeEventListener("abort",o)}if(Ug.isFormData(r))if(uE.hasStandardBrowserEnv||uE.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if(!1!==(a=i.getContentType())){const[e,...t]=a?a.split(";").map((e=>Of(e).call(e))).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}let d=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+n))}const u=yS(e.baseURL,e.url);function p(){if(!d)return;const r=fS.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new jg("Request failed with status code "+n.status,[jg.ERR_BAD_REQUEST,jg.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),l()}),(function(e){n(e),l()}),{data:s&&"text"!==s&&"json"!==s?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:r,config:e,request:d}),d=null}if(d.open(e.method.toUpperCase(),Xg(u,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,"onloadend"in d?d.onloadend=p:d.onreadystatechange=function(){d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))&&setTimeout(p)},d.onabort=function(){d&&(n(new jg("Request aborted",jg.ECONNABORTED,e,d)),d=null)},d.onerror=function(){n(new jg("Network Error",jg.ERR_NETWORK,e,d)),d=null},d.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||Qg;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new jg(t,r.clarifyTimeoutError?jg.ETIMEDOUT:jg.ECONNABORTED,e,d)),d=null},uE.hasStandardBrowserEnv&&(c&&Ug.isFunction(c)&&(c=c(e)),c||!1!==c&&wS(u))){const t=e.xsrfHeaderName&&e.xsrfCookieName&&_S.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===r&&i.setContentType(null),"setRequestHeader"in d&&Ug.forEach(i.toJSON(),(function(e,t){d.setRequestHeader(t,e)})),Ug.isUndefined(e.withCredentials)||(d.withCredentials=!!e.withCredentials),s&&"json"!==s&&(d.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",bS(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",bS(e.onUploadProgress)),(e.cancelToken||e.signal)&&(o=t=>{d&&(n(!t||t.type?new vS(null,e,d):t),d.abort(),d=null)},e.cancelToken&&e.cancelToken.subscribe(o),e.signal&&(e.signal.aborted?o():e.signal.addEventListener("abort",o)));const h=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);h&&-1===uE.protocols.indexOf(h)?n(new jg("Unsupported protocol "+h+":",jg.ERR_BAD_REQUEST,e)):d.send(r||null)}))};const SS={http:null,xhr:ES};Ug.forEach(SS,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const TS=e=>"- ".concat(e),CS=e=>Ug.isFunction(e)||null===e||!1===e;var RS={getAdapter:e=>{e=Ug.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let o=0;o<t;o++){let t;if(n=e[o],r=n,!CS(n)&&(r=SS[(t=String(n)).toLowerCase()],void 0===r))throw new jg("Unknown adapter '".concat(t,"'"));if(r)break;i[t||"#"+o]=r}if(!r){const e=Object.entries(i).map((e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));throw new jg("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(TS).join("\n"):" "+TS(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r},adapters:SS};function OS(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new vS(null,e)}function IS(e){return OS(e),e.headers=fS.from(e.headers),e.data=mS.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),RS.getAdapter(e.adapter||sS.adapter)(e).then((function(t){return OS(e),t.data=mS.call(e,e.transformResponse,t),t.headers=fS.from(t.headers),t}),(function(t){return gS(t)||(OS(e),t&&t.response&&(t.response.data=mS.call(e,e.transformResponse,t.response),t.response.headers=fS.from(t.response.headers))),Ih.reject(t)}))}function AS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const kS=e=>e instanceof fS?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AS(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e):e;function xS(e,t){t=t||{};const n={};function r(e,t,n){return Ug.isPlainObject(e)&&Ug.isPlainObject(t)?Ug.merge.call({caseless:n},e,t):Ug.isPlainObject(t)?Ug.merge({},t):Ug.isArray(t)?t.slice():t}function i(e,t,n){return Ug.isUndefined(t)?Ug.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function o(e,t){if(!Ug.isUndefined(t))return r(void 0,t)}function a(e,t){return Ug.isUndefined(t)?Ug.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,o){return o in t?r(n,i):o in e?r(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t)=>i(kS(e),kS(t),!0)};return Ug.forEach(Object.keys(Object.assign({},e,t)),(function(r){const o=c[r]||i,a=o(e[r],t[r],r);Ug.isUndefined(a)&&o!==s||(n[r]=a)})),n}const LS="1.6.8",NS={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{NS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const PS={};NS.transitional=function(e,t,n){function r(e,t){return"[Axios v1.6.8] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,o)=>{if(!1===e)throw new jg(r(i," has been removed"+(t?" in "+t:"")),jg.ERR_DEPRECATED);return t&&!PS[i]&&(PS[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}};var DS={assertOptions:function(e,t,n){if("object"!=typeof e)throw new jg("options must be an object",jg.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new jg("option "+o+" must be "+n,jg.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new jg("Unknown option "+o,jg.ERR_BAD_OPTION)}},validators:NS};const MS=DS.validators;let US=class{constructor(e){this.defaults=e,this.interceptors={request:new Zg,response:new Zg}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=xS(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&DS.assertOptions(n,{silentJSONParsing:MS.transitional(MS.boolean),forcedJSONParsing:MS.transitional(MS.boolean),clarifyTimeoutError:MS.transitional(MS.boolean)},!1),null!=r&&(Ug.isFunction(r)?t.paramsSerializer={serialize:r}:DS.assertOptions(r,{encode:MS.function,serialize:MS.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&Ug.merge(i.common,i[t.method]);i&&Ug.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=fS.concat(o,i);const a=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let d,u=0;if(!s){const e=[IS.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,c),d=e.length,l=Ih.resolve(t);u<d;)l=l.then(e[u++],e[u++]);return l}d=a.length;let p=t;for(u=0;u<d;){const t=a[u++],n=a[u++];try{p=t(p)}catch(e){n.call(this,e);break}}try{l=IS.call(this,p)}catch(e){return Ih.reject(e)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return Xg(yS((e=xS(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}};Ug.forEach(["delete","get","head","options"],(function(e){US.prototype[e]=function(t,n){return this.request(xS(n||{},{method:e,url:t,data:(n||{}).data}))}})),Ug.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(xS(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}US.prototype[e]=t(),US.prototype[e+"Form"]=t(!0)}));var jS=US;class VS{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Ih((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Ih((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,i){n.reason||(n.reason=new vS(e,r,i),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new VS((function(t){e=t})),cancel:e}}}var BS=VS;const FS={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(FS).forEach((e=>{let[t,n]=e;FS[n]=t}));var GS=FS;const HS=function e(t){const n=new jS(t),r=rg(jS.prototype.request,n);return Ug.extend(r,jS.prototype,n,{allOwnKeys:!0}),Ug.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(xS(t,n))},r}(sS);HS.Axios=jS,HS.CanceledError=vS,HS.CancelToken=BS,HS.isCancel=gS,HS.VERSION=LS,HS.toFormData=Wg,HS.AxiosError=jg,HS.Cancel=HS.CanceledError,HS.all=function(e){return Ih.all(e)},HS.spread=function(e){return function(t){return e.apply(null,t)}},HS.isAxiosError=function(e){return Ug.isObject(e)&&!0===e.isAxiosError},HS.mergeConfig=xS,HS.AxiosHeaders=fS,HS.formToJSON=e=>oS(Ug.isHTMLForm(e)?new FormData(e):e),HS.getAdapter=RS.getAdapter,HS.HttpStatusCode=GS,HS.default=HS;var qS=HS;const WS=()=>{};function zS(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:WS};return e.promise=new Ih(((t,n)=>{e.resolve=n=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(n),e.value=n)},e.reject=t=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,n(t))}})),e}const KS=new Map,YS=new Map,JS=new Map;let XS=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),ZS=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const QS=new Km;let $S=QS.getResult(),eT=null;function tT(e){if(!eT){e&&QS.setUA(e),$S=QS.getResult();const t=function(e){if("Blink"===e.engine.name&&"WeChat"!==e.browser.name)return ZS.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return ZS.CHROME;case"Safari":case"Mobile Safari":return ZS.SAFARI;case"Edge":return ZS.EDGE;case"Firefox":return ZS.FIREFOX;case"QQ":case"QQBrowser":return ZS.QQ;case"Opera":return ZS.OPERA;case"WeChat":return ZS.WECHAT;default:return e.browser.name||""}}($S),n=nT($S),r=function(e){return"Windows"===e.os.name?e.os.version?e.os.name+" "+e.os.version:e.os.name:e.os.name||""}($S),i=$S.os.version,o=nT($S,!1),a=$S.device.type;if(!(t&&n&&r&&i))return{name:t,version:n,os:r,osVersion:i,browserVersion:o,deviceType:a};eT={name:t,version:n,os:r,osVersion:i,browserVersion:o,deviceType:a}}return eT}function nT(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",n?t.split(".")[0]:t}function rT(){return tT().os}function iT(){const e=tT();return"".concat(e.os," ").concat(e.osVersion)}function oT(){const e=tT();return!!("WebKit"===$S.engine.name&&e.os===XS.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==ZS.SAFARI||dT()&&e.name!==ZS.SAFARI)}function aT(){return tT().name===ZS.CHROME}function sT(){return tT().name===ZS.SAFARI}function cT(){return tT().name===ZS.EDGE}function lT(){return tT().name===ZS.FIREFOX}function dT(){return tT().os===XS.IOS}function uT(e){const t=tT();return!(t.name!==ZS.CHROME||!t.osVersion)&&Number(t.version)>=e}function pT(e){const t=tT();return!(t.name!==ZS.CHROME||!t.osVersion)&&Number(t.version)<e}function hT(e){const t=tT();return!(t.name!==ZS.EDGE||!t.osVersion)&&Number(t.version)>=e}function fT(e){const t=tT();return!(t.name!==ZS.SAFARI||!t.osVersion)&&Number(t.version)>=e}function mT(e,t,n){const r=tT();if(r.os!==XS.IOS||!r.osVersion)return!1;const i=r.osVersion.split(".");return n?t&&Number(i[0])===e&&Number(i[1])<t||Number(i[0])<e:t?Number(i[0])===e&&Number(i[1])<=t||Number(i[0])<e:Number(i[0])<=e}function gT(e,t,n){const r=tT();if(r.name!==ZS.SAFARI||!r.osVersion||!r.browserVersion)return!1;const i=r.browserVersion.split(".");return n?t&&Number(i[0])===e&&Number(i[1])<t||Number(i[0])<e:t?Number(i[0])===e&&Number(i[1])<=t||Number(i[0])<e:Number(i[0])<=e}function vT(e){const t=tT();return!(t.name!==ZS.OPERA||!t.osVersion)&&Number(t.version)>=e}function _T(){const e=tT();if(e.os!==XS.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||14===Number(t[0])&&Number(t[1])<=6}function yT(){const e=tT();if(e.os!==XS.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function wT(){const e=tT();if(e.os!==XS.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 16===Number(t[0])}function bT(){const e=tT();if(e.os!==XS.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function ET(){return sT()&&navigator.maxTouchPoints>0}function ST(){return tT().name===ZS.WECHAT}function TT(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function CT(){const e=rT();return function(){const{deviceType:e}=tT();return"mobile"===e||"tablet"===e}()||e===XS.ANDROID||e===XS.IOS||e===XS.HARMONY_OS}function RT(){const e=tT();return e.name!==ZS.EDGE&&e.name!==ZS.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function OT(){return rT()===XS.ANDROID}function IT(){const e=tT();return OT()&&(e.name===ZS.CHROME||e.name===ZS.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function AT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kT(Object(n),!0).forEach((function(t){AT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let LT=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),NT=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(t),AT(this,"code",void 0),AT(this,"message",void 0),AT(this,"data",void 0),AT(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=n}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),"\n").concat(this.stack):"".concat(this.stack)}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return"error"===e&&(t||console).error(this.toString()),"warning"===e&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function PT(e,t){if("boolean"!=typeof e)throw new NT(LT.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function DT(e,t,n){if(!Li(n).call(n,e))throw new NT(LT.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(n)))}function MT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<n||e>r||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!function(e){return"number"==typeof e&&e%1==0}(e))throw new NT(LT.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(n,", ").concat(r,"]. integer only"))}function UT(e,t){if("number"!=typeof e){if(!(e.min||e.max||e.ideal||e.exact))throw new NT(LT.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));void 0!==e.min&&MT(e.min,"".concat(t,".min"),0,1/0),void 0!==e.max&&MT(e.max,"".concat(t,".max"),1,1/0),void 0!==e.exact&&MT(e.exact,"".concat(t,".exact"),1,1/0),void 0!==e.ideal&&MT(e.ideal,"".concat(t,".ideal"),1,1/0)}else MT(e,t,1,1/0)}function jT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new NT(LT.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!FT(e,n,r,i))throw new NT(LT.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))}function VT(e,t){if(!Array.isArray(e))throw new NT(LT.INVALID_PARAMS,"".concat(t," should be an array"))}function BT(e){return null==e}function FT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&e.length<=n&&e.length>=t&&(!r||function(e){if("string"!=typeof e)return!1;for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}(e))}var GT=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(GT||{}),HT=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(HT||{});const qT=new class{constructor(){AT(this,"_clientSize",null),AT(this,"getClientWidth",(()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth)),AT(this,"getClientHeight",(()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight)),AT(this,"getStyle",(e=>window.getComputedStyle(e,null))),AT(this,"checkCssVisibleProperty",(e=>{var t;let n=!0;const r=this.getStyle(e),{display:i,visibility:o,opacity:a,filter:s}=r;return("none"===i||Li(t=["hidden","collapse"]).call(t,o)||Number(a)<.1)&&(n=!1),!!n&&(s&&s.split(" ").filter((e=>{var t;const n=e.split("(")[0];return Li(t=["brightness","blur","opacity"]).call(t,n)})).map((e=>{const[t,n]=e.split(/\(|\)/);return[t,Number(n.match(/^[0-9\.]+/))]})).forEach((e=>{const[t,r]=e;switch(t){case"brightness":(r<.1||r>3)&&(n=!1);break;case"blur":r>3&&(n=!1);break;case"opacity":r<.1&&(n=!1)}})),n)})),AT(this,"checkPropertyUpToAllParentNodes",((e,t)=>{let n=!0,r=!0;const i=e=>t(e);let o=e;for(;o&&r;)i(o)||(n=!1,r=!1),o=o.parentElement,o||(r=!1);return n})),AT(this,"checkActualCssVisibleIncludeInherit",(e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty))),AT(this,"getSizeAboutClient",(e=>{const{width:t,height:n,left:r,right:i,top:o,bottom:a}=e.getBoundingClientRect(),s=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:n,left:r,right:i,top:o,bottom:a,clientWidth:s,clientHeight:c,clientMin:Math.min(s,c)}})),AT(this,"checkActualSize",(()=>{const{width:e,height:t,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(e,t,n)})),AT(this,"elementFromPoint",((e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null)),AT(this,"checkCoverForAPoint",((e,t,n)=>{const r=this.elementFromPoint(e,t);return null!==r&&r!==n})),AT(this,"getPointPositionList",(()=>{const{width:e,height:t,left:n,top:r}=this._clientSize,i=e/6,o=t/6,a=[],s=10**6;for(let e=0;e<5;e++)for(let t=0;t<5;t++){const c=(n*s+(0===e?.1:4===e?(i*e*s-1e5)/s:i*e)*s)/s,l=(r*s+(0===t?.1:4===t?(o*t*s-1e5)/s:o*t)*s)/s;a.push({x:c,y:l})}return[...a]})),AT(this,"checkElementCover",(e=>this.getPointPositionList().map((t=>this.checkCoverForAPoint(t.x,t.y,e))).filter((e=>!!e)).length>6)),AT(this,"checkSizeIsVisible",((e,t,n)=>(e>50||n/e<=10)&&(t>50||n/t<=10))),AT(this,"checkSizeOfPartInClient",(()=>{const{left:e,right:t,top:n,bottom:r,clientHeight:i,clientWidth:o,clientMin:a}=this._clientSize;let s,c,l,d;if(e<0)s=0;else{if(!(e<o))return!1;s=e}if(t<0)return!1;if(c=t<o?t:o,n<0)l=0;else{if(!(n<i))return!1;l=n}if(r<0)return!1;d=r<i?r:i;const u=c-s,p=d-l;return this.checkSizeIsVisible(u,p,a)})),AT(this,"returnHiddenResult",(e=>(this._clientSize=null,{visible:!1,reason:e}))),AT(this,"checkOneElementVisible",(e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(GT.COVERED);{const e=this.checkActualSize(),t=this.checkSizeOfPartInClient();return e&&!t?this.returnHiddenResult(GT.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(GT.SIZE)}}return this.returnHiddenResult(GT.STYLE)}return this.returnHiddenResult(HT.UNMOUNTED)}return this.returnHiddenResult(HT.INVALID_HTML_ELEMENT)})),AT(this,"checkElementIsMountedOnDom",(e=>this.checkPropertyUpToAllParentNodes(e,(e=>"HTML"!==e.nodeName.toUpperCase()?null!==e.parentElement:!!document.documentElement))))}};function WT(e){return(new TextEncoder).encode(e)}const zT=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n},KT=async e=>function(e,t){let n="";return new Uint8Array(e).forEach((e=>{n+=e.toString(16).padStart(2,"0")})),n}(await crypto.subtle.digest("SHA-256",WT(e)));let YT=class{constructor(){AT(this,"_events",{}),AT(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map((e=>e.listener)):[]}on(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map((e=>e));for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(let n=0;n<t.length;n+=1){const i=t[n];i.once&&this.off(e,i.listener),i.listener.apply(this,r||[])}}safeEmit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];[...this._events[e]||[]].forEach((t=>{t.once&&this.off(e,t.listener);try{t.listener.apply(this,n)}catch(t){console.error("safeEmit event:".concat(e," error ").concat(null==t?void 0:t.toString()))}}))}_indexOfListener(e,t){let n=e.length;for(;n--;)if(e[n].listener===t)return n;return-1}},JT=null;function XT(){if(JT)return JT;if(window.electron)return JT=window.electron;if(!window.require)return null;try{return JT=window.require("electron"),JT}catch(e){return null}}let ZT=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e}({}),QT=function(e){return e.TRACER="tracer",e}({});function $T(e){return MT(e.timeout,"config.timeout",0,1e5),MT(e.timeoutFactor,"config.timeoutFactor",0,100,!1),MT(e.maxRetryCount,"config.maxRetryConfig",0,1/0),MT(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let eC=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),tC=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function nC(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach((e=>{if(!e.urls)throw Error()}))}catch(e){return!1}return!0}function rC(e){return jT(e.turnServerURL,"turnServerURL"),jT(e.username,"username"),jT(e.password,"password"),e.udpport&&MT(e.udpport,"udpport",1,99999,!0),e.forceturn&&PT(e.forceturn,"forceturn"),e.security&&PT(e.security,"security"),e.tcpport&&MT(e.tcpport,"tcpport",1,99999,!0),!0}function iC(e){return void 0!==e.level&&DT(e.level,"level",[1,2,3]),void 0!==e.delay&&MT(e.delay,"delay",0,3e3,!0),!0}let oC=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),aC=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e}({}),sC=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),cC=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function lC(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return 0===e.getListeners(t).length?Ih.reject(new NT(LT.UNEXPECTED_ERROR,"can not emit promise")):new Ih(((n,i)=>{e.emit(t,...r,n,i)}))}function dC(e,t){if(0===e.getListeners(t).length)return Ih.resolve();for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return lC(e,t,...r)}function uC(e,t){if(0===e.getListeners(t).length)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return pC(e,t,...r)}function pC(e,t){let n=null,r=null;for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];if(e.emit(t,...o,(e=>{n=e}),(e=>{r=e})),null!==r)throw r;if(null===n)throw new NT(LT.UNEXPECTED_ERROR,"handler is not sync");return n}const hC=new class extends YT{set networkState(e){this.emit(cC.NETWORK_STATE_CHANGE,e,this._networkState),e===sC.ONLINE?this.emit(cC.ONLINE):e===sC.OFFLINE&&(this.onlineWaiter=new Ih((e=>{this.once(cC.ONLINE,(()=>{this.onlineWaiter=void 0,e(sC.ONLINE)}))})),this.emit(cC.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===sC.ONLINE}constructor(){super(),AT(this,"_moduleName","network-indicator"),AT(this,"_networkState",sC.ONLINE),AT(this,"onlineWaiter",void 0),window.addEventListener("online",(()=>{this.networkState=sC.ONLINE})),window.addEventListener("offline",(()=>{this.networkState=sC.OFFLINE}))}};function fC(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function mC(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function gC(e){void 0!==Ih?Ih.resolve().then(e):setTimeout(e,0)}function vC(e){return JSON.parse(JSON.stringify(e))}function _C(e){try{return vC(e)}catch(t){return e}}const yC={};function wC(e,t){yC[t]||(yC[t]=!0,e())}function bC(e){const t=window.atob(e),n=new Uint8Array(new ArrayBuffer(t.length));for(let e=0;e<t.length;e+=1)n[e]=t.charCodeAt(e);return n}function EC(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}function SC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=(new TextEncoder).encode(e);if(n.length>t)n=n.slice(0,t);else if(n.length<t){const e=new Uint8Array(t);e.set(n),n=e}return n}function TC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Ji(t).call(t,((e,t)=>e+t.length),0),i=new Uint8Array(new ArrayBuffer(r));let o=0;return t.forEach((e=>{i.set(e,o),o+=e.length})),i}function CC(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function RC(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach((e=>{t+="string"==typeof e?CC(e):e.size})),t+138}function OC(e){const t=new NT(LT.TIMEOUT,"timeout");return new Ih(((n,r)=>{window.setTimeout((()=>r(t)),e)}))}function IC(e){return new Ih((t=>{window.setTimeout(t,e)}))}function AC(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+AC(e-n.length,"")}function kC(){return AC(32,"").toUpperCase()}const xC=()=>{},LC=new class{constructor(){AT(this,"fnMap",new Map)}throttleByKey(e,t,n,r){for(var i=arguments.length,o=new Array(i>4?i-4:0),a=4;a<i;a++)o[a-4]=arguments[a];if(this.fnMap.has(t)){const i=this.fnMap.get(t);if(i.threshold!==n){i.fn(...i.args),clearTimeout(i.timer);const a=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),n);this.fnMap.set(t,{fn:e,threshold:n,timer:a,args:o,skipFn:r})}else i.skipFn&&i.skipFn(...i.args),this.fnMap.set(t,xT(xT({},i),{},{fn:e,args:o,skipFn:r}))}else{const i=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),n);this.fnMap.set(t,{fn:e,threshold:n,timer:i,args:o,skipFn:r})}}},NC=LC.throttleByKey.bind(LC);function PC(e){return"object"==typeof e&&null!==e&&!(e instanceof RegExp)}function DC(e,t){if(!PC(e)||!PC(t))return t;if(Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const n=[...e];for(let r=0;r<t.length;r++)n[r]=DC(e[r],t[r]);return n}{const n=xT({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)?n[r]=DC(e[r],t[r]):n[r]=t[r]);return n}}function MC(e,t){let n=[0];if(t&&(n=new Array(t).fill(0)),0===e)return n;let r=0;for(;e>0&&(n[r]=255&e,e>>=8,r++,!t||r!==t););return n}function UC(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function jC(e){const t="0123456789abcdef";function n(e){let n,r="";for(n=0;n<=3;n++)r+=t.charAt(e>>8*n+4&15)+t.charAt(e>>8*n&15);return r}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,a){return r(function(e,t){return e<<t|e>>>32-t}(r(r(t,e),r(i,a)),o),n)}function o(e,t,n,r,o,a,s){return i(t&n|~t&r,e,t,o,a,s)}function a(e,t,n,r,o,a,s){return i(t&r|n&~r,e,t,o,a,s)}function s(e,t,n,r,o,a,s){return i(t^n^r,e,t,o,a,s)}function c(e,t,n,r,o,a,s){return i(n^(t|~r),e,t,o,a,s)}const l=function(e){let t;const n=1+(e.length+8>>6),r=new Array(16*n);for(t=0;t<16*n;t++)r[t]=0;for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<t%4*8;return r[t>>2]|=128<<t%4*8,r[16*n-2]=8*e.length,r}(e);let d,u,p,h,f,m=1732584193,g=-271733879,v=-1732584194,_=271733878;for(d=0;d<l.length;d+=16)u=m,p=g,h=v,f=_,m=o(m,g,v,_,l[d+0],7,-680876936),_=o(_,m,g,v,l[d+1],12,-389564586),v=o(v,_,m,g,l[d+2],17,606105819),g=o(g,v,_,m,l[d+3],22,-1044525330),m=o(m,g,v,_,l[d+4],7,-176418897),_=o(_,m,g,v,l[d+5],12,1200080426),v=o(v,_,m,g,l[d+6],17,-1473231341),g=o(g,v,_,m,l[d+7],22,-45705983),m=o(m,g,v,_,l[d+8],7,1770035416),_=o(_,m,g,v,l[d+9],12,-1958414417),v=o(v,_,m,g,l[d+10],17,-42063),g=o(g,v,_,m,l[d+11],22,-1990404162),m=o(m,g,v,_,l[d+12],7,1804603682),_=o(_,m,g,v,l[d+13],12,-40341101),v=o(v,_,m,g,l[d+14],17,-1502002290),g=o(g,v,_,m,l[d+15],22,1236535329),m=a(m,g,v,_,l[d+1],5,-165796510),_=a(_,m,g,v,l[d+6],9,-1069501632),v=a(v,_,m,g,l[d+11],14,643717713),g=a(g,v,_,m,l[d+0],20,-373897302),m=a(m,g,v,_,l[d+5],5,-701558691),_=a(_,m,g,v,l[d+10],9,38016083),v=a(v,_,m,g,l[d+15],14,-660478335),g=a(g,v,_,m,l[d+4],20,-405537848),m=a(m,g,v,_,l[d+9],5,568446438),_=a(_,m,g,v,l[d+14],9,-1019803690),v=a(v,_,m,g,l[d+3],14,-187363961),g=a(g,v,_,m,l[d+8],20,1163531501),m=a(m,g,v,_,l[d+13],5,-1444681467),_=a(_,m,g,v,l[d+2],9,-51403784),v=a(v,_,m,g,l[d+7],14,1735328473),g=a(g,v,_,m,l[d+12],20,-1926607734),m=s(m,g,v,_,l[d+5],4,-378558),_=s(_,m,g,v,l[d+8],11,-2022574463),v=s(v,_,m,g,l[d+11],16,1839030562),g=s(g,v,_,m,l[d+14],23,-35309556),m=s(m,g,v,_,l[d+1],4,-1530992060),_=s(_,m,g,v,l[d+4],11,1272893353),v=s(v,_,m,g,l[d+7],16,-155497632),g=s(g,v,_,m,l[d+10],23,-1094730640),m=s(m,g,v,_,l[d+13],4,681279174),_=s(_,m,g,v,l[d+0],11,-358537222),v=s(v,_,m,g,l[d+3],16,-722521979),g=s(g,v,_,m,l[d+6],23,76029189),m=s(m,g,v,_,l[d+9],4,-640364487),_=s(_,m,g,v,l[d+12],11,-421815835),v=s(v,_,m,g,l[d+15],16,530742520),g=s(g,v,_,m,l[d+2],23,-995338651),m=c(m,g,v,_,l[d+0],6,-198630844),_=c(_,m,g,v,l[d+7],10,1126891415),v=c(v,_,m,g,l[d+14],15,-1416354905),g=c(g,v,_,m,l[d+5],21,-57434055),m=c(m,g,v,_,l[d+12],6,1700485571),_=c(_,m,g,v,l[d+3],10,-1894986606),v=c(v,_,m,g,l[d+10],15,-1051523),g=c(g,v,_,m,l[d+1],21,-2054922799),m=c(m,g,v,_,l[d+8],6,1873313359),_=c(_,m,g,v,l[d+15],10,-30611744),v=c(v,_,m,g,l[d+6],15,-1560198380),g=c(g,v,_,m,l[d+13],21,1309151649),m=c(m,g,v,_,l[d+4],6,-145523070),_=c(_,m,g,v,l[d+11],10,-1120210379),v=c(v,_,m,g,l[d+2],15,718787259),g=c(g,v,_,m,l[d+9],21,-343485551),m=r(m,u),g=r(g,p),v=r(v,h),_=r(_,f);return n(m)+n(g)+n(v)+n(_)}let VC=1,BC=console,FC=class{static setLogger(e){BC=e}constructor(e){AT(this,"lockingPromise",Ih.resolve()),AT(this,"locks",0),AT(this,"name",""),AT(this,"lockId",void 0),this.lockId=VC++,e&&(this.name=e),BC.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,BC.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:""));const n=new Ih((n=>{t=()=>{this.locks-=1,BC.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:"")),n()}})),r=this.lockingPromise.then((()=>t));return this.lockingPromise=this.lockingPromise.then((()=>n)),r}};function GC(e,t){return function(n,r,i){const o=i.value;if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const n=this[t];if(!n)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const i=await n.lock("From ".concat(e,".").concat(r));try{for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return await o.apply(this,s)}finally{i()}},i}}const HC={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function qC(e,t){const n=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,n)}function WC(e,t,n,r){const i=Object.assign({},HC,r);let o=i.timeout;const a=async()=>{await function(e){return new Ih((t=>{window.setTimeout(t,e)}))}(o),o*=i.timeoutFactor,o=Math.min(i.maxRetryTimeout,o)};let s=!1;const c=new Ih((async(r,o)=>{t=t||(()=>!1),n=n||(()=>!0);for(let c=0;c<i.maxRetryCount;c+=1){if(s)return o(new NT(LT.OPERATION_ABORTED));try{const n=await e();if(!t(n,c))return r(n);if(c+1===i.maxRetryCount)return r(n);await a()}catch(e){if(!n(e,c))return o(e);if(c+1===i.maxRetryCount)return o(e);await a()}}}));return c.cancel=()=>s=!0,c}class zC{constructor(e){AT(this,"input",[]),AT(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return 0===this.input.length?0:Ji(e=this.input).call(e,((e,t)=>e+t))/this.input.length}}let KC,YC=0,JC=0;function XC(e,t,n,r){return new Ih(((i,o)=>{t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),YC+=CC(t.data)):n&&(t.data.size?YC+=t.data.size:t.data instanceof FormData?YC+=RC(t.data):YC+=CC(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,qS.request(t).then((e=>{"string"==typeof e.data?JC+=CC(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?JC+=e.data.byteLength:JC+=CC(JSON.stringify(e.data)),r&&i({data:e.data,headers:e.headers}),i(e.data)})).catch((e=>{qS.isCancel(e)?o(new NT(LT.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new NT(LT.NETWORK_TIMEOUT,e.message)):e.response?o(new NT(LT.NETWORK_RESPONSE_ERROR,e.response.status)):o(new NT(LT.NETWORK_ERROR,e.message))}))}))}async function ZC(e,t){const n=new Blob([t.data],{type:"buffer"});return await XC(e,xT(xT({},t),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}const QC=()=>void 0!==window.isSecureContext,$C=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){const e=t[1],n=t[2];return"".concat(e,".").concat(n)}const n=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(n&&n[1]&&n[2]){const e=n[1],t=n[2];return"".concat(e,".").concat(100*(Number(t)+1))}return"4.0.0.999"}("4.22.0"),eR=function(){try{return!0===JSON.parse("true")}catch(e){return!0}}();let tR=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const nR={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},rR="v4.22.0-0-g8569241d-dirty(8/15/2024, 7:04:06 PM)",iR=xT(xT({PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:nR,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,CUSTOM_ADAPTATION_DEFAULT_MODE:"",ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,ENABLE_PRELOAD:!0},{ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,USE_PUB_RTX:!0,USE_SUB_RTX:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_DATASTREAM_2:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,USE_XR:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,ENABLE_PREALLOC_PC:!1,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_PRE_SUB:!1,ENABLE_AUT_FEEDBACK:!1}),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1});function oR(e,t,n){var r,i,o;Li(r=Object.keys(iR)).call(r,e)&&(!n&&Li(i=Object.keys(sR)).call(i,e)||(iR[e]=t,"ENABLE_VIDEO_SEI"===e&&!0===t&&(iR.ENABLE_ENCODED_TRANSFORM=!0),"USE_NEW_NETWORK_CONFIG"===e&&t&&(o=!!t,iR.USE_NEW_NETWORK_CONFIG=o,o&&(iR.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],iR.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],iR.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],iR.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],iR.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",iR.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",iR.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),"ENABLE_PRE_SUB"===e&&t&&(iR.ENABLE_INSTANT_VIDEO=!0,iR.ENABLE_PREALLOC_PC=!0),"ENABLE_SVC"===e&&t&&(iR.ENABLE_AUT_CC=!0)))}function aR(e){return iR[e]}const sR={};var cR=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(cR||{});class lR{constructor(e,t,n,r){AT(this,"state",void 0),this.state={codec:e,audioCodec:t,mode:n,clientId:r,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:tR.Default}}dispatch(e){this.state=function(e,t){switch(t.type){case cR.SET_SESSION_ID:return xT(xT({},e),{},{sessionId:t.sessionId});case cR.SET_P2P_ID:return xT(xT({},e),{},{p2pId:t.p2pId});case cR.SET_UID:return xT(xT({},e),{},{uid:t.uid});case cR.SET_INT_UID:return xT(xT({},e),{},{intUid:t.intUid});case cR.SET_PUB_ID:return xT(xT({},e),{},{pubId:t.pubId});case cR.KEY_METRIC_CLIENT_CREATED:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{clientCreated:t.metric})});case cR.KEY_METRIC_JOIN_START:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{joinStart:t.metric})});case cR.AVOID_JOIN_START:return xT(xT({},e),{},{avoidJoinStart:t.avoidJoinStart});case cR.KEY_METRIC_JOIN_END:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{joinEnd:t.metric})});case cR.KEY_METRIC_REQUEST_AP_START:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{requestAPStart:t.metric})});case cR.KEY_METRIC_REQUEST_AP_END:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{requestAPEnd:t.metric})});case cR.KEY_METRIC_JOIN_GATEWAY_START:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{joinGatewayStart:t.metric})});case cR.KEY_METRIC_JOIN_GATEWAY_END:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{joinGatewayEnd:t.metric})});case cR.KEY_METRIC_PEER_CONNECTION_START:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{peerConnectionStart:t.metric})});case cR.KEY_METRIC_PEER_CONNECTION_END:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{peerConnectionEnd:t.metric})});case cR.KEY_METRIC_DESCRIPTION_START:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{descriptionStart:t.metric})});case cR.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{signalChannelOpen:t.metric})});case cR.KEY_METRIC_ICE_CONNECTION_END:return xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{iceConnectionEnd:t.metric})});case cR.KEY_METRIC_PUBLISH:{const n=e.keyMetrics.publish,r=n.findIndex((e=>e.trackId===t.metric.trackId));return-1!==r?(n[r]=xT(xT({},n[r]),t.metric),xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{publish:[...n]})})):xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{publish:[...e.keyMetrics.publish,t.metric]})})}case cR.KEY_METRIC_SUBSCRIBE:{const n=e.keyMetrics.subscribe,r=n.findIndex((e=>e.userId===t.metric.userId&&e.type===t.metric.type));return-1!==r?(n[r]=xT(xT({},n[r]),t.metric),xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{subscribe:[...n]})})):xT(xT({},e),{},{keyMetrics:xT(xT({},e.keyMetrics),{},{subscribe:[...e.keyMetrics.subscribe,t.metric]})})}case cR.SET_CLOUD_PROXY_SERVER_MODE:return e.cloudProxyServerMode=t.mode,e;case cR.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof t.index?e.joinChannelServiceRecords=[...e.joinChannelServiceRecords,t.record]:(e.joinChannelServiceRecords[t.index]=xT(xT({},e.joinChannelServiceRecords[t.index]),t.record),e.joinChannelServiceRecords=[...e.joinChannelServiceRecords]),e;case cR.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return e.joinChannelServiceRecords=[],e;case cR.RESET_KEY_METRICS:return e.keyMetrics={publish:[],subscribe:[]},e;case cR.SET_USE_P2P:return xT(xT({},e),{},{useP2P:t.val});case cR.SET_TRANSPORT_TYPE:return xT(xT({},e),{},{p2pTransport:t.val});default:return e}}(this.state,e)}set sessionId(e){this.dispatch({type:cR.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.state.sessionId}set codec(e){this.state.codec=e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(e){this.dispatch({type:cR.SET_P2P_ID,p2pId:e})}get p2pId(){return this.state.p2pId}set dcId(e){this.dispatch({type:cR.SET_DC_ID,dcId:e})}get dcId(){return this.state.dcId}set uid(e){this.dispatch({type:cR.SET_UID,uid:e})}get uid(){return this.state.uid}set intUid(e){this.dispatch({type:cR.SET_INT_UID,intUid:e})}get intUid(){return this.state.intUid}set pubId(e){this.dispatch({type:cR.SET_PUB_ID,pubId:e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(e){this.dispatch({type:cR.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(e){this.dispatch({type:cR.SET_USE_P2P,val:e})}get useP2P(){return this.state.useP2P}set p2pTransport(e){this.dispatch({type:cR.SET_TRANSPORT_TYPE,val:e})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:cR.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:cR.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:cR.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:cR.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:cR.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:cR.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:cR.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:cR.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:cR.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:cR.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:cR.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:cR.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(e,t,n,r){this.dispatch({type:cR.KEY_METRIC_PUBLISH,metric:xT(xT({trackId:e,type:t},n&&{publishStart:n}),r&&{publishEnd:r})})}subscribe(e,t,n,r,i,o,a){this.dispatch({type:cR.KEY_METRIC_SUBSCRIBE,metric:xT(xT(xT(xT(xT({userId:e,type:t},n&&{subscribeStart:n}),r&&{subscribeEnd:r}),i&&{firstFrame:i}),o&&{streamAdded:o}),a&&{firstDecoded:a})})}massSubscribe(e,t,n,r){e.forEach((e=>{this.dispatch({type:cR.KEY_METRIC_SUBSCRIBE,metric:xT(xT(xT({userId:e.userId,type:e.type},t&&{subscribeStart:t}),n&&{subscribeEnd:n}),r&&{firstFrame:r})})}))}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(e,t){"gateway"===e.service&&Array.isArray(e.urls)&&(e.urls=e.urls.map((e=>e.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2"))));try{return"number"!=typeof t?(this.dispatch({type:cR.RECORD_JOIN_CHANNEL_SERVICE,record:xT(xT({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(t<0||t>=this.state.joinChannelServiceRecords.length||this.dispatch({type:cR.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:t}),t)}catch(e){return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:cR.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:cR.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch(e){return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(e){this.dispatch({type:cR.AVOID_JOIN_START,avoidJoinStart:e})}}let dR=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});!function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"}({});const uR=10;let pR=0;function hR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fR(Object(n),!0).forEach((function(t){hR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const gR=new class extends YT{constructor(){super(...arguments),hR(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class vR{constructor(e){hR(this,"logger",void 0),hR(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(...this.prefixLists,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.info(...this.prefixLists,...t)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.warning(...this.prefixLists,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(...this.prefixLists,...t)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}}function _R(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function yR(){const e=new Date,t=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return t?(null==t?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const wR={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},bR=Date.now(),ER=e=>{for(const t in wR)if(Object.prototype.hasOwnProperty.call(wR,t)&&wR[t]===e)return t;return"DEFAULT"},SR=new class{constructor(){hR(this,"proxyServerURL",void 0),hR(this,"logLevel",wR.DEBUG),hR(this,"uploadState","collecting"),hR(this,"uploadLogWaitingList",[]),hR(this,"uploadLogUploadingList",[]),hR(this,"uploadErrorCount",0),hR(this,"currentLogID",0),hR(this,"url",void 0),hR(this,"extLog",((e,t)=>{this.appendLogToWaitingList(e,...t)}))}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[wR.DEBUG].concat(t);this.log.apply(this,r)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[wR.INFO].concat(t);this.log.apply(this,r)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[wR.WARNING].concat(t);this.log.apply(this,r)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[wR.ERROR].concat(t);this.log.apply(this,r)}upload(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[wR.DEBUG].concat(t);this.uploadLog.apply(this,r)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){oR("UPLOAD_LOG",!0)}disableLogUpload(){oR("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new vR(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-bR<100)return void setTimeout((()=>{this.log(...t)}),Date.now()-bR);const r=Math.max(0,Math.min(4,t[0]));if(t[0]=_R()+" Agora-SDK [".concat(ER(r),"]:"),this.appendLogToWaitingList(r,...t),r<this.logLevel)return;const i=_R()+" %cAgora-SDK [".concat(ER(r),"]:");let o=[];if(!aR("USE_NEW_LOG"))switch(r){case wR.DEBUG:o=[i,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,o);break;case wR.INFO:o=[i,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,o);break;case wR.WARNING:o=[i,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,o);break;case wR.ERROR:o=[i,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,o)}}uploadLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-bR<100)return void setTimeout((()=>{this.uploadLog(...t)}),Date.now()-bR);const r=Math.max(0,Math.min(4,t[0]));t[0]=_R()+" Agora-SDK [".concat(ER(r),"]:"),this.appendLogToWaitingList(r,...t)}appendLogToWaitingList(e){if(!aR("UPLOAD_LOG"))return;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Array.isArray(n[0])?n[0][0]=yR()+" Agora-SDK [".concat(ER(e),"]:"):n[0]=yR()+" Agora-SDK [".concat(ER(e),"]:");let i="";n.forEach((e=>{"object"==typeof e&&(e=JSON.stringify(e)),i+="".concat(e," ")})),this.uploadLogWaitingList.push({payload_str:i,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:$C,process_id:aR("PROCESS_ID"),payload:JSON.stringify(e)};return WC((async()=>{const e=await qS.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(aR("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(aR("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if("OK"!==e.data){const t=new Error("unexpected upload log response");throw t.response=e,t}}),(()=>(this.uploadLogUploadingList=[],!1)),(t=>{const n={status:-1,message:t.message,errorRange:e.map((e=>e.log_item_id))};return t.response?(n.status=t.response.status,n.data=t.response.data,n.headers=t.response.headers):t.request&&(n.status=t.request.status),gR.reportLogUploadError(n),!0}),{timeout:aR("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:aR("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,aR("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),aR("UPLOAD_LOG_INTERVAL"))})).catch((e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),aR("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),aR("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}};var TR;function CR(e){return jT(e.reportId,"params.reportId",0,100,!1),jT(e.category,"params.category",0,100,!1),jT(e.event,"params.event",0,100,!1),jT(e.label,"params.label",0,100,!1),MT(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(TR={}).FREE="free",TR.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const RR={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let OR=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e}({}),IR=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e}({});!function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}({});let AR=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});class kR{constructor(){hR(this,"baseInfoMap",new Map),hR(this,"proxyServer",void 0),hR(this,"eventUploadTimer",void 0),hR(this,"setSessionIdTimer",void 0),hR(this,"url",void 0),hR(this,"backupUrl",void 0),hR(this,"_appId",void 0),hR(this,"keyEventUploadPendingItems",[]),hR(this,"normalEventUploadPendingItems",[]),hR(this,"apiInvokeUploadPendingItems",[]),hR(this,"apiInvokeCount",0),hR(this,"ltsList",[]),hR(this,"lastSendNormalEventTime",Date.now()),hR(this,"customReportCounterTimer",void 0),hR(this,"customReportCount",0),hR(this,"extApiInvoke",(async e=>{for(const t of e){const e=mR(mR({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:QT.TRACER});this.sendApiInvoke(e)}})),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),aR("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),aR("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return void SR.error("adjust session ".concat(e," start time, sid is not exist or info is undefined"));const t=this.baseInfoMap.get(e),n=Date.now(),r=t.startTime;t.startTime=n,SR.debug("rewrite session ".concat(e," startTime: ").concat(n," , ").concat(n-r,"ms")),this.baseInfoMap.set(e,t)}setAppId(e){this._appId=e}reportApiInvoke(e,t,n){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const r=Date.now();this.apiInvokeCount+=1;const i=this.apiInvokeCount,o=()=>({tag:t.tag,invokeId:i,sid:e,name:t.name,apiInvokeTime:r,options:t.options,states:t.states||null}),a=!!aR("SHOW_REPORT_INVOKER_LOG");a&&SR.info("".concat(t.name," start"),t.options);let s=!1;IC(t.timeout).then((()=>{s||(this.sendApiInvoke(mR(mR({},o()),{},{error:LT.API_INVOKE_TIMEOUT,success:!1})),SR.debug("".concat(t.name," timeout")))}));const c=new NT(LT.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const r=()=>{if(s)throw c;return s=!0,this.sendApiInvoke(mR(mR({},o()),{},{success:!0},t.reportResult&&{result:e})),a&&SR.info("".concat(t.name," onSuccess")),e};return n?NC(r,t.name+"Success",n,(()=>s=!0)):r()},onError:e=>{const r=()=>{if(s)throw e;s=!0,this.sendApiInvoke(mR(mR({},o()),{},{success:!1,error:e})),a&&SR.info("".concat(t.name," onFailure"),e.toString())};return n?NC(r,t.name+"Error",n,(()=>s=!0)):r()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const n=Date.now(),r=this.createBaseInfo(e,n);r.cname=t.cname;const i=Object.assign({},{willUploadConsoleLog:aR("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:eR?"global":"oversea",areas:aR("AREAS")&&aR("AREAS").join(",")},t.extend),{stringUid:o,channelProfile:a,channelMode:s,isABTestSuccess:c,lsid:l,clientRole:d}=t,u=Date.now(),p=mR(mR({},r),{},{eventType:OR.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,buildFormat:t.buildFormat,build:rR,lts:u,elapse:u-n,extend:JSON.stringify(i),mode:t.mode,process:aR("PROCESS_ID"),appType:aR("APP_TYPE"),success:!0,version:$C,stringUid:o,channelProfile:a,channelMode:s,isABTestSuccess:c,lsid:l,clientType:Li(h=window.navigator.userAgent).call(h,"AgoraWebView")?42:20,clientRole:d,serviceId:aR("PROCESS_ID"),extensionID:aR("PLUGIN_INFO").join(",")||""});var h;this.send({type:IR.SESSION,data:p},!0)}joinChooseServer(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{eventType:OR.JOIN_CHOOSE_SERVER,lts:i,eventElapse:t.elapse||i-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:i-n.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3});this.send({type:IR.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{eventType:OR.REQ_USER_ACCOUNT,lts:i,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:t.elapse||i-n.startTime,eventElapse:i-t.lts,extend:JSON.stringify(t.extend)});this.send({type:IR.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info;t.vid&&(r.vid=t.vid),r.uid=t.uid,r.cid=t.cid;const i=Date.now(),{firstSuccess:o,avoidJoinStartTime:a}=t,s=i-(o&&a?a:n.startTime),c=mR(mR({},r),{},{eventType:OR.JOIN_GATEWAY,lts:i,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,errorMsg:t.errorMsg||"",elapse:s,eventElapse:i-t.lts,firstSuccess:o,signalChannel:t.signalChannel,preload:t.preload?1:0});t.succ&&(n.lastJoinSuccessTime=i),this.send({type:IR.JOIN_GATEWAY,data:c},!0)}joinChannelTimeout(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=Date.now(),i=mR(mR({},n.info),{},{lts:r,timeout:t,elapse:r-n.startTime});this.send({type:IR.JOIN_CHANNEL_TIMEOUT,data:i},!0)}publish(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{eventType:OR.PUBLISH,lts:i,eventElapse:t.eventElapse,elapse:i-n.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:IR.PUBLISH,data:o},!0)}subscribe(e,t,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,o=Date.now(),a=mR(mR({},i),{},{eventType:OR.SUBSCRIBE,lts:o,eventElapse:t.eventElapse,elapse:o-r.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid,preSsrc:t.preSsrc?1:0},n&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof t.peerid?a.peerSuid=t.peerid:a.peer=t.peerid,this.send({type:IR.SUBSCRIBE,data:a},!0)}wsCompressorInit(e){var t;const n=[...Yf(t=this.baseInfoMap).call(t)],r=n.length?n[0]:"UnableToGetSid",i=this.baseInfoMap.get(r);if(!i)return;const o=i.info,a=Date.now(),s=mR(mR({},o),{},{eventType:OR.WS_COMPRESSOR_INIT,lts:a,eventElapse:e.eventElapse,elapse:a-i.startTime,status:e.status?1:2});this.send({type:IR.WS_COMPRESSOR_INIT,data:s},!0)}firstRemoteVideoDecode(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,a=Date.now(),s=mR(mR(mR({},o),r),{},{elapse:a-i.startTime,eventType:t,lts:a,firstDecodeFrame:Math.max((r.firstFrame||a)-i.startTime,0),apEnd:Math.max(r.apEnd-i.startTime,0),apStart:Math.max(r.apStart-i.startTime,0),joinGwEnd:Math.max(r.joinGwEnd-i.startTime,0),joinGwStart:Math.max(r.joinGwStart-i.startTime,0),pcEnd:Math.max(r.pcEnd-i.startTime,0),pcStart:Math.max(r.pcStart-i.startTime,0),subscriberEnd:Math.max(r.subscriberEnd-i.startTime,0),subscriberStart:Math.max(r.subscriberStart-i.startTime,0),videoAddNotify:Math.max(r.videoAddNotify-i.startTime,0)});this.send({type:n,data:s},!0)}firstRemoteFrame(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,a=Date.now(),s=mR(mR(mR({},o),r),{},{elapse:a-i.startTime,eventType:t,lts:a});this.send({type:n,data:s},!0)}pcStats(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR(mR({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),elapse:i-n.startTime,eventType:OR.PC_STATS,lts:i,preallocation:t.preallocation?1:0});this.send({type:IR.PC_STATS,data:o},!0)}updateRemoteRTPCapabilities(e,t){if(e){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR(mR({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),eventType:OR.UPDATE_REMOTE_RTPCAPABILITIES,lts:i});this.send({type:IR.UPDATE_REMOTE_RTPCAPABILITIES,data:o},!0)}}onGatewayStream(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,a=Date.now(),s=mR(mR(mR({},o),r),{},{eventType:t,lts:a});this.send({type:n,data:s},!0)}streamSwitch(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{eventType:OR.STREAM_SWITCH,lts:i,isDual:t.isdual,elapse:i-n.startTime,success:t.succ});this.send({type:IR.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{eventType:OR.REQUEST_PROXY_APPCENTER,lts:i,eventElapse:i-t.lts,elapse:i-n.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:IR.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{eventType:OR.REQUEST_PROXY_WORKER_MANAGER,lts:i,eventElapse:i-t.lts,elapse:i-n.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:IR.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,e?SR.debug("reportProxyServerurl: ".concat(e)):SR.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR({},r),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:i,elapse:i-n.startTime,joinChannelSuccessElapse:i-(n.lastJoinSuccessTime||i),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:IR.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now();(function(e,t,n){const r=e[t];if(!r||"string"!=typeof r)return[e];e[t]="";const i=CC(JSON.stringify(e));let o=0;const a=[];let s=0;for(let n=0;n<r.length;n++)s+=r.charCodeAt(n)<=127?1:3,s<=1300-i||(a[a.length]=xT(xT({},e),{},{[t]:r.substring(o,n)}),o=n,s=r.charCodeAt(n)<=127?1:3);return o!==r.length-1&&(a[a.length]=xT(xT({},e),{},{[t]:r.substring(o)})),a})(mR(mR(mR({},r),t),{},{elapse:i-n.startTime,lts:i,productType:"WebRTC"}),"payload").forEach((e=>this.send({type:IR.WORKER_EVENT,data:e},!0)))}apworkerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR(mR({},r),t),{},{elapse:i-n.startTime,lts:i});this.send({type:IR.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR(mR({},r),t),{},{elapse:i-n.startTime,lts:i,extend:t.extend||void 0});this.send({type:IR.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=mR(mR(mR({},r),t),{},{elapse:i-n.startTime,lts:i});this.send({type:IR.WEBSOCKET_QUIT,data:o},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>aR("CUSTOM_REPORT_LIMIT"))throw new NT(LT.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const n=Date.now(),r=t.map((t=>({type:IR.USER_ANALYTICS,data:mR(mR({sid:e},t),{},{lts:n})})));try{aR("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(r):await this.postDataToStatsCollector(r)}catch(e){throw SR.error("send custom report message failed",e.toString()),new NT(LT.CUSTOM_REPORT_SEND_FAILED,e.message)}}sendApiInvoke(e){const t=aR("NOT_REPORT_EVENT");if(e.tag&&Li(t)&&Li(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const n=this.baseInfoMap.get(e.sid);if(!n)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:r,uid:i,cid:o}=n.info;let a;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof NT){const{code:t,message:n}=e.error;a=t||n||e.error.toString()}else a=e.error.toString();const s={invokeId:e.invokeId,sid:e.sid,cname:r,cid:o,uid:i,lts:e.lts,success:e.success,elapse:e.lts-n.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?a:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:IR.API_INVOKE,data:s},!1),!0}appendSessionId(){kR.__CLIENT_LIST__.forEach((e=>{if(e._sessionId){const t=this.apiInvokeUploadPendingItems.length;for(let n=0;n<t;n++){const t=this.apiInvokeUploadPendingItems.shift();t&&(t.sid=e._sessionId,this.sendApiInvoke(Object.assign({},t)))}}}))}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>aR("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const n=[],r=[];for(;e.length;){const t=e.shift();n.length<20?n.push(t):r.push(t)}e.push(...r);for(const e of[...n]){var i;-1!==this.ltsList.indexOf(e.data.lts)?(e.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(e.data.lts)):(this.ltsList.push(e.data.lts),Wm(i=this.ltsList).call(i,((e,t)=>e-t)))}return t||(this.lastSendNormalEventTime=Date.now()),aR("ENABLE_EVENT_REPORT")?(n.length&&(aR("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((e=>n=>{aR("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(e):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(e),this.normalEventUploadPendingItems.length>aR("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-aR("NORMAL_EVENT_QUEUE_CAPACITY")),SR.warning("report: drop normal events"))))})(n)),e):e}async postDataToStatsCollector2(e){hC.networkState===sC.OFFLINE&&await Ih.race([hC.onlineWaiter,IC(2*HC.maxRetryTimeout)]);const t=e=>{let t=new Uint8Array;return e.forEach((e=>{const n=WT(JSON.stringify(e.data)),r=new ArrayBuffer(5),i=(e=>{let t=0;return Object.entries(IR).forEach((n=>{let[r,i]=n;i===e.type&&(t=AR[r])})),t})(e),o=new DataView(r);o.setUint16(0,n.byteLength,!0),o.setUint8(2,255&i),o.setUint8(3,i>>>8&255),o.setUint8(4,i>>>16&255),t=zT(t,new Uint8Array(r)),t=zT(t,n)})),t},n="event";let r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(aR("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(n):"https://".concat(aR("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(n);for(let i=0;i<2;i+=1){1===i&&(r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(aR("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(n):"https://".concat(aR("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(n));try{await XC(r,{timeout:1e4,data:t(e),headers:mR(mR({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(e){if(1===i)throw e;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map((e=>JSON.stringify(e))),vid:(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(e[0])};hC.networkState===sC.OFFLINE&&await Ih.race([hC.onlineWaiter,IC(2*HC.maxRetryTimeout)]);const r=t?"/events/proto-raws":"/events/messages";let i=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(aR("EVENT_REPORT_DOMAIN"),"&p=").concat(aR("STATS_COLLECTOR_PORT"),"&d=").concat(r):"https://".concat(aR("EVENT_REPORT_DOMAIN"),":").concat(aR("STATS_COLLECTOR_PORT")).concat(r));for(let e=0;e<2;e+=1){1===e&&(i=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(aR("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(aR("STATS_COLLECTOR_PORT"),"&d=").concat(r):"https://".concat(aR("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(aR("STATS_COLLECTOR_PORT")).concat(r)));try{t?await ZC(i,{timeout:1e4,data:n}):await XC(i,{timeout:1e4,data:n})}catch(t){if(1===e)throw t;continue}return}}createBaseInfo(e,t){const n=Object.assign({},RR);return n.sid=e,this.baseInfoMap.set(e,{info:n,startTime:t}),n}reportResourceTiming(e,t){const n=performance.getEntriesByName(e),r=n[n.length-1];r&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:r,tag:QT.TRACER}).onSuccess()}}function xR(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,r){const i=r.value;if("function"==typeof i){const o=e.className||t.__className__||("AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name);r.value=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];let s=r;if(e.argsMap)try{s=e.argsMap(this,...r)}catch(e){SR.warning(e),s=[]}try{JSON.stringify(s)}catch(e){SR.warning("arguments for method ".concat(o,".").concat(String(n)," not serializable for apiInvoke.")),s=[]}const c=(e.report||LR).reportApiInvoke(this._sessionId||null,{name:"".concat(o,".").concat(String(n)),options:s,tag:QT.TRACER,reportResult:e.reportResult},e.throttleTime);try{const t=i.apply(this,r);return t instanceof Ih?t.then((t=>(c.onSuccess(e.reportResult&&t),t))).catch((e=>{throw c.onError(e),e})):(c.onSuccess(e.reportResult&&t),t)}catch(e){throw c.onError(e),e}}}return r}}hR(kR,"__CLIENT_LIST__",[]);const LR=new kR;gR.on("REPORT_LOG_UPLOAD",(e=>{e.networkState=hC.networkState,LR.reportApiInvoke(null,{name:"logUploadError",options:e,tag:QT.TRACER}).onSuccess("logUploadError")}));const NR=["CHINA","GLOBAL"],PR=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const r=n.join(""),i=[];for(let e=0;e<6;e++)i.push("1");const o=i.join(""),a={};return a[e]=r,a[t]=o,Object.assign(a,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=PR,eR||(iR.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],iR.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],iR.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],iR.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],iR.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],iR.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],iR.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",iR.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",iR.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",iR.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",iR.AREAS=["NORTH_AMERICA","OVERSEA"]);const DR=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],MR=[];function UR(e,t){return!!t&&MR.some((n=>n.uid===e&&n.channelName===t))}kR.__CLIENT_LIST__=MR;var jR=i_.forEach,VR=Fi("forEach")?[].forEach:function(e){return jR(this,e,arguments.length>1?arguments[1]:void 0)};Nr({target:"Array",proto:!0,forced:[].forEach!=VR},{forEach:VR});var BR=ti("Array").forEach,FR=vi,GR=rn,HR=ge,qR=BR,WR=Array.prototype,zR={DOMTokenList:!0,NodeList:!0},KR=ce((function(e){var t=e.forEach;return e===WR||HR(WR,e)&&t===WR.forEach||GR(zR,FR(e))?qR:t})),YR=en,JR=$o;Nr({target:"Object",stat:!0,forced:le((function(){JR(1)}))},{keys:function(e){return JR(YR(e))}});var XR=ce(ct.Object.keys),ZR=ce(Yi),QR=Nr,$R=sv,eO=me([].reverse),tO=[1,2];QR({target:"Array",proto:!0,forced:String(tO)===String(tO.reverse())},{reverse:function(){return $R(this)&&(this.length=this.length),eO(this)}});var nO=ti("Array").reverse,rO=ge,iO=nO,oO=Array.prototype,aO=function(e){var t=e.reverse;return e===oO||rO(oO,e)&&t===oO.reverse?iO:t},sO=ce(aO),cO=Nr,lO=sv,dO=Nl,uO=st,pO=Gr,hO=Kr,fO=it,mO=em,gO=_n,vO=Fl,_O=_v("slice"),yO=gO("species"),wO=Array,bO=Math.max;cO({target:"Array",proto:!0,forced:!_O},{slice:function(e,t){var n,r,i,o=fO(this),a=hO(o),s=pO(e,a),c=pO(void 0===t?a:t,a);if(lO(o)&&(n=o.constructor,(dO(n)&&(n===wO||lO(n.prototype))||uO(n)&&null===(n=n[yO]))&&(n=void 0),n===wO||void 0===n))return vO(o,s,c);for(r=new(void 0===n?wO:n)(bO(c-s,0)),i=0;s<c;s++,i++)s in o&&mO(r,i,o[s]);return r.length=i,r}});var EO=ti("Array").slice,SO=ge,TO=EO,CO=Array.prototype,RO=ce((function(e){var t=e.slice;return e===CO||SO(CO,e)&&t===CO.slice?TO:t}));function OO(e,t,n,r,i){var o,a,s,c={};return KR(o=XR(r)).call(o,(function(e){c[e]=r[e]})),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=ZR(a=sO(s=RO(n).call(n)).call(s)).call(a,(function(n,r){return r(e,t,n)||n}),c),i&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(i):void 0,c.initializer=void 0),void 0===c.initializer&&(ov(e,t,c),c=null),c}let IO=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),AO=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({}),kO=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),xO=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),LO=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),NO=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),PO=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),DO=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),MO=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e}({}),UO=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),jO=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),VO=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),BO=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),FO=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({});class GO extends NT{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2?arguments[2]:void 0),jw(this,"name","AgoraRTCException")}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return super.print(e,SR)}throw(){super.throw(SR)}}function HO(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw SR.error("Invalid Channel Name ".concat(e)),new GO(LT.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function qO(e){if(!function(e){return"number"==typeof e&&Math.floor(e)===e&&0<=e&&e<=4294967295}(e)&&!FT(e,1,255))throw new GO(LT.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");"string"==typeof e&&SR.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let WO=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const zO={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},KO={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function YO(e,t){jT(e.url,"".concat(t,".url"),1,1e3,!1),BT(e.x)||MT(e.x,"".concat(t,".x"),0,1e4),BT(e.y)||MT(e.y,"".concat(t,".y"),0,1e4),BT(e.width)||MT(e.width,"".concat(t,".width"),0,1e4),BT(e.height)||MT(e.height,"".concat(t,".height"),0,1e4),BT(e.zOrder)||MT(e.zOrder,"".concat(t,".zOrder"),0,255),BT(e.alpha)||MT(e.alpha,"".concat(t,".alpha"),0,1,!1)}const JO={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let XO=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),ZO=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),QO=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function $O(e){if(!e.channelName)throw new GO(LT.INVALID_PARAMS,"invalid channelName in info");if("number"!=typeof e.uid)throw new GO(LT.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&jT(e.token,"info.token",1,2047),qO(e.uid),HO(e.channelName),!0}let eI=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),tI=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),nI=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),rI=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),iI=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),oI=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e}({}),aI=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),sI=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),cI=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const lI=[cI.AFRICA,cI.ASIA,cI.CHINA,cI.EUROPE,cI.GLOBAL,cI.INDIA,cI.JAPAN,cI.NORTH_AMERICA,cI.OCEANIA,cI.OVERSEA,cI.SOUTH_AMERICA];let dI=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const uI={CHINA:{},ASIA:{CODE:dI.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:dI.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:dI.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:dI.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:dI.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:dI.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:dI.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:dI.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:dI.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:dI.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:dI.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:dI.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:dI.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};eR&&(uI.CHINA={CODE:dI.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let pI=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e}({});class hI extends YT{constructor(e,t){super(),jw(this,"onICEConnectionStateChange",void 0),jw(this,"onConnectionStateChange",void 0),jw(this,"onDTLSTransportStateChange",void 0),jw(this,"onDTLSTransportError",void 0),jw(this,"onICETransportStateChange",void 0),jw(this,"onFirstAudioReceived",void 0),jw(this,"onFirstVideoReceived",void 0),jw(this,"onFirstAudioDecoded",void 0),jw(this,"onFirstVideoDecoded",void 0),jw(this,"onFirstVideoDecodedTimeout",void 0),jw(this,"onSelectedLocalCandidateChanged",void 0),jw(this,"onSelectedRemoteCandidateChanged",void 0),jw(this,"getLocalVideoStats",void 0)}}class fI extends hI{constructor(e,t){super(e,t),jw(this,"establishPromise",void 0)}}let mI=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),gI=function(e){return e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.RELAY=2]="RELAY",e}({}),vI=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.TCP_RESTART=1]="TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({}),_I=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),yI=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),wI=function(e){return e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),bI=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),EI=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),SI=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),TI=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),CI=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),RI=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),OI=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),II=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),AI=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),kI=function(e){return e.ABORT="abort",e}({}),xI=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),LI=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const NI={[kO.ACCESS_POINT]:{[NO.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[NO.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[NO.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[NO.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[NO.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[NO.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[NO.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[kO.UNILBS]:{[LO.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[LO.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[LO.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[LO.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[LO.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[LO.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[LO.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[LO.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[LO.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[LO.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[LO.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[LO.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[kO.STRING_UID_ALLOCATOR]:{[xO.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[xO.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[xO.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function PI(e){const t=NI[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};const n=t[e%1e4];if(!n){if(Math.floor(e/1e4)===kO.ACCESS_POINT){const t=e%1e4;if("1"===t.toString()[0])return{desc:e.toString(),retry:!1};if("2"===t.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return n}const DI={[PO.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[PO.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[PO.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[PO.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[PO.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[PO.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[PO.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[PO.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[PO.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[PO.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[PO.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[PO.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[PO.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[PO.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[PO.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[PO.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[PO.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[PO.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[PO.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[PO.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[PO.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[PO.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[PO.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[PO.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[PO.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[PO.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[PO.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[PO.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[PO.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[PO.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[PO.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[PO.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[PO.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[PO.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[PO.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[PO.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[PO.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[PO.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[PO.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[PO.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[PO.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[PO.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[PO.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[PO.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[PO.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[PO.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[PO.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[PO.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[PO.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[PO.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[PO.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[PO.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[PO.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[PO.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[PO.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[PO.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[PO.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[PO.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[PO.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[PO.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[PO.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[PO.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[PO.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function MI(e){return DI[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function UI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UI(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function VI(e){return e.every((e=>e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING))}function BI(e,t){if("string"==typeof e)return e;const{proxy:n,host:r,port:i}=e;if(t){const e=aR("JOIN_GATEWAY_FALLBACK_PORT")||443;return 443===e?"wss://".concat(r,"/ws/?p=").concat(Number(i)+150):"wss://".concat(r,":").concat(e,"/ws/?p=").concat(Number(i)+150)}return n?"wss://".concat(n,"/ws/?h=").concat(r,"&p=").concat(i):"wss://".concat(r,":").concat(i)}const FI=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,GI=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,HI=/wss:\/\/(.+):([0-9]+)\/?/,qI=/wss:\/\/(.[^\/]+)\/?/;let WI=0;class zI{constructor(e,t){jw(this,"id",0),jw(this,"store",void 0),jw(this,"recordIndex",void 0),jw(this,"websockets",[]),jw(this,"try443PortDuration",2e3),jw(this,"forceCloseWSDuration",5e3),jw(this,"try443PortTimeout",null),jw(this,"forceCloseTimeout",null),jw(this,"isTry443PortFailed",!1),jw(this,"isNormalPortFailed",!1),jw(this,"useDoubleDomain",!1),jw(this,"useProxy",!1),jw(this,"startTime",Date.now()),this.id=++WI,this.try443PortDuration=aR("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=e||5e3,this.store=t}closeAllWebsockets(){this.websockets.forEach((e=>{e.onopen=null,e.onclose=null,e.onmessage=null,e.close()})),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var e;const t=Date.now()-this.startTime;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];SR.debug("[choose-best-ws ".concat(null===(e=this.store)||void 0===e?void 0:e.clientId," ").concat(this.id,"] ").concat(t,"ms:"),...r)}createWebSocket(e,t,n){this.logger("createWebSocket:",e,{isTry443Port:t,hasTimeoutDetection:n});const r=aR("GATEWAY_DOMAINS"),i=Date.now(),o=[],a=r.find((t=>{var n;return Li(n=e.host).call(n,t)}));a||(this.useDoubleDomain=!1);const s=[];if(this.useDoubleDomain)r.forEach((n=>{s.push(BI(jI(jI({},e),{},{host:e.host.replace(a,n)}),t))}));else{const n=jI({},e);if(t&&a){const e=r.find((e=>e!==a));e&&(n.host=n.host.replace(a,e))}s.push(BI(n,t))}try{s.forEach((e=>{const t=new WebSocket(e);t.binaryType="arraybuffer",o.push(t),this.logger("ws is connecting:",t.url)}))}catch(r){if(this.logger("ws create failed"),o.forEach((e=>e.close())),o.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(e,t,n);if(!t&&443!==Number(e.port))return this.createWebSocket(e,!0,n);throw new GO(LT.WS_ERR,"init websocket failed! Error: ".concat(r.toString()))}const c=zS();return this.store&&this.store.recordJoinChannelService({urls:o.map((e=>e.url)),service:"gateway"},this.recordIndex),o.forEach((e=>{e.onopen=()=>{this.logger("onopen: ws ".concat(e.url," open cost ").concat(Date.now()-i,"ms")),this.websockets.forEach((t=>{t!==e&&(t.onopen=null,t.onclose=null,t.onmessage=null,t.close(),this.logger("close backup websocket: ".concat(t.url)))})),this.websockets.length=0,c.resolve(e)},e.onclose=n=>{this.logger("onclose: ws ".concat(e.url," closed cost ").concat(Date.now()-i,"ms state: ").concat(e.readyState)),t?this.isTry443PortFailed=VI(o):this.isNormalPortFailed=VI(o),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(t&&this.isTry443PortFailed||!t&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(n.reason)),c.reject({code:n.code,reason:aI.A_ROUND_WS_FAILED}))},e.onmessage=t=>this.logger("".concat(e.url," onmessage: ").concat(t.data))})),this.websockets.push(...o),n||(()=>{const n=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",c.isResolved),this.websockets.forEach((e=>e.readyState!==WebSocket.OPEN&&e.close()))};if(t||this.useProxy)return this.logger("add 5s timeout at ".concat(t?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(n,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout((()=>{if(this.logger("2s timeout, isWebsocket created: ",c.isResolved),c.isResolved)return n();tT().os===XS.MAC_OS&&lT()&&n(),this.createWebSocket(e,!0,!0).then((e=>c.resolve(e))).catch((e=>{this.isNormalPortFailed&&c.reject(e),this.logger("try 443 port to create ws failed")})),this.forceCloseTimeout=window.setTimeout(n,this.forceCloseWSDuration)}),this.try443PortDuration)})(),c.promise}chooseBestWebsocket(e,t,n,r){return this.useDoubleDomain=!!t,"string"==typeof e&&(e=function(e){let t,n,r;return[,t,n,r]=e.match(FI)||[],t||([,n,r]=e.match(GI)||[]),n&&r||([,n,r]=e.match(HI)||[]),n&&r||([,n]=e.match(qI)||[]),n||SR.warning("un-destructible url: ",e),{proxy:t,host:n,port:r||"443"}}(e)),this.recordIndex=r,this.useProxy=!!e.proxy,n&&this.useProxy&&(SR.warn("cannot use 443 only when use proxy"),n=!1),this.createWebSocket(e,!!n,!1).finally((()=>this.clearTimeout()))}}function KI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}class YI extends YT{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;Li(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(FO.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(FO.CONNECTED):"closed"===this._state?this.emit(FO.CLOSED):"failed"===this._state&&this.emit(FO.FAILED))}resetReconnectCount(e){SR.debug("websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;super(),jw(this,"connectionID",0),jw(this,"currentURLIndex",0),jw(this,"urls",[]),jw(this,"_reconnectMode","tryNext"),jw(this,"reconnectReason",void 0),jw(this,"_initMutex",new FC("websocket")),jw(this,"name",void 0),jw(this,"_state","closed"),jw(this,"reconnectInterrupter",void 0),jw(this,"websocket",void 0),jw(this,"retryConfig",void 0),jw(this,"reconnectCount",0),jw(this,"forceCloseTimeout",5e3),jw(this,"onlineReconnectListener",void 0),jw(this,"useCompress",void 0),jw(this,"tryDoubleDomain",!1),jw(this,"use443PortOnly",!1),jw(this,"wsInflateLength",0),jw(this,"wsDeflateLength",0),jw(this,"closeEstablishingWs",(()=>{})),jw(this,"store",void 0),jw(this,"joinGatewayRecordIndex",void 0),this.store=o,this.name=e,this.retryConfig=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KI(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),this.useCompress=n,this.tryDoubleDomain=r,this.use443PortOnly=i;const{timeout:a,timeoutFactor:s}=t,c=Math.max(300,Math.floor(3*a/5)),l=Math.max(1.2,Math.floor(8*s)/10);sC.ONLINE&&(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l),hC.on(cC.NETWORK_STATE_CHANGE,((e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===sC.ONLINE?(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l):(this.retryConfig.timeout=a,this.retryConfig.timeoutFactor=s))}))}getConnection(){return this.websocket||void 0}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=await this._initMutex.lock();this.forceCloseTimeout=t,this.urls=e,this.state="connecting";try{const e=zS(),t=this.urls[this.currentURLIndex];aR("ENABLE_PREALLOC_PC")&&this.emit(TI.PRE_CONNECT_PC),this.createWebSocketConnection(t).then(e.resolve).catch(e.reject),this.once(FO.CLOSED,(()=>{e.reject(new NT(LT.WS_DISCONNECT))})),this.once(FO.CONNECTED,e.resolve),await e.promise}catch(e){}finally{n()}}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const e=this.websocket;t?setTimeout((()=>e.close()),500):e.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return void SR.warning("[".concat(this.name,"] can not reconnect, no websocket"));void 0!==e&&(this.reconnectMode=e),SR.debug("[".concat(this.name,"] reconnect is triggered initiative")),"number"==typeof this.joinGatewayRecordIndex&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(t)]},this.joinGatewayRecordIndex);const n=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),n&&n.bind(this.websocket)({code:9999,reason:t})}sendMessage(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new NT(LT.WS_ABORT,"websocket is not ready");try{t||(e=JSON.stringify(e)),this.websocket.send(e)}catch(e){throw new NT(LT.WS_ERR,"send websocket message error"+e.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e){var t;const n=zS();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const r=e=>{var t;null===(t=this.store)||void 0===t||t.signalChannelOpen(),SR.debug("[".concat(this.name,"] websocket opened:"),e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),n.resolve()},i=async e=>{var t;if(SR.debug("[".concat(this.name,"] websocket close ").concat(null===(t=this.websocket)||void 0===t?void 0:t.url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)n.reject(new NT(LT.WS_DISCONNECT,"websocket close: ".concat(e.code))),this.close();else{"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const t=uC(this,FO.WILL_RECONNECT,this.reconnectMode,e.reason)||this.reconnectMode,r=await this.reconnectWithAction(t);if("closed"===this.state)return void SR.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!r)return n.reject(new NT(LT.WS_DISCONNECT,"websocket reconnect failed: ".concat(e.code))),this.close(!0);n.resolve()}},o=e=>{this.emit(FO.ON_MESSAGE,e)},a=e=>{SR.warn("[".concat(this.connectionID,"] ws open error ").concat(e))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),aR("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=aR("GATEWAY_WSS_ADDRESS")),SR.debug("[".concat(this.name,"] start connect, url:"),e);const s=null===(t=this.store)||void 0===t?void 0:t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var c;const t=await this.chooseBestWebsocketConnection(e);this.websocket=t,r&&r(this.websocket.url),this.websocket.onclose=i,this.websocket.onmessage=o,this.websocket.onerror=a,null===(c=this.store)||void 0===c||c.recordJoinChannelService({endTs:Date.now(),status:"success"},s),this.joinGatewayRecordIndex=s}catch(e){const t="closed"===this.state,r=e instanceof NT,o=r&&e.code===LT.WS_ABORT,a=r&&e.code===LT.WS_ERR,c=r?e.message:e&&(e.reason||e.toString());SR.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(c)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:o?"aborted":"error",errors:[e]},s),t||a?(n.reject(t?new NT(LT.WS_DISCONNECT,"websocket is closed: ".concat(c)):new NT(LT.WS_ERR,"init websocket failed: ".concat(c))),a&&SR.error("[".concat(this.name,"] init websocket failed: ").concat(c))):i&&i(e)}return n.promise}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount)return!1;if(0===this.urls.length)return!1;if("closed"===this.state)return!1;SR.warning("[choose-best-ws] action: =>",e),this.onlineReconnectListener||hC.isOnline||!hC.onlineWaiter||(this.onlineReconnectListener=hC.onlineWaiter.then((()=>{this.onlineReconnectListener=void 0})));let n=!0;if(this.reconnectInterrupter=()=>n=!1,t){const t=qC(this.reconnectCount,this.retryConfig);SR.debug("[".concat(this.name,"] wait ").concat(t,"ms to reconnect websocket, mode: ").concat(e)),await Ih.race([IC(t),this.onlineReconnectListener||new Ih((()=>{}))])}if("closed"===this._state||!n)return!1;this.reconnectCount+=1;const r=async(e,t)=>{this.emit(FO.RECONNECT_CREATE_CONNECTION,t),await this.createWebSocketConnection(e)};try{if("retry"===e)this.emit(FO.RECONNECT_WAITTING_FINISH,e),await r(this.urls[this.currentURLIndex],e);else if("tryNext"===e){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);SR.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(FO.RECONNECT_WAITTING_FINISH,e),await r(this.urls[this.currentURLIndex],e)}else"recover"===e&&(SR.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(FO.RECONNECT_WAITTING_FINISH,e),this.urls=await lC(this,FO.REQUEST_NEW_URLS),this.currentURLIndex=0,await r(this.urls[this.currentURLIndex],e))}catch(n){var i;SR.error("[".concat(this.name,"] reconnect failed ").concat(n&&n.toString()));const r=null==n||null===(i=n.data)||void 0===i?void 0:i.desc;return Array.isArray(r)&&Li(r).call(r,"dynamic key expired")?(this.emit(FO.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(e,t)}return!0}}class JI extends YI{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){const n=zS(),r=function(e,t){return new zI(e,t)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{SR.debug("[choose-best-ws] close establishing websockets"),r.closeAllWebsockets(),n.reject(new NT(LT.WS_ABORT,"choose best websocket aborted"))};const i=aR("GATEWAY_DOMAINS");return SR.debug("[choose-best-ws] currentDomain: ",e,", domains: ",i,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),r.chooseBestWebsocket(e,this.tryDoubleDomain,this.use443PortOnly,t).then(n.resolve).catch(n.reject),n.promise.finally((()=>{this.closeEstablishingWs=void 0}))}}class XI extends YI{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){return new Ih(((n,r)=>{let i=!1;const o=[];this.closeEstablishingWs=()=>{SR.debug("[choose-best-ws] close establishing websockets"),o.forEach((e=>{e.onclose=null,e.onopen=null,e.onmessage=null,e.close()})),r(new NT(LT.WS_ABORT,"choose best websocket aborted"))};const a=aR("GATEWAY_DOMAINS");let s;const c=e.indexOf("?h="),l=a.find((t=>-1!==c?Li(e).call(e,t,c):Li(e).call(e,t)));SR.debug("[choose-best-ws] currentDomain: ",l,", domains: ",a);let d=!this.tryDoubleDomain||!l;if(!d&&l){var u;const p=Date.now();try{a.forEach((t=>{const n=-1===c?e.replace(l,t):e.substr(0,c)+e.substr(c).replace(l,t),r=new WebSocket(n);r.binaryType="arraybuffer",o.push(r),SR.debug("[choose-best-ws] ws is connecting:",r.url)}))}catch(e){for(SR.debug("[choose-best-ws] ws create failed, fallback to single url"),o.forEach((e=>e.close()));o.length;)o.pop();d=!0}null===(u=this.store)||void 0===u||u.recordJoinChannelService({urls:o.map((e=>e.url)),service:"gateway"},t),o.forEach((e=>{e.onopen=()=>{if(i)return;const t=Date.now()-p;SR.debug("[choose-best-ws] ws open cost ".concat(t,"ms")),o.filter((t=>t!==e)).forEach((e=>{SR.debug("[choose-best-ws]close backup websocket: ".concat(e.url)),e.close()})),i=!0,n(e)},e.onclose=e=>{s=e,i||o.find((e=>!(e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING)))||(SR.debug("[choose-best-ws] all websocket is closed"),i=!0,r(s))},e.onmessage=t=>{SR.debug("[choose-best-ws]".concat(e.url," onmessage: ").concat(t.data))}})),IC(this.forceCloseTimeout).then((()=>{o.forEach((e=>{e.readyState!==WebSocket.OPEN&&e.close()}))}))}if(d){var p;let i;SR.debug("[choose-best-ws] use single url: ",e),null===(p=this.store)||void 0===p||p.recordJoinChannelService({urls:[e],service:"gateway"},t);try{i=new WebSocket(e),o.push(i),i.binaryType="arraybuffer"}catch(e){const t=new NT(LT.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return SR.error("[".concat(this.name,"]").concat(t)),void r(t)}i.onopen=()=>{n(i)},i.onclose=e=>{r(e)},i.onmessage=e=>{SR.debug("[choose-best-ws]".concat(i.url," onmessage: ").concat(e.data))},IC(this.forceCloseTimeout).then((()=>{i&&i.readyState!==WebSocket.OPEN&&i.close()}))}})).then((e=>(this.closeEstablishingWs=void 0,e))).catch((e=>{throw this.closeEstablishingWs=void 0,e}))}}class ZI extends YT{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===DO.CONNECTED?this.emit(MO.WS_CONNECTED):e===DO.RECONNECTING?this.emit(MO.WS_RECONNECTING,this._websocketReconnectReason):e===DO.CLOSED&&this.emit(MO.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),jw(this,"_disconnectedReason",void 0),jw(this,"_websocketReconnectReason",void 0),jw(this,"_connectionState",DO.CLOSED),jw(this,"reconnectToken",void 0),jw(this,"websocket",void 0),jw(this,"openConnectionTime",void 0),jw(this,"clientId",void 0),jw(this,"lastMsgTime",Date.now()),jw(this,"uploadCache",[]),jw(this,"uploadCacheInterval",void 0),jw(this,"rttRolling",new zC(5)),jw(this,"pingpongTimer",void 0),jw(this,"wsInflateDataTimer",void 0),jw(this,"pingpongTimeoutCount",0),jw(this,"joinResponse",void 0),jw(this,"multiIpOption",void 0),jw(this,"initError",void 0),jw(this,"spec",void 0),jw(this,"store",void 0),jw(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(MO.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){if(this.emit(t._type,t._message),t._type===VO.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===VO.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(tC.UID_BANNED);break;case 15:this.close(tC.IP_BANNED);break;case 16:this.close(tC.CHANNEL_BANNED)}if(t._type===VO.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case PO.ERR_LICENSE_MISSING:this.close(tC.LICENSE_MISSING);break;case PO.ERR_LICENSE_EXPIRED:this.close(tC.LICENSE_EXPIRED);break;case PO.ERR_LICENSE_MINUTES_EXCEEDED:this.close(tC.LICENSE_MINUTES_EXCEEDED);break;case PO.ERR_LICENSE_PERIOD_INVALID:this.close(tC.LICENSE_PERIOD_INVALID);break;case PO.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(tC.LICENSE_MULTIPLE_SDK_SERVICE);break;case PO.ERR_LICENSE_ILLEGAL:this.close(tC.LICENSE_ILLEGAL);break;default:this.close()}}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new JI("gateway-".concat(this.clientId),this.spec.retryConfig,!0,aR("JOIN_GATEWAY_USE_DUAL_DOMAIN"),aR("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===DO.CONNECTED&&this.reconnect("retry",aC.OFFLINE)}))}async request(e,t,n,r){const i=AC(6,""),o={_id:i,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new Ih(((t,n)=>{if(this.connectionState===DO.CONNECTED)return t();const r=()=>{this.off(MO.WS_CLOSED,i),t()},i=()=>{this.off(MO.WS_CONNECTED,r),n(new GO(LT.WS_ABORT))};this.once(MO.WS_CONNECTED,r),this.once(MO.WS_CLOSED,i),e!==UO.PUBLISH&&e!==UO.PUBLISH_DATASTREAM&&e!==UO.SUBSCRIBE&&e!==UO.SUBSCRIBE_DATASTREAM&&e!==UO.UNSUBSCRIBE&&e!==UO.UNSUBSCRIBE_DATASTREAM&&e!==UO.UNPUBLISH&&e!==UO.UNPUBLISH_DATASTREAM&&e!==UO.CONTROL&&e!==UO.RESTART_ICE||this.once(MO.DISCONNECT_P2P,(()=>{n(new GO(LT.DISCONNECT_P2P))})),e!==UO.PUBLISH&&e!==UO.RESTART_ICE||this.once(MO.ABORT_P2P_EXECUTION,(()=>{n(new GO(LT.DISCONNECT_P2P))}))}));if(this.connectionState!==DO.CONNECTING&&this.connectionState!==DO.RECONNECTING||e===UO.JOIN||e===UO.REJOIN||await s(),this.websocket.sendMessage(o,!0),r)return;const c=new Ih(((n,r)=>{let o=!1;const s=(r,i)=>{o=!0,n({isSuccess:"success"===r,message:i||{}}),this.off(MO.WS_CLOSED,c),this.off(MO.WS_RECONNECTING,c),this.emit(MO.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),s);const c=()=>{r(new GO(LT.WS_ABORT,"type: ".concat(e))),this.off(MO.WS_CLOSED,c),this.off(MO.WS_RECONNECTING,c),this.off("res-@".concat(i),s)};this.once(MO.WS_CLOSED,c),this.once(MO.WS_RECONNECTING,c),IC(aR("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==a||o||(SR.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(MO.REQUEST_TIMEOUT,e,t))}))}));let l=null;try{l=await c}catch(r){if(this.connectionState===DO.CLOSED||e===UO.LEAVE)throw new GO(LT.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===UO.JOIN||e===UO.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const d=Number(l.message.error_code||l.message.code),u=MI(d),p=new GO(LT.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message,desc:u.desc});return"success"===u.action?l.message:(SR.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===PO.ERR_TOO_MANY_BROADCASTERS?e===UO.JOIN||e===UO.REJOIN?(this.initError=p,this.close(),p.throw()):p.throw():"failed"===u.action?p.throw():"quit"===u.action?(this.initError=p,this.close(),p.throw()):(d===PO.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,SR.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",aC.MULTI_IP)):this.reconnect(u.action,aC.SERVER_ERROR),e===UO.JOIN||e===UO.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new Ih((n=>{const r=i=>{(!t||t(i))&&(this.off(e,r),n(i))};this.on(e,r)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void SR.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(jO.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=aR("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==DO.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),aR("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}init(e,t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ih(((t,n)=>{this.once(MO.WS_CONNECTED,(()=>t(this.joinResponse))),this.once(MO.WS_CLOSED,(()=>n(this.initError||new GO(LT.WS_ABORT)))),this.connectionState=DO.CONNECTING,this.websocket.init(e).catch(n),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval((()=>{this.handleWsInflateData()}),2e4)}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||tC.LEAVE,this.connectionState=DO.CLOSED,SR.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(MO.ABORT_P2P_EXECUTION);const e=await lC(this,MO.REQUEST_JOIN_INFO),t=await this.request(UO.JOIN,e);if(!t)return this.emit(MO.REPORT_JOIN_GATEWAY,aI.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(MO.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=DO.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new GO(LT.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=pC(this,MO.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(UO.REJOIN,e);return!!t&&(this.connectionState=DO.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach((e=>{this.emit(VO.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(VO.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(VO.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(VO.MUTE_AUDIO,{uid:e.uid}):this.emit(VO.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(VO.MUTE_VIDEO,{uid:e.uid}):this.emit(VO.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(VO.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(VO.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(VO.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(VO.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(VO.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})})),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){SR.debug("[".concat(this.clientId,"] receive notification: "),e);const t=MI(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(tC.UID_BANNED),void this.close()):void this.reconnect(t.action,aC.SERVER_ERROR);SR.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=aR("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(SR.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>aR("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",aC.TIMEOUT):this.request(UO.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),aR("REPORT_STATS")&&this.send(UO.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(jO.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(FO.RECONNECT_WAITTING_FINISH,(e=>{this.emit(MO.WS_RECONNECT_WAITTING_FINISH,e)})),this.websocket.on(FO.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(MO.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(FO.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(FO.CLOSED,(()=>{this.connectionState=DO.CLOSED})),this.websocket.on(FO.FAILED,(()=>{this._disconnectedReason=tC.NETWORK_ERROR,this.connectionState=DO.CLOSED})),this.websocket.on(FO.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===DO.CONNECTED?this.connectionState=DO.RECONNECTING:this.connectionState=DO.CONNECTING})),this.websocket.on(FO.WILL_RECONNECT,((e,t,n)=>{const r=pC(this,MO.IS_P2P_DISCONNECTED),i=r||"retry"!==e;r&&"retry"===e&&(SR.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),e="tryNext",t=aI.P2P_DISCONNECTED),i&&(SR.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(e)),this.emit(MO.REPORT_JOIN_GATEWAY,t||aI.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(MO.DISCONNECT_P2P)),n(e)})),this.websocket.on(FO.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch((e=>{SR.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",aC.SERVER_ERROR)})):this.join().catch((e=>{if(this.emit(MO.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof GO){if(e.code===LT.UNEXPECTED_RESPONSE&&e.data.code===PO.ERR_NO_AUTHORIZED)return this.initError=new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,"AgoraRTCError CAN_NOT_GET_GATEWAY_SERVER: dynamic key expired"),SR.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",aC.SERVER_ERROR);SR.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",aC.SERVER_ERROR):(this.initError=e,this.close())}}))})),this.websocket.on(FO.REQUEST_NEW_URLS,((e,t)=>{lC(this,MO.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(FO.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(VO.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})),this.websocket.on(TI.PRE_CONNECT_PC,(()=>{this.emit(MO.PRE_CONNECT_PC)}))}}let QI=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function $I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$I(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tA(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(aR("TURN_DOMAIN")):(SR.info("Unidentified as ip: ".concat(e,", use as host")),e)}function nA(e,t){e.addresses||(e.addresses=[]);const n=function(e,t){if(aR("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return e.map((e=>{let{ip:t,port:n}=e;return{address:"".concat(t,":").concat(n)}}));const n=aR("GATEWAY_DOMAINS");let r=n[1]&&Li(t).call(t,n[1])?1:0;return e.map((e=>{let{domain_prefix:t,port:i,ip:o}=e;if(t)return{address:"".concat(t,".").concat(n[r++%n.length],":").concat(i)};const a=/^[\.\:\d]+$/.test(o),s=a?"".concat(o.replace(/[^\d]/g,"-"),".").concat(n[r++%n.length],":").concat(i):"".concat(o,":").concat(i);return a||SR.info("Unidentified as ip: ".concat(o,", use as host")),{ip:o,port:i,address:s}}))}(e.addresses,t),r=Array.isArray(e.detail)&&e.detail[18];if(r&&"string"==typeof r){const e=r.split(";");for(let t=0;t<e.length;t++){var i;const r=Of(i=e[t]).call(i);n[t]&&r&&(n[t].ip6=r)}}const o=e.detail&&e.detail.candidate;let a;if(o){const[e,t]=o.split(":");e&&t&&(a={port:Number(t),ip:e,address:"".concat(e,":").concat(t)})}return{gatewayAddrs:n,apGatewayAddress:a,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function rA(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function iA(e){const t=e._encoderConfig;if(!t)return{};const n={resolution:t.width&&t.height?"".concat(rA(t.width),"x").concat(rA(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return"number"==typeof t.frameRate?(n.maxFrameRate=t.frameRate,n.minFrameRate=t.frameRate):t.frameRate&&(n.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,n.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),n}function oA(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function aA(e,t){let n,r,i;switch(t){case QI.CHOOSE_SERVER:r=4096,i="choose server";break;case QI.CLOUD_PROXY:r=1048576,i="proxy";break;case QI.CLOUD_PROXY_5:r=4194304,i="proxy5";break;case QI.CLOUD_PROXY_FALLBACK:r=4194310,i="proxy fallback";break;default:throw new GO(LT.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach((t=>{t.buffer&&t.buffer.flag===r&&(n={code:t.buffer.code,addresses:(t.buffer.edges_services||[]).map((e=>eA(eA({},e),{},{ticket:t.buffer.cert}))),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:eA(eA({},t.buffer.detail),e.detail),flag:t.buffer.flag,opid:e.opid,cert:t.buffer.cert})})),!n)throw new GO(LT.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(i," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return n}async function sA(e,t){return await Ih.all(e.addresses.map((async e=>({address:tA(e.ip),tcpport:e.port,udpport:e.port,username:t&&aR("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():PR.username,password:t&&aR("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await KT(t.toString()):PR.password}))))}function cA(e,t){const n=t.getMediaStreamTrack(!0).getSettings(),r=t.videoHeight||n.height,i=t.videoWidth||n.width;return r&&i?Math.max(Math.min(r,i)/Math.min(rA(e.height),rA(e.width)),1):(SR.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function lA(e){let{candidateType:t,relayProtocol:n,type:r,address:i,port:o,protocol:a}=e;return"local-candidate"===r?{candidateType:t,relayProtocol:n,protocol:a}:{candidateType:t,relayProtocol:n,address:i,port:o,protocol:a}}var dA,uA=ce(aO),pA=ti("Array").values,hA=vi,fA=rn,mA=ge,gA=pA,vA=Array.prototype,_A={DOMTokenList:!0,NodeList:!0},yA=ce((function(e){var t=e.values;return e===vA||mA(vA,e)&&t===vA.values||fA(_A,hA(e))?gA:t})),wA=Me,bA=me,EA=Ve,SA=le,TA=$o,CA=Vo,RA=Be,OA=en,IA=Ze,AA=Object.assign,kA=Object.defineProperty,xA=bA([].concat),LA=!AA||SA((function(){if(wA&&1!==AA({b:1},AA(kA({},"a",{enumerable:!0,get:function(){kA(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=AA({},e)[n]||TA(AA({},t)).join("")!=r}))?function(e,t){for(var n=OA(e),r=arguments.length,i=1,o=CA.f,a=RA.f;r>i;)for(var s,c=IA(arguments[i++]),l=o?xA(TA(c),o(c)):TA(c),d=l.length,u=0;d>u;)s=l[u++],wA&&!EA(a,c,s)||(n[s]=c[s]);return n}:AA,NA=sr,PA=ts,DA=tr,MA=Ve,UA=en,jA=function(e,t,n,r){try{return r?t(NA(n)[0],n[1]):t(n)}catch(t){PA(e,"throw",t)}},VA=ja,BA=Nl,FA=Kr,GA=em,HA=Za,qA=qa,WA=Array,zA=me,KA=2147483647,YA=/[^\0-\u007E]/,JA=/[.\u3002\uFF0E\uFF61]/g,XA="Overflow: input needs wider integers to process",ZA=RangeError,QA=zA(JA.exec),$A=Math.floor,ek=String.fromCharCode,tk=zA("".charCodeAt),nk=zA([].join),rk=zA([].push),ik=zA("".replace),ok=zA("".split),ak=zA("".toLowerCase),sk=function(e){return e+22+75*(e<26)},ck=function(e,t,n){var r=0;for(e=n?$A(e/700):e>>1,e+=$A(e/t);e>455;)e=$A(e/35),r+=36;return $A(r+36*e/(e+38))},lk=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=tk(e,n++);if(i>=55296&&i<=56319&&n<r){var o=tk(e,n++);56320==(64512&o)?rk(t,((1023&i)<<10)+(1023&o)+65536):(rk(t,i),n--)}else rk(t,i)}return t}(e);var n,r,i=e.length,o=128,a=0,s=72;for(n=0;n<e.length;n++)(r=e[n])<128&&rk(t,ek(r));var c=t.length,l=c;for(c&&rk(t,"-");l<i;){var d=KA;for(n=0;n<e.length;n++)(r=e[n])>=o&&r<d&&(d=r);var u=l+1;if(d-o>$A((KA-a)/u))throw ZA(XA);for(a+=(d-o)*u,o=d,n=0;n<e.length;n++){if((r=e[n])<o&&++a>KA)throw ZA(XA);if(r==o){for(var p=a,h=36;;){var f=h<=s?1:h>=s+26?26:h-s;if(p<f)break;var m=p-f,g=36-f;rk(t,ek(sk(f+m%g))),p=$A(m/g),h+=36}rk(t,ek(sk(p))),s=ck(a,u,l==c),a=0,l++}}a++,o++}return nk(t,"")},dk=Nr,uk=Me,pk=Fw,hk=_e,fk=tr,mk=me,gk=ac,vk=il,_k=ul,yk=rn,wk=LA,bk=function(e){var t=UA(e),n=BA(this),r=arguments.length,i=r>1?arguments[1]:void 0,o=void 0!==i;o&&(i=DA(i,r>2?arguments[2]:void 0));var a,s,c,l,d,u,p=qA(t),h=0;if(!p||this===WA&&VA(p))for(a=FA(t),s=n?new this(a):WA(a);a>h;h++)u=o?i(t[h],h):t[h],GA(s,h,u);else for(d=(l=HA(t,p)).next,s=n?new this:[];!(c=MA(d,l)).done;h++)u=o?jA(l,i,[c.value,h],!0):c.value,GA(s,h,u);return s.length=h,s},Ek=am,Sk=lh.codeAt,Tk=wi,Ck=Cc,Rk=Hl,Ok=nE,Ik=Qs,Ak=Ik.set,kk=Ik.getterFor("URL"),xk=Ok.URLSearchParams,Lk=Ok.getState,Nk=hk.URL,Pk=hk.TypeError,Dk=hk.parseInt,Mk=Math.floor,Uk=Math.pow,jk=mk("".charAt),Vk=mk(/./.exec),Bk=mk([].join),Fk=mk(1..toString),Gk=mk([].pop),Hk=mk([].push),qk=mk("".replace),Wk=mk([].shift),zk=mk("".split),Kk=mk("".slice),Yk=mk("".toLowerCase),Jk=mk([].unshift),Xk="Invalid scheme",Zk="Invalid host",Qk="Invalid port",$k=/[a-z]/i,ex=/[\d+-.a-z]/i,tx=/\d/,nx=/^0x/i,rx=/^[0-7]+$/,ix=/^\d+$/,ox=/^[\da-f]+$/i,ax=/[\0\t\n\r #%/:<>?@[\\\]^|]/,sx=/[\0\t\n\r #/:<>?@[\\\]^|]/,cx=/^[\u0000-\u0020]+/,lx=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,dx=/[\t\n\r]/g,ux=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)Jk(t,e%256),e=Mk(e/256);return Bk(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=Fk(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},px={},hx=wk({},px,{" ":1,'"':1,"<":1,">":1,"`":1}),fx=wk({},hx,{"#":1,"?":1,"{":1,"}":1}),mx=wk({},fx,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),gx=function(e,t){var n=Sk(e,0);return n>32&&n<127&&!yk(t,e)?e:encodeURIComponent(e)},vx={ftp:21,file:null,http:80,https:443,ws:80,wss:443},_x=function(e,t){var n;return 2==e.length&&Vk($k,jk(e,0))&&(":"==(n=jk(e,1))||!t&&"|"==n)},yx=function(e){var t;return e.length>1&&_x(Kk(e,0,2))&&(2==e.length||"/"===(t=jk(e,2))||"\\"===t||"?"===t||"#"===t)},wx=function(e){return"."===e||"%2e"===Yk(e)},bx={},Ex={},Sx={},Tx={},Cx={},Rx={},Ox={},Ix={},Ax={},kx={},xx={},Lx={},Nx={},Px={},Dx={},Mx={},Ux={},jx={},Vx={},Bx={},Fx={},Gx=function(e,t,n){var r,i,o,a=Tk(e);if(t){if(i=this.parse(a))throw Pk(i);this.searchParams=null}else{if(void 0!==n&&(r=new Gx(n,!0)),i=this.parse(a,null,r))throw Pk(i);(o=Lk(new xk)).bindURL(this),this.searchParams=o}};Gx.prototype={type:"URL",parse:function(e,t,n){var r,i,o,a,s,c=this,l=t||bx,d=0,u="",p=!1,h=!1,f=!1;for(e=Tk(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=qk(e,cx,""),e=qk(e,lx,"$1")),e=qk(e,dx,""),r=bk(e);d<=r.length;){switch(i=r[d],l){case bx:if(!i||!Vk($k,i)){if(t)return Xk;l=Sx;continue}u+=Yk(i),l=Ex;break;case Ex:if(i&&(Vk(ex,i)||"+"==i||"-"==i||"."==i))u+=Yk(i);else{if(":"!=i){if(t)return Xk;u="",l=Sx,d=0;continue}if(t&&(c.isSpecial()!=yk(vx,u)||"file"==u&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=u,t)return void(c.isSpecial()&&vx[c.scheme]==c.port&&(c.port=null));u="","file"==c.scheme?l=Px:c.isSpecial()&&n&&n.scheme==c.scheme?l=Tx:c.isSpecial()?l=Ix:"/"==r[d+1]?(l=Cx,d++):(c.cannotBeABaseURL=!0,Hk(c.path,""),l=Vx)}break;case Sx:if(!n||n.cannotBeABaseURL&&"#"!=i)return Xk;if(n.cannotBeABaseURL&&"#"==i){c.scheme=n.scheme,c.path=Ek(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,l=Fx;break}l="file"==n.scheme?Px:Rx;continue;case Tx:if("/"!=i||"/"!=r[d+1]){l=Rx;continue}l=Ax,d++;break;case Cx:if("/"==i){l=kx;break}l=jx;continue;case Rx:if(c.scheme=n.scheme,i==dA)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ek(n.path),c.query=n.query;else if("/"==i||"\\"==i&&c.isSpecial())l=Ox;else if("?"==i)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ek(n.path),c.query="",l=Bx;else{if("#"!=i){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ek(n.path),c.path.length--,l=jx;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ek(n.path),c.query=n.query,c.fragment="",l=Fx}break;case Ox:if(!c.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,l=jx;continue}l=kx}else l=Ax;break;case Ix:if(l=Ax,"/"!=i||"/"!=jk(u,d+1))continue;d++;break;case Ax:if("/"!=i&&"\\"!=i){l=kx;continue}break;case kx:if("@"==i){p&&(u="%40"+u),p=!0,o=bk(u);for(var m=0;m<o.length;m++){var g=o[m];if(":"!=g||f){var v=gx(g,mx);f?c.password+=v:c.username+=v}else f=!0}u=""}else if(i==dA||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()){if(p&&""==u)return"Invalid authority";d-=bk(u).length+1,u="",l=xx}else u+=i;break;case xx:case Lx:if(t&&"file"==c.scheme){l=Mx;continue}if(":"!=i||h){if(i==dA||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()){if(c.isSpecial()&&""==u)return Zk;if(t&&""==u&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(u))return a;if(u="",l=Ux,t)return;continue}"["==i?h=!0:"]"==i&&(h=!1),u+=i}else{if(""==u)return Zk;if(a=c.parseHost(u))return a;if(u="",l=Nx,t==Lx)return}break;case Nx:if(!Vk(tx,i)){if(i==dA||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()||t){if(""!=u){var _=Dk(u,10);if(_>65535)return Qk;c.port=c.isSpecial()&&_===vx[c.scheme]?null:_,u=""}if(t)return;l=Ux;continue}return Qk}u+=i;break;case Px:if(c.scheme="file","/"==i||"\\"==i)l=Dx;else{if(!n||"file"!=n.scheme){l=jx;continue}if(i==dA)c.host=n.host,c.path=Ek(n.path),c.query=n.query;else if("?"==i)c.host=n.host,c.path=Ek(n.path),c.query="",l=Bx;else{if("#"!=i){yx(Bk(Ek(r,d),""))||(c.host=n.host,c.path=Ek(n.path),c.shortenPath()),l=jx;continue}c.host=n.host,c.path=Ek(n.path),c.query=n.query,c.fragment="",l=Fx}}break;case Dx:if("/"==i||"\\"==i){l=Mx;break}n&&"file"==n.scheme&&!yx(Bk(Ek(r,d),""))&&(_x(n.path[0],!0)?Hk(c.path,n.path[0]):c.host=n.host),l=jx;continue;case Mx:if(i==dA||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&_x(u))l=jx;else if(""==u){if(c.host="",t)return;l=Ux}else{if(a=c.parseHost(u))return a;if("localhost"==c.host&&(c.host=""),t)return;u="",l=Ux}continue}u+=i;break;case Ux:if(c.isSpecial()){if(l=jx,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=dA&&(l=jx,"/"!=i))continue}else c.fragment="",l=Fx;else c.query="",l=Bx;break;case jx:if(i==dA||"/"==i||"\\"==i&&c.isSpecial()||!t&&("?"==i||"#"==i)){if(".."===(s=Yk(s=u))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(c.shortenPath(),"/"==i||"\\"==i&&c.isSpecial()||Hk(c.path,"")):wx(u)?"/"==i||"\\"==i&&c.isSpecial()||Hk(c.path,""):("file"==c.scheme&&!c.path.length&&_x(u)&&(c.host&&(c.host=""),u=jk(u,0)+":"),Hk(c.path,u)),u="","file"==c.scheme&&(i==dA||"?"==i||"#"==i))for(;c.path.length>1&&""===c.path[0];)Wk(c.path);"?"==i?(c.query="",l=Bx):"#"==i&&(c.fragment="",l=Fx)}else u+=gx(i,fx);break;case Vx:"?"==i?(c.query="",l=Bx):"#"==i?(c.fragment="",l=Fx):i!=dA&&(c.path[0]+=gx(i,px));break;case Bx:t||"#"!=i?i!=dA&&("'"==i&&c.isSpecial()?c.query+="%27":c.query+="#"==i?"%23":gx(i,px)):(c.fragment="",l=Fx);break;case Fx:i!=dA&&(c.fragment+=gx(i,hx))}d++}},parseHost:function(e){var t,n,r;if("["==jk(e,0)){if("]"!=jk(e,e.length-1))return Zk;if(t=function(e){var t,n,r,i,o,a,s,c=[0,0,0,0,0,0,0,0],l=0,d=null,u=0,p=function(){return jk(e,u)};if(":"==p()){if(":"!=jk(e,1))return;u+=2,d=++l}for(;p();){if(8==l)return;if(":"!=p()){for(t=n=0;n<4&&Vk(ox,p());)t=16*t+Dk(p(),16),u++,n++;if("."==p()){if(0==n)return;if(u-=n,l>6)return;for(r=0;p();){if(i=null,r>0){if(!("."==p()&&r<4))return;u++}if(!Vk(tx,p()))return;for(;Vk(tx,p());){if(o=Dk(p(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;u++}c[l]=256*c[l]+i,2!=++r&&4!=r||l++}if(4!=r)return;break}if(":"==p()){if(u++,!p())return}else if(p())return;c[l++]=t}else{if(null!==d)return;u++,d=++l}}if(null!==d)for(a=l-d,l=7;0!=l&&a>0;)s=c[l],c[l--]=c[d+a-1],c[d+--a]=s;else if(8!=l)return;return c}(Kk(e,1,-1)),!t)return Zk;this.host=t}else if(this.isSpecial()){if(e=function(e){var t,n,r=[],i=ok(ik(ak(e),JA,"."),".");for(t=0;t<i.length;t++)n=i[t],rk(r,QA(YA,n)?"xn--"+lk(n):n);return nk(r,".")}(e),Vk(ax,e))return Zk;if(t=function(e){var t,n,r,i,o,a,s,c=zk(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=c[r]))return e;if(o=10,i.length>1&&"0"==jk(i,0)&&(o=Vk(nx,i)?16:8,i=Kk(i,8==o?1:2)),""===i)a=0;else{if(!Vk(10==o?ix:8==o?rx:ox,i))return e;a=Dk(i,o)}Hk(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=Uk(256,5-t))return null}else if(a>255)return null;for(s=Gk(n),r=0;r<n.length;r++)s+=n[r]*Uk(256,3-r);return s}(e),null===t)return Zk;this.host=t}else{if(Vk(sx,e))return Zk;for(t="",n=bk(e),r=0;r<n.length;r++)t+=gx(n[r],px);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return yk(vx,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&_x(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,c=e.fragment,l=t+":";return null!==i?(l+="//",e.includesCredentials()&&(l+=n+(r?":"+r:"")+"@"),l+=ux(i),null!==o&&(l+=":"+o)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?a[0]:a.length?"/"+Bk(a,"/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw Pk(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Hx(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ux(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Tk(e)+":",bx)},getUsername:function(){return this.username},setUsername:function(e){var t=bk(Tk(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=gx(t[n],mx)}},getPassword:function(){return this.password},setPassword:function(e){var t=bk(Tk(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=gx(t[n],mx)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ux(e):ux(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,xx)},getHostname:function(){var e=this.host;return null===e?"":ux(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Lx)},getPort:function(){var e=this.port;return null===e?"":Tk(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=Tk(e))?this.port=null:this.parse(e,Nx))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+Bk(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ux))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=Tk(e))?this.query=null:("?"==jk(e,0)&&(e=Kk(e,1)),this.query="",this.parse(e,Bx)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=Tk(e))?("#"==jk(e,0)&&(e=Kk(e,1)),this.fragment="",this.parse(e,Fx)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Hx=function(e){var t=_k(this,qx),n=Rk(arguments.length,1)>1?arguments[1]:void 0,r=Ak(t,new Gx(e,!1,n));uk||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},qx=Hx.prototype,Wx=function(e,t){return{get:function(){return kk(this)[e]()},set:t&&function(e){return kk(this)[t](e)},configurable:!0,enumerable:!0}};if(uk&&(vk(qx,"href",Wx("serialize","setHref")),vk(qx,"origin",Wx("getOrigin")),vk(qx,"protocol",Wx("getProtocol","setProtocol")),vk(qx,"username",Wx("getUsername","setUsername")),vk(qx,"password",Wx("getPassword","setPassword")),vk(qx,"host",Wx("getHost","setHost")),vk(qx,"hostname",Wx("getHostname","setHostname")),vk(qx,"port",Wx("getPort","setPort")),vk(qx,"pathname",Wx("getPathname","setPathname")),vk(qx,"search",Wx("getSearch","setSearch")),vk(qx,"searchParams",Wx("getSearchParams")),vk(qx,"hash",Wx("getHash","setHash"))),gk(qx,"toJSON",(function(){return kk(this).serialize()}),{enumerable:!0}),gk(qx,"toString",(function(){return kk(this).serialize()}),{enumerable:!0}),Nk){var zx=Nk.createObjectURL,Kx=Nk.revokeObjectURL;zx&&gk(Hx,"createObjectURL",fk(zx,Nk)),Kx&&gk(Hx,"revokeObjectURL",fk(Kx,Nk))}Ck(Hx,"URL"),dk({global:!0,constructor:!0,forced:!pk,sham:!uk},{URL:Hx});var Yx=Nr,Jx=le,Xx=Hl,Zx=wi,Qx=Fw,$x=ht("URL");Yx({target:"URL",stat:!0,forced:!(Qx&&Jx((function(){$x.canParse()})))},{canParse:function(e){var t=Xx(arguments.length,1),n=Zx(e),r=t<2||void 0===arguments[1]?void 0:Zx(arguments[1]);try{return!!new $x(n,r)}catch(e){return!1}}});var eL=ce(ct.URL);const tL={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function nL(){return tL}function rL(){return"setSinkId"in HTMLAudioElement.prototype&&(!aR("RESTRICTION_SET_PLAYBACK_DEVICE")||(aT()||cT())&&!CT())}function iL(){return!tL.supportUnifiedPlan||aR("CHROME_FORCE_PLAN_B")&&RT()}let oL=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function aL(e,t,n){return{sampleRate:e,stereo:t,bitrate:n}}function sL(e,t,n,r,i){return{width:e,height:t,frameRate:n,bitrateMin:r,bitrateMax:i}}function cL(e,t,n,r,i){return{width:{max:e},height:{max:t},frameRate:n,bitrateMin:r,bitrateMax:i}}function lL(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}const dL={"90p":sL(160,90),"90p_1":sL(160,90),"120p":sL(160,120,15,30,65),"120p_1":sL(160,120,15,30,65),"120p_3":sL(120,120,15,30,50),"120p_4":sL(212,120),"180p":sL(320,180,15,30,140),"180p_1":sL(320,180,15,30,140),"180p_3":sL(180,180,15,30,100),"180p_4":sL(240,180,15,30,120),"240p":sL(320,240,15,40,200),"240p_1":sL(320,240,15,40,200),"240p_3":sL(240,240,15,40,140),"240p_4":sL(424,240,15,40,220),"360p":sL(640,360,15,80,400),"360p_1":sL(640,360,15,80,400),"360p_3":sL(360,360,15,80,260),"360p_4":sL(640,360,30,80,600),"360p_6":sL(360,360,30,80,400),"360p_7":sL(480,360,15,80,320),"360p_8":sL(480,360,30,80,490),"360p_9":sL(640,360,15,80,800),"360p_10":sL(640,360,24,80,800),"360p_11":sL(640,360,24,80,1e3),"480p":sL(640,480,15,100,500),"480p_1":sL(640,480,15,100,500),"480p_2":sL(640,480,30,100,1e3),"480p_3":sL(480,480,15,100,400),"480p_4":sL(640,480,30,100,750),"480p_6":sL(480,480,30,100,600),"480p_8":sL(848,480,15,100,610),"480p_9":sL(848,480,30,100,930),"480p_10":sL(640,480,10,100,400),"720p":sL(1280,720,15,120,1130),"720p_auto":sL(1280,720,30,900,3e3),"720p_1":sL(1280,720,15,120,1130),"720p_2":sL(1280,720,30,120,2e3),"720p_3":sL(1280,720,30,120,1710),"720p_5":sL(960,720,15,120,910),"720p_6":sL(960,720,30,120,1380),"1080p":sL(1920,1080,15,120,2080),"1080p_1":sL(1920,1080,15,120,2080),"1080p_2":sL(1920,1080,30,120,3e3),"1080p_3":sL(1920,1080,30,120,3150),"1080p_5":sL(1920,1080,60,120,4780),"1440p":sL(2560,1440,30,120,4850),"1440p_1":sL(2560,1440,30,120,4850),"1440p_2":sL(2560,1440,60,120,7350),"4k":sL(3840,2160,30,120,8910),"4k_1":sL(3840,2160,30,120,8910),"4k_3":sL(3840,2160,60,120,13500)},uL={"480p":cL(640,480,5),"480p_1":cL(640,480,5),"480p_2":cL(640,480,30),"480p_3":cL(640,480,15),"720p":cL(1280,720,5),"720p_auto":sL(1280,720,30,900,3e3),"720p_1":cL(1280,720,5),"720p_2":cL(1280,720,30),"720p_3":cL(1280,720,15),"1080p":cL(1920,1080,5),"1080p_1":cL(1920,1080,5),"1080p_2":cL(1920,1080,30),"1080p_3":cL(1920,1080,15)},pL={"1SL1TL":lL(1,1),"3SL3TL":lL(3,3),"2SL3TL":lL(2,3)};function hL(e){return e||(e="480p_1"),"string"==typeof e?Object.assign({},dL[e]):e}function fL(e){return"string"==typeof e?Object.assign({},uL[e]):e}function mL(e){return"string"==typeof e?Object.assign({},pL[e]):e}const gL={speech_low_quality:aL(16e3,!1),speech_standard:aL(32e3,!1,18),music_standard:aL(48e3,!1),standard_stereo:aL(48e3,!0,56),high_quality:aL(48e3,!1,128),high_quality_stereo:aL(48e3,!0,192)};function vL(e){return"string"==typeof e?Object.assign({},gL[e]):e}const _L=[];function yL(e){return DT(e,"mediaSource",["screen","window","application"]),!0}let wL=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),bL=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e}({}),EL=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),SL=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),TL=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e}({}),CL=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),RL=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),OL=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),IL=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),AL=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});const kL={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},xL={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},LL={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},NL={uplinkNetworkQuality:0,downlinkNetworkQuality:0},PL={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let DL=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),ML=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),UL=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),jL=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),VL=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),BL=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const FL={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let GL=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function HL(e,t,n,r,i){var o,a,s={};return Object.keys(r).forEach((function(e){s[e]=r[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=Ji(o=uA(a=n.slice()).call(a)).call(o,(function(n,r){return r(e,t,n)||n}),s),i&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(i):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}function qL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WL(Object(n),!0).forEach((function(t){qL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class KL extends YT{set _mediaStreamTrack(e){e!==this.mediaStreamTrack&&(this.safeEmit(CL.TRACK_UPDATED,e),this.mediaStreamTrack=e)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(e,t){super(),qL(this,"trackMediaType",void 0),qL(this,"_ID",void 0),qL(this,"_rtpTransceiver",void 0),qL(this,"_lowRtpTransceiver",void 0),qL(this,"_hints",[]),qL(this,"_isClosed",!1),qL(this,"_originMediaStreamTrack",void 0),qL(this,"mediaStreamTrack",void 0),qL(this,"_external",{}),this._ID=t||AC(8,"track-"),this._originMediaStreamTrack=e,this.mediaStreamTrack=e,function(e){Li(_L).call(_L,e)||_L.push(e)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){return e||wC((()=>{var e;LR.reportApiInvoke(null,{name:ZT.GET_MEDIA_STREAM_TRACK,options:[],tag:QT.TRACER}).onSuccess((null===(e=this._mediaStreamTrack)||void 0===e?void 0:e.label)||"")}),this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(e){return e===EL.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(e){const t=_L.indexOf(e);-1!==t&&_L.splice(t,1)}(this),this.emit(RL.CLOSED),this.removeAllListeners(CL.SEI_RECEIVED)}_updateRtpTransceiver(e,t){if(t===EL.LOW_STREAM){if(this._lowRtpTransceiver===e)return;this._lowRtpTransceiver=e}else{if(this._rtpTransceiver===e)return;this._rtpTransceiver=e}this.emit(CL.TRANSCEIVER_UPDATED,e,t)}}class YL extends KL{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(e,t){super(e,t),qL(this,"_enabled",!0),qL(this,"_muted",!1),qL(this,"_isExternalTrack",!1),qL(this,"_isClosed",!1),qL(this,"_enabledMutex",void 0),qL(this,"processor",void 0),qL(this,"_processorContext",void 0),qL(this,"_handleTrackEnded",(()=>{this.onTrackEnded()})),this._enabledMutex=new FC("".concat(this.getTrackId())),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var e,t;return null!==(e=null===(t=this._originMediaStreamTrack)||void 0===t?void 0:t.label)&&void 0!==e?e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,SR.debug("[".concat(this.getTrackId(),"] close")),this.emit(wL.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isExternalTrack=n,e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await dC(this,wL.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){SR.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(RL.TRACK_ENDED)}stateCheck(e,t){if(SR.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(t,"]")),PT(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new NT(LT.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",SR);if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new NT(LT.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",SR)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():Ih.resolve([])}}const JL=window.AudioContext||window.webkitAudioContext;let XL=null;const ZL=new class extends YT{constructor(){super(...arguments),qL(this,"prevState",void 0),qL(this,"curState",void 0),qL(this,"currentTime",void 0),qL(this,"currentTimeStuckAt",void 0),qL(this,"interruptDetectorTrack",void 0),qL(this,"onLocalAudioTrackMute",(()=>{SR.info("ios15-interruption-start"),this.emit(oL.IOS_15_16_INTERRUPTION_START)})),qL(this,"onLocalAudioTrackUnmute",(async()=>{SR.info("ios15-interruption-end"),"running"!==this.curState||this.duringInterruption?SR.info("ios15-interruption-end-canceled"):(XL&&await XL.suspend(),this.emit(oL.IOS_15_16_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){SR.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){SR.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function QL(){if(!XL){if(function(){if(!JL)return void SR.error("your browser is not support web audio");SR.info("create audio context");const e=zL({},aR("WEBAUDIO_INIT_OPTIONS"));SR.debug("audio context init option:",JSON.stringify(e)),XL=new JL(e),ZL.curState=XL.state,XL.onstatechange=()=>{ZL.prevState=ZL.curState,ZL.curState=XL?XL.state:void 0;const{prevState:e,curState:t}=ZL,n="running"===t,r="interrupted"===t,i="running"===e,o="suspended"===e,a="interrupted"===e,s=tT().osVersion;(dT()||ET())&&i&&r&&(SR.info("ios".concat(s,"-interruption-start")),ZL.emit(oL.IOS_INTERRUPTION_START)),(dT()||ET())&&(o||a)&&n&&(SR.info("ios".concat(s,"-interruption-end")),ZL.emit(oL.IOS_INTERRUPTION_END)),e!==t&&ZL.emit(oL.STATE_CHANGE,t,e)},setInterval((()=>{var e;const t=null===(e=XL)||void 0===e?void 0:e.currentTime;ZL.currentTime!==t?(ZL.currentTimeStuckAt&&(SR.debug("AudioContext current time resume at ".concat(t)),ZL.currentTimeStuckAt=void 0),ZL.currentTime=t):(t!==ZL.currentTimeStuckAt&&(LR.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:t},tag:QT.TRACER}).onSuccess(),SR.warning("AudioContext current time stuck at ".concat(t))),ZL.currentTimeStuckAt=t)}),5e3),async function(e){const t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let n,r=!1,i=!1,o=!1;function a(t){"running"===e.state?s(!1):dT()||ET()?"suspended"===e.state&&(s(!0),t&&e.resume().then(c,c)):"closed"!==e.state&&(s(!0),t&&e.resume().then(c,c))}function s(e){if(r!==e){r=e;for(let n=0,r=t;n<r.length;n+=1){const t=r[n];e?window.addEventListener(t,l,{capture:!0,passive:!0}):window.removeEventListener(t,l,{capture:!0,passive:!0})}}}function c(){a(!1)}function l(){a(!0)}function d(e){if(!o)if(n.paused)if(e){let t;u(!1),o=!0;try{t=n.play(),t?t.then(p,p):(n.addEventListener("playing",p),n.addEventListener("abort",p),n.addEventListener("error",p))}catch(e){p()}}else u(!0);else u(!1)}function u(e){if(i!==e){i=e;for(let n=0,r=t;n<r.length;n++){const t=r[n];e?window.addEventListener(t,h,{capture:!0,passive:!0}):window.removeEventListener(t,h,{capture:!0,passive:!0})}}}function p(){n.removeEventListener("playing",p),n.removeEventListener("abort",p),n.removeEventListener("error",p),o=!1,d(!1)}function h(){d(!0)}if(dT()){const t=e.createMediaStreamDestination(),r=document.createElement("div");r.innerHTML="<audio x-webkit-airplay='deny'></audio>",n=r.children.item(0),n.controls=!1,n.disableRemotePlayback=!0,n.preload="auto",n.srcObject=t.stream,d(!0)}ZL.on(oL.STATE_CHANGE,(function(){a(!0)})),a(!1)}(XL)}(),!XL)throw new NT(LT.NOT_SUPPORTED,"can not create audio context");return XL}return XL}function $L(e){if(function(){if(null!==eN)return eN;const e=QL(),t=e.createBufferSource(),n=e.createGain(),r=e.createGain();t.connect(n),t.connect(r),t.disconnect(n);let i=!1;try{t.disconnect(n)}catch(e){i=!0}return t.disconnect(),eN=i,i}())return;const t=e.connect,n=e.disconnect;e.connect=(n,r,i)=>{var o;return e._inputNodes||(e._inputNodes=[]),Li(o=e._inputNodes).call(o,n)||(n instanceof AudioNode?(e._inputNodes.push(n),t.call(e,n,r,i)):t.call(e,n,r)),e},e.disconnect=(r,i,o)=>{n.call(e),r?fC(e._inputNodes,r):e._inputNodes=[];for(const n of e._inputNodes)t.call(e,n)}}let eN=null;function tN(e,t){let n=!1;const r=1/t;if(aR("DISABLE_WEBAUDIO")){const t=window.setInterval((()=>{n?window.clearInterval(t):e(performance.now()/1e3)}),1e3*r)}else{const t=QL();let i=t.createGain();i.gain.value=0,i.connect(t.destination);const o=()=>{if(n)return void(i=null);const a=t.createOscillator();a.onended=o,a.connect(i),a.start(0),a.stop(t.currentTime+r),e(t.currentTime)};o()}return()=>{n=!0}}class nN{constructor(){qL(this,"context",void 0),qL(this,"analyserNode",void 0),qL(this,"sourceNode",void 0),this.context=QL(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch(e){}this.sourceNode=e,null==e||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode)return 0;if(!this.context||dT()||ET()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{const t=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(t);for(let n=0;n<e.length;++n)e[n]=t[n]/128-1}const t=Ji(e).call(e,((e,t)=>e+t*t),0)/e.length;return Math.max(10*Math.log10(t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,t;null===(e=this.sourceNode)||void 0===e||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(t=this.sourceNode)||void 0===t||t.connect(this.analyserNode)}catch(e){SR.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class rN extends YT{get processSourceNode(){return this.sourceNode}set processedNode(e){var t;if(!this.isDestroyed&&this._processedNode!==e){try{var n;null===(n=this.sourceNode)||void 0===n||n.disconnect(this.outputNode)}catch(e){}null===(t=this._processedNode)||void 0===t||t.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),qL(this,"outputNode",void 0),qL(this,"outputTrack",void 0),qL(this,"isPlayed",!1),qL(this,"sourceNode",void 0),qL(this,"context",void 0),qL(this,"audioBufferNode",void 0),qL(this,"destNode",void 0),qL(this,"audioOutputLevel",0),qL(this,"volumeLevelAnalyser",void 0),qL(this,"_processedNode",void 0),qL(this,"playNode",void 0),qL(this,"isDestroyed",!1),qL(this,"onNoAudioInput",void 0),qL(this,"isNoAudioInput",!1),qL(this,"_noAudioInputCount",0),this.context=QL(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),$L(this.outputNode),this.volumeLevelAnalyser=new nN}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{this.emit(AL.ON_AUDIO_BUFFER,function(e){for(let t=0;t<e.outputBuffer.numberOfChannels;t+=1){const n=e.outputBuffer.getChannelData(t);for(let e=0;e<n.length;e+=1)n[e]=0}return e.inputBuffer}(e))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!nL().webAudioMediaStreamDest)throw new NT(LT.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){"running"!==this.context.state&&gC((()=>{ZL.emit("autoplay-failed")})),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;dT()||ET()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume();const t=this.volumeLevelAnalyser.getAnalyserNode();let n;t.getFloatTimeDomainData?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n)):(n=new Uint8Array(t.fftSize),t.getByteTimeDomainData(n));let r=!1;for(let e=0;e<n.length;e++)0!==n[e]&&(r=!0);return r?(this.isNoAudioInput=!1,!0):(await IC(200),await this.checkHasAudioInput(e?e+1:1)&&r)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var e,t;null===(e=this.processedNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?null===(e=this.processedNode)||void 0===e||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class iN extends rN{get isFreeze(){return!1}constructor(e,t,n){var r;if(super(),qL(this,"sourceNode",void 0),qL(this,"track",void 0),qL(this,"clonedTrack",void 0),qL(this,"audioElement",void 0),qL(this,"isCurrentTrackCloned",!1),qL(this,"isRemoteTrack",!1),qL(this,"originVolumeLevelAnalyser",void 0),qL(this,"rebuildWebAudio",(async()=>{if(SR.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void SR.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then((()=>SR.info("resume success"))),SR.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const e=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?e.stop():this.isCurrentTrackCloned=!0;const t=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(t),$L(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const n=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(n,this.context.currentTime),$L(this.outputNode),this.emit(AL.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=t,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()})),"audio"!==e.kind)throw new NT(LT.UNEXPECTED_ERROR);this.track=e;const i=new MediaStream([this.track]);if(this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(i),$L(this.sourceNode),n){const e=n.clone();e.enabled=!0,this.clonedTrack=e,SR.debug("create an unmuted track ".concat(e.id," from the original track ").concat(n.id," to get the volume"));const t=this.context.createMediaStreamSource(new MediaStream([e]));$L(t),this.originVolumeLevelAnalyser=new nN,this.originVolumeLevelAnalyser.updateSource(t)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=i;const o=tT();t&&o.os===XS.IOS&&Number(null===(r=o.osVersion)||void 0===r?void 0:r.split(".")[0])<15&&(ZL.on(oL.STATE_CHANGE,(()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()})),this.checkHasAudioInput().then((e=>{e||document.body.addEventListener("click",this.rebuildWebAudio,!0)})))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),$L(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(AL.UPDATE_SOURCE),this.audioElement.srcObject=t}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),ZL.off("state-change",this.rebuildWebAudio),null===(e=this.originVolumeLevelAnalyser)||void 0===e||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){const t=e.clone();t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=t),SR.debug("create an unmuted track ".concat(t.id," from the original track ").concat(e.id," to get the volume"));const n=this.context.createMediaStreamSource(new MediaStream([t]));$L(n),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(n)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function oN(e,t,n){const r=(e,t)=>e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t,i={audio:!!n&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:r(t.height,1080),maxWidth:r(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(i.video.mandatory.maxFrameRate=t.frameRate.max,i.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(i.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(i)}async function aN(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const n=XT();if(!n)throw console.error("failed to fetch electron, please mount it to window"),new NT(LT.ELECTRON_IS_NULL);let r=null;try{var i;r=(null===(i=n.desktopCapturer)||void 0===i?void 0:i.getSources({types:t}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch(e){r=null}r&&r.then||(r=new Ih(((e,r)=>{n.desktopCapturer.getSources({types:t},((t,n)=>{t?r(t):e(n)}))})));try{return await r}catch(e){throw new NT(LT.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.toString())}}const sN=new FC("safari");let cN=!1,lN=!1;async function dN(e,t){let n=0,r=null;for(;n<2;)try{r=await uN(e,t,n>0);break}catch(e){if(e instanceof NT)throw SR.error("[".concat(t,"] ").concat(e.toString())),e;const r=pN(e.name||e.code||e,e.message);if(r.code===LT.MEDIA_OPTION_INVALID){SR.debug("[".concat(t,"] detect media option invalid, retry")),n+=1,await IC(500);continue}throw SR.error("[".concat(t,"] ").concat(r.toString())),r}if(!r)throw new NT(LT.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return r}async function uN(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new NT(LT.NOT_SUPPORTED,"can not find getUserMedia");n&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const r=nL(),i=new MediaStream;if(e.audioSource&&i.addTrack(e.audioSource),e.videoSource&&i.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return SR.debug("Using Video Source/ Audio Source"),i;if(e.screen)if(XT())e.screen.sourceId?hN(i,await oN(e.screen.sourceId,e.screen,e.screenAudio)):hN(i,await async function(e,t){const n=await aN(e.mediaSource),{sourceId:r,audio:i}=await function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Ih(((n,r)=>{const i=document.createElement("div");i.innerText="share screen",i.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const o=document.createElement("div");o.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const a=document.createElement("div");a.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",a.setAttribute("style","height: 12%;");const s=document.createElement("div");s.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const c=document.createElement("div");c.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const l=document.createElement("button");l.innerHTML="cancel",l.setAttribute("style","width: 85px;"),l.onclick=()=>{document.body.removeChild(p);const e=new Error("NotAllowedError");e.name="NotAllowedError",r(e)};let d=t;const u=document.createElement("div");if(t){const e=document.createElement("input");e.setAttribute("type","checkbox");const t=document.createElement("span");e.setAttribute("style","margin-right: 6px;"),t.innerText="Share audio",e.checked=d,e.onchange=()=>{d=e.checked},u.appendChild(e),u.appendChild(t)}c.appendChild(u),c.appendChild(l),o.appendChild(a),o.appendChild(s),o.appendChild(c);const p=document.createElement("div");p.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),p.appendChild(i),p.appendChild(o),document.body.appendChild(p),e.map((e=>{if(e.id){const t=document.createElement("div");t.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let r=e.thumbnail;try{const{width:e}=r.getSize();e>1920&&(r=r.resize({width:1920}))}catch(e){throw e&&e.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),e}t.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+r.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))+"</span>",t.onclick=()=>{document.body.removeChild(p),n({sourceId:e.id,audio:d})},s.appendChild(t)}}))}))}(n,t);return await oN(r,e,i)}(e.screen,e.screenAudio));else if(aT()&&e.screen.extensionId&&e.screen.mandatory){if(!r.getStreamFromExtension)throw new NT(LT.NOT_SUPPORTED,"This browser does not support screen sharing");SR.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const n=await(a=e.screen.extensionId,s=t,new Ih(((e,t)=>{try{chrome.runtime.sendMessage(a,{getStream:!0},(n=>{if(!n||!n.streamId)return SR.error("[".concat(s,"] No response from Chrome Plugin. Plugin not installed properly"),n),void t(new NT(LT.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(n.streamId)}))}catch(e){SR.error("[".concat(s,"] AgoraRTC screensharing plugin is not accessible(").concat(a,")"),e.toString()),t(new NT(LT.CHROME_PLUGIN_NOT_INSTALL))}})));e.screen.mandatory.chromeMediaSourceId=n,hN(i,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(r.getDisplayMedia){var o;e.screen.mediaSource&&yL(e.screen.mediaSource);const n={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:null!==(o=e.screen.displaySurface)&&void 0!==o?o:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource},{selfBrowserSurface:r,surfaceSwitching:a,systemAudio:s}=e.screen,c={selfBrowserSurface:r,surfaceSwitching:a,systemAudio:s};!r&&delete c.selfBrowserSurface,!a&&delete c.surfaceSwitching,!s&&delete c.systemAudio,SR.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:n,audio:!!e.screenAudio,controls:c})),hN(i,await navigator.mediaDevices.getDisplayMedia(zL({video:n,audio:!!e.screenAudio},c)))}else{if(!lT())throw SR.error("[".concat(t,"] This browser does not support screenSharing")),new NT(LT.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&yL(e.screen.mediaSource);const n={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};SR.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(n))),hN(i,await navigator.mediaDevices.getUserMedia(n))}}var a,s;if(!e.video&&!e.audio)return i;let c={video:e.video,audio:e.audio},l=aR("MEDIA_DEVICE_CONSTRAINTS");if(l)try{"string"==typeof l&&(l=JSON.parse(l)),c=DC(c,l)}catch(e){}SR.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(c)),tT();let d,u=null;(sT()||dT()||oT())&&(u=await sN.lock());try{d=await navigator.mediaDevices.getUserMedia(c)}catch(e){throw u&&u(),e}return c.audio&&(cN=!0),c.video&&(lN=!0),hN(i,d),u&&u(),i}function pN(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new NT(LT.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new NT(LT.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new NT(LT.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new NT(LT.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new NT(LT.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new NT(LT.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return SR.error("getUserMedia unexpected error",e),new NT(LT.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function hN(e,t){const n=e.getVideoTracks()[0],r=e.getAudioTracks()[0],i=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(r&&e.removeTrack(r),e.addTrack(o)),i&&(n&&e.removeTrack(n),e.addTrack(i))}const fN=new class extends YT{get state(){return this._state}set state(e){e!==this._state&&(this.emit(jL.STATE_CHANGE,e),this._state=e)}constructor(){super(),qL(this,"_state",UL.IDLE),qL(this,"isAccessMicrophonePermission",!1),qL(this,"isAccessCameraPermission",!1),qL(this,"lastAccessMicrophonePermission",!1),qL(this,"lastAccessCameraPermission",!1),qL(this,"checkdeviceMatched",!1),qL(this,"deviceInfoMap",new Map),this.init().then((()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval((()=>{(aR("ENUMERATE_DEVICES_INTERVAL")||(OT()||rT()===XS.HARMONY_OS)&&RT())&&this.updateDevicesInfo()}),aR("ENUMERATE_DEVICES_INTERVAL_TIME"))})).catch((e=>SR.error(e.toString())))}async enumerateDevices(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new NT(LT.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const r=await navigator.mediaDevices.enumerateDevices(),i=this.checkMediaDeviceInfoIsOk(r);let o=!this.isAccessMicrophonePermission&&e,a=!this.isAccessCameraPermission&&t;i.audio&&(o=!1),i.video&&(a=!1);let s=null,c=null,l=null;if(!n&&(o||a)){if(sN.isLocked&&(SR.debug("[device manager] wait GUM lock"),(await sN.lock())(),SR.debug("[device manager] GUM unlock")),cN&&(o=!1,this.isAccessMicrophonePermission=!0),lN&&(a=!1,this.isAccessCameraPermission=!0),SR.debug("[device manager] check media device permissions",e,t,o,a),o&&a){try{l=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(e){const t=pN(e.name||e.code||e,e.message);if(t.code===LT.PERMISSION_DENIED)throw t;SR.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(o){try{s=await navigator.mediaDevices.getUserMedia({audio:e})}catch(e){const t=pN(e.name||e.code||e,e.message);if(t.code===LT.PERMISSION_DENIED)throw t;SR.warning("getUserMedia failed in getDevices",t)}this.isAccessMicrophonePermission=!0}else if(a){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(e){const t=pN(e.name||e.code||e,e.message);if(t.code===LT.PERMISSION_DENIED)throw t;SR.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0}SR.debug("[device manager] mic permission",e,"cam permission",t)}try{const e=await navigator.mediaDevices.enumerateDevices();return s&&s.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),l&&l.getTracks().forEach((e=>e.stop())),s=null,c=null,l=null,e}catch(e){return s&&s.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),l&&l.getTracks().forEach((e=>e.stop())),s=null,c=null,l=null,new NT(LT.ENUMERATE_DEVICES_FAILED,e.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audioinput"===e.kind))}async getCamerasDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter((e=>"videoinput"===e.kind))}async getSpeakers(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audiooutput"===e.kind))}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach((n=>{n.device.label===e&&(t=n.device.deviceId)})),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find((t=>t.deviceId===e));if(!t)throw new NT(LT.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=UL.INITING;try{await this.updateDevicesInfo(),this.state=UL.INITEND}catch(e){throw SR.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=UL.IDLE,("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)||new NT(LT.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),n=[];if(e[0]&&e[0].label&&!1===this.checkdeviceMatched){this.checkdeviceMatched=!0;const t=e.find((e=>"audioinput"===e.kind&&"default"===e.deviceId)),n=e.find((e=>"audiooutput"===e.kind&&"default"===e.deviceId));t&&n?n.groupId===t.groupId?SR.debug("[device-check] default input ".concat(t.label," and output ").concat(n.label," is the same group")):SR.warning("[device-check] default input ".concat(t.label," and output ").concat(n.label," is not the same group")):SR.debug("[device-check] default input or output not found")}const r=this.checkMediaDeviceInfoIsOk(e);if(e.forEach((e=>{if(!e.deviceId)return;const r=this.deviceInfoMap.get("".concat(e.kind,"_").concat(e.deviceId));if("ACTIVE"!==(r?r.state:"INACTIVE")){const r={initAt:t,updateAt:t,device:e,state:"ACTIVE"};this.deviceInfoMap.set("".concat(e.kind,"_").concat(e.deviceId),r),n.push(r)}r&&(r.updateAt=t)})),this.deviceInfoMap.forEach(((e,r)=>{"ACTIVE"===e.state&&e.updateAt!==t&&(e.state="INACTIVE",n.push(e))})),this.state!==UL.INITEND)return r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));n.forEach((e=>{switch(e.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(jL.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(jL.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(jL.PLAYOUT_DEVICE_CHANGED,e)}})),r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter((e=>"audioinput"===e.kind)),n=e.filter((e=>"videoinput"===e.kind)),r={audio:!1,video:!1};for(const e of t)if(e.label&&e.deviceId){r.audio=!0;break}for(const e of n)if(e.label&&e.deviceId){r.video=!0;break}return r}};let mN=!1;const gN=new class extends YT{constructor(){super(...arguments),qL(this,"onAutoplayFailed",void 0),qL(this,"onAudioAutoplayFailed",void 0)}};function vN(){if(tT(),!mN){const e=t=>{t.preventDefault(),mN=!1,IT()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};mN=!0,IT()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),SR.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),gN.onAutoplayFailed?gN.onAutoplayFailed():gN.onAudioAutoplayFailed?SR.warning("AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."):SR.warning("We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),gN.emit("autoplay-failed")}}function _N(e,t,n,r){if(!e)return;const i=LR.getBaseInfoBySessionId(e);if(!i)return;const o=i.info,a=Date.now(),s=zL(zL({},o),{},{vid:void 0===o.vid?0:Number(o.vid),lts:a,elapse:a-i.startTime,cbRegistered:gN.onAutoplayFailed||gN.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:t,trackId:r,extend:void 0});LR.send({type:IR.AUTOPLAY_FAILED,data:s},!0)}const yN=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],wN=new class{constructor(){qL(this,"onAutoplayFailed",void 0),qL(this,"elementMap",new Map),qL(this,"elementStateMap",new Map),qL(this,"elementsNeedToResume",[]),qL(this,"sinkIdMap",new Map),qL(this,"autoResumeAfterInterruption",(e=>{Array.from(this.elementMap.entries()).forEach((t=>{let[n,r]=t;const i=this.elementStateMap.get(n),o=r.srcObject.getAudioTracks()[0],a=o&&o.readyState;if(SR.debug("resume after interrupted, ele: ".concat(i," audio: ").concat(a," ").concat(e)),"live"===a){if(e)return r.pause(),void r.play();if("running"===ZL.curState)return yT()?(r.pause(),void r.play()):void(i&&"paused"===i&&r.play())}}))})),qL(this,"autoResumeAfterInterruptionOnIOS15_16",(()=>{Array.from(this.elementMap.entries()).forEach((e=>{let[t,n]=e;const r=n.srcObject.getAudioTracks()[0];r&&"live"===r.readyState&&(SR.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())}))})),this.autoResumeAudioElement(),ZL.on(oL.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ZL.on(oL.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),ZL.on(oL.STATE_CHANGE,(()=>{dT()&&"suspended"===ZL.prevState&&"running"===ZL.curState&&this.autoResumeAfterInterruption()}))}async setSinkID(e,t){const n=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),n)try{await n.setSinkId(t)}catch(e){throw new NT(LT.PERMISSION_DENIED,"can not set sink id: "+e.toString())}}play(e,t,n,r){if(this.elementMap.has(t))return;const i=document.createElement("audio");i.autoplay=!0,i.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,i),this.elementMap.set(t,i),this.elementStateMap.set(t,VL.INIT),this.setVolume(t,n);const o=this.sinkIdMap.get(t);if(o)try{i.setSinkId(o).catch((e=>{SR.warning("[".concat(t,"] set sink id failed"),e.toString())}))}catch(e){SR.warning("[".concat(t,"] set sink id failed"),e.toString())}const a=i.play();a&&a.then&&a.catch((e=>{r&&_N(r,"audio",e.message,t),SR.warning("audio element play warning",e.toString()),this.elementMap.has(t)&&"NotAllowedError"===e.name&&(SR.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(i),gC((()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),vN()})))}))}updateTrack(e,t){const n=this.elementMap.get(e);n&&(n.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&"playing"===this.elementStateMap.get(e)}setVolume(e,t){const n=this.elementMap.get(e);n&&(t=Math.max(0,Math.min(100,t)),n.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const n=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(n,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){yN.forEach((n=>{t.addEventListener(n,(n=>{const r=this.elementStateMap.get(e),i="pause"===n.type?"paused":n.type;if(SR.debug("[".concat(e,"] audio-element-status change ").concat(r," => ").concat(i)),"error"===n.type){const n=null==t?void 0:t.error;n&&SR.error("[".concat(e,"] media error, code: ").concat(n.code,", message: ").concat(n.message))}this.elementStateMap.set(e,i)}))}))}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach((e=>{e.play().then((e=>{SR.debug("Auto resume audio element success")})).catch((e=>{SR.warning("Auto resume audio element failed!",e)}))})),this.elementsNeedToResume=[]};new Ih((e=>{document.body?e():window.addEventListener("load",(()=>e()))})).then((()=>{IT()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))}))}};function bN(){return function(e,t,n){const r=n.value;return"function"==typeof r&&(n.value=function(){this._isClosed&&new NT(LT.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",SR);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=r.apply(this,t);return i instanceof Ih?new Ih(((e,t)=>{i.then(e).catch(t)})):i}),n}}class EN extends YT{constructor(e){super(),qL(this,"name","VideoProcessorDestination"),qL(this,"ID","0"),qL(this,"_source",void 0),qL(this,"videoContext",void 0),qL(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new NT(LT.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new NT(LT.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");e.track&&e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=e.track,this.emit(DL.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(DL.ON_TRACK,void 0)}}class SN extends YT{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t){super(),qL(this,"constraintsMap",new Map),qL(this,"statsRegistry",[]),qL(this,"usageRegistry",[]),qL(this,"trackId",void 0),qL(this,"direction",void 0),qL(this,"_chained",!1),this.trackId=e,this.direction=t}async getConstraints(){return await lC(this,ML.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,t){var n;return SR.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),dC(this,ML.REQUEST_UPDATE_CONSTRAINTS,Array.from(yA(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return SR.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),dC(this,ML.REQUEST_UPDATE_CONSTRAINTS,Array.from(yA(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t));-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:i}of this.statsRegistry)try{const o=i();e.push({processorID:t,processorName:n,type:r,stats:o})}catch(e){SR.error(new NT(LT.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find((t=>t.processorID===e.ID&&t.processorName===e.name))||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex((t=>t.processorID===e.ID&&t.processorName===e.name));-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let n=t();n instanceof Ih&&(n=await n),e.push(zL(zL({},n),{},{direction:this.direction}))}catch(e){SR.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class TN extends YT{constructor(e){super(),qL(this,"name","AudioProcessorDestination"),qL(this,"ID","0"),qL(this,"inputTrack",void 0),qL(this,"inputNode",void 0),qL(this,"audioProcessorContext",void 0),qL(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new NT(LT.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new NT(LT.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(DL.ON_TRACK,void 0),this.emit(DL.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");e.track&&this.inputTrack!==e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=e.track,this.emit(DL.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=e.node,this.emit(DL.ON_NODE,this.inputNode))}}class CN extends YT{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t,n){super(),qL(this,"constraintsMap",new Map),qL(this,"statsRegistry",[]),qL(this,"audioContext",void 0),qL(this,"trackId",void 0),qL(this,"direction",void 0),qL(this,"usageRegistry",[]),qL(this,"_chained",!1),this.audioContext=e,this.trackId=t,this.direction=n}async getConstraints(){return lC(this,ML.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,t){var n;return SR.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),dC(this,ML.REQUEST_UPDATE_CONSTRAINTS,Array.from(yA(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),dC(this,ML.REQUEST_UPDATE_CONSTRAINTS,Array.from(yA(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t));-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:i}of this.statsRegistry)try{const o=i();e.push({processorID:t,processorName:n,type:r,stats:o})}catch(e){SR.error(new NT(LT.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find((t=>t.processorID===e.ID&&t.processorName===e.name))||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex((t=>t.processorID===e.ID&&t.processorName===e.name));-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let n=t();n instanceof Ih&&(n=await n),e.push(zL(zL({},n),{},{direction:this.direction}))}catch(e){SR.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class RN extends YT{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),qL(this,"context",void 0),qL(this,"processSourceNode",void 0),qL(this,"outputTrack",void 0),qL(this,"processedNode",void 0),qL(this,"clonedTrack",void 0),qL(this,"outputNode",void 0),this.outputNode=new ON}setVolume(){}createOutputTrack(){throw new NT(LT.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class ON{disconnect(){}connect(){}}function IN(e){return new Ih(((t,n)=>{let r=!1;const i=document.createElement("video");i.setAttribute("autoplay",""),i.setAttribute("muted",""),i.muted=!0,i.autoplay=!0,i.setAttribute("playsinline",""),i.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(i);const o=dT()?"canplay":"playing";i.addEventListener(o,(()=>{const e=i.videoWidth,n=i.videoHeight;!e&&lT()||(r=!0,i.srcObject=null,i.remove(),t([e,n]))})),i.srcObject=new MediaStream([e]),i.play().catch(xC),setTimeout((()=>{r||(i.srcObject=null,i.remove(),t([i.videoWidth,i.videoHeight]))}),4e3)}))}function AN(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const n=hL(e.encoderConfig);return null!=n.width&&(t.width=n.width),null!=n.height&&(t.height=n.height),!TT()&&n.frameRate&&(t.frameRate=n.frameRate),cT()&&"object"==typeof t.frameRate&&(t.frameRate.max=60),lT()&&(t.frameRate={ideal:30,max:30}),t}function kN(e){const t={};if(TT()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,aT()&&e.ANS&&(t.googHighpassFilter=e.ANS))),e.encoderConfig){const n=vL(e.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),OT()&&(t.sampleRate=void 0),t}const xN=async(e,t,n)=>await(async(e,t,n)=>{const r=function(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(parseInt(e.slice(n,n+2),16));return Uint8Array.from(t)}(jC(""+t+n)).slice(0,16),i=r.slice(0,12),o=await window.crypto.subtle.importKey("raw",r,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},o,e))})(e.buffer,t,n),LN=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new Ih(((n,r)=>{t.toBlob((async e=>{if(t.remove(),e){const r=await NN(e);n({buffer:r,width:t.width,height:t.height})}else r(new NT(LT.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,1)}))},NN=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)};var PN,DN,MN,UN,jN,VN,BN,FN,GN,HN,qN,WN,zN,KN,YN,JN,XN,ZN,QN,$N,eP,tP,nP,rP,iP,oP,aP,sP,cP,lP,dP,uP,pP,hP,fP,mP,gP,vP,_P,yP;let wP=(PN=xR({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),DN=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),MN=bN(),UN=GC("LocalAudioTrack","_enabledMutex"),jN=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),VN=bN(),BN=GC("LocalAudioTrack","_enabledMutex"),FN=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),GN=bN(),HN=bN(),qN=bN(),WN=xR({argsMap:e=>[e.getTrackId()]}),zN=bN(),KN=xR({argsMap:e=>[e.getTrackId()]}),YN=bN(),JN=xR({argsMap:e=>[e.getTrackId()]}),XN=xR({argsMap:(e,t)=>[e.getTrackId(),t.name]}),ZN=xR({argsMap:e=>[e.getTrackId()]}),HL((QN=class extends YL{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?wN.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,n,r){super(e,n),qL(this,"trackMediaType",IL.AUDIO),qL(this,"_encoderConfig",void 0),qL(this,"_trackSource",void 0),qL(this,"_enabled",!0),qL(this,"_volume",100),qL(this,"_useAudioElement",!0),qL(this,"_bypassWebAudio",!1),qL(this,"processor",void 0),qL(this,"_processorContext",void 0),qL(this,"_processorDestination",void 0),qL(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!r,this._trackSource=new RN,aR("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),aR("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),sT()&&!XL?setTimeout((()=>this.initWebAudio())):this.initWebAudio()}setVolume(e){MT(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&wN.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void SR.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,dC(this,wL.NEED_REPLACE_TRACK,this).then((()=>{SR.debug("[".concat(this.getTrackId(),"] replace web audio track success"))})).catch((e=>{SR.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e)})))}catch(e){}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!rL())throw new NT(LT.NOT_SUPPORTED,"your browser does not support setting the audio output device");await wN.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,n){return this._setEnabled(e,t,n)}async _setEnabled(e,t,n){if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(SR.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{n||(this._enabled=!0),await dC(this,wL.NEED_ENABLE_TRACK,this),SR.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(e){throw n||(this._enabled=!1),SR.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}}else{this._originMediaStreamTrack.enabled=!1,n||(this._enabled=!1);try{await dC(this,wL.NEED_DISABLE_TRACK,this)}catch(e){throw n||(this._enabled=!0),SR.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,SR.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await dC(this,wL.NEED_MUTE_TRACK,this):await dC(this,wL.NEED_UNMUTE_TRACK,this))}getStats(){return wC((()=>{SR.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")}),"localAudioTrackGetStatsWarning"),uC(this,wL.GET_STATS)||zL({},kL)}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(AL.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(AL.ON_AUDIO_BUFFER),this._source.on(AL.ON_AUDIO_BUFFER,(t=>e(t)))}play(){SR.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(SR.debug("[".concat(this.getTrackId(),"] start audio playback in element")),wN.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){SR.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?wN.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];SR.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&wN.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await dC(this,wL.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return Ih.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new NT(LT.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new NT(LT.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){e.on(DL.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e),await dC(this,wL.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await dC(this,wL.NEED_REPLACE_TRACK,this))})),e.on(DL.ON_NODE,(e=>{this._source.processedNode=e}))}unbindProcessorDestinationEvents(e){e.removeAllListeners(DL.ON_TRACK),e.removeAllListeners(DL.ON_NODE)}bindProcessorContextEvents(e){e.on(ML.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}unbindProcessorContextEvents(e){e.removeAllListeners(ML.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof RN&&(this._trackSource=new iN(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new CN(this._source.context,this.getTrackId(),"local"),t=new TN(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(AL.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})})),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(wN.stop(this.getTrackId()),this._source.play()),dC(this,wL.NEED_REPLACE_MIXING_TRACK,this).then((()=>{SR.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))})).catch((e=>{SR.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),e)}))),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[PN],Object.getOwnPropertyDescriptor(QN.prototype,"setVolume"),QN.prototype),HL(QN.prototype,"setPlaybackDevice",[DN,MN],Object.getOwnPropertyDescriptor(QN.prototype,"setPlaybackDevice"),QN.prototype),HL(QN.prototype,"setEnabled",[UN,jN,VN],Object.getOwnPropertyDescriptor(QN.prototype,"setEnabled"),QN.prototype),HL(QN.prototype,"setMuted",[BN,FN,GN],Object.getOwnPropertyDescriptor(QN.prototype,"setMuted"),QN.prototype),HL(QN.prototype,"getStats",[HN],Object.getOwnPropertyDescriptor(QN.prototype,"getStats"),QN.prototype),HL(QN.prototype,"setAudioFrameCallback",[qN],Object.getOwnPropertyDescriptor(QN.prototype,"setAudioFrameCallback"),QN.prototype),HL(QN.prototype,"play",[WN,zN],Object.getOwnPropertyDescriptor(QN.prototype,"play"),QN.prototype),HL(QN.prototype,"stop",[KN,YN],Object.getOwnPropertyDescriptor(QN.prototype,"stop"),QN.prototype),HL(QN.prototype,"close",[JN],Object.getOwnPropertyDescriptor(QN.prototype,"close"),QN.prototype),HL(QN.prototype,"pipe",[XN],Object.getOwnPropertyDescriptor(QN.prototype,"pipe"),QN.prototype),HL(QN.prototype,"unpipe",[ZN],Object.getOwnPropertyDescriptor(QN.prototype,"unpipe"),QN.prototype),QN),bP=($N=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),eP=bN(),tP=GC("MicrophoneAudioTrack","_enabledMutex"),nP=xR({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),rP=bN(),iP=xR({argsMap:e=>[e.getTrackId()]}),HL((oP=class extends wP{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,n,r){super(e,t.encoderConfig?vL(t.encoderConfig):{},r,aR("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),qL(this,"_config",void 0),qL(this,"_deviceName","default"),qL(this,"_constraints",void 0),qL(this,"_originalConstraints",void 0),qL(this,"_enabled",!0),this._config=t,this._constraints=n,this._originalConstraints=n,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),(yT()||wT())&&ZL.bindInterruptDetectorTrack(this)}async setDevice(e){if(SR.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const t=await fN.getDeviceById(e),n={};n.audio=zL({},this._constraints),n.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let r=null;try{r=await dN(n,this.getTrackId())}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),r=await dN({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await fN.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}SR.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,n){if(t)return SR.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(SR.info("[".concat(this.getTrackId(),"] start setEnabled"),e),aR("AUTO_RESET_AUDIO_ROUTE")&&(dT()||ET())){const t=navigator.audioSession;t&&(e||(t.type="playback"),t.type="auto")}if(!e){var r;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),null===(r=this._source.clonedTrack)||void 0===r||r.stop(),n||(this._enabled=!1);try{await dC(this,wL.NEED_DISABLE_TRACK,this)}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.toString()),e}return}const i=zL({},this._constraints),o=fN.searchDeviceIdByName(this._deviceName);o&&!i.deviceId&&(i.deviceId=o);try{n||(this._enabled=!0);const e=await dN({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await dC(this,wL.NEED_ENABLE_TRACK,this)}catch(e){throw n||(this._enabled=!1),SR.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.toString()),e}SR.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(yT()||wT())&&ZL.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((dT()||ET())&&this._enabled&&!this._isClosed&&ZL.duringInterruption){const e=async()=>{ZL.off(oL.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(SR.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ZL.on(oL.IOS_INTERRUPTION_END,e)}else SR.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(RL.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=fN.searchDeviceIdByName(this._deviceName);if(n&&!t.deviceId&&(t.deviceId=n),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();const e=await dN({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(ML.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}}))}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(ML.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[$N,eP],Object.getOwnPropertyDescriptor(oP.prototype,"setDevice"),oP.prototype),HL(oP.prototype,"setEnabled",[tP,nP,rP],Object.getOwnPropertyDescriptor(oP.prototype,"setEnabled"),oP.prototype),HL(oP.prototype,"close",[iP],Object.getOwnPropertyDescriptor(oP.prototype,"close"),oP.prototype),oP),EP=(aP=xR({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),sP=bN(),cP=xR({argsMap:e=>[e.getTrackId()]}),lP=bN(),dP=xR({argsMap:e=>[e.getTrackId()]}),uP=bN(),pP=xR({argsMap:e=>[e.getTrackId()]}),hP=bN(),fP=xR({argsMap:e=>[e.getTrackId()]}),mP=bN(),gP=xR({argsMap:e=>[e.getTrackId()]}),vP=xR({argsMap:e=>[e.getTrackId()]}),_P=bN(),HL((yP=class extends wP{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,n,r){super(t.createOutputTrack(),n,r),qL(this,"source",void 0),qL(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(AL.AUDIO_SOURCE_STATE_CHANGE,(e=>{this.safeEmit(RL.SOURCE_STATE_CHANGE,e)}));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){MT(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[aP,sP],Object.getOwnPropertyDescriptor(yP.prototype,"startProcessAudioBuffer"),yP.prototype),HL(yP.prototype,"pauseProcessAudioBuffer",[cP,lP],Object.getOwnPropertyDescriptor(yP.prototype,"pauseProcessAudioBuffer"),yP.prototype),HL(yP.prototype,"seekAudioBuffer",[dP,uP],Object.getOwnPropertyDescriptor(yP.prototype,"seekAudioBuffer"),yP.prototype),HL(yP.prototype,"resumeProcessAudioBuffer",[pP,hP],Object.getOwnPropertyDescriptor(yP.prototype,"resumeProcessAudioBuffer"),yP.prototype),HL(yP.prototype,"stopProcessAudioBuffer",[fP,mP],Object.getOwnPropertyDescriptor(yP.prototype,"stopProcessAudioBuffer"),yP.prototype),HL(yP.prototype,"close",[gP],Object.getOwnPropertyDescriptor(yP.prototype,"close"),yP.prototype),HL(yP.prototype,"setAudioBufferPlaybackSpeed",[vP,_P],Object.getOwnPropertyDescriptor(yP.prototype,"setAudioBufferPlaybackSpeed"),yP.prototype),yP);class SP extends wP{get __className__(){return"MixingAudioTrack"}get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=QL().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,AC(8,"track-mix-")),qL(this,"trackList",void 0),qL(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return-1!==this.trackList.indexOf(e)}addAudioTrack(e){-1===this.trackList.indexOf(e)?(SR.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):SR.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){if(-1!==this.trackList.indexOf(e)){SR.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(e){}fC(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach((t=>{t._encoderConfig&&((t._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=t._encoderConfig.bitrate),(t._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=t._encoderConfig.sampleRate),(t._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=t._encoderConfig.sampleSize),t._encoderConfig.stereo&&(e.stereo=!0))})),this._encoderConfig=e}_updateRtpTransceiver(e){this._rtpTransceiver!==e&&(this._rtpTransceiver=e,this.trackList.forEach((t=>{t instanceof SP?t.emit(CL.TRANSCEIVER_UPDATED,e):t._updateRtpTransceiver(e)})))}}class TP extends rN{set currentState(e){e!==this._currentState&&(this._currentState=e,this.safeEmit(AL.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),qL(this,"audioBuffer",void 0),qL(this,"sourceNode",void 0),qL(this,"startPlayTime",0),qL(this,"startPlayOffset",0),qL(this,"pausePlayTime",0),qL(this,"options",void 0),qL(this,"currentLoopCount",0),qL(this,"currentPlaybackSpeed",100),qL(this,"_currentState","stopped"),this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):SR.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(e){this.sourceNode&&("playing"===this.currentState&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=e/100),this.currentPlaybackSpeed=e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e.playbackRate.value=this.currentPlaybackSpeed/100,e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const CP=new Map;class RP{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){const e=this.renderStats.curTs-this.renderStats.lastTs,t=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/e;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,t}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(SR.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}get videoState(){return this._videoState}set videoState(e){var t;e!==this._videoState&&(this._videoState=e,null===(t=this.onVideoStateChanged)||void 0===t||t.call(this,this.videoState))}constructor(e){qL(this,"trackId",void 0),qL(this,"config",void 0),qL(this,"onFirstVideoFrameDecoded",void 0),qL(this,"onVideoStateChanged",void 0),qL(this,"freezeTimeCounterList",[]),qL(this,"renderFreezeAccTime",0),qL(this,"isKeepLastFrame",!1),qL(this,"timeUpdatedCount",0),qL(this,"freezeTime",0),qL(this,"playbackTime",0),qL(this,"lastTimeUpdatedTime",0),qL(this,"autoplayFailed",!1),qL(this,"videoTrack",void 0),qL(this,"videoElement",void 0),qL(this,"cacheVideoElement",void 0),qL(this,"renderStats",void 0),qL(this,"_videoState",BL.VideoStateStopped),qL(this,"videoElementCheckInterval",void 0),qL(this,"videoElementFreezeTimeout",void 0),qL(this,"_videoElementStatus",VL.NONE),qL(this,"isGettingVideoDimensions",!1),qL(this,"startGetVideoDimensions",(()=>{const e=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return SR.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(e,500)};!this.isGettingVideoDimensions&&e()})),qL(this,"autoResumeAfterInterruption",(()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===ZL.curState&&(SR.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(iT())),bT()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))})),qL(this,"handleVideoEvents",(e=>{switch(e.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=VL.PLAYING;break;case"loadeddata":if(this.videoState=BL.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch(e){}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=VL.CANPLAY;break;case"stalled":this.videoElementStatus=VL.STALLED;break;case"suspend":this.videoElementStatus=VL.SUSPEND;break;case"pause":this.videoElementStatus=VL.PAUSED,dT()||ET()||sT()&&this.autoplayFailed||!this.videoTrack||"live"!==this.videoTrack.readyState||(SR.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=VL.WAITING;break;case"abort":this.videoElementStatus=VL.ABORT;break;case"ended":this.videoElementStatus=VL.ENDED;break;case"emptied":this.videoElementStatus=VL.EMPTIED;break;case"error":{const e=this.videoElement.error;e?(this.videoElementStatus=VL.ERROR,SR.error("[".concat(this.trackId,"] media error: ").concat(e.message," (").concat(e.code,")"))):SR.debug("[".concat(this.trackId,"] media not been an error."));break}case"timeupdate":{const e=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=e);const t=e-this.lastTimeUpdatedTime,n=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=e,OD.lastVisibleTime<OD.lastHiddenTime||n<OD.lastHiddenTime||n<OD.lastVisibleTime)return;for(t>aR("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=t),this.playbackTime+=t;this.playbackTime>=6e3;){this.playbackTime-=6e3;const e=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(e),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}})),qL(this,"autoResumeAfterInterruptionOnIOS15_16",(()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&(SR.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(iT())),bT()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))})),this.trackId=e.trackId,this.config=e,e.element instanceof HTMLVideoElement?this.videoElement=e.element:this.videoElement=document.createElement("video"),ZL.on(oL.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ZL.on(oL.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var e;return null!==(e=this.videoElement.parentElement)&&void 0!==e?e:void 0}updateConfig(e){this.config=e,this.trackId=e.trackId,e.element!==this.videoElement&&(this.destroy(),this.videoElement=e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.initVideoElement())}play(e){const t=this.videoElement.play();t&&t.catch&&t.catch((t=>{e&&_N(e,"video",t.message,this.trackId),"NotAllowedError"===t.name?(SR.warning("detected video element autoplay failed",t),this.autoplayFailed=!0,this.handleAutoPlayFailed()):SR.warning("[".concat(this.trackId,"] play warning: "),t)}));const n=tT();if(("Safari"===n.name&&15===Number(n.version)||yT())&&t&&t.then){const e=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};t.then(e).catch(e)}}getCurrentFrame(){const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");if(!t)return SR.error("create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);const n=t.getImageData(0,0,e.width,e.height);return e.remove(),n}async getCurrentFrameToUint8Array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.createElement("canvas");n.width=this.videoElement.videoWidth,n.height=this.videoElement.videoHeight;const r=n.getContext("2d");return r?(r.drawImage(this.videoElement,0,0,n.width,n.height),new Ih(((r,i)=>{n.toBlob((async e=>{if(n.remove(),e){const t=await NN(e);r({buffer:t,width:n.width,height:n.height})}else i(new NT(LT.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,t<0?.1:t>1?1:t)}))):await LN(e)}destroy(){this.renderStats=void 0,ZL.off(oL.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ZL.off(oL.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=BL.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=VL.INIT,!this.videoElementCheckInterval&&(OP.forEach((e=>{this.videoElement.addEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval=window.setInterval((()=>{(function(e){return e!==document.body&&document.body.contains(e)})(this.videoElement)||(this.videoElementStatus=VL.DESTROYED)}),1e3),aR("ENABLE_VIDEO_FRAME_CALLBACK"))){var e,t;let n;const r=()=>{"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",r),this.videoElementFreezeTimeout=window.setTimeout(i,aR("VIDEO_FREEZE_DURATION")))},i=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===BL.VideoStateDecoding&&("visible"===document.visibilityState?this.videoState=BL.VideoStateFrozen:document.addEventListener("visibilitychange",r))},o=(e,t)=>{if(this.videoElementStatus===VL.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=t.mediaTime):this.renderStats={lastTs:t.mediaTime,curTs:t.mediaTime,lastRenderNum:0,renderNum:0},n){const e=t.presentationTime-n.presentationTime;this.videoState===BL.VideoStateStarting&&(this.videoState=BL.VideoStateDecoding),this.videoState===BL.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(i,aR("VIDEO_FREEZE_DURATION"))),e<aR("VIDEO_FREEZE_DURATION")&&this.videoState===BL.VideoStateFrozen&&(this.videoState=BL.VideoStateDecoding),e>aR("VIDEO_FREEZE_DURATION")&&OD.lastVisibleTime>=OD.lastHiddenTime&&n.timestamp>OD.lastVisibleTime&&n.timestamp>OD.lastHiddenTime&&(this.renderFreezeAccTime+=e)}n=zL(zL({},t),{},{timestamp:e})}var r,a;aR("ENABLE_VIDEO_FRAME_CALLBACK")&&(null===(r=(a=this.videoElement).requestVideoFrameCallback)||void 0===r||r.call(a,o))};null===(e=(t=this.videoElement).requestVideoFrameCallback)||void 0===e||e.call(t,o)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),OT()&&!aR("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const n=tT();"Safari"===n.name&&15===Number(n.version)||yT()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,lT()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,lT()&&this.videoElement.load());const r=this.videoElement.play();void 0!==r&&r.catch((e=>{SR.debug("[".concat(this.trackId,"] playback interrupted"),e.toString())}))}resetVideoElement(){OP.forEach((e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=VL.NONE}handleAutoPlayFailed(){const e=t=>{t.preventDefault(),this.videoElement.play().then((()=>{SR.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))})).catch((e=>{SR.error(e)})),this.autoplayFailed=!1,IT()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};IT()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),vN()}}const OP=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class IP extends RP{constructor(e){super(e),qL(this,"container",void 0),qL(this,"slot",void 0),this.slot=e.element,this.updateConfig(e)}updateConfig(e){this.config=e,this.trackId=e.trackId;const t=e.element;t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){var t;null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)&&super.play(e)}getCurrentFrame(){var e;return null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(e,n):await LN(e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch(e){}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",aR("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var e;!this.container||null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var e;if(null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch(e){}this.videoElement=document.createElement("video")}}resetVideoElement(){var e;null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var AP,kP,xP,LP,NP,PP,DP,MP,UP,jP,VP,BP,FP,GP,HP,qP,WP,zP,KP,YP,JP,XP,ZP,QP,$P,eD,tD,nD,rD,iD,oD,aD,sD,cD;let lD=(AP=xR({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),kP=bN(),xP=xR({argsMap:e=>[e.getTrackId()]}),LP=GC("LocalVideoTrack","_enabledMutex"),NP=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),PP=bN(),DP=GC("LocalVideoTrack","_enabledMutex"),MP=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),UP=bN(),jP=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),VP=bN(),BP=bN(),FP=xR({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),GP=bN(),HP=bN(),qP=bN(),WP=bN(),zP=bN(),KP=bN(),YP=bN(),JP=xR({argsMap:(e,t)=>[e.getTrackId(),t.name]}),XP=xR({argsMap:e=>[e.getTrackId()]}),ZP=xR({argsMap:e=>[e.getTrackId()]}),QP=xR({argsMap:(e,t,n)=>[e.getTrackId(),t.label,n]}),$P=class e extends YL{get videoHeight(){if(sT()){const{height:e}=this._mediaStreamTrack.getSettings();return this._videoHeight=e,this._videoHeight}return this._videoHeight}get videoWidth(){if(sT()){const{width:e}=this._mediaStreamTrack.getSettings();return this._videoWidth=e,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==VL.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}get __className__(){return"LocalVideoTrack"}constructor(e,t,n,r,i,o){if(super(e,i),qL(this,"trackMediaType",IL.VIDEO),qL(this,"_player",void 0),qL(this,"isUseScaleResolutionDownBy",!1),qL(this,"_videoVisibleTimer",null),qL(this,"_previousVideoVisibleStatus",void 0),qL(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),qL(this,"_encoderConfig",void 0),qL(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),qL(this,"_optimizationMode",void 0),qL(this,"_videoHeight",void 0),qL(this,"_videoWidth",void 0),qL(this,"_forceBitrateLimit",void 0),qL(this,"_enabled",!0),qL(this,"_processorDestination",void 0),qL(this,"_processorContext",void 0),sT()){const{width:t,height:n}=e.getSettings();this._videoWidth=t,this._videoHeight=n}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=t,this._scalabilityMode=n,this._optimizationMode=r,this._hints=o||[],-1===this._hints.indexOf(bL.SCREEN_TRACK))this.updateBitrateFromProfile();else if(function(e,t,n){const r=tT();return!(r.name!==e||!r.osVersion)&&115===Number(r.version)}(ZS.CHROME)&&-1!==rT().indexOf("Windows")){const t=function(e,t){if("VideoFrame"in window&&"TransformStream"in window&&nL().supportWebRTCInsertableStream){const t=new MediaStreamTrackProcessor(e),n=new MediaStreamTrackGenerator({kind:"video"});let r,i,o=Date.now();const a=()=>{s&&(clearInterval(s),s=void 0),r&&(r.close(),r=void 0),e.stop(),i=void 0,n.removeEventListener("ended",a)};let s=window.setInterval((()=>{if(i&&r&&Date.now()-o>1e3)try{"live"===n.readyState?i.enqueue(r.clone()):a()}catch(e){a()}}),1e3);const c=new TransformStream({transform:(e,t)=>{"live"===n.readyState?(i=t,o=Date.now(),void 0===r?(r=e,t.enqueue(e.clone())):(t.enqueue(r),r=e)):e.close()}});return n.addEventListener("ended",a),t.readable.pipeThrough(c).pipeTo(n.writable),n}}(e);t&&(SR.info("local screen video track begin to inject frame"),this._mediaStreamTrack=t)}t&&-1!==this._hints.indexOf(bL.CUSTOM_TRACK)&&this.setEncoderConfiguration(t),this._processorContext=new SN(this.getTrackId(),"local"),this._processorDestination=new EN(this.processorContext),this.bindProcessorDestinationEvents()}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(SR.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}SR.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=zL(zL(zL({},this._getDefaultPlayerConfig()),t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(e instanceof HTMLVideoElement?this._player=new RP(n):this._player=new IP(n),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(RL.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),aR("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,SR.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(SR.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.enabled=!1;try{await dC(this,wL.NEED_DISABLE_TRACK,this)}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}return t||(this._enabled=!1),void SR.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await dC(this,wL.NEED_ENABLE_TRACK,this)}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}SR.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,SR.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await dC(this,wL.NEED_MUTE_TRACK,this):await dC(this,wL.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(e,t){if(!this._enabled)throw new NT(LT.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(e=hL(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),e.width||e.height||e.frameRate){const t=AN({encoderConfig:e});(sT()||dT()||ET())&&(t.deviceId=void 0),SR.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(t));try{await this._originMediaStreamTrack.applyConstraints(t),this.updateMediaStreamTrackResolution()}catch(e){const t=new NT(LT.UNEXPECTED_ERROR,e.toString());throw SR.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}}this._encoderConfig=e,-1===this._hints.indexOf(bL.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await dC(this,wL.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(SR)}}getStats(){return wC((()=>{SR.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")}),"localVideoTrackGetStatsWarning"),uC(this,wL.GET_STATS)||zL({},xL)}async setBeautyEffect(e){SR.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(e,t):await LN(e)}async setBitrateLimit(e){if(SR.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(e))),e){this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate);try{await dC(this,wL.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(SR)}}}async setOptimizationMode(e){if("motion"!==e&&"detail"!==e&&"balanced"!==e)return void SR.error(LT.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const t=this._optimizationMode;try{this._optimizationMode=e,await dC(this,wL.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(e){throw this._optimizationMode=t,SR.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.toString()),e}SR.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(e,")"))}setScalabiltyMode(e){if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return SR.error(LT.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=e,SR.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(e,")"))}updateMediaStreamTrackResolution(){IN(this._originMediaStreamTrack).then((e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t})).catch(xC)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(e){if(!this._enabled)throw new NT(LT.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");SR.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(e)),e=hL(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),this._encoderConfig=e,-1===this._hints.indexOf(bL.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await dC(this,wL.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(SR)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:e,height:t,frameRate:n}=this.getMediaStreamTrackSettings();if(!e||!t||!n)return;const{bitrateMax:r,bitrateMin:i}=this._encoderConfig;if(null==i||null==r){const{max:o,min:a}=function(e,t,n,r,i){const o=aR("BITRATE_ADAPTER_TYPE");if("DEFAULT_BITRATE"===o)return{min:r,max:i};if(void 0===i){var a;const s=Math.floor(200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75));i="STANDARD_BITRATE"===o?4*s:2*s,r=null!==(a=r)&&void 0!==a?a:s}else{var s;r=null!==(s=r)&&void 0!==s?s:Math.floor(i/10)}return{min:r,max:i}}(e,t,n,i,r);this._encoderConfig.bitrateMin=a,this._encoderConfig.bitrateMax=o,SR.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(e,", h: ").concat(t,", fps: ").concat(n,"] => [brMax: ").concat(o,", brMin: ").concat(a,"]"))}}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:i,slot:o}=r;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=qT.checkOneElementVisible(i),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new NT(LT.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}async renewMediaStreamTrack(e){}pipe(e){if(this.processor===e)return e;if(e._source)throw new NT(LT.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._encoderConfig;t&&(r=zL(zL({},r),hL(t))),r=_C(r);const i=AC(8,"track-video-cloned-"),o=new e(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,r,_C(this._scalabilityMode),this._optimizationMode,i,_C(this._hints));return t&&r&&o.setEncoderConfiguration(r),SR.debug("clone video track from ".concat(this.getTrackId()," to ").concat(i,", clone ").concat(n)),o}async replaceTrack(e,t){if(!(e instanceof MediaStreamTrack))throw new NT(LT.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if("video"!==e.kind)throw new NT(LT.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(e,t,!0),this.updateMediaStreamTrackResolution()}sendSeiData(e){if(wC((()=>{LR.reportApiInvoke(null,{name:ZT.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:QT.TRACER}).onSuccess("")}),this._mediaStreamTrack.id||this.getTrackId()),!aR("ENABLE_VIDEO_SEI")||!aR("ENABLE_ENCODED_TRANSFORM"))return void SR.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(e instanceof Uint8Array==0)return new NT(LT.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const t=this.getRTCRtpTransceiver();if(!t)return void SR.warning("Video track is not published, SEI can not be send");const n=t.sender.getParameters();if(0===n.codecs.length)return;const r=n.codecs[0].mimeType.toLocaleLowerCase();"video/h264"===r?this.safeEmit("sei-to-send",e):SR.warning("SEI is not supported by ".concat(r))}bindProcessorDestinationEvents(){this.processorDestination.on(DL.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await dC(this,wL.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await dC(this,wL.NEED_REPLACE_TRACK,this))}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(DL.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(ML.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(ML.REQUEST_CONSTRAINTS)}},HL($P.prototype,"play",[AP,kP],Object.getOwnPropertyDescriptor($P.prototype,"play"),$P.prototype),HL($P.prototype,"stop",[xP],Object.getOwnPropertyDescriptor($P.prototype,"stop"),$P.prototype),HL($P.prototype,"setEnabled",[LP,NP,PP],Object.getOwnPropertyDescriptor($P.prototype,"setEnabled"),$P.prototype),HL($P.prototype,"setMuted",[DP,MP,UP],Object.getOwnPropertyDescriptor($P.prototype,"setMuted"),$P.prototype),HL($P.prototype,"setEncoderConfiguration",[jP,VP],Object.getOwnPropertyDescriptor($P.prototype,"setEncoderConfiguration"),$P.prototype),HL($P.prototype,"getStats",[BP],Object.getOwnPropertyDescriptor($P.prototype,"getStats"),$P.prototype),HL($P.prototype,"setBeautyEffect",[FP,GP],Object.getOwnPropertyDescriptor($P.prototype,"setBeautyEffect"),$P.prototype),HL($P.prototype,"getCurrentFrameData",[HP],Object.getOwnPropertyDescriptor($P.prototype,"getCurrentFrameData"),$P.prototype),HL($P.prototype,"getCurrentFrameImage",[qP],Object.getOwnPropertyDescriptor($P.prototype,"getCurrentFrameImage"),$P.prototype),HL($P.prototype,"setBitrateLimit",[WP],Object.getOwnPropertyDescriptor($P.prototype,"setBitrateLimit"),$P.prototype),HL($P.prototype,"setOptimizationMode",[zP],Object.getOwnPropertyDescriptor($P.prototype,"setOptimizationMode"),$P.prototype),HL($P.prototype,"setScalabiltyMode",[KP],Object.getOwnPropertyDescriptor($P.prototype,"setScalabiltyMode"),$P.prototype),HL($P.prototype,"updateMediaStreamTrackResolution",[YP],Object.getOwnPropertyDescriptor($P.prototype,"updateMediaStreamTrackResolution"),$P.prototype),HL($P.prototype,"pipe",[JP],Object.getOwnPropertyDescriptor($P.prototype,"pipe"),$P.prototype),HL($P.prototype,"unpipe",[XP],Object.getOwnPropertyDescriptor($P.prototype,"unpipe"),$P.prototype),HL($P.prototype,"close",[ZP],Object.getOwnPropertyDescriptor($P.prototype,"close"),$P.prototype),HL($P.prototype,"replaceTrack",[QP],Object.getOwnPropertyDescriptor($P.prototype,"replaceTrack"),$P.prototype),$P),dD=(eD=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),tD=bN(),nD=GC("CameraVideoTrack","_enabledMutex"),rD=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),iD=bN(),oD=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),aD=bN(),sD=xR({argsMap:e=>[e.getTrackId()]}),cD=class e extends lD{get __className__(){return"CameraVideoTrack"}constructor(e,t,n,r,i,o){super(e,hL(t.encoderConfig),r,i,o),qL(this,"_config",void 0),qL(this,"_originalConstraints",void 0),qL(this,"_constraints",void 0),qL(this,"_enabled",!0),qL(this,"_deviceName","default"),qL(this,"tryResumeVideoForIOS15_16WeChat",(async()=>{(yT()||wT())&&!function(){const e=tT();if(e.os!==XS.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=2}()&&ST()&&this._enabled&&!this._isClosed&&(SR.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())})),this._config=t,this._originalConstraints=n,this._constraints=n,this._deviceName=e.label,this._encoderConfig=hL(this._config.encoderConfig),ZL.on(oL.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),ZL.on(oL.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(e){return"string"==typeof e?this._setDeviceById(e):e.deviceId?this._setDeviceById(e.deviceId):e.facingMode?this._setDeviceByFacingModel(e.facingMode):void 0}async _setDeviceById(e){if(SR.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),this._enabled)try{const t=await fN.getDeviceById(e),n={};n.video=zL({},this._constraints),n.video.deviceId={exact:e},n.video.facingMode=void 0,this._originMediaStreamTrack.stop();let r=null;try{r=await dN(n,this.getTrackId())}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),r=await dN({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await fN.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}SR.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(e){SR.info("[".concat(this.getTrackId(),"] set facingMode ").concat(e));const t={video:zL(zL({},this._constraints),{},{deviceId:void 0,facingMode:{exact:e}})};if(this._enabled){this._originMediaStreamTrack.stop();let e=null;try{e=await dN(t,this.getTrackId())}catch(t){throw SR.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),t.toString()),e=await dN({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),t}await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=e,this._config.cameraId=void 0,this._constraints=zL({},t.video),SR.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(SR.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const e=await dN({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1)}await dC(this,wL.NEED_ENABLE_TRACK,this)}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.toString()),e}this.updateMediaStreamTrackResolution(),SR.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),t||(this._enabled=!1);try{await dC(this,wL.NEED_DISABLE_TRACK,this)}catch(e){throw SR.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}SR.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(e,t){if(!this._enabled)throw new NT(LT.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");e=hL(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate||e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate||e.bitrateMin);const n=vC(this._config);n.encoderConfig=e;const r=AN(n);(sT()||dT()||ET())&&(r.deviceId=void 0),SR.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(r));try{await this._originMediaStreamTrack.applyConstraints(r),this.updateMediaStreamTrackResolution()}catch(e){const t=new NT(LT.UNEXPECTED_ERROR,e.toString());throw SR.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}this._config=n,this._constraints=r,this._originalConstraints=r,this._encoderConfig=e,-1===this._hints.indexOf(bL.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await dC(this,wL.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(SR)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((dT()||ET())&&this._enabled&&!this._isClosed&&ZL.duringInterruption){const e=async()=>{ZL.off(oL.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(SR.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ZL.on(oL.IOS_INTERRUPTION_END,e)}else SR.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(RL.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=fN.searchDeviceIdByName(this._deviceName);if(n&&!t.deviceId&&(t.deviceId={exact:n}),this._enabled){const e=await dN({video:t},this.getTrackId());this._constraints=t,await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),ZL.off(oL.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),ZL.off(oL.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._encoderConfig;t&&(r=zL(zL({},r),hL(t))),r=_C(r);const i=AC(8,"track-cam-cloned-"),o=new e(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,_C(zL(zL({},this._config),{},{encoderConfig:r})),_C(this._constraints),_C(this._scalabilityMode),this._optimizationMode,i);return t&&r&&o.setEncoderConfiguration(r),SR.debug("clone track from ".concat(this.getTrackId()," to ").concat(i,", clone ").concat(n)),o}bindProcessorContextEvents(){this.processorContext.on(ML.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}})),this.processorContext.on(ML.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}},HL(cD.prototype,"setDevice",[eD,tD],Object.getOwnPropertyDescriptor(cD.prototype,"setDevice"),cD.prototype),HL(cD.prototype,"setEnabled",[nD,rD,iD],Object.getOwnPropertyDescriptor(cD.prototype,"setEnabled"),cD.prototype),HL(cD.prototype,"setEncoderConfiguration",[oD,aD],Object.getOwnPropertyDescriptor(cD.prototype,"setEncoderConfiguration"),cD.prototype),HL(cD.prototype,"close",[sD],Object.getOwnPropertyDescriptor(cD.prototype,"close"),cD.prototype),cD);function uD(e,t,n,r){n.optimizationMode&&(r&&r.width&&r.height?(n.encoderConfig=zL(zL({},r),{},{bitrateMin:r.bitrateMin,bitrateMax:r.bitrateMax}),"motion"!==n.optimizationMode&&"detail"!==n.optimizationMode||(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?SR.debug("[".concat(e,"] set content hint to"),n.optimizationMode):SR.debug("[".concat(e,"] set content hint failed")))):SR.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var pD,hD,fD,mD,gD,vD,_D,yD,wD,bD,ED,SD;class TD extends KL{getUserId(){return this._userId}constructor(e,t,n,r){super(e,"track-".concat(e.kind,"-").concat(t,"-").concat(r.clientId,"_").concat(AC(5,""))),qL(this,"_userId",void 0),qL(this,"_uintId",void 0),qL(this,"_isDestroyed",!1),qL(this,"store",void 0),qL(this,"processor",void 0),qL(this,"processorContext",void 0),this._userId=t,this._uintId=n,this.store=r}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,SR.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let CD=(pD=xR({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),hD=xR({argsMap:e=>[e.getTrackId()]}),fD=xR({argsMap:(e,t)=>[e.getTrackId(),t.name]}),mD=xR({argsMap:e=>[e.getTrackId()]}),HL((gD=class extends TD{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==VL.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,n,r){super(e,t,n,r),qL(this,"_videoVisibleTimer",null),qL(this,"_previousVideoVisibleStatus",void 0),qL(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),qL(this,"trackMediaType",IL.VIDEO),qL(this,"_videoWidth",void 0),qL(this,"_videoHeight",void 0),qL(this,"_player",void 0),qL(this,"processorDestination",void 0),qL(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new SN(this.getTrackId(),"remote"),this.processorDestination=new EN(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return wC((()=>{SR.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")}),"remoteVideoTrackGetStatsWarning"),uC(this,wL.GET_STATS)||zL({},PL)}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(SR.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}SR.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=zL(zL({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(e instanceof HTMLVideoElement?this._player=new RP(n):this._player=new IP(n),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(OL.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=e=>{this.safeEmit(OL.VIDEO_STATE_CHANGED,e)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(OL.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),aR("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,SR.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){IN(this._originMediaStreamTrack).then((e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t})).catch(xC)}_updatePlayerSource(){SR.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:i,slot:o}=r;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=qT.checkOneElementVisible(i),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new NT(LT.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new NT(LT.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(DL.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(DL.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(CL.SEI_RECEIVED,e)}}).prototype,"play",[pD],Object.getOwnPropertyDescriptor(gD.prototype,"play"),gD.prototype),HL(gD.prototype,"stop",[hD],Object.getOwnPropertyDescriptor(gD.prototype,"stop"),gD.prototype),HL(gD.prototype,"pipe",[fD],Object.getOwnPropertyDescriptor(gD.prototype,"pipe"),gD.prototype),HL(gD.prototype,"unpipe",[mD],Object.getOwnPropertyDescriptor(gD.prototype,"unpipe"),gD.prototype),gD),RD=(vD=xR({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),_D=xR({argsMap:(e,t)=>[e.getTrackId(),t]}),yD=xR({argsMap:e=>[e.getTrackId()]}),wD=xR({argsMap:e=>[e.getTrackId()]}),bD=xR({argsMap:(e,t)=>[e.getTrackId(),t.name]}),ED=xR({argsMap:e=>[e.getTrackId()]}),HL((SD=class extends TD{get isPlaying(){return this._useAudioElement?wN.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,n,r){super(e,t,n,r),qL(this,"trackMediaType",IL.AUDIO),qL(this,"_source",void 0),qL(this,"_useAudioElement",!0),qL(this,"_volume",100),qL(this,"processorContext",void 0),qL(this,"processorDestination",void 0),qL(this,"_played",!1),qL(this,"_bypassWebAudio",!1),aR("DISABLE_WEBAUDIO")?(this._source=new RN,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new iN(e,!0),aR("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(AL.RECEIVE_TRACK_BUFFER,(()=>{this.safeEmit(OL.FIRST_FRAME_DECODED)})),this.processorContext=new CN(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new TN(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(AL.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})}))}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(AL.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(AL.ON_AUDIO_BUFFER),this._source.on(AL.ON_AUDIO_BUFFER,(t=>e(t)))}setVolume(e){this._volume=e,this._useAudioElement?wN.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!rL())throw new NT(LT.NOT_SUPPORTED,"your browser does not support setting the audio output device");await wN.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return wC((()=>{SR.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")}),"remoteAudioTrackGetStatsWarning"),uC(this,wL.GET_STATS)||zL({},LL)}play(){SR.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(SR.debug("[".concat(this.getTrackId(),"] use audio element to play")),wN.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){SR.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?wN.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];SR.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&wN.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new NT(LT.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new NT(LT.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new NT(LT.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(DL.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})),this.processorDestination.on(DL.ON_NODE,(e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(DL.ON_TRACK),this.processorDestination.removeAllListeners(DL.ON_NODE)}}).prototype,"setVolume",[vD],Object.getOwnPropertyDescriptor(SD.prototype,"setVolume"),SD.prototype),HL(SD.prototype,"setPlaybackDevice",[_D],Object.getOwnPropertyDescriptor(SD.prototype,"setPlaybackDevice"),SD.prototype),HL(SD.prototype,"play",[yD],Object.getOwnPropertyDescriptor(SD.prototype,"play"),SD.prototype),HL(SD.prototype,"stop",[wD],Object.getOwnPropertyDescriptor(SD.prototype,"stop"),SD.prototype),HL(SD.prototype,"pipe",[bD],Object.getOwnPropertyDescriptor(SD.prototype,"pipe"),SD.prototype),HL(SD.prototype,"unpipe",[ED],Object.getOwnPropertyDescriptor(SD.prototype,"unpipe"),SD.prototype),SD);const OD=new class extends YT{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),qL(this,"_lastHiddenTime",0),qL(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),SR.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)}))}};class ID extends YT{constructor(e,t){super(),qL(this,"trackMediaType",IL.DATA),qL(this,"_version",1),qL(this,"_type",3),qL(this,"_config",void 0),qL(this,"_originDataChannel",void 0),qL(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),qL(this,"_dataStreamPacketHandler",{serialize:e=>e,deserialize:e=>e}),qL(this,"_datachannelEventMap",new Map),this._config=e,t&&(this._originDataChannel=t,this._bandDataChannelEvents(t)),this._initPacketHeader()}useDataStream(e){this._dataStreamPacketHandler=e}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return aR("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.readyState)&&void 0!==e?e:"connecting"}get _originDataChannelId(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.id)&&void 0!==e?e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new Ih(((e,t)=>{if(this._originDataChannel){"open"===this._originDataChannel.readyState&&e();const n=setTimeout((()=>{var e;t(new NT(LT.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat(null===(e=this._originDataChannel)||void 0===e?void 0:e.id)))}),1e4);this._originDataChannel.onopen=()=>{clearTimeout(n),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),e()},this._originDataChannel.onerror=()=>{throw clearTimeout(n),new NT(LT.DATACHANNEL_CONNECTION_TIMEOUT)}}else t(new NT(LT.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))}))}_updateOriginDataChannel(e){this._originDataChannel=e,this._bandDataChannelEvents(e)}_initPacketHeader(){const e=new DataView(this._dataStreamPacketHeader);e.setUint16(0,this._version),e.setUint8(2,this._type),e.setUint8(3,this._config.id)}_bandDataChannelEvents(e){this._unbindDataChannelEvents(e),[GL.OPEN,GL.CLOSE,GL.ERROR].forEach((t=>{const n=()=>{this.emit(t)};this._datachannelEventMap.set(t,n),e.addEventListener(t,n)}))}_unbindDataChannelEvents(e){Array.from(this._datachannelEventMap.entries()).forEach((t=>{let[n,r]=t;e.removeEventListener(n,r)})),this._datachannelEventMap.clear()}}class AD extends ID{constructor(e){super(e),qL(this,"_messageListener",void 0),this._messageListener=e=>{if(e.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const t=e.data.slice(0,this._dataStreamPacketHeader.byteLength),n=new DataView(t).getUint8(3);if(n!==this.id)return void(aR("SHOW_DATASTREAM2_LOG")&&SR.debug("invalid datachannel id: ".concat(n," !== ").concat(this.id)));let r=e.data.slice(this._dataStreamPacketHeader.byteLength);r=this._dataStreamPacketHandler.deserialize(r),this.emit(GL.MESSAGE,r)}}_updateOriginDataChannel(e){super._updateOriginDataChannel(e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class kD extends ID{send(e){if(this._originDataChannel){let t=e;t=this._dataStreamPacketHandler.serialize(e);const n=new Uint8Array(this._dataStreamPacketHeader.byteLength+t.byteLength);n.set(new Uint8Array(this._dataStreamPacketHeader),0),n.set(new Uint8Array(t),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(n.buffer)}}}function xD(){const e=new Blob([atob("ZnVuY3Rpb24gZShlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLGE9W10sbz0wO2Zvcig7YS5sZW5ndGg8bjspbyszPG4mJjA9PT1yW29dJiYwPT09cltvKzFdJiYzPT09cltvKzJdJiYoMD09PXJbbyszXXx8MT09PXJbbyszXXx8Mj09PXJbbyszXXx8Mz09PXJbbyszXSk/KGEucHVzaChyW29dLHJbbysxXSxyW28rM10pLG8rPTQpOihhLnB1c2gocltvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYSl9ZnVuY3Rpb24gdChlLHQpe2NvbnN0IG49ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmxlbmd0aDtsZXQgbj1bXSxyPTA7Zm9yKDtyPHQ7KXIrMjx0JiYwPT09ZVtyXSYmMD09PWVbcisxXSYmKDA9PT1lW3IrMl18fDE9PT1lW3IrMl18fDI9PT1lW3IrMl18fDM9PT1lW3IrMl0pPyhuLnB1c2goZVtyXSxlW3IrMV0sMyxlW3IrMl0pLHIrPTMpOihuLnB1c2goZVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KHQpLHI9bi5sZW5ndGgsYT1NYXRoLmZsb29yKHIvMjU1KSxvPXIlMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNithKzErcitlLmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8YTspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1vLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkoZSksNitpK3IpLHMuYnVmZmVyfW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiU2FmYXJpIik+LTEmJi0xPT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKSYmKHNlbGYub25ydGN0cmFuc2Zvcm09bj0+e2NvbnN0IHI9bi50cmFuc2Zvcm1lcjtsZXQgYT1bXTtyLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9ZT0+e2UuZGF0YS5zZWkmJmEucHVzaChlLmRhdGEuc2VpKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IG89ci5yZWFkYWJsZS5nZXRSZWFkZXIoKSxzPXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7InJ4Ij09PXIub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1mdW5jdGlvbih0KXtjb25zdCBuPW5ldyBEYXRhVmlldyh0LmRhdGEpO2xldCByPTA7Zm9yKDtyKzQ8dC5kYXRhLmJ5dGVMZW5ndGg7KXtpZigwPT09bi5nZXRVaW50OChyKzApJiYwPT09bi5nZXRVaW50OChyKzEpJiYwPT09bi5nZXRVaW50OChyKzIpJiYxPT09bi5nZXRVaW50OChyKzMpJiY2PT09bi5nZXRVaW50OChyKzQpKXtsZXQgYT1yKzYsbz0wLHM9MDtmb3IoOzI1NT09PShzPW4uZ2V0VWludDgoYSsrKSk7KW8rPTI1NTtvKz1zO2NvbnN0IGk9ZSh0LmRhdGEsYSxvKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoaSl9cisrfXJldHVybiBudWxsfShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1hLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout((()=>eL.revokeObjectURL(e)),0),new Worker(eL.createObjectURL(e))}const LD=new Map,ND=new Map;function PD(e,t,n){let r=new Uint8Array(e,t,n),i=[],o=0;for(;i.length<n;)o+3<n&&0===r[o]&&0===r[o+1]&&3===r[o+2]&&(0===r[o+3]||1===r[o+3]||2===r[o+3]||3===r[o+3])?(i.push(r[o],r[o+1],r[o+3]),o+=4):(i.push(r[o]),o++);return new Uint8Array(i)}const DD=new Map;const MD=new Map;!function(){const e=tT();tL.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),tL.getStreamFromExtension=e.name===ZS.CHROME&&Number(e.version)>34,tL.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),tL.supportMinBitrate=e.name===ZS.CHROME||e.name===ZS.EDGE,tL.supportSetRtpSenderParameters=function(){const e=tT();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!RT()||!(!sT()&&!oT())||e.name===ZS.FIREFOX&&Number(e.version)>=64)}(),e.name===ZS.SAFARI&&(Number(e.version)>=14?tL.supportDualStream=!0:tL.supportDualStream=!1),tL.webAudioMediaStreamDest=function(){const e=tT();return!(e.name===ZS.SAFARI&&Number(e.version)<12)}(),tL.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,tL.supportWebGL="undefined"!=typeof WebGLRenderingContext,tL.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,RT()||(tL.webAudioWithAEC=!0),tL.supportShareAudio=function(){const e=tT();return(e.os===XS.WIN_10||e.os===XS.WIN_81||e.os===XS.WIN_7||e.os===XS.LINUX||e.os===XS.MAC_OS||e.os===XS.CHROMIUM_OS)&&e.name===ZS.CHROME&&Number(e.version)>=74}(),tL.supportDataChannel=!!(uT(76)||function(e){const t=tT();return!(t.name!==ZS.FIREFOX||!t.osVersion)&&Number(t.version)>=68}()||fT(14)),tL.supportPCSetConfiguration=function(){const e=window.RTCPeerConnection;return!lT()&&!!e&&e.prototype.setConfiguration instanceof Function}(),tL.supportWebRTCEncodedTransform=function(){const e=tT();return"Chrome"===e.name&&Number(e.version)>=86||"Safari"===e.name&&Number(e.version)>=15}(),tL.supportWebRTCInsertableStream=function(){const e=tT();return(e.name===ZS.CHROME||e.name===ZS.EDGE)&&Number(e.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),tL.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,tL.supportWebCrypto="undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle,gC((()=>{tL.supportDualStreamEncoding=function(){const e=tT();return!!aR("DISABLE_WEBAUDIO")||"Safari"===e.name&&Number(e.version)>=14||!!("Chrome"===e.name&&/Windows/i.test(e.os||"")&&Number(e.version)>=100&&aR("CHROME_DUAL_STREAM_USE_ENCODING"))}(),SR.info("browser compatibility",JSON.stringify(tL),JSON.stringify(e))}))}();class UD extends YT{constructor(e,t){super(),jw(this,"signal",void 0),jw(this,"token",void 0),jw(this,"tokenTimeout",void 0),jw(this,"tokenInterval",void 0),jw(this,"_sequence",0),jw(this,"userMap",new Map),jw(this,"encoder",new TextEncoder),this.signal=e,this.token=t;const n=()=>{this.signal.connectionState===DO.CONNECTED&&this.check(),0===this.userMap.size?this.tokenInterval=window.setTimeout(n,1e3):this.tokenInterval=window.setTimeout(n,3*aR("P2P_TOKEN_INTERVAL"))};n()}async send(e,t,n,r,i){var o,a,s;if(0===this.userMap.size)return;const c=Array.from(yA(o=this.userMap).call(o))[0].token;"string"!=typeof t&&(t=JSON.stringify(t)),r=null!==(a=r)&&void 0!==a?a:AC(6,""),i=null!==(s=i)&&void 0!==s?s:this._sequence++;const l={_id:r,_type:e,_seq:i,_message:t,token:"".concat(this.token,"_").concat(c)};aR("SHOW_P2P_LOG")&&SR.debug("send message",l,"noNeedResponse : ".concat(n)),this.splitMessage(JSON.stringify(l)).forEach((e=>{this.signal.request(UO.DATA_STREAM,{payload:EC(this.encoder.encode(e))})}));const d=new Ih(((t,i)=>{const o=window.setTimeout((()=>{this.off("res-@".concat(r,"_ack"),a),this.off("res-@".concat(r),c),this.off(kI.ABORT,s),SR.debug("[external-signal] request timeout, type: ".concat(e,", requestId: ").concat(r)),0===this.userMap.size?i(new NT(LT.INVALID_REMOTE_USER)):i(new NT(LT.TIMEOUT))}),aR("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),a=()=>{o&&window.clearTimeout(o),this.off(kI.ABORT,s),n&&t()},s=()=>{o&&window.clearTimeout(o),this.off("res-@".concat(r,"_ack"),a),this.off("res-@".concat(r),c),i(new NT(LT.EXTERNAL_SIGNAL_ABORT,"type: ".concat(e,", requestId: ").concat(r)))};this.once(kI.ABORT,s),this.once("res-@".concat(r,"_ack"),a);const c=(n,c)=>{d=!0,o&&window.clearTimeout(o),this.off("res-@".concat(r,"_ack"),a),this.off(kI.ABORT,s),"success"===n?t(c):i(new NT(LT.P2P_MESSAGE_FAILED,"request ".concat(e," failed, requestId: ").concat(r)))};let d=!1;n||(this.once("res-@".concat(r),c),IC(aR("SIGNAL_REQUEST_TIMEOUT")).then((()=>{d||SR.warning("external_signal request timeout, type: ".concat(e,", requestId: ").concat(r,", ").concat(l))})))}));try{return await d}catch(o){if(o.code===LT.TIMEOUT)return await this.send(e,t,n,r,i);throw o}}onMessage(e){var t;const{_uid:n}=e;let r,i=this.userMap.get(n);if(i)r=i.splitMessageMap;else{if(this.userMap.size>0||!("_type"in e)||e._type!==AI.CHECK)return;const{token:t}=e;r=new Map,i={uid:n,isStart:!0,token:t,splitMessageMap:r,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(n,i),this.signal.emit(VO.ON_USER_ONLINE,{uid:n}),this.handleUserOnline()}if("id"in e&&"total"in e){var o;const{id:t,total:i}=e,a=null!==(o=r.get(t))&&void 0!==o?o:[];if(a.push(e),r.has(t)||r.set(t,a),a.length!==i)return;{const i=Wm(a).call(a,((e,t)=>e.index-t.index)).map((e=>e.payload)).join("");r.delete(t),(e=JSON.parse(i))._uid=n}}const{_type:a,token:s}=e;if(Li(t=[AI.ACK,AI.CHECK]).call(t,a))return a===AI.CHECK&&this.handleCheckToken(i,s),void this.receiveMessage(e);s==="".concat(i.token,"_").concat(this.token)?this.handleReceivedMessage(e):SR.debug('Receive unexpected message", '.concat(s,", cur_token: ").concat(i.token,"_").concat(this.token),e)}check(){const e={_id:AC(6,""),token:this.token,_type:AI.CHECK};aR("SHOW_P2P_LOG")&&SR.debug("send message",e),this.signal.request(UO.DATA_STREAM,{payload:EC(this.encoder.encode(JSON.stringify(e)))})}ack(e){const t={_id:e,_type:AI.ACK,token:this.token};aR("SHOW_P2P_LOG")&&SR.debug("send message",t),this.signal.request(UO.DATA_STREAM,{payload:EC(this.encoder.encode(JSON.stringify(t)))})}response(e,t,n){this.send(AI.RESPONSE,JSON.stringify({success:!n,message:t}),!0,e)}handleReceivedMessage(e){const t=()=>{this.userMap.forEach((e=>{const{receivedMessagesMap:t,nextExpectedSequenceNumber:n}=e;for(;t.has(n);){const r=t.get(n);t.delete(n),this.receiveMessage(r),e.nextExpectedSequenceNumber++}}))};if(!e)return void t();const{_uid:n,_seq:r}=e,i=this.userMap.get(n),{receivedMessagesMap:o,isStart:a,nextExpectedSequenceNumber:s}=i;if(r<s)return this.ack(e._id),void SR.debug("[external-signal] receive old message, seq: ".concat(r,", ").concat(e._message));o.set(r,e),a&&r===s&&(this.receiveMessage(e),o.delete(s),i.nextExpectedSequenceNumber++,t())}receiveMessage(e){const{_id:t,_type:n,_message:r,_uid:i}=e;if(aR("SHOW_P2P_LOG")&&SR.debug("receive message",e),t){let o;switch(e._type!==AI.ACK&&(r&&(o=JSON.parse(r)),this.ack(e._id)),e._type){case AI.CANDIDATE:case AI.CONTROL:this.signal.emit(n,o,i);break;case AI.PUBLISH:case AI.UNPUBLISH:case AI.RESTART_ICE:case AI.CALL:o.uid=i,lC(this.signal,n,o).then((t=>{this.response(e._id,t)})).catch((()=>{this.response(e._id,void 0,!0)}));break;case AI.ACK:this.getListeners("res-@".concat(t,"_ack")).length>0&&this.emit("res-@".concat(t,"_ack"));break;case AI.RESPONSE:{const{success:e,message:n}=o;this.emit("res-@".concat(t),e?"success":"failed",n);break}}}}splitMessage(e){if(e.length<UD.MAX_MESSAGE_SIZE)return[e];const t=[],{remoteToken:n}=JSON.parse(e),r=AC(6,"");let i=0,o=800;const a=Math.ceil(e.length/o);for(;e.length>0;){i++;const s={id:r,index:i,total:a,payload:e.slice(0,o),token:"".concat(this.token,"_").concat(n)};JSON.stringify(s).length>UD.MAX_MESSAGE_SIZE?o-=50:(t.push(s),e=e.slice(o))}return t.map((e=>JSON.stringify(e)))}handleCheckToken(e,t){return e.token!==t?(SR.debug("token changed, from ".concat(e.token," to ").concat(t)),this.reset(e.uid,t),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout((()=>{SR.debug("token timeout, ".concat(t)),this.reset(e.uid)}),aR("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const e=await lC(this.signal,AI.CALL,void 0),t=await this.send(AI.CALL,e);this.signal.emit(MO.P2P_CONNECTION,t,!0)}async reset(e,t){const n=this.userMap.get(e);n&&(this.emit(kI.ABORT),this.signal.emit(VO.ON_USER_OFFLINE,{uid:n.uid,reason:LI.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),t||(SR.debug("change local token from ".concat(t," to ").concat(t)),this.token=AC(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(kI.ABORT)}}jw(UD,"MAX_SIZE",1),jw(UD,"MAX_MESSAGE_SIZE",1024);class jD extends YT{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===DO.CONNECTED?this.emit(MO.WS_CONNECTED):e===DO.RECONNECTING?this.emit(MO.WS_RECONNECTING,this._websocketReconnectReason):e===DO.CLOSED&&this.emit(MO.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),jw(this,"_disconnectedReason",void 0),jw(this,"_websocketReconnectReason",void 0),jw(this,"_connectionState",DO.CLOSED),jw(this,"reconnectToken",void 0),jw(this,"p2pToken",void 0),jw(this,"websocket",void 0),jw(this,"openConnectionTime",void 0),jw(this,"clientId",void 0),jw(this,"lastMsgTime",Date.now()),jw(this,"uploadCache",[]),jw(this,"uploadCacheInterval",void 0),jw(this,"rttRolling",new zC(5)),jw(this,"pingpongTimer",void 0),jw(this,"pingpongTimeoutCount",0),jw(this,"joinResponse",void 0),jw(this,"multiIpOption",void 0),jw(this,"initError",void 0),jw(this,"spec",void 0),jw(this,"store",void 0),jw(this,"_external_signal",void 0),jw(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(MO.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){switch(t._type){case VO.ON_DATA_STREAM:return void this.handleDataStream(t._message);case VO.MUTE_AUDIO:case VO.MUTE_VIDEO:case VO.ON_P2P_LOST:case VO.ON_USER_ONLINE:return;case VO.ON_USER_OFFLINE:const{uid:e}=t._message;return SR.debug("[".concat(this.clientId,"] user-offline uid: ").concat(e)),void this._external_signal.reset(e)}if(this.emit(t._type,t._message),t._type===VO.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===VO.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(tC.UID_BANNED);break;case 15:this.close(tC.IP_BANNED);break;case 16:this.close(tC.CHANNEL_BANNED)}if(t._type===VO.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case PO.ERR_LICENSE_MISSING:this.close(tC.LICENSE_MISSING);break;case PO.ERR_LICENSE_EXPIRED:this.close(tC.LICENSE_EXPIRED);break;case PO.ERR_LICENSE_MINUTES_EXCEEDED:this.close(tC.LICENSE_MINUTES_EXCEEDED);break;case PO.ERR_LICENSE_PERIOD_INVALID:this.close(tC.LICENSE_PERIOD_INVALID);break;case PO.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(tC.LICENSE_MULTIPLE_SDK_SERVICE);break;case PO.ERR_LICENSE_ILLEGAL:this.close(tC.LICENSE_ILLEGAL);break;default:this.close()}}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new JI("gateway-".concat(this.clientId),this.spec.retryConfig,!0,aR("JOIN_GATEWAY_USE_DUAL_DOMAIN"),aR("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===DO.CONNECTED&&this.reconnect("retry",aC.OFFLINE)})),this.p2pToken=AC(6,""),this._external_signal=new UD(this,this.p2pToken)}async request(e,t,n,r){const i=AC(6,""),o={_id:i,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new Ih(((e,t)=>{if(this.connectionState===DO.CONNECTED)return e();const n=()=>{this.off(MO.WS_CLOSED,r),e()},r=()=>{this.off(MO.WS_CONNECTED,n),t(new NT(LT.WS_ABORT))};this.once(MO.WS_CONNECTED,n),this.once(MO.WS_CLOSED,r)}));if(this.connectionState!==DO.CONNECTING&&this.connectionState!==DO.RECONNECTING||e===UO.JOIN||e===UO.REJOIN||await s(),this.websocket.sendMessage(o,!0),r)return;const c=new Ih(((n,r)=>{let o=!1;const s=(r,i)=>{o=!0,n({isSuccess:"success"===r,message:i||{}}),this.off(MO.WS_CLOSED,c),this.off(MO.WS_RECONNECTING,c),this.emit(MO.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),s);const c=()=>{r(new NT(LT.WS_ABORT,"type: ".concat(e))),this.off(MO.WS_CLOSED,c),this.off(MO.WS_RECONNECTING,c),this.off("res-@".concat(i),s)};this.once(MO.WS_CLOSED,c),this.once(MO.WS_RECONNECTING,c),IC(aR("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==a||o||(SR.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(MO.REQUEST_TIMEOUT,e,t))}))}));let l=null;try{l=await c}catch(r){if(this.connectionState===DO.CLOSED||e===UO.LEAVE)throw new NT(LT.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===UO.JOIN||e===UO.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const d=Number(l.message.error_code||l.message.code),u=MI(d),p=new NT(LT.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message,desc:u.desc});return"success"===u.action?l.message:(SR.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===PO.ERR_TOO_MANY_BROADCASTERS?e===UO.JOIN||e===UO.REJOIN?(this.initError=p,this.close(),p.throw()):p.throw():"failed"===u.action?p.throw():"quit"===u.action?(this.initError=p,this.close(),p.throw()):(d===PO.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,SR.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",aC.MULTI_IP)):this.reconnect(u.action,aC.SERVER_ERROR),e===UO.JOIN||e===UO.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new Ih((n=>{const r=i=>{(!t||t(i))&&(this.off(e,r),n(i))};this.on(e,r)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void SR.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(jO.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=aR("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==DO.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),aR("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}async sendExtensionMessage(e,t,n){return await this._external_signal.send(e,t,n)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ih(((t,n)=>{this.once(MO.WS_CONNECTED,(()=>t(this.joinResponse))),this.once(MO.WS_CLOSED,(()=>n(this.initError||new NT(LT.WS_ABORT)))),this.connectionState=DO.CONNECTING,this.websocket.init(e).catch(n)}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=e||tC.LEAVE,this.connectionState=DO.CLOSED,SR.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=AC(6,""),this._external_signal.clear(),this._external_signal=new UD(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(MO.ABORT_P2P_EXECUTION);const e=await lC(this,MO.REQUEST_JOIN_INFO),t=await this.request(UO.JOIN,e);if(!t)return this.emit(MO.REPORT_JOIN_GATEWAY,LT.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(MO.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=DO.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleDataStream(e){try{var t;const n=bC(e.payload),r=(new TextDecoder).decode(n),i=JSON.parse(r);"total"in i&&"id"in i||Li(t=Object.values(AI)).call(t,i._type)?(i._uid=e.uid,this._external_signal.onMessage(i)):this.emit(VO.ON_DATA_STREAM,e)}catch(t){this.emit(VO.ON_DATA_STREAM,e)}}handleNotification(e){SR.debug("[".concat(this.clientId,"] receive notification: "),e);const t=MI(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(tC.UID_BANNED),void this.close()):void this.reconnect(t.action,aC.SERVER_ERROR);SR.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=aR("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(SR.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>aR("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",aC.TIMEOUT):this.request(UO.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),aR("REPORT_STATS")&&this.send(UO.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWebsocketEvents(){this.websocket.on(FO.RECONNECT_WAITTING_FINISH,(e=>{this.emit(MO.WS_RECONNECT_WAITTING_FINISH,e)})),this.websocket.on(FO.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(MO.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(FO.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(FO.CLOSED,(()=>{this.connectionState=DO.CLOSED})),this.websocket.on(FO.FAILED,(()=>{this._disconnectedReason=tC.NETWORK_ERROR,this.connectionState=DO.CLOSED})),this.websocket.on(FO.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===DO.CONNECTED?this.connectionState=DO.RECONNECTING:this.connectionState=DO.CONNECTING})),this.websocket.on(FO.WILL_RECONNECT,((e,t,n)=>{"retry"!==e?(SR.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0):SR.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),n(e)})),this.websocket.on(FO.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.join().catch((e=>{if(this.emit(MO.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof NT&&e.code===LT.UNEXPECTED_RESPONSE&&e.data.code===PO.ERR_NO_AUTHORIZED)return SR.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",aC.SERVER_ERROR);SR.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",aC.SERVER_ERROR):(this.initError=e,this.close())}))})),this.websocket.on(FO.REQUEST_NEW_URLS,((e,t)=>{lC(this,MO.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(FO.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(VO.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}))}}var VD={exports:{}};VD.exports=(()=>{var e={8:(e,t,n)=>{n.r(t),n.d(t,{Parser:()=>E,Printer:()=>O,parse:()=>x,print:()=>L});const r="\n",i="".concat("\r").concat(r),o=" ";let a;function s(e){return e>="0"&&e<="9"}function c(e){return e>="!"&&e<="~"}function l(e){return c(e)||e>=""&&e<=""}function d(e){return"!"===e||e>="#"&&e<="'"||e>="*"&&e<="+"||e>="-"&&e<="."||e>="0"&&e<="9"||e>="A"&&e<="Z"||e>="^"&&e<="~"}function u(e){return e>="1"&&e<="9"}function p(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function h(e){return"d"===e||"h"===e||"m"===e||"s"===e}function f(e){return e>""&&e<"\t"||e>"\v"&&e<"\f"||e>""&&e<""}function m(e){return p(e)||s(e)||"+"===e||"/"===e}function g(e){return s(e)||p(e)||"+"===e||"/"===e||"-"===e||"_"===e}function v(e){return p(e)||s(e)||"+"===e||"/"===e}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.VERSION="v",e.ORIGIN="o",e.SESSION_NAME="s",e.INFORMATION="i",e.URI="u",e.EMAIL="e",e.PHONE="p",e.CONNECTION="c",e.BANDWIDTH="b",e.TIME="t",e.REPEAT="r",e.ZONE_ADJUSTMENTS="z",e.KEY="k",e.ATTRIBUTE="a",e.MEDIA="m"}(a||(a={}));class b{consumeText(e,t){let n=t;for(;n<e.length;){const t=e[n];if("\0"===t||"\r"===t||t===r)break;n+=1}if(n-t==0)throw new Error("Invalid text, at ".concat(e));return n}consumeUnicastAddress(e,t,n){return this.consumeTill(e,t,o)}consumeOneOrMore(e,t,n){let r=t;for(;n(e[r]);)r++;if(r-t==0)throw new Error("Invalid rule at ".concat(t,"."));return r}consumeSpace(e,t){if(e[t]===o)return t+1;throw new Error("Invalid space at ".concat(t,"."))}consumeIP4Address(e,t){let n=t;for(let t=0;t<4;t++)if(n=this.consumeDecimalUChar(e,n),3!==t){if("."!==e[n])throw new Error("Invalid IP4 address.");n++}return n}consumeDecimalUChar(e,t){let n=t;for(let t=0;t<3&&s(e[n]);t++,n++);if(n-t==0)throw new Error("Invalid decimal uchar.");const r=parseInt(e.slice(t,n));if(r>=0&&r<=255)return n;throw new Error("Invalid decimal uchar")}consumeIP6Address(e,t){let n=this.consumeHexpart(e,t);return":"===e[n]?(n+=1,n=this.consumeIP4Address(e,n),n):n}consumeHexpart(e,t){let n=t;if(":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}if(n=this.consumeHexseq(e,n),":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}return n}consumeHexseq(e,t){let n=t;for(;n=this.consumeHex4(e,n),":"===e[n]&&":"!==e[n+1];)n+=1;return n}consumeHex4(e,t){let n=0;for(;n<4;n++)if(!((r=e[t+n])>="0"&&r<="9"||r>="a"&&r<="f"||r>="A"&&r<="F")){if(0===n)throw new Error("Invalid hex 4");break}var r;return t+n}consumeFQDN(e,t){let n=t;for(;s(e[n])||p(e[n])||"-"===e[n]||"."===e[n];)n+=1;if(n-t<4)throw new Error("Invalid FQDN");return n}consumeExtnAddr(e,t){return this.consumeOneOrMore(e,t,l)}consumeMulticastAddress(e,t,n){switch(n){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e,t);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e,t);default:try{return this.consumeFQDN(e,t)}catch(n){return this.consumeExtnAddr(e,t)}}}consumeIP6MulticastAddress(e,t){const n=this.consumeHexpart(e,t);return"/"===e[n]?this.consumeInteger(e,n+1):n}consumeIP4MulticastAddress(e,t){let n=t+3;const r=e.slice(t,n),i=parseInt(r);if(i<224||i>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let t=0;t<3;t++){if("."!==e[n])throw new Error("Invalid IP4 multicast address.");n+=1,n=this.consumeDecimalUChar(e,n)}return"/"===e[n]&&(n+=1),n=this.consumeTTL(e,n),"/"===e[n]&&(n=this.consumeInteger(e,n)),n}consumeInteger(e,t){if(!u(e[t]))throw new Error("Invalid integer.");for(t+=1;s(e[t]);)t+=1;return t}consumeTTL(e,t){if("0"===e[t])return t+1;if(!u(e[t]))throw new Error("Invalid TTL.");t+=1;for(let n=0;n<2&&s(e[t]);n++)t+=1;return t}consumeToken(e,t){return this.consumeOneOrMore(e,t,d)}consumeTime(e,t){let n=t;if("0"===e[n])return n+1;for(u(e[n])&&(n+=1);s(e[n]);)n++;if(n-t<10)throw new Error("Invalid time");return n}consumeAddress(e,t){return this.consumeTill(e,t,o)}consumeTypedTime(e,t){let n=t;return n=this.consumeOneOrMore(e,n,s),h(e[n])?n+1:n}consumeRepeatInterval(e,t){if(!u(e[t]))throw new Error("Invalid repeat interval");for(t+=1;s(e[t]);)t+=1;return h(e[t])&&(t+=1),t}consumePort(e,t){return this.consumeOneOrMore(e,t,s)}consume(e,t,n){for(let r=0;r<n.length;r++){if(t+r>=e.length)throw new Error("consume exceeding value length");if(e[t+r]!==n[r])throw new Error("consume ".concat(n," failed at ").concat(r))}return t+n.length}consumeTill(e,t,n){let r=t;for(;r<e.length&&("string"!=typeof n||e[r]!==n)&&("function"!=typeof n||!n(e[r]));)r++;return r}}class E extends b{constructor(){super(),w(this,"records",[]),w(this,"currentLine",0)}parse(e){const t=this.probeEOL(e);this.records=e.split(t).filter((e=>!!Of(e).call(e))).map(this.parseLine),this.currentLine=0;const n=this.parseVersion(),r=this.parseOrigin(),i=this.parseSessionName(),o=this.parseInformation(),a=this.parseUri(),s=this.parseEmail(),c=this.parsePhone(),l=this.parseConnection(),d=this.parseBandWidth(),u=this.parseTimeFields(),p=this.parseKey(),h=this.parseSessionAttribute(),f=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:n,origin:r,sessionName:i,information:o,uri:a,emails:s,phones:c,connection:l,bandwidths:d,timeFields:u,key:p,attributes:h,mediaDescriptions:f}}getCurrentRecord(){const e=this.records[this.currentLine];if(!e)throw new Error("Record doesn't exit.");return e}probeEOL(e){for(let t=0;t<e.length;t++)if(e[t]===r)return"\r"===e[t-1]?i:r;throw new Error("Invalid newline character.")}parseLine(e,t){if(e.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const n=e[0];if("="!==e[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:n,value:e.slice(2),line:t,cur:0}}parseSessionAttribute(){const e=new T;for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==a.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(t,(e=>d(e)&&":"!==e)),_cur:0};":"===t.value[t.cur]&&(t.cur+=1,n.attValue=this.extractOneOrMore(t,f)),e.parse(n),this.currentLine++}return e.digest()}parseMediaAttributes(e){const t=new C(e);for(;this.currentLine<this.records.length;){const e=this.getCurrentRecord();if(e.type!==a.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(e,(e=>d(e)&&":"!==e)),_cur:0};":"===e.value[e.cur]&&(e.cur+=1,n.attValue=this.extractOneOrMore(e,f)),t.parse(n),this.currentLine++}return t.digest()}parseKey(){const e=this.getCurrentRecord();if(e.type===a.KEY){if("prompt"===e.value||"clear:"===e.value||"base64:"===e.value||"uri:"===e.value)return e.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e=this.getCurrentRecord();if(e.type===a.ZONE_ADJUSTMENTS){const t=[];for(;;)try{const n=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);let r=!1;"-"===e.value[e.cur]&&(r=!0,e.cur+=1);const i=this.extract(e,this.consumeTypedTime);t.push({time:n,typedTime:i,back:r})}catch(e){break}if(0===t.length)throw new Error("Invalid zone adjustments");return this.currentLine++,t}return[]}parseRepeat(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.REPEAT)break;{const n=this.extract(t,this.consumeRepeatInterval),r=this.parseTypedTime(t);e.push({repeatInterval:n,typedTimes:r}),this.currentLine++}}return e}parseTypedTime(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeTypedTime))}catch(e){break}if(0===t.length)throw new Error("Invalid typed time.");return t}parseTime(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);const n=this.extract(e,this.consumeTime);return this.currentLine++,{startTime:t,stopTime:n}}parseBandWidth(){const e=[];for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==a.BANDWIDTH)break;{const n=this.extractOneOrMore(t,d);if(":"!==t.value[t.cur])throw new Error("Invalid bandwidth field.");t.cur++;const r=this.extractOneOrMore(t,s);e.push({bwtype:n,bandwidth:r}),this.currentLine++}}return e}parseVersion(){const e=this.getCurrentRecord();if(e.type!==a.VERSION)throw new Error("first sdp record must be version");const t=e.value.slice(0,this.consumeOneOrMore(e.value,0,s));if(t.length!==e.value.length)throw new Error('invalid proto version, "v='.concat(e.value,'"'));return this.currentLine++,t}parseOrigin(){const e=this.getCurrentRecord();if(e.type!==a.ORIGIN)throw new Error("second line of sdp must be origin");const t=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,s);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,s);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const o=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const c=this.extract(e,this.consumeUnicastAddress);return this.currentLine++,{username:t,sessId:n,sessVersion:r,nettype:i,addrtype:o,unicastAddress:c}}parseSessionName(){const e=this.getCurrentRecord();if(e.type===a.SESSION_NAME){const t=this.extract(e,this.consumeText);return this.currentLine++,t}}parseInformation(){const e=this.getCurrentRecord();if(e.type!==a.INFORMATION)return;const t=this.extract(e,this.consumeText);return this.currentLine++,t}parseUri(){const e=this.getCurrentRecord();if(e.type===a.URI)return this.currentLine++,e.value}parseEmail(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.EMAIL)break;e.push(t.value),this.currentLine++}return e}parsePhone(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.PHONE)break;e.push(t.value),this.currentLine++}return e}parseConnection(){const e=this.getCurrentRecord();if(e.type===a.CONNECTION){const t=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const r=this.extract(e,this.consumeAddress);return this.currentLine++,{nettype:t,addrtype:n,address:r}}}parseMedia(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeToken);this.consumeSpaceForRecord(e);let n=this.extract(e,this.consumePort);"/"===e.value[e.cur]&&(e.cur+=1,n+=this.extract(e,this.consumeInteger)),this.consumeSpaceForRecord(e);const r=[];for(r.push(this.extract(e,this.consumeToken));"/"===e.value[e.cur];)e.cur+=1,r.push(this.extract(e,this.consumeToken));if(0===r.length)throw new Error("Invalid proto");const i=this.parseFmt(e);return this.currentLine++,{mediaType:t,port:n,protos:r,fmts:i}}parseTimeFields(){const e=[];for(;this.getCurrentRecord().type===a.TIME;){const t=this.parseTime(),n=this.parseRepeat(),r=this.parseZone();e.push({time:t,repeats:n,zones:r})}return e}parseMediaDescription(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===a.MEDIA;){const t=this.parseMedia(),n=this.parseInformation(),r=this.parseConnections(),i=this.parseBandWidth(),o=this.parseKey(),a=this.parseMediaAttributes(t);e.push({media:t,information:n,connections:r,bandwidths:i,key:o,attributes:a})}return e}parseConnections(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===a.CONNECTION;)e.push(this.parseConnection());return e}parseFmt(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeToken))}catch(e){break}if(0===t.length)throw new Error("Invalid fmts");return t}extract(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];const o=t.call(this,e.value,e.cur,...r),a=e.value.slice(e.cur,o);return e.cur=o,a}extractOneOrMore(e,t){const n=this.consumeOneOrMore(e.value,e.cur,t),r=e.value.slice(e.cur,n);return e.cur=n,r}consumeSpaceForRecord(e){if(e.value[e.cur]!==o)throw new Error("Invalid space at ".concat(e.cur,"."));e.cur+=1}}class S extends b{constructor(){super(...arguments),w(this,"attributes",void 0),w(this,"digested",!1)}extractOneOrMore(e,t,n){const r=this.consumeOneOrMore(e.attValue,e._cur,t),i=e.attValue.slice(e._cur,r),[o,a]=n||[];if("number"==typeof o&&i.length<o)throw new Error("error in length, should be more or equal than ".concat(o," characters."));if("number"==typeof a&&i.length>a)throw new Error("error in length, should be less or equal than ".concat(a," characters."));return e._cur=r,i}consumeAttributeSpace(e){if(e.attValue[e._cur]!==o)throw new Error("Invalid space at ".concat(e._cur,"."));e._cur+=1}extract(e,t){if(!e.attValue)throw new Error("Nothing to extract from attValue.");for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];const o=t.call(this,e.attValue,e._cur,...r),a=e.attValue.slice(e._cur,o);return e._cur=o,a}atEnd(e){if(!e.attValue)throw new Error;return e._cur>=e.attValue.length}peekChar(e){if(!e.attValue)throw new Error;return e.attValue[e._cur]}peek(e,t){if(!e.attValue)throw new Error;for(let n=0;n<t.length;n++)if(t[n]!==e.attValue[e._cur+n])return!1;return!0}parseIceUfrag(e){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e,m,[4,256])}parseIcePwd(e){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e,m,[22,256])}parseIceOptions(e){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const t=[];for(;!this.atEnd(e);){t.push(this.extractOneOrMore(e,m));try{this.consumeAttributeSpace(e)}catch(t){if(this.atEnd(e))break;throw t}}this.attributes.iceOptions=t}parseFingerprint(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill);this.attributes.fingerprints.push({hashFunction:t,fingerprint:n})}parseExtmap(e){const t=this.extractOneOrMore(e,s);let n;"/"===this.peekChar(e)&&(this.extract(e,this.consume,"/"),n=this.extract(e,this.consumeToken)),this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,o),i=y(y({entry:parseInt(t,10)},n&&{direction:n}),{},{extensionName:r});this.peekChar(e)===o&&(this.consumeAttributeSpace(e),i.extensionAttributes=this.extract(e,this.consumeTill)),this.attributes.extmaps.push(i)}parseSetup(e){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const t=this.extract(e,this.consumeTill);if("active"!==t&&"passive"!==t&&"actpass"!==t&&"holdconn"!==t)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=t}}class T extends S{constructor(){super(...arguments),w(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"group":this.parseGroup(e);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"fingerprint":this.parseFingerprint(e);break;case"setup":this.parseSetup(e);break;case"tls-id":this.parseTlsId(e);break;case"identity":this.parseIdentity(e);break;case"extmap":this.parseExtmap(e);break;case"msid-semantic":this.parseMsidSemantic(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing session attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;)this.consumeAttributeSpace(e),n.push(this.extract(e,this.consumeToken));this.attributes.groups.push({semantic:t,identificationTag:n})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e,g)}parseIdentity(e){const t=this.extractOneOrMore(e,v),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.extract(e,this.consume,"=");const r=this.extractOneOrMore(e,(e=>e!==o&&f(e)));n.push({name:t,value:r})}this.attributes.identities.push({assertionValue:t,extensions:n})}parseMsidSemantic(e){this.peekChar(e)===o&&this.consumeAttributeSpace(e);const t={semantic:this.extract(e,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e)}catch(e){break}if("*"===this.peekChar(e)){this.extract(e,this.consume,"*"),t.applyForAll=!0;break}{const n=this.extract(e,this.consumeTill,o);t.identifierList.push(n)}}this.attributes.msidSemantic=t}}class C extends S{constructor(e){super(),w(this,"attributes",void 0),-1!==e.protos.indexOf("RTP")||e.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"extmap":this.parseExtmap(e);break;case"setup":this.parseSetup(e);break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"candidate":this.parseCandidate(e);break;case"remote-candidate":this.parseRemoteCandidate(e);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e);break;case"rtpmap":this.parseRtpmap(e);break;case"ptime":this.parsePtime(e);break;case"maxptime":this.parseMaxPtime(e);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e);break;case"ssrc":this.parseSSRC(e);break;case"fmtp":this.parseFmtp(e);break;case"rtcp-fb":this.parseRtcpFb(e);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e);break;case"mid":this.parseMid(e);break;case"msid":this.parseMsid(e);break;case"imageattr":this.parseImageAttr(e);break;case"rid":this.parseRid(e);break;case"simulcast":this.parseSimulcast(e);break;case"sctp-port":this.parseSctpPort(e);break;case"max-message-size":this.parseMaxMessageSize(e);break;case"ssrc-group":this.parseSSRCGroup(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing media attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}parseCandidate(e){const t=this.extractOneOrMore(e,m,[1,32]);this.consumeAttributeSpace(e);const n=this.extractOneOrMore(e,s,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const i=this.extractOneOrMore(e,s,[1,10]);this.consumeAttributeSpace(e);const a=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const l=this.extract(e,this.consumePort);this.consumeAttributeSpace(e),this.extract(e,this.consume,"typ"),this.consumeAttributeSpace(e);const d={foundation:t,componentId:n,transport:r,priority:i,connectionAddress:a,port:l,type:this.extract(e,this.consumeToken),extension:{}};for(this.peek(e," raddr")&&(this.extract(e,this.consume," raddr"),this.consumeAttributeSpace(e),d.relAddr=this.extract(e,this.consumeAddress)),this.peek(e," rport")&&(this.extract(e,this.consume," rport"),this.consumeAttributeSpace(e),d.relPort=this.extract(e,this.consumePort));this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e),d.extension[t]=this.extractOneOrMore(e,c)}this.attributes.candidates.push(d)}parseRemoteCandidate(e){const t=[];for(;;){const n=this.extractOneOrMore(e,s,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumePort);t.push({componentId:n,connectionAddress:r,port:i});try{this.consumeAttributeSpace(e)}catch(e){break}}this.attributes.remoteCandidatesList.push(t)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,"/");this.extract(e,this.consume,"/");const r={encodingName:n,clockRate:this.extractOneOrMore(e,s)};this.atEnd(e)||"/"!==this.peekChar(e)||(this.extract(e,this.consume,"/"),r.encodingParameters=parseInt(this.extract(e,this.consumeTill),10));const i=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));i?i.rtpMap=r:this.attributes.payloads.push({payloadType:parseInt(t,10),rtpMap:r,rtcpFeedbacks:[]})}parsePtime(e){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e,this.consumeTill)}parseMaxPtime(e){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e,this.consumeTill)}parseDirection(e){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e.attField}parseSSRC(e){const t=this.extractOneOrMore(e,s);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,":");let r;":"===this.peekChar(e)&&(this.extract(e,this.consume,":"),r=this.extract(e,this.consumeTill));const i=this.attributes.ssrcs.find((e=>e.ssrcId===parseInt(t,10)));i?i.attributes[n]=r:this.attributes.ssrcs.push({ssrcId:parseInt(t,10),attributes:{[n]:r}})}parseFmtp(e){const t=this.extract(e,this.consumeTill,o);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill),r={};n.split(";").forEach((e=>{let[t,n]=e.split("=");t=Of(t).call(t);const i="string"==typeof n?Of(n).call(n):null;"string"==typeof t&&t.length>0&&(r[t]=i)}));const i=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));i?i.fmtp={parameters:r}:this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[],fmtp:{parameters:r}})}parseFmtParameters(e){const t={},n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");for(t[n]=r;";"===e.attValue[e._cur];){const n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");t[n]=r}return t}parseRtcpFb(e){let t="";t="*"===this.peekChar(e)?this.extract(e,this.consume,"*"):this.extract(e,this.consumeTill,o),this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,o);let r;if("trr-int"===n)r={type:n,interval:this.extract(e,this.consumeTill)};else{const t={type:n};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.parameter=this.extract(e,this.consumeToken),this.peekChar(e)===o&&(t.additional=this.extract(e,this.consumeTill))),r=t}if("*"===t)this.attributes.rtcpFeedbackWildcards.push(r);else{const e=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));e?e.rtcpFeedbacks.push(r):this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[r]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const t={port:this.extract(e,this.consumePort)};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.netType=this.extractOneOrMore(e,d),this.consumeAttributeSpace(e),t.addressType=this.extractOneOrMore(e,d),this.consumeAttributeSpace(e),t.address=this.extract(e,this.consumeAddress)),this.attributes.rtcp=t}parseMsid(e){const t={id:this.extractOneOrMore(e,d,[1,64])};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.appdata=this.extractOneOrMore(e,d,[1,64])),this.attributes.msids.push(t)}parseImageAttr(e){this.attributes.imageattr.push(e.attValue)}parseRid(e){const t=this.extractOneOrMore(e,(e=>p(e)||s(e)||"_"===e||"-"===e));this.consumeAttributeSpace(e);const n={id:t,direction:this.extract(e,this.consumeToken),params:[]};if(this.peekChar(e)===o){if(this.consumeAttributeSpace(e),this.peek(e,"pt=")){this.extract(e,this.consume,"pt=");const t=[];for(;;){const n=this.extract(e,this.consumeToken);t.push(n);try{this.extract(e,this.consume,",")}catch(e){break}}n.payloads=t,this.peekChar(e)===o&&this.extract(e,this.consume,o)}for(;;){const t=this.extract(e,this.consumeToken);switch(t){case"depend":{const r={type:t,rids:this.extract(e,this.consume,"=").split(",")};n.params.push(r);break}default:{const r={type:t};"="===this.peekChar(e)&&(this.extract(e,this.consume,"="),r.val=this.extract(e,this.consumeTill,";")),n.params.push(r)}}try{this.extract(e,this.consume,";")}catch(e){break}}}this.attributes.rids.push(n)}parseSimulcast(e){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e.attValue,this.extract(e,this.consumeTill)}parseSctpPort(e){this.attributes.sctpPort=this.extractOneOrMore(e,s,[1,5])}parseMaxMessageSize(e){this.attributes.maxMessageSize=this.extractOneOrMore(e,s,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e){this.attributes.mid=this.extract(e,this.consumeToken)}parseSSRCGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;;)try{this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeInteger);n.push(parseInt(t,10))}catch(e){break}this.attributes.ssrcGroups.push({semantic:t,ssrcIds:n})}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class O{constructor(){R(this,"eol",i)}print(e,t){let n="";return t&&(this.eol=t),n+=this.printVersion(e.version),n+=this.printOrigin(e.origin),n+=this.printSessionName(e.sessionName),n+=this.printInformation(e.information),n+=this.printUri(e.uri),n+=this.printEmail(e.emails),n+=this.printPhone(e.phones),n+=this.printConnection(e.connection),n+=this.printBandwidth(e.bandwidths),n+=this.printTimeFields(e.timeFields),n+=this.printKey(e.key),n+=this.printSessionAttributes(e.attributes),n+=this.printMediaDescription(e.mediaDescriptions),n}printVersion(e){return"v=".concat(e).concat(this.eol)}printOrigin(e){return"o=".concat(e.username," ").concat(e.sessId," ").concat(e.sessVersion," ").concat(e.nettype," ").concat(e.addrtype," ").concat(e.unicastAddress).concat(this.eol)}printSessionName(e){return e?"s=".concat(e).concat(this.eol):""}printInformation(e){return e?"i=".concat(e).concat(this.eol):""}printUri(e){return e?"u=".concat(e).concat(this.eol):""}printEmail(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printPhone(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printConnection(e){return e?"c=".concat(e.nettype," ").concat(e.addrtype," ").concat(e.address).concat(this.eol):""}printBandwidth(e){let t="";for(const n of e)t+="b=".concat(n.bwtype,":").concat(n.bandwidth).concat(this.eol);return t}printTimeFields(e){let t="";for(const n of e){t+="t=".concat(n.time.startTime," ").concat(n.time.startTime).concat(this.eol);for(const e of n.repeats)t+="r=".concat(e.repeatInterval," ").concat(e.typedTimes.join(" ")).concat(this.eol);n.zoneAdjustments&&(t+="z=",t+="z=".concat(n.zoneAdjustments.map((e=>"".concat(e.time," ").concat(e.back?"-":""," ").concat(e.typedTime))).join(" ")).concat(this.eol),t+=this.eol)}return t}printKey(e){return e?"k=".concat(e).concat(this.eol):""}printAttributes(e){let t="";for(const n of e)t+="a=".concat(n.attField).concat(n.attValue?":".concat(n.attValue):"").concat(this.eol);return t}printMediaDescription(e){let t="";for(const n of e)t+=this.printMedia(n.media),t+=this.printInformation(n.information),t+=this.printConnections(n.connections),t+=this.printBandwidth(n.bandwidths),t+=this.printKey(n.key),t+=this.printMediaAttributes(n);return t}printConnections(e){let t="";for(const n of e)t+=this.printConnection(n);return t}printMedia(e){return"m=".concat(e.mediaType," ").concat(e.port," ").concat(e.protos.join("/")," ").concat(e.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e){return new A(this.eol).print(e)}printMediaAttributes(e){return new k(this.eol).print(e)}}class I{constructor(e){R(this,"eol",void 0),this.eol=e}printIceUfrag(e){return void 0===e?"":"a=ice-ufrag:".concat(e).concat(this.eol)}printIcePwd(e){return void 0===e?"":"a=ice-pwd:".concat(e).concat(this.eol)}printIceOptions(e){return void 0===e?"":"a=ice-options:".concat(e.join(o)).concat(this.eol)}printFingerprints(e){return e.length>0?e.map((e=>"a=fingerprint:".concat(e.hashFunction).concat(o).concat(e.fingerprint))).join(this.eol)+this.eol:""}printExtmap(e){return e.map((e=>"a=extmap:".concat(e.entry).concat(e.direction?"/".concat(e.direction):"").concat(o).concat(e.extensionName).concat(e.extensionAttributes?"".concat(o).concat(e.extensionAttributes):"").concat(this.eol))).join("")}printSetup(e){return void 0===e?"":"a=setup:".concat(e).concat(this.eol)}printUnrecognized(e){return e.map((e=>"a=".concat(e.attField).concat(e.attValue?":".concat(e.attValue):"").concat(this.eol))).join("")}}class A extends I{print(e){let t="";return t+=this.printGroups(e.groups),t+=this.printMsidSemantic(e.msidSemantic),t+=this.printIceLite(e.iceLite),t+=this.printIceUfrag(e.iceUfrag),t+=this.printIcePwd(e.icePwd),t+=this.printIceOptions(e.iceOptions),t+=this.printFingerprints(e.fingerprints),t+=this.printSetup(e.setup),t+=this.printTlsId(e.tlsId),t+=this.printIdentity(e.identities),t+=this.printExtmap(e.extmaps),t+=this.printUnrecognized(e.unrecognized),t}printGroups(e){let t="";return e.length>0&&(t+=e.map((e=>"a=group:".concat(e.semantic).concat(e.identificationTag.map((e=>"".concat(o).concat(e))).join("")).concat(this.eol))).join("")),t}printIceLite(e){return void 0===e?"":"a=ice-lite"+this.eol}printTlsId(e){return e?"a=tls-id:".concat(e).concat(this.eol):""}printIdentity(e){return 0===e.length?"":e.map((e=>"a=identity:".concat(e.assertionValue).concat(e.extensions.map((e=>"".concat(o).concat(e.name).concat(e.value?"=".concat(e.value):"")))))).join(this.eol)+this.eol}printMsidSemantic(e){if(!e)return"";let t="a=msid-semantic:".concat(e.semantic);return e.applyForAll?t+="".concat(o,"*"):e.identifierList.length>0&&(t+=e.identifierList.map((e=>"".concat(o).concat(e)))),t+this.eol}}class k extends I{print(e){const t=e.attributes;let n="";return n+=this.printRTCP(t.rtcp),n+=this.printIceUfrag(t.iceUfrag),n+=this.printIcePwd(t.icePwd),n+=this.printIceOptions(t.iceOptions),n+=this.printCandidates(t.candidates),n+=this.printRemoteCandidatesList(t.remoteCandidatesList),n+=this.printEndOfCandidates(t.endOfCandidates),n+=this.printFingerprints(t.fingerprints),n+=this.printSetup(t.setup),n+=this.printMid(t.mid),n+=this.printExtmap(t.extmaps),n+=this.printRTPRelated(t),n+=this.printPtime(t.ptime),n+=this.printMaxPtime(t.maxPtime),n+=this.printDirection(t.direction),n+=this.printSSRCGroups(t.ssrcGroups),n+=this.printSSRC(t.ssrcs),n+=this.printRTCPMux(t.rtcpMux),n+=this.printRTCPMuxOnly(t.rtcpMuxOnly),n+=this.printRTCPRsize(t.rtcpRsize),n+=this.printMSId(t.msids),n+=this.printImageattr(t.imageattr),n+=this.printRid(t.rids),n+=this.printSimulcast(t.simulcast),n+=this.printSCTPPort(t.sctpPort),n+=this.printMaxMessageSize(t.maxMessageSize),n+=this.printUnrecognized(t.unrecognized),n}printCandidates(e){return e.map((e=>"a=candidate:".concat(e.foundation).concat(o).concat(e.componentId).concat(o).concat(e.transport).concat(o).concat(e.priority).concat(o).concat(e.connectionAddress).concat(o).concat(e.port).concat(o,"typ").concat(o).concat(e.type).concat(e.relAddr?"".concat(o,"raddr").concat(o).concat(e.relAddr):"").concat(e.relPort?"".concat(o,"rport").concat(o).concat(e.relPort):"").concat(Object.keys(e.extension).map((t=>"".concat(o).concat(t).concat(o).concat(e.extension[t]))).join("")).concat(this.eol))).join("")}printRemoteCandidatesList(e){return e.map((e=>"a=remote-candidates:".concat(e.join(o)).concat(this.eol))).join("")}printEndOfCandidates(e){return void 0===e?"":"a=end-of-candidates"+this.eol}printRTPRelated(e){if(!e.payloads)return"";const t=e.payloads;let n="";n+=e.rtcpFeedbackWildcards.map((e=>this.printRTCPFeedback("*",e))).join("");for(const e of t)n+=this.printRtpMap(e.payloadType,e.rtpMap),n+=this.printFmtp(e.payloadType,e.fmtp),n+=e.rtcpFeedbacks.map((t=>this.printRTCPFeedback(e.payloadType,t))).join("");return n}printFmtp(e,t){if(!t)return"";const n=Object.keys(t.parameters);return 1===n.length&&null===t.parameters[n[0]]?"a=fmtp:".concat(e).concat(o).concat(n[0]).concat(this.eol):"a=fmtp:".concat(e).concat(o).concat(Object.keys(t.parameters).map((e=>"".concat(e,"=").concat(t.parameters[e]))).join(";")).concat(this.eol)}printRtpMap(e,t){return t?"a=rtpmap:".concat(e).concat(o).concat(t.encodingName,"/").concat(t.clockRate).concat(t.encodingParameters?"/".concat(t.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e,t){let n="a=rtcp-fb:".concat(e).concat(o),r=t;return"trr-int"===r.type?n+="ttr-int".concat(o).concat(r.interval):(n+="".concat(r.type),r.parameter&&(n+="".concat(o).concat(r.parameter),r.additional&&(n+="".concat(o).concat(r.additional)))),n+this.eol}printPtime(e){return void 0===e?"":"a=ptime:".concat(e).concat(this.eol)}printMaxPtime(e){return void 0===e?"":"a=maxptime:".concat(e).concat(this.eol)}printDirection(e){return void 0===e?"":"a=".concat(e).concat(this.eol)}printSSRC(e){return e.map((e=>Object.keys(e.attributes).map((t=>"a=ssrc:".concat(e.ssrcId.toString(10)).concat(o).concat(t).concat(e.attributes[t]?":".concat(e.attributes[t]):"").concat(this.eol))).join(""))).join("")}printRTCPMux(e){return void 0===e?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e){return void 0===e?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e){return void 0===e?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e){if(void 0===e)return"";let t="a=rtcp:".concat(e.port);return e.netType&&(t+="".concat(o).concat(e.netType)),e.addressType&&(t+="".concat(o).concat(e.addressType)),e.address&&(t+="".concat(o).concat(e.address)),t+this.eol}printMSId(e){return e.map((e=>"a=msid:".concat(e.id).concat(e.appdata?"".concat(o).concat(e.appdata):"").concat(this.eol))).join("")}printImageattr(e){return e.map((e=>"a=imageattr:".concat(e).concat(this.eol))).join("")}printRid(e){return e.map((e=>{let t="a=rid:".concat(e.id).concat(o).concat(e.direction);return e.payloads&&(t+="".concat(o,"pt=").concat(e.payloads.join(","))),e.params.length>0&&(t+="".concat(o).concat(e.params.map((e=>"depend"===e.type?"depend=".concat(e.rids.join(",")):"".concat(e.type,"=").concat(e.val))).join(";"))),t+this.eol})).join("")}printSimulcast(e){return void 0===e?"":"a=simulcast:".concat(e).concat(this.eol)}printSCTPPort(e){return void 0===e?"":"a=sctp-port:".concat(e).concat(this.eol)}printMaxMessageSize(e){return void 0===e?"":"a=max-message-size:".concat(e).concat(this.eol)}printMid(e){return void 0===e?"":"a=mid:".concat(e).concat(this.eol)}printSSRCGroups(e){return e.map((e=>"a=ssrc-group:".concat(e.semantic).concat(e.ssrcIds.map((e=>"".concat(o).concat(e.toString(10)))).join("")).concat(this.eol))).join("")}}function x(e){return(new E).parse(e)}function L(e,t){return(new O).print(e,t)}}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8)})();var BD=VD.exports;function FD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aR("SVC_MODE");if(aR("ENABLE_SVC"))return function(e){return e in IO}(e)?e:IO.L1T3}function GD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?GD(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const{filterRTX:i,filterVideoFec:o,filterAudioFec:a,filterAudioCodec:s,filterVideoCodec:c}=t,{useXR:l}=n;let d=[],u=[],p=[],h=[],f=!1,m=!1;if(BD.parse(e).mediaDescriptions.forEach((e=>{r&&r!==e.attributes.direction||("video"!==e.media.mediaType||f||(u=e.attributes.payloads,h=e.attributes.extmaps,f=!0),"audio"!==e.media.mediaType||m||(d=e.attributes.payloads,p=e.attributes.extmaps,m=!0))})),!h||0===u.length)throw new Error("Cannot get video capabilities from SDP.");if(!p||0===d.length)throw new Error("Cannot get audio capabilities from SDP.");if(u.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),l&&e.rtcpFeedbacks.push({type:"rrtr"})})),d.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),l&&e.rtcpFeedbacks.push({type:"rrtr"})})),i&&(d=d.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})),u=u.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}))),o&&(u=u.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),a&&(d=d.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),s&&(null==s?void 0:s.length)>0&&(d=d.filter((e=>{var t;return Li(s).call(s,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}))),c&&(null==c?void 0:c.length)>0){const e=u.filter((e=>{var t;return Li(c).call(c,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}));u=e.concat(i?[]:cM(e,u))}const g=aR("UNSUPPORTED_VIDEO_CODEC");return g&&g.length>0&&(u=u.filter((e=>!(e.rtpMap&&Li(g).call(g,e.rtpMap.encodingName.toLowerCase()))))),{audioCodecs:d,videoCodecs:u,audioExtensions:p,videoExtensions:h}}function WD(e){const t=BD.parse(e);let n,r;for(const e of t.mediaDescriptions){if(!n){const t=e.attributes.iceUfrag,r=e.attributes.icePwd;if(!t||!r)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:t,icePwd:r}}if(!r){const t=e.attributes.fingerprints;t.length>0&&(r={fingerprints:t})}}if(!r&&t.attributes.fingerprints.length>0&&(r={fingerprints:t.attributes.fingerprints}),!r||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:r}}function zD(e,t){const n=[],r=e.attributes.ssrcGroups.filter((e=>"FID"===e.semantic)),i=e.attributes.ssrcGroups.find((e=>"SIM"===e.semantic)),o=e.attributes.ssrcs;if(i)i.ssrcIds.forEach((e=>{var i;const o=null===(i=r.find((t=>t.ssrcIds[0]===e)))||void 0===i?void 0:i.ssrcIds[1];n.push({ssrcId:e,rtx:t?o:void 0})}));else if(r.length>0){const e=r[0].ssrcIds[0],i=r[0].ssrcIds[1];n.push({ssrcId:e,rtx:t?i:void 0})}else{if(0===o.length)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:o[0].ssrcId})}return n}function KD(e,t,n){const{cname:r}=e;let i;t?i=YD(t):(i=e.iceParameters.candidates.map((e=>({foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}}))),SR.debug("Using candidates from gateway."));const o={fingerprints:e.dtlsParameters.fingerprints.map((e=>({hashFunction:e.algorithm,fingerprint:e.fingerprint})))},a={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let s;switch(e.dtlsParameters.role){case"server":s="passive";break;case"client":s="active";break;case"auto":s="actpass"}const c=oM(e.rtpCapabilities),l=[];return Array.isArray(n)&&n.length>0&&n.forEach((e=>{l.push({kind:mI.VIDEO,ssrcId:e.v,rtx:e.v_rtx,mslabel:"".concat(e.v,"_").concat(e.a)},{kind:mI.AUDIO,ssrcId:e.a,mslabel:"".concat(e.v,"_").concat(e.a)})})),{dtlsParameters:o,iceParameters:a,candidates:i,rtpCapabilities:c,setup:s,cname:r,preSSRCs:l}}function YD(e){let t=[];return e.ip&&"number"==typeof e.port&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],SR.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),SR.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),t}function JD(e,t,n){const r=[],i=[];return e.forEach((e=>{let{ssrcId:o,rtx:a}=e;const s=AC(8,"track-"),c={ssrcId:o,attributes:HD({label:s,mslabel:n=n||AC(10,""),msid:"".concat(n," ").concat(s)},t&&{cname:t})};if(r.push(c),void 0!==a){const e={ssrcId:a,attributes:HD({label:s,mslabel:n,msid:"".concat(n," ").concat(s)},t&&{cname:t})};r.push(e),i.push({semantic:"FID",ssrcIds:[o,a]})}})),e.length>1&&i.push({semantic:"SIM",ssrcIds:e.map((e=>{let{ssrcId:t}=e;return t}))}),{ssrcs:r,ssrcGroups:i}}function XD(e,t){t instanceof wP&&e.attributes.payloads.forEach((e=>{var n;const r=null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase();if(!r||-1===["opus","pcmu","pcma","g722"].indexOf(r))return;e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.minptime="10",e.fmtp.parameters.useinbandfec="1";const i=t._encoderConfig;i&&"pcmu"!==r&&"pcma"!==r&&"g722"!==r&&(i.bitrate&&!lT()&&(e.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*i.bitrate))),i.sampleRate&&(e.fmtp.parameters.maxplaybackrate="".concat(i.sampleRate),e.fmtp.parameters["sprop-maxcapturerate"]="".concat(i.sampleRate)),i.stereo&&(e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"))}))}function ZD(e){const t=e.attributes.unrecognized.findIndex((e=>"x-google-flag"===e.attField&&"conference"===e.attValue));-1!==t&&e.attributes.unrecognized.splice(t,1)}function QD(e,t){var n;if(!(t instanceof lD&&t._encoderConfig&&-1===t._hints.indexOf(bL.SCREEN_TRACK)))return;const r=t._encoderConfig;nL().supportMinBitrate&&r.bitrateMin&&e.attributes.payloads.forEach((e=>{var t,n;Li(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-min-bitrate"]="".concat(r.bitrateMin))})),nL().supportMinBitrate&&!Li(n=t._hints).call(n,bL.LOW_STREAM)&&r.bitrateMax&&e.attributes.payloads.forEach((e=>{var t,n;Li(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-start-bitrate"]="".concat(aR("X_GOOGLE_START_BITRATE")||Math.floor(r.bitrateMax)))}))}function $D(e){if("video"!==e.media.mediaType)return;const t=tT();if(t.name!==ZS.SAFARI&&t.os!==XS.IOS)return;const n=e.attributes.extmaps.findIndex((e=>/video-orientation/g.test(e.extensionName)));-1!==n&&e.attributes.extmaps.splice(n,1)}function eM(e,t,n){if(!t)return;let r,i;if("video"===e.media.mediaType?(r=n.videoExtensions,i=n.videoCodecs):(r=n.audioExtensions,i=n.audioCodecs),!0===t.twcc){const t=r.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));if(t){e.attributes.extmaps.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"});const n=function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))))))}(i,e.attributes.payloads);n.forEach((e=>{e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))||e.rtcpFeedbacks.push({type:"transport-cc"})}))}}else if(!1===t.twcc){const t=e.attributes.extmaps.findIndex((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}if(!0===t.remb){const t=r.find((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName));if(t){e.attributes.extmaps.find((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"});const n=function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))))))}(i,e.attributes.payloads);n.forEach((e=>{e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))||e.rtcpFeedbacks.push({type:"goog-remb"})}))}}else if(!1===t.remb){const t=e.attributes.extmaps.findIndex((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"goog-remb"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}}function tM(e,t,n){if(lT())return;if("video"!==e.media.mediaType)return;if(!(t instanceof lD))return;if("vp9"!==n&&"vp8"!==n)return;if("vp8"===n&&!aR("SIMULCAST"))return;if("vp9"===n&&aR("ENABLE_SVC"))return;if(void 0===t._scalabilityMode||t._scalabilityMode.numSpatialLayers<=1)return;const r="vp8"===n?2:t._scalabilityMode.numSpatialLayers,i=e.attributes.ssrcs[0],o=e.attributes.ssrcGroups.find((e=>"FID"===e.semantic&&e.ssrcIds[0]===i.ssrcId)),a={semantic:"SIM",ssrcIds:[i.ssrcId]};for(let t=1;t<r;t++)e.attributes.ssrcs.push({ssrcId:i.ssrcId+t,attributes:vC(i.attributes)}),a.ssrcIds.push(i.ssrcId+t),o&&(e.attributes.ssrcs.push({ssrcId:o.ssrcIds[1]+t,attributes:vC(i.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[i.ssrcId+t,o.ssrcIds[1]+t]}));e.attributes.ssrcGroups.unshift(a)}async function nM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendonly"}),n.addTransceiver("audio",{direction:"sendonly"}),n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const r=(await n.createOffer()).sdp,{send:i,recv:o,sendrecv:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=qD(n,e,t,"sendonly"),i=qD(n,e,t,"recvonly"),o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(iM(r,i,"videoExtensions",o,a,s),iM(r,i,"videoCodecs",o,a,s),iM(r,i,"audioExtensions",o,a,s),iM(r,i,"audioCodecs",o,a,s),aR("RAISE_H264_BASELINE_PRIORITY")){const e=s.videoCodecs.findIndex((e=>{var t,n;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"===(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])}));if(-1!==e){const t=s.videoCodecs.findIndex((e=>{var t;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())}));if(t<e){SR.debug("raising H264 baseline profile priority");const n=s.videoCodecs[e];s.videoCodecs.splice(e,1),s.videoCodecs.splice(t,0,n)}-1!==t&&(a.videoCodecs=a.videoCodecs.filter((e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"]))}))),-1!==t&&aR("FILTER_SEND_H264_BASELINE")&&(o.videoCodecs=o.videoCodecs.filter((e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"]))})))}}return{send:o,recv:a,sendrecv:s}}(e,t,r);try{n.close()}catch(e){}return{send:i,recv:o,sendrecv:a}}function rM(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=qD(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"recvonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(iM(e,t,"videoExtensions",n,r,i),iM(e,t,"videoCodecs",n,r,i),iM(e,t,"audioExtensions",n,r,i),iM(e,t,"audioCodecs",n,r,i),aR("RAISE_H264_BASELINE_PRIORITY")){const e=i.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]));if(-1!==e){const t=i.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()));if(t<e){SR.debug("raising H264 baseline profile priority");const n=i.videoCodecs[e];i.videoCodecs.splice(e,1),i.videoCodecs.splice(t,0,n)}-1!==t&&(r.videoCodecs=r.videoCodecs.filter((e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"]))))}}return{send:n,recv:r,sendrecv:i}}function iM(e,t,n,r,i,o){if("videoExtensions"===n||"audioExtensions"===n){const a=[];return e[n].forEach((e=>{t[n].some(((t,n)=>{if(e.entry===t.entry&&e.extensionName===t.extensionName)return a.push(n),!0}))?o[n].push(e):r[n].push(e)})),void t[n].forEach(((e,t)=>{-1===a.indexOf(t)&&i[n].push(e)}))}if("videoCodecs"===n||"audioCodecs"===n){const a=[];return e[n].forEach((e=>{t[n].some(((t,n)=>{if(e.payloadType===t.payloadType&&JSON.stringify(e)===JSON.stringify(t))return a.push(n),!0}))?o[n].push(e):r[n].push(e)})),void t[n].forEach(((e,t)=>{-1===a.indexOf(t)&&i[n].push(e)}))}}function oM(e){const{send:t,recv:n,sendrecv:r}=e;if(!r){if(!t||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:n}}let i,o;return t?(i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i.audioCodecs=[...t.audioCodecs,...r.audioCodecs],i.videoCodecs=[...t.videoCodecs,...r.videoCodecs],i.audioExtensions=[...t.audioExtensions,...r.audioExtensions],i.videoExtensions=[...t.videoExtensions,...r.videoExtensions]):i=r,n?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...n.audioCodecs,...r.audioCodecs],o.videoCodecs=[...n.videoCodecs,...r.videoCodecs],o.audioExtensions=[...n.audioExtensions,...r.audioExtensions],o.videoExtensions=[...n.videoExtensions,...r.videoExtensions]):o=r,{send:i,recv:o}}function aM(e){"audio"===e.media.mediaType&&e.attributes.payloads.filter((e=>{var t;return"opus"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})).forEach((e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"}))}function sM(e,t,n,r){let i=[];if(e===mI.VIDEO){if(aR("H264_PROFILE_LEVEL_ID")&&"h264"===r&&(i=t.videoCodecs.filter((e=>{var t;return Li(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,r)&&e&&e.fmtp&&e.fmtp.parameters["profile-level-id"]===aR("H264_PROFILE_LEVEL_ID")}))),!Array.isArray(i)||0===i.length){let e=[];const o=[],a=[],s=[];if(n.videoCodecs.forEach((t=>{const n=t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"";Li(n).call(n,r)?e.push(t):Li(n).call(n,"vp9")?o.push(t):Li(n).call(n,"vp8")?a.push(t):Li(n).call(n,"h264")&&s.push(t)})),0===e.length){let t="";0!==o.length?(e=o,t="vp9"):0!==a.length?(e=a,t="vp8"):0!==s.length&&(e=s,t="h264"),SR.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(t))}0!==e.length&&(i=t.videoCodecs.filter((t=>e.some((e=>e.payloadType===t.payloadType)))))}if(0===i.length&&(SR.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),i=t.videoCodecs),aR("USE_PUB_RTX")||aR("USE_SUB_RTX")){const e=cM(i,t.videoCodecs);i=[...i,...e]}}else i=t.audioCodecs.filter((e=>{var t;return Li(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,r)})),0===i.length&&(SR.warning("codec ".concat(r," not included in rtpCapabilities, fallback to opus")),i=t.audioCodecs.filter((e=>{var t;return Li(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,"opus")})));return i}function cM(e,t){const n=e.map((e=>e.payloadType.toString()));return t.filter((e=>e.rtpMap&&"rtx"===e.rtpMap.encodingName&&e.fmtp&&e.fmtp.parameters.apt&&Li(n).call(n,e.fmtp&&e.fmtp.parameters.apt)))}async function lM(e,t,n){const r=t.toString(),i=uM(r,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:r});const o=await e.createAnswer();if(!o.sdp)throw new Error("cannot get answer sdp");let a=o.sdp;a=dM(a,n||{}),null==i||i(a||""),await e.setLocalDescription({type:"answer",sdp:a})}function dM(e,t,n){const r=BD.parse(e),{useXR:i}=t;return r.mediaDescriptions.forEach((e=>{var t;e.attributes.mid&&(Array.isArray(n)&&!Li(n).call(n,e.attributes.mid)||("audio"===e.media.mediaType&&aM(e),i&&Li(t=["audio","video"]).call(t,e.media.mediaType)&&e.attributes.payloads.forEach((e=>{-1===e.rtcpFeedbacks.findIndex((e=>"rrtr"===e.type))&&e.rtcpFeedbacks.push({type:"rrtr"})}))))})),BD.print(r)}function uM(e,t,n,r){if(aR("SDP_LOGGING"))return SR.upload("exchanging ".concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{uM(e,"answer","local"===n?"remote":"local",r)}:void 0}function pM(e,t){return typeof aR(e)===t?aR(e):void 0}function hM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hM(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const mM=new Map;class gM extends YT{get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(oI.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(oI.CONNECTION_STATE_CHANGE,e,t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){SR.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,t){super(),jw(this,"store",void 0),jw(this,"joinInfo",void 0),jw(this,"key",void 0),jw(this,"ntpOffset",0),jw(this,"signal",void 0),jw(this,"role",void 0),jw(this,"inChannelInfo",{joinAt:null,duration:0}),jw(this,"spec",void 0),jw(this,"_state","DISCONNECTED"),jw(this,"_statsCollector",void 0),jw(this,"_disconnectedReason",void 0),jw(this,"isSignalRecover",!1),jw(this,"hasChangeBGPAddress",!1),jw(this,"trafficStatsInterval",void 0),jw(this,"networkQualityInterval",void 0),jw(this,"_joinGatewayStartTime",0),jw(this,"_signalTimeout",!1),jw(this,"_clientRoleOptions",void 0),jw(this,"_isProactiveJoin",!1),this.store=e,this.spec=t,this.signal=this.store.useP2P?new jD(fM(fM({},t),{},{retryConfig:t.websocketRetryConfig}),e):new ZI(fM(fM({},t),{},{retryConfig:t.websocketRetryConfig}),e),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}async join(e,t,n){this.store.joinGatewayStart(),"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const r=Date.now();let i=mM.get(e.cname);if(i||(i=new Map,mM.set(e.cname,i)),this._isProactiveJoin=!0,i.has(e.uid)){const t=new GO(LT.UID_CONFLICT);throw LR.joinGateway(e.sid,{lts:r,succ:!1,ec:t.code,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer,signalChannel:"0",preload:e.preload}),this._isProactiveJoin=!1,t}i.set(e.uid,!0),this.joinInfo=e,this.key=t;let o=0;this.joinGatewayStartTime=r;const a=e.proxyServer;try{SR.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(o));const t=e.gatewayAddrs.map((t=>{let{address:n}=t;const[r,i]=n.split(":"),o={host:r,port:i};return e.proxyServer&&(o.proxy=e.proxyServer),o}));o=(await this.signal.init(t,n)).uid,SR.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(o," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(t){var s;throw SR.error("[".concat(this.store.clientId,"] User join failed"),t.toString()),LR.joinGateway(e.sid,{lts:r,succ:!1,ec:(null===(s=t.data)||void 0===s?void 0:s.desc)||t.code,errorMsg:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!a,signalChannel:"0",preload:e.preload}),this._isProactiveJoin=!1,i.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),SR.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval((()=>{this.updateTrafficStats().catch((e=>{SR.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString())}))}),3e3),this.networkQualityInterval=window.setInterval((()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(oI.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(oI.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(oI.NETWORK_QUALITY,{uplinkNetworkQuality:oA(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:oA(this._statsCollector.trafficStats.B_dnq)}):this.emit(oI.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3),this.store.joinGatewayEnd(),o}async leave(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if("DISCONNECTED"!==this.state){t!==tC.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==DO.CONNECTED||await function(e,t){return Ih.race([e,OC(3e3)])}(this.signal.request(UO.LEAVE,void 0,!0))}catch(e){SR.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),e)}this.signal.close(t),t!==tC.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const r={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:aR("PUB_EXTEND"),twcc:!!aR("PUBLISH_TWCC"),rtx:!!aR("USE_PUB_RTX")};try{return(await this.signal.request(UO.PUBLISH,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===PO.ERR_PUBLISH_REQUEST_INVALID)return SR.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),r.toString()),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw r}}async publishDataChannel(e,t,n){var r;if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const i={stream_id:t.streamId,ordered:t.ordered?1:0,max_retrans_times:null!==(r=t.maxRetransmits)&&void 0!==r?r:10,channel_id:t.channelId,metadata:t.metadata};try{await this.signal.request(UO.PUBLISH_DATASTREAM,i,!0)}catch(r){if(n&&r.data&&r.data.code===PO.ERR_PUBLISH_REQUEST_INVALID)return SR.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),r.toString()),await this.tryUnpubDataChannelBeforeRepub(e,t),this.publishDataChannel(e,t,!1);throw r}}async unpublish(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(UO.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(e){SR.warning("[".concat(this.store.clientId,"] unpublish warning: "),e)}}async unpublishDataChannel(e){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ih.all(e.map((e=>this.signal.request(UO.UNPUBLISH_DATASTREAM,{channel_id:e},!0))))}catch(e){SR.warning("unpublish datachannels warning: ",e)}}async presubscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!aR("SUBSCRIBE_TWCC"),rtx:!!aR("USE_SUB_RTX")||void 0,extend:aR("SUB_EXTEND"),svc:Array.isArray(aR("SVC"))&&0!==aR("SVC").length?aR("SVC"):void 0};try{return await this.signal.request(UO.PRE_SUBSCRIBE,r,!0)}catch(r){if(n&&r.data&&r.data.code===PO.ERR_SUBSCRIBE_REQUEST_INVALID)return SR.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),r.toString()),this.presubscribe(e,t,!1);throw r}}async subscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!aR("SUBSCRIBE_TWCC"),rtx:!!aR("USE_SUB_RTX"),extend:aR("SUB_EXTEND"),ssrcId:t.ssrcId,svc:Array.isArray(aR("SVC"))&&0!==aR("SVC").length?aR("SVC"):void 0};try{return(await this.signal.request(UO.SUBSCRIBE,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===PO.ERR_SUBSCRIBE_REQUEST_INVALID)return SR.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),r.toString()),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw r}}async subscribeDataChannel(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const r={uid:e,stream_id:t.id,channel_id:t.datachannelId};try{return void await this.signal.request(UO.SUBSCRIBE_DATASTREAM,r,!0)}catch(r){if(n&&r.data&&r.data.code===PO.ERR_SUBSCRIBE_REQUEST_INVALID)return SR.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),r.toString()),await this.tryUnsubDataChannelBeforeResub(e,t),await this.subscribeDataChannel(e,t,!1);throw r}}async subscribeAll(e,t){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const n={p2p_id:this.store.p2pId,users:e,dtx:!1,rtx:!!aR("USE_SUB_RTX"),twcc:!!aR("SUBSCRIBE_TWCC"),svc:Array.isArray(aR("SVC"))&&0!==aR("SVC").length?aR("SVC"):void 0};try{return await this.signal.request(UO.SUBSCRIBE_STREAMS,n,!0)}catch(n){if(t&&n.data&&n.data.code===PO.ERR_SUBSCRIBE_REQUEST_INVALID)return SR.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),n.toString()),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw n}}async setVideoProfile(e){const t=function(e){if(!(e.bitrateMax&&e.bitrateMin&&e.frameRate&&e.height&&e.width))return;let t=e.frameRate,n=e.width,r=e.height,i=!0;return"number"!=typeof t&&(t=t.exact||t.ideal||t.max||t.min||0,t||(i=!1)),"number"!=typeof n&&(n=n.exact||n.ideal||n.max||n.min||0,n||(i=!1)),"number"!=typeof r&&(r=r.exact||r.ideal||r.max||r.min||0,t||(i=!1)),i?{stream_type:0,width:n,height:r,fps:t,start_bps:1e3*e.bitrateMax,min_bps:1e3*e.bitrateMin,target_bps:1e3*e.bitrateMax}:void 0}(e);if(t)return this.signal.request(UO.SET_VIDEO_PROFILE,t);SR.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(e,t){try{await this.signal.request(UO.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(e){SR.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),e)}}async unsubscribeDataChannel(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new GO(LT.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ih.all(e.map((e=>this.signal.request(UO.UNSUBSCRIBE_DATASTREAM,{stream_id:e,uid:t},!0))))}catch(e){SR.warning("unsubscribeDataChannel warning: ",e)}}async massUnsubscribe(e){try{await this.signal.request(UO.UNSUBSCRIBE_STREAMS,e,!0)}catch(e){SR.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),e)}}async reconnectPC(e){const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=e;return{gatewayEstablishParams:await this.signal.request(UO.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(UO.GATEWAY_INFO)}async renewToken(e){await this.signal.request(UO.RENEW_TOKEN,e),this.key=e.token}async setClientRole(e,t){if(t&&(this._clientRoleOptions=Object.assign({},t)),"CONNECTED"!==this.state)return void(this.role=e);let n,r=0;"audience"===e?this._clientRoleOptions&&this._clientRoleOptions.delay?(n=this._clientRoleOptions.delay,r=1):r=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:r=0,await this.signal.request(UO.SET_CLIENT_ROLE,{role:e,level:r,delay:n,client_ts:Date.now()}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(UO.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(UO.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,t){await this.signal.request(UO.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(UO.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}async setRTM2Flag(e){await this.signal.request(UO.SET_RTM2_FLAG,{rtm2_flag:e})}async sendExtensionMessage(e,t,n){if(this.signal instanceof jD)return this.signal.sendExtensionMessage(e,t,n)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),fM({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(UO.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=mM.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){let t;return t=e.startsWith("dc")?e.match(/(dc\:\/\/)?([^:]+):(\d+)/):e.match(/(wss\:\/\/)?([^:]+):(\d+)/),t?{username:PR.username,password:PR.password,turnServerURL:t[2],tcpport:parseInt(t[3])+30,udpport:parseInt(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(fM(fM({},PR),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if("CONNECTED"!==this.state)return;const e=await this.signal.request(UO.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),null!=e.ntp_offset&&(this.ntpOffset=e.ntp_offset),e.peer_delay.forEach((e=>{const t=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find((t=>t.peer_uid===e.peer_uid));t&&t.B_st!==e.B_st&&gC((()=>{this.emit(oI.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)}))})),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new GO(LT.UNEXPECTED_ERROR,"can not generate join message, no join info");const t=Object.assign({},this.joinInfo.apResponse);let n=aR("REPORT_APP_SCENARIO");if("string"!=typeof n)try{n=JSON.stringify(n)}catch(e){n=void 0}n&&n.length>128&&(n=void 0);const r=!(lT()||pT(87)||iL())&&"boolean"==typeof aR("ENABLE_PRE_SUB")&&aR("ENABLE_PRE_SUB"),i=!iL()&&pM("ENABLE_PREALLOC_PC","boolean"),o=fM({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:$C,browser:navigator.userAgent,process_id:aR("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:t,extend:aR("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:n,attributes:{userAttributes:{enablePublishedUserList:aR("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:aR("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:"number"==typeof aR("SUBSCRIBE_AUDIO_FILTER_TOPN")?aR("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:"boolean"==typeof aR("ENABLE_PUBLISH_AUDIO_FILTER")?aR("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:"boolean"==typeof aR("ENABLE_USER_LICENSE_CHECK")?aR("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:!0===aR("USE_PUB_RTX")||!0===aR("USE_SUB_RTX")||void 0,disableFEC:aR("DISABLE_FEC"),enableNTPReport:!!aR("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!aR("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!aR("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:pM("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!aR("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:"number"==typeof this.joinInfo.rtmFlag?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!aR("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:pM("USE_XR","boolean"),enableLossbasedBwe:pM("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!aR("ENABLE_AUT_CC")||void 0,enableCCFallback:pM("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:i,preSubNum:r?pM("PRE_SUB_NUM","number"):void 0,enablePubTWCC:pM("PUBLISH_TWCC","boolean"),enableSubTWCC:pM("SUBSCRIBE_TWCC","boolean"),enablePubRTX:pM("USE_PUB_RTX","boolean"),enableSubRTX:pM("USE_SUB_RTX","boolean"),enableSubSVC:aR("ENABLE_SVC")?aR("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(aR("SVC"))&&0!==aR("SVC").length?aR("SVC"):void 0}},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(o.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(o.aes_mode=this.joinInfo.aesmode,aR("ENCRYPT_AES")?(o.aes_secret=this.joinInfo.aespassword,o.aes_encrypt=!0):o.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(o.aes_salt=this.joinInfo.aessalt)),t.addresses[this.signal.websocket.currentURLIndex]&&(o.ap_response.ticket=t.addresses[this.signal.websocket.currentURLIndex].ticket,delete t.addresses),void 0!==this.joinInfo.defaultVideoStream&&(o.default_video_stream=this.joinInfo.defaultVideoStream),o}getRejoinMessage(){if(!this.joinInfo)throw new GO(LT.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(MO.WS_RECONNECT_WAITTING_FINISH,(e=>{var t;Li(t=["tryNext","recover"]).call(t,e)&&this.joinInfo&&LR.adjustSessionStartTime(this.joinInfo.sid)})),this.signal.on(MO.WS_RECONNECT_CREATE_CONNECTION,(e=>{this.joinGatewayStartTime=Date.now()})),this.signal.on(MO.WS_RECONNECTING,(e=>{this.joinInfo&&LR.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||aC.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",LR.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:"live"===this.spec.mode?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:"audience"===this.role?2:1,buildFormat:2}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())})),this.signal.on(MO.WS_CLOSED,(e=>{let t;switch(e){case tC.LEAVE:t=aC.LEAVE;break;case tC.UID_BANNED:case tC.IP_BANNED:case tC.CHANNEL_BANNED:case tC.SERVER_ERROR:t=aC.SERVER_ERROR;break;case tC.FALLBACK:t=aC.FALLBACK;break;case tC.LICENSE_MISSING:case tC.LICENSE_EXPIRED:case tC.LICENSE_MINUTES_EXCEEDED:case tC.LICENSE_PERIOD_INVALID:case tC.LICENSE_MULTIPLE_SDK_SERVICE:case tC.LICENSE_ILLEGAL:case tC.TOKEN_EXPIRE:t=e;break;default:t=aC.NETWORK_ERROR}SR.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(t||"undefined -> "+aC.NETWORK_ERROR)),this.joinInfo&&LR.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===tC.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this._disconnectedReason=e,e!==tC.FALLBACK&&(this.state="DISCONNECTED"),this.reset()})),this.signal.on(MO.WS_CONNECTED,(()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&("audience"===this.role&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(SR.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),LR.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&1===this.joinInfo.setLocalAPVersion)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return void SR.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e));oR("EVENT_REPORT_DOMAIN",e[1]),oR("EVENT_REPORT_BACKUP_DOMAIN",e[1]),oR("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}})),this.signal.on(VO.ON_UPLINK_STATS,(e=>{this._statsCollector.updateUplinkStats(e)})),this.signal.on(MO.REQUEST_RECOVER,((e,t,n)=>{if(!this.joinInfo)return n(new GO(LT.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,lC(this,oI.REQUEST_NEW_GATEWAY_LIST).then(t).catch(n)})),this.signal.on(MO.REQUEST_JOIN_INFO,(async e=>{var t;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void e(this.getJoinMessage({ortc:{}}));const{iceParameters:n,dtlsParameters:r,rtpCapabilities:i}=await lC(this,oI.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(t=this.joinInfo)||void 0===t?void 0:t.turnServer});e(this.getJoinMessage({ortc:{iceParameters:n,dtlsParameters:r,rtpCapabilities:i,version:"2"}}))})),this.signal.on(MO.REQUEST_REJOIN_INFO,(e=>{e(this.getRejoinMessage())})),this.signal.on(MO.REPORT_JOIN_GATEWAY,((e,t)=>{if(!this.joinInfo)return;let n,r="";var i;e instanceof GO?(n=(null===(i=e.data)||void 0===i?void 0:i.desc)||e.code,r=e.message):n=e,LR.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:n,errorMsg:r,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload}),this._isProactiveJoin=!1})),this.signal.on(MO.IS_P2P_DISCONNECTED,(e=>{e(pC(this,oI.IS_P2P_DISCONNECTED))})),this.signal.on(MO.DISCONNECT_P2P,(()=>{this.emit(oI.DISCONNECT_P2P)})),this.signal.on(MO.REQUEST_SUCCESS,(()=>{this._signalTimeout=!1})),this.signal.on(MO.REQUEST_TIMEOUT,(()=>{this._signalTimeout=!0})),this.signal.on(MO.JOIN_RESPONSE,(e=>{const t=this.getCurrentGatewayAddress();this.emit(oI.JOIN_RESPONSE,e,t)})),this.signal.on(MO.PRE_CONNECT_PC,(async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const e=this.getCurrentGatewayAddress(),t=aR("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(e&&t){const n=YD(e);this.emit(oI.PRE_CONNECT_PC,{candidates:n,fingerprint:t})}}}))}async tryUnsubBeforeResub(e,t){try{await this.signal.request(UO.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),e),e}}async tryUnsubDataChannelBeforeResub(e,t){try{await this.signal.request(UO.UNSUBSCRIBE,{stream_id:t.id},!0)}catch(e){throw SR.warning("unsubscribe datachannel warning",e),e}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(UO.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),e),e}}async tryUnpubDataChannelBeforeRepub(e,t){try{await this.signal.request(UO.UNPUBLISH_DATASTREAM,{channnel_id:t.channelId},!0)}catch(e){throw SR.warning("unpublish datastream warning: ",e),e}}async tryMassUnsubBeforeResub(e){const t={users:e.map((e=>({stream_id:e.stream_id,stream_type:e.stream_type})))};try{await this.signal.request(UO.UNSUBSCRIBE_STREAMS,t,!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),e),e}}async muteLocal(e,t){const n={action:e.find((e=>e.stream_type===iI.Audio))?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(UO.CONTROL,n,!0,!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),e),e}}async unmuteLocal(e,t){const n={action:e.find((e=>e.stream_type===iI.Audio))?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(UO.CONTROL,n,!0,!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),e),e}}async muteRemote(e,t){const n={action:e===mI.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(UO.CONTROL,n,!0,!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),e),e}}async unmuteRemote(e,t){const n={action:e===mI.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(UO.CONTROL,n,!0,!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),e),e}}uploadWRTCStats(e){this.signal.uploadWRTCStats(e)}upload(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return await this.signal.request(UO.RESTART_ICE,t,!0)}catch(e){throw SR.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),e),e}}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,aC.P2P_FAILED)}getCurrentGatewayAddress(){var e,t;if(!aR("GATEWAY_WSS_ADDRESS"))return aR("USE_CANDIDATE_FROM_AP_DETAIL")&&null!==(e=this.joinInfo)&&void 0!==e&&e.apGatewayAddress?(SR.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):null!==(t=this.joinInfo)&&void 0!==t&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(UO.SET_PARAMETER,{enablePublishAudioFilter:e})}}let vM=0,_M=0;function yM(e,t,n,r){return new Ih(((i,o)=>{t.timeout=t.timeout||aR("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),vM+=CC(t.data)):n&&(t.data.size?vM+=t.data.size:t.data instanceof FormData?vM+=RC(t.data):vM+=CC(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,qS.request(t).then((e=>{"string"==typeof e.data?_M+=CC(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?_M+=e.data.byteLength:_M+=CC(JSON.stringify(e.data)),r&&i({data:e.data,headers:e.headers}),i(e.data)})).catch((e=>{qS.isCancel(e)?o(new GO(LT.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new GO(LT.NETWORK_TIMEOUT,e.message)):e.response?o(new GO(LT.NETWORK_RESPONSE_ERROR,e.response.status)):o(new GO(LT.NETWORK_ERROR,e.message))}))}))}!function(){var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof se&&se];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}if(o("Symbol",(function(e){function t(e,t){this.A=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var s=i[n[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return e})),"function"==typeof Object.setPrototypeOf)n=Object.setPrototypeOf;else{var c;e:{var l={};try{l.__proto__={a:!0},c=l.a;break e}catch(e){}c=!1}n=c?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=n;function u(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function p(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function h(e,t){return e.h=3,{value:t}}function f(e){this.g=new u,this.G=e}function m(e,t,n,r){try{var i=t.call(e.g.j,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.m=!1,i;var o=i.value}catch(t){return e.g.j=null,e.g.s(t),g(e)}return e.g.j=null,r.call(e.g,o),g(e)}function g(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function v(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){p(e.g);var n=e.g.j;return n?m(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),g(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function _(e,t){return t=new v(new f(t)),d&&e.prototype&&d(t,e.prototype),t}if(u.prototype.o=function(e){this.v=e},u.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},u.prototype.return=function(e){this.l={return:e},this.h=this.u},f.prototype.o=function(e){return p(this.g),this.g.j?m(this,this.g.j.next,e,this.g.o):(this.g.o(e),g(this))},f.prototype.s=function(e){return p(this.g),this.g.j?m(this,this.g.j.throw,e,this.g.o):(this.g.s(e),g(this))},o("Array.prototype.entries",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return[e,t]}))}})),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var y=function(e,t){for(var n=0;n<e.length;n++)t(e[n])},w=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},b=function(e,t,n){return t instanceof Blob?(n=void 0!==n?String(n+""):"string"==typeof t.name?t.name:"blob",t.name===n&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],n)),[String(e),t]):[String(e),String(t)]},E=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},S="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,T=S.FormData,C=S.XMLHttpRequest&&S.XMLHttpRequest.prototype.send,R=S.Request&&S.fetch,O=S.navigator&&S.navigator.sendBeacon,I=S.Element&&S.Element.prototype,A=S.Symbol&&Symbol.toStringTag;A&&(Blob.prototype[A]||(Blob.prototype[A]="Blob"),"File"in S&&!File.prototype[A]&&(File.prototype[A]="File"));try{new File([],"")}catch(e){S.File=function(e,t,n){return e=new Blob(e,n||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(n&&void 0!==n.lastModified?new Date(n.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),A&&Object.defineProperty(e,A,{value:"File"}),e}}var k=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},x=function(e){this.i=[];var t=this;e&&y(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var n=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];y(n,(function(n){t.append(e.name,n)}))}else"select-multiple"===e.type||"select-one"===e.type?y(e.options,(function(n){!n.disabled&&n.selected&&t.append(e.name,n.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(n="textarea"===e.type?w(e.value):e.value,t.append(e.name,n))}))};if((e=x.prototype).append=function(e,t,n){E(arguments,2),this.i.push(b(e,t,n))},e.delete=function(e){E(arguments,1);var t=[];e=String(e),y(this.i,(function(n){n[0]!==e&&t.push(n)})),this.i=t},e.entries=function e(){var t,n=this;return _(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<n.i.length?e=h(e,n.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},e.forEach=function(e,t){E(arguments,1);for(var n=s(this),r=n.next();!r.done;r=n.next()){var i=s(r.value);r=i.next().value,i=i.next().value,e.call(t,i,r,this)}},e.get=function(e){E(arguments,1);var t=this.i;e=String(e);for(var n=0;n<t.length;n++)if(t[n][0]===e)return t[n][1];return null},e.getAll=function(e){E(arguments,1);var t=[];return e=String(e),y(this.i,(function(n){n[0]===e&&t.push(n[1])})),t},e.has=function(e){E(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},e.keys=function e(){var t,n,r,i=this;return _(e,(function(e){if(1==e.h&&(t=s(i),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,h(e,s(r).next().value));n=t.next(),e.h=2}))},e.set=function(e,t,n){E(arguments,2),e=String(e);var r=[],i=b(e,t,n),o=!0;y(this.i,(function(t){t[0]===e?o&&(o=!r.push(i)):r.push(t)})),o&&r.push(i),this.i=r},e.values=function e(){var t,n,r,i,o=this;return _(e,(function(e){if(1==e.h&&(t=s(o),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,(i=s(r)).next(),h(e,i.next().value));n=t.next(),e.h=2}))},x.prototype._asNative=function(){for(var e=new T,t=s(this),n=t.next();!n.done;n=t.next()){var r=s(n.value);n=r.next().value,r=r.next().value,e.append(n,r)}return e},x.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],n="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,r){return"string"==typeof e?t.push(n+k(w(r))+'"\r\n\r\n'+w(e)+"\r\n"):t.push(n+k(w(r))+'"; filename="'+k(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},x.prototype[Symbol.iterator]=function(){return this.entries()},x.prototype.toString=function(){return"[object FormData]"},I&&!I.matches&&(I.matches=I.matchesSelector||I.mozMatchesSelector||I.msMatchesSelector||I.oMatchesSelector||I.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),A&&(x.prototype[A]="FormData"),C){var L=S.XMLHttpRequest.prototype.setRequestHeader;S.XMLHttpRequest.prototype.setRequestHeader=function(e,t){L.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},S.XMLHttpRequest.prototype.send=function(e){e instanceof x?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),C.call(this,e)):C.call(this,e)}}R&&(S.fetch=function(e,t){return t&&t.body&&t.body instanceof x&&(t.body=t.body._blob()),R.call(this,e,t)}),O&&(S.navigator.sendBeacon=function(e,t){return t instanceof x&&(t=t._asNative()),O.call(this,e,t)}),S.FormData=x}}();const wM=()=>{const e=aR("AREAS");return 0===e.length&&e.push(cI.GLOBAL),Ji(e).call(e,((e,t,n)=>{const r=bM(t);return r?0===n?r:"".concat(e,",").concat(r):e}),"")},bM=e=>e===cI.OVERSEA?"".concat(dI.ASIA,",").concat(dI.EUROPE,",").concat(dI.AFRICA,",").concat(dI.NORTH_AMERICA,",").concat(dI.SOUTH_AMERICA,",").concat(dI.OCEANIA):dI[e],EM=e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map((e=>{const n=uI[e],r=Object.keys(n);r&&r.map((e=>{"CODE"!==e&&(t[e]=t[e].concat(n[e]))}))})),t},SM={GLOBAL:{ASIA:[cI.CHINA,cI.JAPAN,cI.INDIA,cI.KOREA,cI.HKMC],EUROPE:[],NORTH_AMERICA:[cI.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},TM=Object.keys(SM[cI.GLOBAL]),CM=[cI.CHINA,cI.NORTH_AMERICA,cI.EUROPE,cI.ASIA,cI.JAPAN,cI.INDIA,cI.OCEANIA,cI.SOUTH_AMERICA,cI.AFRICA,cI.KOREA,cI.HKMC,cI.US],RM=function(e,t){let n=[];if(Li(e).call(e,cI.GLOBAL)){const o=[cI.GLOBAL,cI.OVERSEA],a=Object.keys(uI);if(t===cI.GLOBAL)throw new GO(LT.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===cI.CHINA)n=[cI.OVERSEA];else if(i=t,Li(TM).call(TM,i)){const e=(r=t,SM[cI.GLOBAL][r]||[]),i=[...o,t,...e];n=a.filter((e=>!Li(i).call(i,e)))}else if(function(e){let t=!1;return TM.forEach((n=>{var r;Li(r=SM[cI.GLOBAL][n]).call(r,e)&&(t=!0)})),t}(t)){const e=function(e){let t;return TM.forEach((n=>{var r;Li(r=SM[cI.GLOBAL][n]).call(r,e)&&(t=n)})),t}(t),r=[...o,e,t];n=a.filter((e=>!Li(r).call(r,e)))}else n=e;n=function(e){const t=[];return CM.forEach((n=>{Li(e).call(e,n)&&t.push(n)})),t.concat(e.filter((e=>!Li(CM).call(CM,e))))}(n)}else n=e;var r,i;return n};function OM(e){var t,n;if(!e&&Li(t=aR("AREAS")).call(t,cI.EXTENSIONS))return SR.debug("update area from ap : reset"),void IM(NR,!0);if(!Li(n=aR("AREAS")).call(n,cI.GLOBAL)||!e)return;let r=uI.EXTENSIONS;r&&(r={CODE:bM(cI.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},SR.debug("update area from ap success: ".concat(e,",config is "),r),oR("AREAS",[cI.EXTENSIONS],!0),Object.keys(r).map((e=>{oR(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?r[e][0]:r[e])})))}function IM(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=LR.reportApiInvoke(null,{name:ZT.SET_AREA,options:e,tag:QT.TRACER});try{let r=[];if("string"==typeof e&&(r=[e]),Array.isArray(e)&&(e.forEach((e=>{if(!Li(lI).call(lI,e))throw new GO(LT.INVALID_PARAMS,"invalid area code")})),r=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:t,excludedArea:n}=e;if(!t)throw new GO(LT.INVALID_PARAMS,"area code is needed");let i=t;"string"==typeof t&&(i=[t]),r=n?RM(i,n):i}if(!t){if(sR.AREAS){const e=new GO(LT.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return n.onError(e),void SR.warning("setArea is prohibited because of config-distribute")}if(Li(r).call(r,cI.GLOBAL)&&aR("AREAS")===cI.EXTENSIONS){const e=new GO(LT.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return n.onError(e),void SR.warning("setArea is prohibited because of ap extensions")}}oR("AREAS",r,t);const i=EM(r);Object.keys(i).map((e=>{oR(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?i[e][0]:i[e])})),SR.debug("set area success:",r.join(","))}catch(e){throw n.onError(e),e}n.onSuccess()}function AM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AM(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let xM=1;let LM=1;function NM(e,t,n,r){let{url:i,areaCode:o}=e;const{clientId:a,sid:s}=t,c=Date.now();let l;const[d,u]=UM(t,o,[QI.CHOOSE_SERVER]);let p=hC.networkState;return WC((async()=>{p&&hC.networkState===sC.OFFLINE&&hC.onlineWaiter&&await Ih.race([hC.onlineWaiter,IC(r&&r.maxRetryTimeout||HC.maxRetryTimeout)]),p=hC.networkState;const{data:e,headers:o}=await yM(i,{data:d,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l="1"===o.http3?1:-1,LR.reportResourceTiming(i,s),DM(e,i,t,c,[QI.CHOOSE_SERVER],l);const a=aA(e,QI.CHOOSE_SERVER);return MM(a),nA(a,i)}),(e=>(e&&LR.joinChooseServer(s,{lts:c,succ:!0,csAddr:i,opid:u,serverList:e.gatewayAddrs.map((e=>e.address)),ec:null,cid:e.cid.toString(),uid:e.uid.toString(),csIp:e.csIp,unilbsServerIds:[QI.CHOOSE_SERVER].toString(),isHttp3:l}),!1)),(e=>e.code!==LT.OPERATION_ABORTED&&(e.code===LT.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(LR.joinChooseServer(s,{lts:c,succ:!1,csAddr:i,serverList:null,opid:u,ec:e.code,csIp:e.data&&e.data.csIp,unilbsServerIds:[QI.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:p}),isHttp3:l}),SR.warning("[".concat(a||"sid-".concat(s.slice(0,6)),"] Choose server network error, retry"),e),!0))),r)}function PM(e,t,n,r){let i,{url:o,areaCode:a,serviceIds:s}=e;const c=Date.now(),[l,d]=UM(t,a,s);let u;return WC((async()=>{u&&hC.networkState===sC.OFFLINE&&hC.onlineWaiter&&await Ih.race([hC.onlineWaiter,IC(r&&r.maxRetryTimeout||HC.maxRetryTimeout)]),u=hC.networkState;const{data:e,headers:a}=await yM(o,{data:l,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);i="1"===a.http3?1:-1,LR.reportResourceTiming(o,t.sid),DM(e,o,t,c,s,i);const d=aA(e,QI.CHOOSE_SERVER),p=aA(e,"proxy5"===t.cloudProxyServer?QI.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?QI.CLOUD_PROXY:QI.CLOUD_PROXY_FALLBACK);return MM(d),{gatewayInfo:nA(d,o),proxyInfo:p,url:o}}),(e=>(e.gatewayInfo&&LR.joinChooseServer(t.sid,{lts:c,succ:!0,csAddr:o,serverList:e.gatewayInfo.gatewayAddrs.map((e=>e.address)),ec:null,opid:d,cid:e.gatewayInfo.cid.toString(),uid:e.gatewayInfo.uid.toString(),csIp:e.gatewayInfo.csIp,unilbsServerIds:s.toString(),isHttp3:i}),e.proxyInfo&&LR.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:o,turnServerAddrList:e.proxyInfo.addresses.map((e=>e.ip)).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:s.toString()}),!1)),(e=>e.code!==LT.OPERATION_ABORTED&&(e.code===LT.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(LR.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer,unilbsServerIds:s.toString(),extend:JSON.stringify({networkState:u})}),SR.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),e),!0))),r)}const DM=(e,t,n,r,i,o)=>{const{sid:a,clientId:s,cloudProxyServer:c}=n,l=[],d=n=>{4096===n.flag?LR.joinChooseServer(a,{lts:r,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:n.error.message,csIp:n.error.data&&n.error.data.csIp,unilbsServerIds:i.toString(),isHttp3:o}):1048576!==n.flag&&4194304!==n.flag&&4194310!==n.flag||LR.joinWebProxyAP(a,{lts:r,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:n.error.code,eventType:c,unilbsServerIds:i.toString()})};if(e.response_body.forEach((t=>{const n=t.buffer.code;if(23===t.uri&&0===n&&!t.buffer.edges_services)if(4194310===t.buffer.flag)SR.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),t.buffer.edges_services=[];else{const n={error:new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:t.buffer.flag};l.push(n),d(n)}if(0!==n){const r=PI(n),i={error:new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,r.desc,{desc:r.desc,retry:r.retry,csIp:e.detail[502]}),flag:t.buffer.flag};4194310===t.buffer.flag?SR.warning(i.error.toString()):l.push(i),d(i)}})),l.length)throw SR.warning("[".concat(s||"sid-".concat(a.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(l.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message,", retry: ").concat(e.error.data.retry))).join(" | "))),new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,l.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message))).join(" | "),{retry:!!l.find((e=>e.error.data.retry)),csIp:e.detail[502],desc:[...new Set(l.map((e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc})).filter((e=>!!e)))]})},MM=e=>{var t,n,r,i;if(e.addresses&&0===e.addresses.length&&0===e.code)throw new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(aR("AP_AREA")&&(null!==(r=e.detail)&&void 0!==r&&r[23]&&"string"==typeof(null===(i=e.detail)||void 0===i?void 0:i[23])?OM(e.detail[23].toLowerCase()):OM()),null!==(t=e.detail)&&void 0!==t&&t[19]&&"string"==typeof(null===(n=e.detail)||void 0===n?void 0:n[19])){const t=e.detail[19],n=null==t?void 0:t.split(";");for(let t=0;t<n.length;t++){var o;const r=Of(o=n[t]).call(o);e.addresses[t]&&n&&(e.addresses[t].fingerprint=r)}}if(aR("GATEWAY_ADDRESS")&&aR("GATEWAY_ADDRESS").length>0){SR.debug("assign gateway address to",aR("GATEWAY_ADDRESS"));const t=aR("GATEWAY_ADDRESS").map((t=>{var n,r;const i=null!==(n=null===(r=e.addresses.find((e=>e.ip===t.ip&&e.port===t.port)))||void 0===r?void 0:r.fingerprint)&&void 0!==n?n:"";return{ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:i}}));e.addresses=t}},UM=(e,t,n)=>{const r=Math.floor(Math.random()*10**12),i={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:kM({6:e.stringUid,11:t,12:aR("USE_NEW_TOKEN")?"1":void 0,22:t},e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:n,uid:e.uid||0}}]};i.request_bodies.forEach((t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))}));const o=new FormData;return o.append("request",JSON.stringify(i)),[o,r]};let jM=0;function VM(e){return Ih.all(e.map((e=>e.then((e=>{throw e}),(e=>e))))).then((e=>{throw e}),(e=>e))}const BM=async e=>{let{fragementLength:t,referenceList:n,asyncMapHandler:r,allFailedhandler:i,promisesCollector:o}=e,a=0;const s=t;let c,l=0;const d=async()=>{const e=(()=>{const e=a*s,t=e+s;return n.slice(e,t).map(r)})();o&&o.push(...e);try{c=await VM(e)}catch(e){if(l+=s,a++,!(l>=n.length))return void await d();i(e)}e.forEach((e=>e.cancel()))};return await d(),c},FM=async e=>{let{referenceList:t,asyncMapHandler:n,closeFn:r}=e;const i=t.length;let o=0;const a=async()=>{const e=n(t.shift());try{return await e}catch(e){if(o++,o>=i||null!=r&&r(e))throw e;return a()}};return a()};async function GM(e,t,n,r){const i=async function(e,t,n,r){let i=null;const o=[],a=async()=>{const i=aR("WEBCS_DOMAIN").slice(0,aR("AJAX_REQUEST_CONCURRENT")).map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:wM()}))),a=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map((e=>e.url))}),s=await BM({fragementLength:aR("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(SR.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),NM(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:o});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),s},s=async()=>{if(await IC(1e3),null!==i)return i;const a=aR("WEBCS_DOMAIN_BACKUP_LIST").map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:wM()}))),s=r.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:a.map((e=>e.url))}),c=await BM({fragementLength:aR("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:r=>(SR.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),NM(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:o});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},s),c};try{return i=await VM([a(),s()]),o.length&&o.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),i}catch(e){throw e[0]}}(e,t,n,r);return{gatewayInfo:await i}}async function HM(e,t,n,r,i){const o=e.cloudProxyServer;if("disabled"===o){if(!r)return;if(e.useLocalAccessPoint)return await GM(e,t,n,i);if(aR("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:r,proxyInfo:o}=await KM(e,t,n,i);if(e.turnServer&&"auto"!==e.turnServer.mode)return{gatewayInfo:r};const s=o.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||PR.tcpport,udpport:e.udpport||PR.udpport,username:e.username||PR.username,password:e.password||PR.password,forceturn:!1,security:!0})));if(i.useP2P){var a;const t=null!==(a=e.uid)&&void 0!==a?a:r.uid,n="glb:".concat(t.toString()),i=await KT(n),c=o.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||PR.tcpport,udpport:e.udpport||PR.udpport,username:n,password:i,forceturn:!1,security:!0})));s.push(...c)}return e.turnServer={mode:"manual",servers:s},{gatewayInfo:r}}return await GM(e,t,n,i)}const{proxyInfo:s,gatewayInfo:c}=await KM(e,t,n,i),l={gatewayInfo:c},d=s.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport?e.tcpport:PR.tcpport,udpport:"proxy4"===o?void 0:e.udpport?e.udpport:PR.udpport,username:e.username||PR.username,password:e.password||PR.password,forceturn:"proxy4"!==o,security:"proxy5"===o})));if(i.useP2P){var u;const t=null!==(u=e.uid)&&void 0!==u?u:c.uid,n="glb:".concat(t.toString()),r=await KT(n),i=s.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport||PR.tcpport,udpport:"proxy4"===o?void 0:e.udpport||PR.udpport,username:n,password:r,forceturn:"proxy4"!==o,security:"proxy5"===o})));d.push(...i)}return e.turnServer={mode:"manual",servers:d},SR.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(o)),l}async function qM(e,t,n,r,i){const o=aR("ACCOUNT_REGISTER").slice(0,aR("AJAX_REQUEST_CONCURRENT"));let a=[];a=t.proxyServer?o.map((e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1"))):o.map((e=>"https://".concat(e,"/api/v1")));const s=null==i?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:a});try{const o=await async function(e,t,n,r,i){const o=Date.now(),a={sid:n.sid,opid:10,appid:n.appId,string_uid:t};let s=e[0];const c=await WC((()=>yM(s+"".concat(-1===s.indexOf("?")?"?":"&","action=stringuid"),{data:a,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}})),((n,r)=>{if(0===n.code){if(n.uid<=0||n.uid>=Math.pow(2,32))throw SR.error("Invalid Uint Uid ".concat(t," => ").concat(n.uid),n),LR.reqUserAccount(a.sid,{lts:o,success:!1,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:LT.INVALID_UINT_UID_FROM_STRING_UID,extend:a}),new GO(LT.INVALID_UINT_UID_FROM_STRING_UID);return LR.reqUserAccount(a.sid,{lts:o,success:!0,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:null,extend:a}),!1}const i=PI(n.code);return i.retry&&(s=e[(r+1)%e.length]),LR.reqUserAccount(a.sid,{lts:o,success:!1,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:i.desc,extend:a}),i.retry}),((t,n)=>t.code!==LT.OPERATION_ABORTED&&(LR.reqUserAccount(a.sid,{lts:o,success:!1,serverAddr:s,stringUid:a.string_uid,uid:null,errorCode:t.code,extend:a}),s=e[(n+1)%e.length],!0)),i);if(0!==c.code){const e=PI(c.code);throw new GO(LT.UNEXPECTED_RESPONSE,e.desc)}return c}(a,e,t,n,r);return null==i||i.recordJoinChannelService({status:"success",endTs:Date.now()},s),o.uid}catch(e){throw null==i||i.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[e]},s),e}}async function WM(e,t,n){const r=aR("ACCOUNT_REGISTER");let i=[];i=t.proxyServer?r.map((e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1"))):r.map((e=>"https://".concat(e,"/api/v1")));try{const r=await FM({referenceList:i,asyncMapHandler:r=>async function(e,t,n,r){const i=Date.now(),o={sid:n.sid,opid:10,appid:n.appId,string_uid:t};try{const t=await yM(e+"".concat(-1===e.indexOf("?")?"?":"&","action=stringuid"),{data:o,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(0!==t.code){const e=PI(t.code);throw new GO(LT.UNEXPECTED_RESPONSE,"preload sua error:".concat(e.desc),e)}if(t.uid<=0||t.uid>=Math.pow(2,32))throw new GO(LT.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:i,url:e,req:o,uid:t.uid,elapse:Date.now()-i}}catch(e){throw e}}(r,e,t,n),closeFn:e=>e.code===LT.OPERATION_ABORTED||e.code===LT.UNEXPECTED_RESPONSE&&!e.data.retry});return r}catch(e){throw e}}async function zM(e,t){const n=aR("WEBCS_DOMAIN").concat(aR("WEBCS_DOMAIN_BACKUP_LIST")).map((e=>({url:"https://".concat(e,"/api/v2/transpond/webrtc?v=2"),areaCode:wM(),serviceIds:[QI.CHOOSE_SERVER,QI.CLOUD_PROXY_FALLBACK]})));try{const r=await FM({referenceList:n,asyncMapHandler:n=>async function(e,t,n){let r,{url:i,areaCode:o,serviceIds:a}=e;const s=Date.now(),[c,l]=UM(t,o,a);let d=hC.networkState;try{d&&hC.networkState===sC.OFFLINE&&hC.onlineWaiter&&await Ih.race([hC.onlineWaiter,IC(HC.maxRetryTimeout)]),d=hC.networkState;const{data:e,headers:t}=await yM(i,{data:c,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);r="1"===t.http3?1:-1;const o=e=>{const t=[];if(e.response_body.forEach((n=>{const r=n.buffer.code;if(23===n.uri&&0===r&&!n.buffer.edges_services)if(4194310===n.buffer.flag)n.buffer.edges_services=[];else{const r={error:new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:n.buffer.flag};t.push(r)}if(0!==r){const i=PI(r),o={error:new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,i.desc,{desc:i.desc,retry:i.retry,csIp:e.detail[502]}),flag:n.buffer.flag};4194310===n.buffer.flag?SR.warning(o.error.toString()):t.push(o)}})),t.length)throw new GO(LT.CAN_NOT_GET_GATEWAY_SERVER,t.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message))).join(" | "),{retry:!!t.find((e=>e.error.data.retry)),csIp:e.detail[502],desc:[...new Set(t.map((e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc})).filter((e=>!!e)))]})};o(e);const a=aA(e,QI.CHOOSE_SERVER),u=aA(e,QI.CLOUD_PROXY_FALLBACK);return MM(a),{gatewayInfo:nA(a,i),proxyInfo:u,opid:l,requestTime:s,url:i,isHttp3:r,elapse:Date.now()-s}}catch(e){throw e}}(n,e,t),closeFn:e=>e.code===LT.OPERATION_ABORTED||e.code===LT.CAN_NOT_GET_GATEWAY_SERVER&&!e.data.retry});return r}catch(e){throw e}}async function KM(e,t,n,r){const i=aR("PROXY_SERVER_TYPE3"),o=(e,t,n)=>{let r=n||i;return Array.isArray(r)&&(r=t%2==0?i[1]:i[0]),"https://".concat(r,"/ap/?url=").concat(e)};let a=null;const s=[],c=async()=>{const i=aR("WEBCS_DOMAIN").slice(0,aR("AJAX_REQUEST_CONCURRENT")).map(((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:wM(),serviceIds:[QI.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?QI.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?QI.CLOUD_PROXY:QI.CLOUD_PROXY_FALLBACK]}})),a=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map((e=>e.url))}),c=await BM({fragementLength:aR("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(SR.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),PM(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:s});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),c},l=async()=>{if(await IC(1e3),null!==a)return a;const i=aR("WEBCS_DOMAIN_BACKUP_LIST").map(((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:wM(),serviceIds:[QI.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?QI.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?QI.CLOUD_PROXY:QI.CLOUD_PROXY_FALLBACK]}})),c=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map((e=>e.url))}),l=await BM({fragementLength:aR("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(SR.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),PM(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},c),e[0]},promisesCollector:s});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},c),l};let d,u,p;try{({gatewayInfo:d,proxyInfo:u,url:p}=await VM([c(),l()]))}catch(e){throw e[0]}if(s.length&&s.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),!d||!u)throw new GO(LT.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=p,"disabled"!==e.cloudProxyServer&&Array.isArray(i)&&p){const t=/^https?:\/\/(.+?)(\/.*)?$/.exec(p)[1];Li(i).call(i,t)&&(e.proxyServer=t,SR.setProxyServer(t),LR.setProxyServer(t))}return a={gatewayInfo:d,proxyInfo:await sA(u,d.uid)},a}async function YM(e,t,n){let r=null;const i=[],o=async o=>{const a=aR(o?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2")));return o&&(await IC(1e3),null!==r)?r:await BM({fragementLength:aR("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:r=>(SR.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(o?"backup":""," choose_server:"),r),function(e,t,n,r){const[i]=((e,t)=>{const n=Math.floor(Math.random()*10**12),r={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map((e=>({ip:e.ip,port:e.port})))}}]},i=new FormData;return i.append("request",JSON.stringify(r)),[i,n]})(t,[QI.CHOOSE_SERVER]);let o=hC.networkState;return WC((async()=>{o&&hC.networkState===sC.OFFLINE&&hC.onlineWaiter&&await Ih.race([hC.onlineWaiter,IC(r&&r.maxRetryTimeout||HC.maxRetryTimeout)]),o=hC.networkState;return((e,t)=>{if(e.response_body&&e.response_body.length){const t=e.response_body[0];if(0!==t.buffer.code){const e=PI(t.buffer.code);throw new GO(LT.UPDATE_TICKET_FAILED,"[".concat(t.buffer.code,"]: ").concat(e.desc),{retry:e.retry})}return t.buffer.ticket}throw SR.debug("update ticket request received ap response without response body:",t),new GO(LT.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})})(await yM(e,{data:i,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0),e)}),(()=>!1),(e=>e.code!==LT.OPERATION_ABORTED&&(e.code===LT.UPDATE_TICKET_FAILED?e.data.retry:(SR.warning("[".concat(t.clientId,"] update ticket network error, retry"),e),!0))),r)}(r,e,t,n)),allFailedhandler:e=>{throw e[0]},promisesCollector:i})};try{return r=await VM([o(!1),o(!0)]),i.length&&i.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),r}catch(e){throw e[0]}}function JM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function XM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JM(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class ZM extends YT{get isSuccess(){return!!this.configs}constructor(){super(),jw(this,"configs",void 0),jw(this,"joinInfo",void 0),jw(this,"cancelToken",void 0),jw(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),jw(this,"interval",void 0),jw(this,"mutex",new FC("config-distribute")),jw(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),aR("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval((()=>{this.updateConfigDistribute()}),aR("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,LR.reportApiInvoke(null,{options:void 0,name:ZT.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:QT.TRACER}).onSuccess(JSON.stringify(sR))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void SR.debug("[config-distribute] get config distribute interrupted have no joininfo");let e;const t=await this.mutex.lock();try{e=await async function(e,t,n){const r=aR("CDS_AP").slice(0,aR("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1"):"https://".concat(t,"/api/v1?action=config"))),i=r.map((r=>function(e,t,n,r){const i=tT(),o={flag:64,cipher_method:0,features:{device:i.name,system:i.os,system_general:navigator.userAgent,vendor:t.appId,version:$C,cname:t.cname,sid:t.sid,session_id:t.sid,detail:"",proxyServer:t.proxyServer}};return WC((()=>yM(e,{data:o,timeout:1e3,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}})),void 0,(e=>e.code!==LT.OPERATION_ABORTED),r)}(r,e,t,n)));let o=null,a=null,s={};try{o=await VM(i)}catch(e){if(e.code===LT.OPERATION_ABORTED)throw e;a=e}if(i.forEach((e=>e.cancel())),LR.reportApiInvoke(e.sid,{name:ZT.REQUEST_CONFIG_DISTRIBUTE,options:{error:a,res:o}}).onSuccess(),o&&o.test_tags)try{s=function(e){if(!e.test_tags)return{};const t=e.test_tags,n=Object.keys(t),r={};return n.forEach((e=>{var n;const i=Of(n=e.slice(4)).call(n),o=JSON.parse(t[e])[1];r[i]=o})),r}(o)}catch(e){}return s}(this.joinInfo,this.cancelToken,this.retryConfig),SR.debug("[config-distribute] get config distribute",JSON.stringify(e)),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(e){const t=new GO(LT.NETWORK_RESPONSE_ERROR,e);SR.warning("[config-distribute] ".concat(t.toString()))}finally{t()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var t;(t=e)&&t.uplink&&t.id&&void 0!==t.uplink.max_bitrate&&void 0!==t.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(pI.UPDATE_BITRATE_LIMIT,e):this.emit(pI.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&XM({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var t;const n=Wm(t=Object.keys(e).filter((e=>/^webrtc_ng_global_parameter/.test(e)))).call(t);for(let t=0;t<n.length;t++)for(let r=n.length-1;r>t;r--){const t=n[r];if("number"==typeof e[t].__priority){const i=e[t].__priority,o=n[r-1];if("number"==typeof e[o].__priority){if(!(i>e[o].__priority))continue;{const e=t;n[r]=n[r-1],n[r-1]=e}}else{const e=t;n[r]=n[r-1],n[r-1]=e}}}const r={};n.forEach((t=>{const n=e[t],i=n.__expires;Object.keys(n).forEach((e=>{"__priority"===e||"__expires"===e||Object.prototype.hasOwnProperty.call(r,e)||(r[e]=XM({value:n[e]},i&&{expires:i}))}))}));try{!function(e){try{const t=Date.now();Object.keys(e).forEach((n=>{switch(n){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":case"ENABLE_AG_ADAPTATION":case"FORCE_AG_HIGH_FRAMERATE":case"FORCE_SUPPORT_AG_ADAPTATION":case"ENCODER_CONFIG_LIMIT":case"CAMERA_CAPTURE_CONFIG":case"ENABLE_PRELOAD":if(Object.prototype.hasOwnProperty.call(iR,n)){const{value:r,expires:i}=e[n];if(i&&i<=t)return;sR[n]=r,iR[n]=r,SR.debug("Update global parameters from config distribute",n,r)}}}))}catch(t){SR.error("Error update config immediately: ".concat(e),t.message)}}(r);const e=JSON.stringify(r),t=window.btoa(e);window.localStorage.setItem("websdk_ng_global_parameter",t),SR.debug("Caching global parameters ".concat(e))}catch(e){SR.error("Error caching global parameters:",e.message)}}}class QM extends YT{constructor(){super(...arguments),jw(this,"resultStorage",new Map)}setLocalAudioStats(e,t,n){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(n,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(n,t))}setLocalVideoStats(e,t,n){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(n,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(n,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(n))}setRemoteAudioStats(e,t){const n=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",n,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const n=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",n,this.checkVideoDecode(t))}record(e,t,n){if(aR("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const r=this.resultStorage.get(e);if(r&&(r.result.push(n),r.result.length>=5)){var i;const n=Li(i=r.result).call(i,!0);r.isPrevNormal&&!n&&this.emit("exception",$M[e],e,t),!r.isPrevNormal&&n&&this.emit("exception",$M[e]+2e3,e+"_RECOVER",t),r.isPrevNormal=n,r.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof SP&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let n=null;t._encoderConfig&&t._encoderConfig.frameRate&&(n=rA(t._encoderConfig.frameRate));const r=e.captureFrameRate;return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof SP&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const $M={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},eU=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}measureFromPublishStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}};function tU(e,t){this.v=e,this.k=t}function nU(e){return new tU(e,0)}var rU=Oh,iU=du;Nr({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var e=iU.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var oU=du,aU=Wd;Nr({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=oU.f(this),n=aU(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var sU=ce(rU),cU=Vv.f("asyncIterator"),lU=ce(cU);function dU(e){var t,n;function r(t,n){try{var o=e[t](n),a=o.value,s=a instanceof tU;sU.resolve(s?a.v:a).then((function(n){if(s){var c="return"===t?"return":"next";if(!a.k||n.done)return r(c,n);n=e[c](n).value}i(o.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new sU((function(o,a){var s={key:e,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,r(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function uU(e){return function(){return new dU(e.apply(this,arguments))}}dU.prototype["function"==typeof Pw&&lU||"@@asyncIterator"]=function(){return this},dU.prototype.next=function(e){return this._invoke("next",e)},dU.prototype.throw=function(e){return this._invoke("throw",e)},dU.prototype.return=function(e){return this._invoke("return",e)};var pU=ce(ct.Object.getOwnPropertySymbols),hU=Nr,fU=Qr.indexOf,mU=Fi,gU=ke([].indexOf),vU=!!gU&&1/gU([1],1,-0)<0;hU({target:"Array",proto:!0,forced:vU||!mU("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return vU?gU(this,e,t)||0:fU(this,e,t)}});var _U=ti("Array").indexOf,yU=ge,wU=_U,bU=Array.prototype,EU=ce((function(e){var t=e.indexOf;return e===bU||yU(bU,e)&&t===bU.indexOf?wU:t}));function SU(e){if(Array.isArray(e))return e.map((e=>e));if(!TU(e))return e;const t={};for(const n in e){const r=e[n];TU(r)||Array.isArray(r)?t[n]=SU(r):t[n]=r}return t}function TU(e){return!("object"!=typeof e||Array.isArray(e)||!e)}class CU{constructor(e){jw(this,"input",[]),jw(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const RU={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},OU={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:RU,remoteCandidate:RU}},IU={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0},AU={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},kU={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},xU={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function LU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function NU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?LU(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class PU{constructor(e,t){jw(this,"onFirstVideoReceived",void 0),jw(this,"onFirstVideoDecoded",void 0),jw(this,"onFirstAudioReceived",void 0),jw(this,"onFirstVideoDecodedTimeout",void 0),jw(this,"onFirstAudioDecoded",void 0),jw(this,"onSelectedLocalCandidateChanged",void 0),jw(this,"onSelectedRemoteCandidateChanged",void 0),jw(this,"videoIsReady",!1),jw(this,"videoIsReady2",{}),jw(this,"pc",void 0),jw(this,"options",void 0),jw(this,"intervalTimer",void 0),jw(this,"stats",SU(OU)),jw(this,"isFirstVideoReceived",{}),jw(this,"isFirstVideoDecoded",{}),jw(this,"isFirstAudioReceived",{}),jw(this,"isFirstAudioDecoded",{}),jw(this,"isFirstVideoDecodedTimeout",{}),jw(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval((async()=>{this.updateStats()}),this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new Ih((e=>{e({local:NU({},RU),remote:NU({},RU)})}))}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const t=this.lossRateWindowStats.length,n=["videoSend","audioSend","videoRecv","audioRecv"];let r=0,i=0,o=0,a=0;for(const s of n)e[s].forEach(((e,n)=>{if(!this.lossRateWindowStats[t-1][s][n]||!this.lossRateWindowStats[0][s][n])return;const c=this.lossRateWindowStats[t-1][s][n].packets-this.lossRateWindowStats[0][s][n].packets,l=this.lossRateWindowStats[t-1][s][n].packetsLost-this.lossRateWindowStats[0][s][n].packetsLost;"videoSend"===s||"audioSend"===s?(r+=c,o+=l):(i+=c,a+=l),Number.isNaN(c)||Number.isNaN(c)?e.packetLostRate=0:e.packetLostRate=c<=0||l<=0?0:l/(c+l)}));e.sendPacketLossRate=r<=0||o<=0?0:o/(r+o),e.recvPacketLossRate=i<=0||a<=0?0:a/(i+a)}}function DU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DU(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class UU extends PU{constructor(){super(...arguments),jw(this,"_stats",OU),jw(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=SU(OU);const n=t.filter((e=>"ssrc"===e.type));this.processSSRCStats(n);const r=t.find((e=>"VideoBwe"===e.type));r&&this.processBandwidthStats(r),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach((e=>{var t;const n=Li(t=e.id).call(t,"send");switch("".concat(e.mediaType,"_").concat(n?"send":"recv")){case"video_send":{const t=SU(AU);t.codec=e.googCodecName,t.adaptionChangeReason="none",e.googCpuLimitedResolution&&(t.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(t.adaptionChangeReason="bandwidth"),t.avgEncodeMs=Number(e.googAvgEncodeMs),t.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.firsCount=Number(e.googFirReceived),t.nacksCount=Number(e.googNacksReceived),t.plisCount=Number(e.googPlisReceived),t.frameCount=Number(e.framesEncoded),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.videoSend.push(t),this._stats.rtt=t.rttMs;break}case"video_recv":{const t=SU(IU),n=this.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(t.codec=e.googCodecName,t.targetDelayMs=Number(e.googTargetDelayMs),t.renderDelayMs=Number(e.googRenderDelayMs),t.currentDelayMs=Number(e.googCurrentDelayMs),t.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),t.decodeMs=Number(e.googDecodeMs),t.maxDecodeMs=Number(e.googMaxDecodeMs),t.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},t.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},t.decodeFrameRate=Number(e.googFrameRateDecoded),t.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},t.jitterBufferMs=Number(e.googJitterBufferMs),t.firsCount=Number(e.googFirsSent),t.nacksCount=Number(e.googNacksSent),t.plisCount=Number(e.googPlisSent),t.framesDecodeCount=Number(e.framesDecoded),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,t.decodedFrame.width,t.decodedFrame.height),this.isFirstVideoDecoded[t.ssrc]=!0),n){const r=n.stats,i=Date.now()-n.lts;t.framesDecodeFreezeTime=r.framesDecodeFreezeTime,t.framesDecodeInterval=r.framesDecodeInterval,t.framesDecodeCount>r.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=i,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc,10))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<n.stats.framesDecodeCount&&(t.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:MU({},t),lts:Date.now()}),this._stats.videoRecv.push(t);break}case"audio_recv":{const t=SU(xU);t.codec=e.googCodecName,t.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,t.decodingCNG=Number(e.googDecodingCNG),t.decodingCTN=Number(e.googDecodingCTN),t.decodingCTSG=Number(e.googDecodingCTSG),t.decodingNormal=Number(e.googDecodingNormal),t.decodingPLC=Number(e.googDecodingPLC),t.decodingPLCCNG=Number(e.googDecodingPLCCNG),t.expandRate=Number(e.googExpandRate),t.accelerateRate=Number(e.googAccelerateRate),t.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),t.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),t.speechExpandRate=Number(e.googSpeechExpandRate),t.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),t.jitterBufferMs=Number(e.googJitterBufferMs),t.jitterMs=Number(e.googJitterReceived),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),t.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.decodingNormal>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),this._stats.audioRecv.push(t);break}case"audio_send":{const t=SU(kU);t.codec=e.googCodecName,t.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,t.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),t.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),t.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),t.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.rtt=t.rttMs,this._stats.audioSend.push(t);break}}}))}_getStats(){return new Ih(((e,t)=>{this.pc.getStats(e,t)}))}statsResponsesToObjects(e){const t=[];return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t.push(n)})),t}}function jU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function VU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jU(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class BU extends PU{constructor(){super(...arguments),jw(this,"_stats",OU),jw(this,"report",void 0),jw(this,"lastDecodeVideoReceiverStats",new Map),jw(this,"lastVideoFramesRecv",new Map),jw(this,"lastVideoFramesSent",new Map),jw(this,"lastVideoFramesDecode",new Map),jw(this,"lastVideoFramesOutput",new Map),jw(this,"lastVideoJBDelay",new Map),jw(this,"lastAudioJBDelay",new Map),jw(this,"mediaBytesSent",new Map),jw(this,"mediaBytesRetransmit",new Map),jw(this,"mediaBytesTargetEncode",new Map),jw(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=SU(OU),this.report.forEach((e=>{switch(e.type){case AO.OUTBOUND:case AO.INBOUND:{const t=e.mediaType||e.kind,n=!t&&"frameWidth"in e,r=!t&&!("frameWidth"in e);e.type===AO.OUTBOUND?"audio"===t||r?this.processAudioOutboundStats(e):("video"===t||n)&&this.processVideoOutboundStats(e):e.type===AO.INBOUND&&("audio"===t||r?this.processAudioInboundStats(e):("video"===t||n)&&this.processVideoInboundStats(e));break}case AO.TRANSPORT:{const t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case AO.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),t={local:VU({},RU),remote:VU({},RU)};return e.forEach((n=>{let r;if(n.type===AO.TRANSPORT&&(r=e.get(n.selectedCandidatePairId)),n.type===AO.CANDIDATE_PAIR&&n.selected&&(r=n),r){const n=(e,t)=>{e.type=t.type,e.id=t.id,t.address&&(e.address=t.address),t.candidateType&&(e.candidateType=t.candidateType),t.port&&(e.port=t.port),t.priority&&(e.priority=t.priority),t.protocol&&(e.protocol=t.protocol),t.relayProtocol&&(e.relayProtocol=t.relayProtocol)};if(r.localCandidateId){const i=e.get(r.localCandidateId);i&&n(t.local,i)}if(r.remoteCandidateId){const i=e.get(r.remoteCandidateId);i&&n(t.remote,i)}}})),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach((t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.audioSend.forEach((t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){const t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===AO.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===AO.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===AO.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(VU({},t),VU({},this.stats.selectedCandidatePair.localCandidate)),e.type===AO.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(VU({},t),VU({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find((t=>t.ssrc===e.ssrc));t||(t=SU(xU),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.packetsDiscarded=e.packetsDiscarded,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,this.processAudioTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),"number"==typeof e.concealedSamples&&(t.concealedSamples=e.concealedSamples)}processVideoInboundStats(e){let t=this._stats.videoRecv.find((t=>t.ssrc===e.ssrc));t||(t=SU(IU),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.framesDroppedCount=e.framesDropped,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,t.totalFreezesDuration=e.totalFreezesDuration;const n=this.lastDecodeVideoReceiverStats.get(t.ssrc),r=this.lastVideoFramesDecode.get(t.ssrc),i=this.lastVideoFramesOutput.get(t.ssrc),o=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){const e=t.decodedFrame?t.decodedFrame.width:0,n=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,e,n),this.isFirstVideoDecoded[t.ssrc]=!0}if(n){const r=n.stats,i=o-n.lts;t.framesDecodeFreezeTime=r.framesDecodeFreezeTime,t.framesDecodeInterval=r.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&i>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>r.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=i,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<r.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(n.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-n.qpSum)/(e.framesDecoded-n.stats.framesDecodeCount))}r&&o-r.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-r.count)/((o-r.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:o,rate:t.decodeFrameRate})):r?t.decodeFrameRate=r.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:o,rate:0}),t.framesDroppedCount&&e.framesReceived&&(i&&o-i.lts>=800?(t.outputFrameRate=Math.round((e.framesReceived-t.framesDroppedCount-i.count)/((o-i.lts)/1e3)),this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:o,rate:Math.max(t.outputFrameRate,0)})):i?t.outputFrameRate=i.rate:this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:o,rate:0})),e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:VU({},t),lts:n?n.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find((t=>t.ssrc===e.ssrc));t||(t=SU(AU),this._stats.videoSend.push(t));const n=this.mediaBytesSent.get(e.ssrc);if(n)n.add(e.bytesSent);else{const t=new CU(10);t.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,t)}if(void 0!==e.retransmittedBytesSent){const t=this.mediaBytesRetransmit.get(e.ssrc);if(t)t.add(e.retransmittedBytesSent);else{const t=new CU(10);t.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,t)}}if(e.totalEncodedBytesTarget){const t=this.mediaBytesTargetEncode.get(e.ssrc);if(t)t.add(e.totalEncodedBytesTarget);else{const t=new CU(10);t.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,t)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,e.totalEncodeTime&&e.framesEncoded){const n=this.lastEncoderMs.get(e.ssrc);if(!n||n.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const r=e.framesEncoded-n.lastFrameCount,i=e.totalEncodeTime-n.lastEncoderTime;t.avgEncodeMs=1e3*i/r}}if(e.framesEncoded&&e.qpSum){const n=this.lastEncoderMs.get(e.ssrc);!n||n.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-n.lastQpSum)/(e.framesEncoded-n.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const n=this.findRemoteStatsId(e.ssrc,AO.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find((t=>t.ssrc===e.ssrc));if(t||(t=SU(kU),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const n=this.findRemoteStatsId(e.ssrc,AO.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}findRemoteStatsId(e,t){var n;const r=Array.from(yA(n=this.report).call(n)).find((n=>n.type===t&&n.ssrc===e));return r?r.id:null}processVideoMediaSource(e,t){const n=this.report.get(e);n&&n.width&&n.height&&n.framesPerSecond&&(t.inputFrame={width:n.width,height:n.height,frameRate:n.framesPerSecond})}processAudioMediaSource(e,t){const n=this.report.get(e);n&&(t.inputLevel=n.audioLevel)}processVideoTrackSenderStats(e,t,n){var r,i,o,a;const s=t?this.report.get(t):void 0,c=null!==(r=null==s?void 0:s.framesSent)&&void 0!==r?r:e.framesSent;if("number"!=typeof c)return;let l=null!==(i=null==s?void 0:s.frameWidth)&&void 0!==i?i:e.frameWidth,d=null!==(o=null==s?void 0:s.frameHeight)&&void 0!==o?o:e.frameHeight,u=null!==(a=null==s?void 0:s.framesPerSecond)&&void 0!==a?a:e.framesPerSecond;if("number"==typeof l&&"number"==typeof d||(l=0,d=0),null==u){const e=Date.now(),t=this.lastVideoFramesSent.get(n.ssrc);t&&e-t.lts>=800?(u=Math.round((c-t.count)/((e-t.lts)/1e3)),this.lastVideoFramesSent.set(n.ssrc,{count:c,lts:e,rate:u})):t?u=t.rate:this.lastVideoFramesSent.set(n.ssrc,{count:c,lts:e,rate:0})}n.sentFrame={width:l,height:d,frameRate:Math.max(0,u)}}processVideoTrackReceiverStats(e,t,n){var r,i,o,a,s;const c=t?this.report.get(t):void 0,l=null!==(r=null==c?void 0:c.framesReceived)&&void 0!==r?r:e.framesReceived,d=null!==(i=null==c?void 0:c.frameWidth)&&void 0!==i?i:e.frameWidth,u=null!==(o=null==c?void 0:c.frameHeight)&&void 0!==o?o:e.frameHeight,p=null!==(a=null==c?void 0:c.jitterBufferDelay)&&void 0!==a?a:e.jitterBufferDelay,h=null!==(s=null==c?void 0:c.jitterBufferEmittedCount)&&void 0!==s?s:e.jitterBufferEmittedCount;if("number"==typeof l){const e=this.lastVideoFramesRecv.get(n.ssrc),t=Date.now();n.framesReceivedCount=l;let r=0;e&&t-e.lts>=800?(r=Math.round((l-e.count)/((t-e.lts)/1e3)),this.lastVideoFramesRecv.set(n.ssrc,{count:l,lts:t,rate:r})):e?r=e.rate:this.lastVideoFramesRecv.set(n.ssrc,{count:l,lts:t,rate:0}),n.receivedFrame={width:d||0,height:u||0,frameRate:r||0},n.decodedFrame={width:d||0,height:u||0,frameRate:n.decodeFrameRate||0},n.outputFrame={width:d||0,height:u||0,frameRate:n.outputFrameRate||n.decodeFrameRate||0}}if(p&&h){const e=this.lastVideoJBDelay.get(n.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const r=h-e.jitterBufferEmittedCount;r>0&&(t=1e3*(p-e.jitterBufferDelay)/r),n.jitterBufferMs=t,n.currentDelayMs=Math.round(t),this.lastVideoJBDelay.set(n.ssrc,{jitterBufferDelay:p,jitterBufferEmittedCount:h,jitterBufferMs:n.currentDelayMs})}}processAudioTrackSenderStats(e,t,n){var r,i,o,a;const s=t?this.report.get(t):void 0,c=null!==(r=null!==(i=null==s?void 0:s.echoReturnLoss)&&void 0!==i?i:e.echoReturnLoss)&&void 0!==r?r:0,l=null!==(o=null!==(a=null==s?void 0:s.echoReturnLossEnhancement)&&void 0!==a?a:e.echoReturnLossEnhancement)&&void 0!==o?o:0;n.aecReturnLoss=c,n.aecReturnLossEnhancement=l}processAudioTrackReceiverStats(e,t,n){var r,i,o,a,s,c,l;const d=t?this.report.get(t):void 0,u=null!==(r=null==d?void 0:d.removedSamplesForAcceleration)&&void 0!==r?r:e.removedSamplesForAcceleration,p=null!==(i=null==d?void 0:d.totalSamplesReceived)&&void 0!==i?i:e.totalSamplesReceived,h=null!==(o=null==d?void 0:d.jitterBufferDelay)&&void 0!==o?o:e.jitterBufferDelay,f=null!==(a=null==d?void 0:d.jitterBufferEmittedCount)&&void 0!==a?a:e.jitterBufferEmittedCount,m=null!==(s=null==d?void 0:d.audioLevel)&&void 0!==s?s:null==e?void 0:e.audioLevel,g=null!==(c=null==d?void 0:d.totalSamplesDuration)&&void 0!==c?c:null==e?void 0:e.totalSamplesDuration,v=null!==(l=null==d?void 0:d.concealedSamples)&&void 0!==l?l:e.concealedSamples;if(u&&p&&(n.accelerateRate=u/p),h&&f){const e=this.lastAudioJBDelay.get(n.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const r=f-e.jitterBufferEmittedCount;r>0&&(t=1e3*(h-e.jitterBufferDelay)/r),n.jitterBufferMs=Math.round(t),this.lastAudioJBDelay.set(n.ssrc,{jitterBufferDelay:h,jitterBufferEmittedCount:f,jitterBufferMs:n.jitterBufferMs})}n.outputLevel=m;let _=1920;g&&p&&(_=p/g/50,n.receivedFrames=Math.round(p/_)),v&&(n.droppedFrames=Math.round(v/_))}processRemoteInboundStats(e,t){const n=this.report.get(e);n&&(t.packetsLost=n.packetsLost,n.roundTripTime&&(t.rttMs=1e3*n.roundTripTime),n.jitter&&(t.jitterMs=1e3*n.jitter),n.timestamp&&(t.timestamp=n.timestamp))}getCodecFromCodecStats(e){const t=this.report.get(e);if(!t)return"";const n=t.mimeType.match(/\/(.*)$/);return n&&n[1]?n[1]:""}updateSendBitrate(){let e=0,t=null,n=null;this.mediaBytesSent.forEach((t=>{e+=t.diffMean()})),this.mediaBytesRetransmit.forEach((e=>{t=null===t?e.diffMean():t+e.diffMean()})),this.mediaBytesTargetEncode.forEach((e=>{n=null===n?e.diffMean():n+e.diffMean()}));const r=null!==t?e-t:e;this._stats.bitrate={actualEncoded:8*r/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==n&&(this._stats.bitrate.targetEncoded=8*n/(this.options.updateInterval/1e3))}}class FU extends PU{updateStats(){return Ih.resolve()}}function GU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4;const o=function(){const e=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return e&&e[0]?Number(e[0].split("/")[1]):null}();return o?o<76?new UU(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):new BU(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):function(e){if(!window.RTCStatsReport)return!1;const t=e.getStats();return!!(t instanceof Ih||function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}(t))}(e)?new BU(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):new FU(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i})}let HU=class{get localCapabilities(){return vC(this._localCapabilities)}get rtpCapabilities(){return vC(this._rtpCapabilities)}get candidates(){return vC(this._candidates)}get iceParameters(){return vC(this._iceParameters)}get dtlsParameters(){return vC(this._dtlsParameters)}constructor(e){jw(this,"sessionDesc",void 0),jw(this,"_localCapabilities",void 0),jw(this,"_rtpCapabilities",void 0),jw(this,"_candidates",void 0),jw(this,"_iceParameters",void 0),jw(this,"_dtlsParameters",void 0),jw(this,"setup",void 0),jw(this,"currentMidIndex",void 0),jw(this,"cname","o/i14u9pJrxRKAsu"),jw(this,"firefoxSsrcMidMap",new Map),e=vC(e);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:r,remoteRTPCapabilities:i,localCapabilities:o,direction:a,setup:s,videoCodec:c,audioCodec:l}=e;let d;this.setup=s,d=a===BO.RECEIVE_ONLY?BD.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"):BD.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"),this._rtpCapabilities=i,this._candidates=r,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=o;const u=a===BO.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,p=a===BO.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,h=a===BO.RECEIVE_ONLY?i.send.videoCodecs:sM(mI.VIDEO,u,p,c),f=a===BO.RECEIVE_ONLY?i.send.audioCodecs:sM(mI.AUDIO,u,p,l);for(const e of d.mediaDescriptions)e.attributes.iceUfrag=t.iceUfrag,e.attributes.icePwd=t.icePwd,e.attributes.fingerprints=n.fingerprints,e.attributes.candidates=r,e.attributes.setup=this.setup,"application"===e.media.mediaType&&(e.attributes.sctpPort="5000"),"video"===e.media.mediaType&&(e.media.fmts=h.map((e=>e.payloadType.toString(10))),e.attributes.payloads=h,e.attributes.extmaps=u.videoExtensions),"audio"===e.media.mediaType&&(e.media.fmts=f.map((e=>e.payloadType.toString(10))),e.attributes.payloads=f,e.attributes.extmaps=u.audioExtensions,aM(e));this.sessionDesc=d,this.currentMidIndex=d.mediaDescriptions.length-1}toString(){return BD.print(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every((e=>this.hasMid(e))):this.sessionDesc.mediaDescriptions.some((t=>t.attributes.mid===e))}send(e,t,n,r,i){n=n.replace(/ /g,"-");const{ssrcs:o,ssrcGroups:a}=JD(t,this.cname,aR("SYNC_GROUP")?n:void 0),s=this.findPreloadMediaDesc(o);if(s){if(lT()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,s.attributes.mid),i&&(i.twcc||i.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,i),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,o,r);let n;return-1===t?(n=this.createOrRecycleSendMedia(e,o,a,"sendonly",r,i),this.updateBundleMids()):(n=vC(this.sessionDesc.mediaDescriptions[t]),n.attributes.direction="sendonly",n.attributes.ssrcs=o,n.attributes.ssrcGroups=a,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(n,i)),lT()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,n.attributes.mid),{needExchangeSDP:!0,mid:n.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{e.attributes.ssrcs=[]})),this.updateBundleMids()}receive(e,t,n){const r=[];return e.forEach((e=>{const i=e._mediaStreamTrack.kind,o=this.findAvailableRecvMediaIndex(i);let a,s=!1;-1===o?(s=!0,a=this.createOrRecycleRecvMedia(e,[],"recvonly",t,n),this.updateBundleMids()):(a=vC(this.sessionDesc.mediaDescriptions[o]),a.attributes.direction="recvonly"),r.push({mid:a.attributes.mid,needCreateTransceiver:s})})),r}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:n,address:r,port:i,type:o,relatedAddress:a,relatedPort:s,priority:c}=new RTCIceCandidate(e),l={foundation:null!=t?t:"",componentId:"1",transport:null!=n?n:"",priority:c?c+"":"",connectionAddress:null!=r?r:"",port:i?i+"":"",type:o?o+"":"",relAddr:null!=a?a:"",relPort:s?s+"":"",extension:{}};this.candidates.some((e=>e.priority===l.priority&&e.connectionAddress===l.connectionAddress&&e.port===l.port))||(this._candidates.push(l),this.sessionDesc.mediaDescriptions.forEach((e=>{e.attributes.candidates=this.candidates})))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,n,r,i){const o=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,s=sM(o,a,this.localCapabilities.send,o===mI.AUDIO?i:r),c=o===mI.VIDEO?a.videoExtensions:a.audioExtensions,l="".concat(++this.currentMidIndex);let d={media:{mediaType:o,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};d=this.mungRecvMediaDsec(d,e);const u=this.findFirstClosedMedia(o);if(u){const e=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[e]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Li(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Li(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}findAvailableMediaIndex(e,t,n){return this.sessionDesc.mediaDescriptions.findIndex((r=>{const i=r.media.mediaType===e&&"0"!==r.media.port&&("sendonly"===r.attributes.direction||"sendrecv"===r.attributes.direction)&&0===r.attributes.ssrcs.length;if(lT()){if(i){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==r.attributes.mid&&"1"!==r.attributes.mid)||!(!e||e!==r.attributes.mid)}return!1}return i&&r.attributes.mid===n}))}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex((t=>{const n=t.media.mediaType===e&&"0"!==t.media.port&&("recvonly"===t.attributes.direction||"sendrecv"===t.attributes.direction);return"0"!==t.attributes.mid&&"1"!==t.attributes.mid&&n}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}restartICE(e){e=vC(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}createOrRecycleSendMedia(e,t,n,r,i,o){const a=this.rtpCapabilities.send,s=e===mI.VIDEO?a.videoCodecs:a.audioCodecs,c=e===mI.VIDEO?a.videoExtensions:a.audioExtensions;lT()&&(i="".concat(++this.currentMidIndex));let l={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:i}};l=this.mungSendMediaDesc(l,o);const d=this.findFirstClosedMedia(e);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}mungRecvMediaDsec(e,t,n){const r=vC(e);return ZD(r),XD(r,t),QD(r,t),$D(r),eM(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=vC(e);return eM(n,t,this.localCapabilities.recv),aM(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId}))}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>lT()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}};const qU=["sdp"];var WU;function zU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function KU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zU(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let YU=(WU=class e extends hI{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[]}set isInRestartIce(e){this._isInRestartIce=e}get isInRestartIce(){return this._isInRestartIce}constructor(t,n,r){super(t,n),jw(this,"direction",void 0),jw(this,"name",void 0),jw(this,"store",void 0),jw(this,"spec",void 0),jw(this,"peerConnection",void 0),jw(this,"initialOffer",void 0),jw(this,"transport",void 0),jw(this,"statsFilter",void 0),jw(this,"localCandidateCount",0),jw(this,"_isInRestartIce",!1),jw(this,"mutex",new FC("P2PConnection-mutex")),jw(this,"onLocalCandidate",void 0),jw(this,"remoteSDP",void 0),jw(this,"pendingCandidates",[]),jw(this,"localCapabilities",void 0),jw(this,"isReady",!1),jw(this,"restartCnt",0),jw(this,"curTurnServerIndex",0),this.store=n,this.spec=t,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t,n.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=null!=r?r:BO.SEND_ONLY,this.name=this.direction===BO.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=GU(this.peerConnection,aR("STATS_UPDATE_INTERVAL"),void 0,lT()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(e){try{const t=await nM();if(this.localCapabilities=oM(t),e){const{sdp:t}=e,n=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=XR(e);for(r=0;r<o.length;r++)n=o[r],EU(t).call(t,n)>=0||(i[n]=e[n]);return i}(e,t);if(pU){var o=pU(e);for(r=0;r<o.length;r++)n=o[r],EU(t).call(t,n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,qU),r=function(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=qD(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"sendonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(iM(t,e,"videoExtensions",n,r,i),iM(t,e,"videoCodecs",n,r,i),iM(t,e,"audioExtensions",n,r,i),iM(t,e,"audioCodecs",n,r,i),aR("RAISE_H264_BASELINE_PRIORITY")){const e=i.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]));if(-1!==e){const t=i.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()));if(t<e){SR.debug("raising H264 baseline profile priority");const n=i.videoCodecs[e];i.videoCodecs.splice(e,1),i.videoCodecs.splice(t,0,n)}-1!==t&&aR("FILTER_SEND_H264_BASELINE")&&(n.videoCodecs=n.videoCodecs.filter((e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"]))))}}return{send:n,recv:r,sendrecv:i}}({},{},t);this.remoteSDP=new HU({remoteIceParameters:n.iceParameters,remoteDtlsParameters:n.dtlsParameters,candidates:[],remoteRTPCapabilities:r,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const i=await this.peerConnection.createAnswer();if(!i.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const o=WD(i.sdp);await this.peerConnection.setLocalDescription(i);const a=await rM({},{},i.sdp);this.localCapabilities=oM(a);const s=this.peerConnection.getTransceivers()[0];return null!=s&&s.receiver&&s.receiver.transport&&this.tryBindTransportEvents(s.receiver.transport),KU(KU({},o),{},{sdp:i.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=WD(e.sdp);return this.initialOffer=e,KU(KU({},t),{},{sdp:e.sdp})}}catch(e){throw new NT(LT.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:t,iceParameters:n,dtlsParameters:r}=e,i=await rM({},{},t);this.remoteSDP=new HU({remoteIceParameters:n,remoteDtlsParameters:r,candidates:[],remoteRTPCapabilities:i,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const o=this.peerConnection.getTransceivers()[0];null!=o&&o.sender&&o.sender.transport&&this.tryBindTransportEvents(o.sender.transport)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async addRemoteCandidate(e){try{e&&this.pendingCandidates.push(e),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach((e=>{this.peerConnection.addIceCandidate(e)})),this.pendingCandidates=[])}catch(e){throw new NT(LT.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return uU((function*(){const i=yield nU(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const i=[],o=r.remoteSDP.receive(e,t,n);e.forEach(((e,t)=>{if(o[t].needCreateTransceiver){const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});i.push(t),e._updateRtpTransceiver(t)}else{const n=r.peerConnection.getTransceivers().find((e=>e.mid===o[t].mid));if(!n)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(o[t].mid));i.push(n),e._updateRtpTransceiver(n)}})),lT()&&!0===aR("SIMULCAST")&&(yield nU(r.applySimulcastForFirefox(i,e)));const a=o.map((e=>e.mid)),s=yield nU(r.peerConnection.createOffer()),c=r.mungSendOfferSDP(s.sdp,e,a),l=BD.parse(c),d=a.map((e=>{const t=l.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return zD(t,aR("USE_PUB_RTX"))})),u=i.map(((e,t)=>{const n=a[t];return{localSSRC:d[t],id:n}}));yield nU(r.peerConnection.setLocalDescription({type:"offer",sdp:c}));try{yield u}catch(e){const t=r.remoteSDP.toString();throw yield nU(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield nU(r.peerConnection.setRemoteDescription({type:"answer",sdp:t})),yield nU(r.stopSending(a,!0)),e}yield nU(r.applySimulcastEncodings(i,e)),yield nU(r.applySendEncodings(i,e));const p=r.remoteSDP.toString(),h=r.logSDPExchange(c,"offer","local","send");return null==h||h(p),yield nU(r.setRemoteDescription({type:"answer",sdp:p})),i.map(((e,t)=>{const n=a[t];return{localSSRC:d[t],id:n}}))}catch(e){throw e instanceof NT?e:new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}}))()}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length (".concat(t.length,") doesn't match mids' length (").concat(e.length,") when trying to call P2PConnection.stopSending."));t.map((e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const i=this.remoteSDP.toString();null==r||r(i),await this.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);if(o){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(r.sdp,i,e);null==n||n(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),SR.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else SR.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const a=this.peerConnection.getTransceivers().find((e=>e.mid===i));if(!a||null===a.mid)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,mid:a.mid,transceiver:a}}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async mockReceive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);if(o){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(r.sdp,i,e);null==n||n(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),SR.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else SR.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."))}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===tR.Auto&&(this.store.p2pTransport=tR.SdRtn,nL().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,nL().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:t}=WD(e.sdp);return this.store.descriptionStart(),this.direction===BO.SEND_ONLY&&await this.peerConnection.setLocalDescription(e),t}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===BO.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const e=await this.peerConnection.createAnswer();if(!e.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:t}=WD(e.sdp);return await this.peerConnection.setLocalDescription(e),t}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}close(){var e;this.peerConnection.close(),this.peerConnection.onicecandidate=null,null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const i=this.remoteSDP.toString(),o=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==o||o(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===n.length&&(this.isVP8Simulcast(t)?lT()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find((e=>e.mid===t));n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:KU(KU({},RU),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:KU(KU({},RU),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e,t;Li(e=["connected","completed"]).call(e,this.peerConnection.iceConnectionState)&&(this.isReady=!1),null===(t=this.onICEConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;"connected"===this.peerConnection.connectionState&&(this.restartCnt=0),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=e=>{var t;e.candidate?(e.candidate.candidate&&(null===(t=this.onLocalCandidate)||void 0===t||t.call(this,e.candidate.toJSON())),this.localCandidateCount+=1):SR.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i={iceServers:[]};var o;return t.iceServers?i.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(nC(t.turnServer.servers)?i.iceServers=t.turnServer.servers:(i.iceServers&&i.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers,n,r)),aR("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&t.turnServer.serversFromGateway&&i.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway,n,r)),Li(o=[tR.Relay,tR.SdRtn]).call(o,n)&&(i.iceTransportPolicy="relay"),aR("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(i.iceTransportPolicy="relay")})))),aR("ENABLE_ENCODED_TRANSFORM")&&nL().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),SR.debug("P2PConnection p2pTransport is ".concat(n)),i}static turnServerConfigToIceServers(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=[],i=e.filter((e=>e.tcpport));SR.debug("P2PConnection turnServers is ".concat(i,", current index is ").concat(n));const o=i.length>n?i[n]:i[0];switch(t){case tR.SdRtn:const t=e.filter((e=>{var t;return Li(t=e.username).call(t,"glb:")&&e.turnServerURL==e.turnServerURL})),i=t.length>n?t[n]:t[0];i&&(r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(tA(i.turnServerURL),":").concat(i.tcpport,"?transport=udp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(tA(i.turnServerURL),":").concat(i.tcpport,"?transport=tcp")}));break;case tR.Relay:o&&(r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(o.turnServerURL,":").concat(o.tcpport,"?transport=udp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(tA(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}));break;default:o&&(r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(o.turnServerURL,":").concat(o.tcpport,"?transport=udp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(tA(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"stun:".concat(o.turnServerURL,":").concat(o.tcpport)}))}return r}tryBindTransportEvents(e){if(e){this.transport=e,e.onstatechange=()=>{var t;null!=e&&e.state&&(null===(t=this.onDTLSTransportStateChange)||void 0===t||t.call(this,e.state))},e.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const t=e.iceTransport;t&&(t.onstatechange=()=>{const t=null==e?void 0:e.iceTransport.state;var n;t&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,t))},t.getSelectedCandidatePair&&(t.onselectedcandidatepairchange=()=>{if(t.getSelectedCandidatePair()){const{local:e,remote:n}=t.getSelectedCandidatePair();SR.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:e.type,protocol:e.protocol}),", remote ").concat(JSON.stringify({candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n;if(t||(t=this.peerConnection.getSenders().find((t=>t.track===e._mediaStreamTrack))),!t)return SR.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return SR.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!nL().supportSetRtpSenderParameters)return SR.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const r={},i={};switch(e._optimizationMode){case"motion":r.degradationPreference="maintain-framerate";break;case"detail":r.degradationPreference="maintain-resolution";break;default:r.degradationPreference="balanced"}if(e._encoderConfig){var o;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(i.maxBitrate=1e3*t),Li(o=e._hints).call(o,bL.LOW_STREAM)&&(n&&(i.maxFramerate=rA(n)),r&&r>=1&&(i.scaleResolutionDownBy=r))}if(aR("DSCP_TYPE")&&RT()){var a;const e=aR("DSCP_TYPE");Li(a=["very-low","low","medium","high"]).call(a,e)&&(i.networkPriority=e)}const s=t.getParameters(),c=null===(n=s.encodings)||void 0===n?void 0:n[0];lT()&&!c&&(r.encodings=[i]),c&&Object.assign(c,i),Object.assign(s,r),SR.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(s.encodings))),await t.setParameters(s)}async applySendEncodings(e,t){try{if(!nL().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];i instanceof lD&&!this.isVP8Simulcast(i)&&await this.updateRtpSenderEncodings(i,r.sender)}}catch(e){SR.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){const r=BD.parse(e);return t.forEach(((e,t)=>{const i=n[t],o=r.mediaDescriptions.find((e=>e.attributes.mid===i));o&&(XD(o,e),tM(o,e,this.store.codec))})),BD.print(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,i,o,a;const c=e[s],l=t[s];if(l instanceof lD&&!Li(n=l._hints).call(n,bL.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(i=l._encoderConfig)||void 0===i?void 0:i.bitrateMax)>200&&null!==(o=l._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!lT()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof lD&&this.isVP8Simulcast(r)){const t=e[n],i={},o={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};i.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,i))}}}isVP8Simulcast(e){var t,n,r,i,o;return!!(e instanceof lD&&aR("SIMULCAST")&&"vp8"===this.store.codec&&!Li(t=e._hints).call(t,bL.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(i=e._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(aR("SDP_LOGGING"))return SR.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async e=>{e.direction="sendonly"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async getRemoteSSRC(e,t){var n,r;if(t=null!==(n=t)&&void 0!==n?n:null===(r=this.currentRemoteDescription)||void 0===r?void 0:r.sdp){var i;const n=null===(i=BD.parse(t).mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===i?void 0:i.attributes.ssrcs;return null==n?void 0:n[0].ssrcId}}async setRemoteDescription(e){var t;await this.peerConnection.setRemoteDescription(e),Li(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(e,t,n){const r=BD.parse(e),i=r.mediaDescriptions.find((e=>e.attributes.mid===t));return i&&n===mI.AUDIO&&"audio"===i.media.mediaType&&aM(i),BD.print(r)}},OO(WU.prototype,"establish",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"establish"),WU.prototype),OO(WU.prototype,"connect",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"connect"),WU.prototype),OO(WU.prototype,"receive",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"receive"),WU.prototype),OO(WU.prototype,"mockReceive",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"mockReceive"),WU.prototype),OO(WU.prototype,"stopReceiving",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"stopReceiving"),WU.prototype),OO(WU.prototype,"restartICE",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"restartICE"),WU.prototype),OO(WU.prototype,"close",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"close"),WU.prototype),OO(WU.prototype,"updateEncoderConfig",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"updateEncoderConfig"),WU.prototype),OO(WU.prototype,"updateSendParameters",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"updateSendParameters"),WU.prototype),OO(WU.prototype,"replaceTrack",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"replaceTrack"),WU.prototype),OO(WU.prototype,"muteLocal",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"muteLocal"),WU.prototype),OO(WU.prototype,"unmuteLocal",[JU],Object.getOwnPropertyDescriptor(WU.prototype,"unmuteLocal"),WU.prototype),WU);function JU(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}function XU(e,t){let n=document.createElement("video"),r=document.createElement("canvas");n.setAttribute("style","display:none"),r.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),r.width=rA(t.width),r.height=rA(t.height);const i=rA(t.framerate||15);document.body.append(n),document.body.append(r);let o=e._mediaStreamTrack;n.srcObject=new MediaStream([o]),n.play();const a=r.getContext("2d");if(!a)throw new GO(LT.UNEXPECTED_ERROR,"can not get canvas context");const s=nL(),c=r.captureStream(s.supportRequestFrame?0:i).getVideoTracks()[0];c.canvas||(c.canvas=r),r.startCapture=()=>{if(!n)return r.stopCapture&&r.stopCapture();if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const e=n.videoWidth,t=n.videoHeight/e,i=r.width*t;Math.abs(i-r.height)>=2&&(SR.debug("adjust low stream resolution","".concat(r.width,"x").concat(r.height," -> ").concat(r.width,"x").concat(i)),r.height=i)}a.drawImage(n,0,0,r.width,r.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,n.srcObject=new MediaStream([o]))},r.stopCapture=tN((()=>r.startCapture&&r.startCapture()),i);const l=c.stop;return c.stop=()=>{l.call(c),n&&(n.remove(),n.srcObject=null,n=null),r&&(r.width=0,r.remove(),r.stopCapture&&r.stopCapture(),r.startCapture=void 0,r.stopCapture=void 0,r=null),SR.debug("clean low stream renderer")},c}var ZU=function(e){return e[e.HEIGHT=2033]="HEIGHT",e[e.FRAME_RATE=2034]="FRAME_RATE",e[e.WIDTH=2035]="WIDTH",e}(ZU||{}),QU=function(e){return e[e.FRAME_RATE=2002]="FRAME_RATE",e[e.WIDTH=2003]="WIDTH",e[e.HEIGHT=2004]="HEIGHT",e[e.PACKAGE_LOST=2005]="PACKAGE_LOST",e[e.AVG_ENCODE=2007]="AVG_ENCODE",e[e.NACKS=2009]="NACKS",e[e.PLIS=2010]="PLIS",e[e.FIRS=2011]="FIRS",e[e.BITRATE=2012]="BITRATE",e[e.PACKAGE_RATE=2031]="PACKAGE_RATE",e[e.ADAPTATION=2032]="ADAPTATION",e[e.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",e[e.BANDWIDTH=2061]="BANDWIDTH",e[e.RETRANSMIT=2062]="RETRANSMIT",e[e.TARGET_ENCODED=2064]="TARGET_ENCODED",e[e.TRANSMIT=2066]="TRANSMIT",e[e.FREEZE=2082]="FREEZE",e[e.DISABLED=2095]="DISABLED",e[e.PLAYER_STATUS=2128]="PLAYER_STATUS",e[e.QP_SUM=2143]="QP_SUM",e}(QU||{}),$U=function(e){return e[e.BITRATE=2069]="BITRATE",e[e.PACKAGE_LOST=2070]="PACKAGE_LOST",e[e.PACKAGE_RATE=2071]="PACKAGE_RATE",e[e.HEIGHT=2073]="HEIGHT",e[e.FRAME_RATE=2075]="FRAME_RATE",e[e.WIDTH=2077]="WIDTH",e}($U||{}),ej=function(e){return e[e.JITTER=-1]="JITTER",e[e.PACKAGE_LOST=2014]="PACKAGE_LOST",e[e.WIDTH=2018]="WIDTH",e[e.HEIGHT=2019]="HEIGHT",e[e.FRAME_RATE=2020]="FRAME_RATE",e[e.JITTER_BUFFER=2023]="JITTER_BUFFER",e[e.CURRENT_DELAY=2024]="CURRENT_DELAY",e[e.NACKS=2026]="NACKS",e[e.PLIS=2027]="PLIS",e[e.FIRS=2028]="FIRS",e[e.BITRATE=2029]="BITRATE",e[e.PACKAGE_RATE=2078]="PACKAGE_RATE",e[e.FREEZE=2084]="FREEZE",e[e.DISABLED=2101]="DISABLED",e[e.PLAYER_STATUS=2129]="PLAYER_STATUS",e[e.QP_SUM=2144]="QP_SUM",e[e.I_FRAME_DELAY=2149]="I_FRAME_DELAY",e}(ej||{}),tj=function(e){return e[e.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",e[e.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",e[e.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",e[e.FREEZE_TIME=2109]="FREEZE_TIME",e[e.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",e[e.FREEZE_DURATION=2156]="FREEZE_DURATION",e}(tj||{}),nj=function(e){return e[e.PCM_LEVEL=2104]="PCM_LEVEL",e}(nj||{}),rj=function(e){return e[e.PACKAGE_LOST=-1]="PACKAGE_LOST",e[e.LEVEL=2038]="LEVEL",e[e.BITRATE=2039]="BITRATE",e[e.PACKAGE_RATE=2040]="PACKAGE_RATE",e[e.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",e[e.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",e[e.FREEZE=2081]="FREEZE",e[e.DISABLED=2096]="DISABLED",e}(rj||{}),ij=function(e){return e[e.BITRATE=2044]="BITRATE",e[e.PACKAGE_LOST=2045]="PACKAGE_LOST",e[e.PACKAGE_RATE=2046]="PACKAGE_RATE",e[e.CURRENT_DELAY=2047]="CURRENT_DELAY",e[e.JITTER_BUFFER=2054]="JITTER_BUFFER",e[e.JITTER=2055]="JITTER",e[e.FREEZE=2083]="FREEZE",e[e.DISABLED=2102]="DISABLED",e[e.PCM_LEVEL=2105]="PCM_LEVEL",e[e.PLAYER_STATUS=2130]="PLAYER_STATUS",e[e.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",e}(ij||{}),oj=function(e){return e[e.FREEZE_TIME=-1]="FREEZE_TIME",e[e.LEVEL=2043]="LEVEL",e}(oj||{}),aj=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e}(aj||{});const sj=1e3;function cj(e,t,n){null!=n&&Number.isFinite(n)&&(e[t]=Math.round(Math.max(0,n)))}function lj(e){const t={[aj.CONN_TYPE]:0,[aj.RTT]:e.rtt};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const n=e.selectedCandidatePair.localCandidate.relayProtocol;"udp"===n&&(t[aj.CONN_TYPE]=1),"tcp"===n&&(t[aj.CONN_TYPE]=3),"tls"===n&&(t[aj.CONN_TYPE]=4);break}case"srflx":t[aj.CONN_TYPE]=2}return t}function dj(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}class uj extends YT{constructor(e){super(),jw(this,"store",void 0),jw(this,"uploadWRTCStatsTimer",void 0),jw(this,"uploadOutboundDenoiserStatsTimer",void 0),jw(this,"uploadExtStatsTimer",void 0),jw(this,"uploadExtUsageStatsTimer",void 0),jw(this,"uploadInboundExtStatsTimer",void 0),jw(this,"requestStats",void 0),jw(this,"requestTransportStats",void 0),jw(this,"requestLocalMedia",void 0),jw(this,"requestRemoteMedia",void 0),jw(this,"requestAllTracks",void 0),jw(this,"requestVideoIsReady",void 0),jw(this,"requestUploadStats",void 0),jw(this,"requestUpload",void 0),jw(this,"uploadOutboundStarted",!1),jw(this,"uploadInboundStarted",!1),jw(this,"uploadTransportStarted",!1),jw(this,"uploadExtensionUsageStarted",!1),jw(this,"lastRecvStats",void 0),jw(this,"lastSendStats",void 0),jw(this,"lastFullRecvStats",void 0),jw(this,"lastFullSendStats",void 0),jw(this,"needUploadRenderFreezeTime",!0),this.store=e}uploadWRTCStats(e){if(!this.requestStats||!this.requestUploadStats)return;let t,n;if(this.uploadTransportStarted&&(t=this.requestStats(),this.store.useP2P&&(n=this.requestStats(!0))),!t&&this.uploadOutboundStarted&&(t=this.requestStats()),!n&&this.uploadInboundStarted&&(n=this.requestStats(!0)),t||n){const r={};if(this.uploadTransportStarted&&t){const i=this.getTransportStats(t,n,e);i&&(r.misc=[i])}if(this.uploadOutboundStarted&&t){const n=this.getOutboundStats(t,e?this.lastSendStats:this.lastFullSendStats,e);n&&(r.outbound=[n])}if(this.uploadInboundStarted&&n){const t=this.getInboundStats(n,e?this.lastRecvStats:this.lastFullRecvStats,e);t&&(r.inbound=t)}this.requestUploadStats(r)}this.lastRecvStats=n,this.lastSendStats=t,e||(this.lastFullRecvStats=n,this.lastFullSendStats=t)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let e=1;this.uploadWRTCStatsTimer=window.setInterval((()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(3!==e),4==++e&&(e=1)}),sj)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(e,t,n){if(!this.requestStats)return;if(n)return null==e.rtt?void 0:{addition:{[aj.RTT]:e.rtt,[aj.CONN_TYPE]:void 0}};const r=lj(e);if(this.store.useP2P){if(t){const e=lj(t);r[aj.CONN_TYPE]+=e[aj.CONN_TYPE]<<3}r[aj.CONN_TYPE]+=110}else r[aj.CONN_TYPE]+=100;return{addition:r}}getOutboundStats(e,t,n){if(!this.requestUploadStats||!this.requestLocalMedia)return;const r=this.requestLocalMedia();if(!r||0===r.length)return;let i,o,a;return r.forEach((r=>{let[s,{track:c,ssrcs:l}]=r;switch(s){case _I.LocalVideoLowTrack:case _I.LocalVideoTrack:if(s===_I.LocalVideoTrack){const r=function(e,t,n,r,i){const o=t.videoSend.find((t=>t.ssrc===e));if(!o)return;const a={},{sentFrame:s,inputFrame:c}=o;if(c&&s){const e=c.frameRate,t=s.frameRate;a[QU.FREEZE]=function(e,t){let n=!0;return n=!(e<=5)&&(e<=10?t<3:e<=20?t<4:t<5),n}(e,t)?1:0}if(cj(a,QU.QP_SUM,o.qpSumPerFrame),i)return a;switch(s&&(cj(a,QU.HEIGHT,s.height),cj(a,QU.WIDTH,s.width),cj(a,QU.FRAME_RATE,s.frameRate)),a[QU.DISABLED]=r._originMediaStreamTrack&&!r._originMediaStreamTrack.enabled||r._mediaStreamTrack&&!r._mediaStreamTrack.enabled?1:0,o.adaptionChangeReason){case"none":a[QU.ADAPTATION]=0;break;case"cpu":a[QU.ADAPTATION]=1;break;case"bandwidth":a[QU.ADAPTATION]=2;break;case"other":a[QU.ADAPTATION]=3}let l=0;o.adaptionChangeReason&&(l+=dj(o.adaptionChangeReason)),t.qualityLimitationReason&&(l+=dj(t.qualityLimitationReason)<<3),a[QU.ADAPTATION]=l,a[QU.PLAYER_STATUS]=FL[r._player?r._player.videoElementStatus:"uninit"],cj(a,QU.NACKS,o.nacksCount),cj(a,QU.PLIS,o.plisCount),cj(a,QU.FIRS,o.firsCount),cj(a,QU.AVG_ENCODE,o.avgEncodeMs);const d=n&&n.videoSend.find((t=>t.ssrc===e));if(d){let e=i?sj:3e3;d.timestamp&&o.timestamp&&(e=o.timestamp-d.timestamp),null!=d.packets&&null!=o.packets&&cj(a,QU.PACKAGE_RATE,1e3*(o.packets-d.packets)/e),null!=o.packetsLost&&null!=d.packetsLost&&cj(a,QU.PACKAGE_LOST,o.packetsLost-d.packetsLost),null!=d.bytes&&null!=o.bytes&&cj(a,QU.BITRATE,8*(o.bytes-d.bytes)/e)}return a}(l[0].ssrcId,e,t,c,n),i=n?null:function(e,t,n){const r=t.videoSend.find((t=>t.ssrc===e));if(!r)return null;const i={},o=r.inputFrame,a=o&&o.height||n&&n.videoHeight||0,s=o&&o.width||n&&n.videoWidth||0,c=o&&o.frameRate||0;return cj(i,ZU.HEIGHT,a),cj(i,ZU.WIDTH,s),cj(i,ZU.FRAME_RATE,c),i}(l[0].ssrcId,e,c),a=n?null:function(e){const t={};return cj(t,QU.RETRANSMIT,e.bitrate.retransmit),cj(t,QU.TARGET_ENCODED,e.bitrate.targetEncoded),cj(t,QU.ACTUAL_ENCODED,e.bitrate.actualEncoded),cj(t,QU.TRANSMIT,e.bitrate.transmit),cj(t,QU.BANDWIDTH,e.sendBandwidth),t}(e);o=Object.assign({},r,i,a)}else a=n?void 0:function(e,t,n){const r=t.videoSend.find((t=>t.ssrc===e));if(!r)return;const i={},o=r.sentFrame;if(o&&(cj(i,$U.HEIGHT,o.height),cj(i,$U.WIDTH,o.width),cj(i,$U.FRAME_RATE,o.frameRate)),n){const t=n.videoSend.find((t=>t.ssrc===e));if(t){let e=3e3;t.timestamp&&r.timestamp&&(e=r.timestamp-t.timestamp),null!=t.packets&&null!=r.packets&&cj(i,$U.PACKAGE_RATE,1e3*(r.packets-t.packets)/e),null!=r.packetsLost&&null!=t.packetsLost&&cj(i,$U.PACKAGE_LOST,r.packetsLost-t.packetsLost),null!=t.bytes&&null!=r.bytes&&cj(i,$U.BITRATE,8*(r.bytes-t.bytes)/e)}}return i}(l[0].ssrcId,e,t);break;case _I.LocalAudioTrack:i=n?void 0:function(e,t,n,r){const i=t.audioSend.find((t=>t.ssrc===e));if(!i)return;const o={};o[rj.DISABLED]=r._originMediaStreamTrack&&!r._originMediaStreamTrack.enabled||r._mediaStreamTrack&&!r._mediaStreamTrack.enabled?1:0;const a=100*r._source.getAccurateVolumeLevel(),s=i.inputLevel;if(null!=s){const e=Math.ceil(50*Math.log10(100*s+1));cj(o,rj.LEVEL,e)}cj(o,nj.PCM_LEVEL,a),cj(o,rj.AEC_RETURN_LOSS,i.aecReturnLoss),cj(o,rj.AEC_RETURN_LOSS_ENH,i.aecReturnLossEnhancement),o[rj.FREEZE]=0;const c=n&&n.audioSend.find((t=>t.ssrc===e));if(c){let e=3e3;c.timestamp&&i.timestamp&&(e=i.timestamp-c.timestamp),null!=c.bytes&&null!=i.bytes&&cj(o,rj.BITRATE,8*(i.bytes-c.bytes)/e),null!=c.packets&&null!=i.packets&&cj(o,rj.PACKAGE_RATE,1e3*(i.packets-c.packets)/e)}return o}(l[0].ssrcId,e,t,c)}})),{high:o,low:a,audio:i}}getInboundStats(e,t,n){if(!this.requestRemoteMedia)return;const r=this.requestRemoteMedia()||[],i=[];return r.forEach((r=>{let[o,a]=r;const s={peer:o.uid};if(a.has(mI.VIDEO)&&o.videoTrack){const r=o._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(o._videoSSRC)||!1,i=o.videoTrack?function(e,t,n,r,i,o,a){var s;const c=t.videoRecv.find((t=>t.ssrc===e));if(!c)return;const l={},{receivedFrame:d,outputFrame:u,decodeFrameRate:p}=c,h=n&&n.videoRecv.find((t=>t.ssrc===e));if(l[ej.FREEZE]=i&&Dj.isRemoteVideoFreeze(r,c,h)?1:0,cj(l,tj.FRAME_RATE_DECODE,p),cj(l,ej.QP_SUM,c.qpSumPerFrame),c.framesRateFirefox&&cj(l,ej.FRAME_RATE,c.framesRateFirefox),d&&cj(l,ej.FRAME_RATE,d.frameRate),h){const e=t.timestamp-n.timestamp||(a?sj:3e3);null!=c.packetsLost&&null!=h.packetsLost&&cj(l,ej.PACKAGE_LOST,c.packetsLost-h.packetsLost),null!=h.bytes&&null!=c.bytes&&cj(l,ej.BITRATE,8*(c.bytes-h.bytes)/e),null!=h.packets&&null!=c.packets&&cj(l,ej.PACKAGE_RATE,1e3*(c.packets-h.packets)/e)}if(a)return l;d?(cj(l,ej.HEIGHT,d.height),cj(l,ej.WIDTH,d.width)):r&&(cj(l,ej.HEIGHT,r._videoHeight||0),cj(l,ej.WIDTH,r._videoWidth||0)),u&&cj(l,tj.FRAME_RATE_OUTPUT,u.frameRate);const f=null===(s=r._player)||void 0===s?void 0:s.rendFrameRate.toFixed(0);if(f&&cj(l,tj.FRAME_RATE_RENDER,+f),cj(l,ej.JITTER_BUFFER,c.jitterBufferMs),cj(l,ej.CURRENT_DELAY,c.currentDelayMs),cj(l,ej.FIRS,c.firsCount),cj(l,ej.NACKS,c.nacksCount),cj(l,ej.PLIS,c.plisCount),r){l[ej.DISABLED]=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?0:1;const e=r._player;if(e){const{freezeTimeCounterList:t,renderFreezeAccTime:n,videoElementStatus:r}=e;if(t&&t.length>0&&cj(l,tj.FREEZE_TIME,t.splice(0,1)[0]),o&&"visible"===OD.visibility&&r===VL.PLAYING&&nL().supportRequestVideoFrameCallback){const t=Math.min(6e3,n);e.renderFreezeAccTime=Math.max(0,n-t),cj(l,tj.FREEZE_TIME_RENDER,t)}if("number"==typeof c.totalFreezesDuration){const e=h&&h.totalFreezesDuration?c.totalFreezesDuration-h.totalFreezesDuration:c.totalFreezesDuration;cj(l,tj.FREEZE_DURATION,1e3*e)}}}if(l[ej.PLAYER_STATUS]=FL[r._player?r._player.videoElementStatus:"uninit"],h&&void 0!==c.totalInterFrameDelay&&void 0!==c.totalSquaredInterFrameDelay&&void 0!==h.totalInterFrameDelay&&void 0!==h.totalSquaredInterFrameDelay){const e=c.totalInterFrameDelay-h.totalInterFrameDelay,t=c.totalSquaredInterFrameDelay-h.totalSquaredInterFrameDelay,n=c.framesDecodeCount-h.framesDecodeCount,r=e/n*1e3,i=Math.round(1e3*Math.sqrt((t-Math.pow(e,2)/n)/n));!isNaN(i)&&r+i>Math.max(3*r,r+150)&&(l[ej.I_FRAME_DELAY]=i)}return l}(o._videoSSRC,e,t,o.videoTrack,!0===r,this.needUploadRenderFreezeTime,n):void 0;i&&(s.video=i)}if(a.has(mI.AUDIO)&&o.audioTrack){const r=o.audioTrack?function(e,t,n,r,i){const o=t.audioRecv.find((t=>t.ssrc===e));if(!o)return;const a={},s=n&&n.audioRecv.find((t=>t.ssrc===e)),{receivedFrames:c,droppedFrames:l}=o;var d;if(cj(a,ij.JITTER,o.jitterMs),null!=c&&null!=l&&(a[ij.FREEZE]=0===(d=c)||100*l/d>20?1:0),s){const e=t.timestamp-n.timestamp||(i?sj:3e3);null!=o.packets&&null!=s.packets&&cj(a,ij.PACKAGE_RATE,1e3*(o.packets-s.packets)/e),null!=s.bytes&&null!=o.bytes&&cj(a,ij.BITRATE,8*(o.bytes-s.bytes)/e),null!=o.packetsLost&&null!=s.packetsLost&&cj(a,ij.PACKAGE_LOST,o.packetsLost-s.packetsLost)}if(i)return a;const u=100*r._source.getAccurateVolumeLevel(),p=o.outputLevel;if(null!=p){const e=Math.ceil(50*Math.log10(100*p+1));cj(a,oj.LEVEL,e)}if(cj(a,ij.PCM_LEVEL,u),r&&(a[ij.DISABLED]=r._originMediaStreamTrack.enabled&&r._mediaStreamTrack.enabled?0:1),cj(a,ij.JITTER_BUFFER,o.jitterBufferMs),cj(a,ij.CURRENT_DELAY,o.jitterBufferMs),a[ij.PLAYER_STATUS]=FL[wN.getPlayerState(r.getTrackId())],s){const e=o.concealedSamples-s.concealedSamples;e>0&&cj(a,ij.CONCEALED_SAMPLES,e)}return a}(o._audioSSRC,e,t,o.audioTrack,n):void 0;r&&(s.audio=r)}(s.video||s.audio)&&i.push(s)})),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,i}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval((()=>{if(!this.requestAllTracks||!this.requestUpload)return;const e=(this.requestAllTracks()||[]).find((e=>e instanceof bP));if(e&&e._external.getDenoiserStats){const t=e._external.getDenoiserStats();t&&this.requestUpload(jO.DENOISER_STATS,t)}}),2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval((()=>{this.requestAllTracks&&this.requestUpload&&this.requestAllTracks().forEach((e=>{e.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}))}))}),2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval((()=>{this.requestUpload&&this.requestRemoteMedia&&(this.requestRemoteMedia()||[]).forEach((e=>{let[t,n]=e;n.has(mI.VIDEO)&&t.videoTrack&&t.videoTrack.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)})),n.has(mI.AUDIO)&&t.audioTrack&&t.audioTrack.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}))}))}),2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const e=new Map;this.uploadExtUsageStatsTimer=window.setInterval((async()=>{const t=Date.now(),n={connectionInterval:aR("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:t};let r=[];const i=this.requestAllTracks&&this.requestAllTracks()||[];for(const e of i)!e.muted&&e.enabled&&(r=r.concat(await e.getProcessorUsage()));const o=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[e,t]of o)t.has(mI.VIDEO)&&e.videoTrack&&(r=r.concat(await e.videoTrack.getProcessorUsage())),t.has(mI.AUDIO)&&e.audioTrack&&(r=r.concat(await e.audioTrack.getProcessorUsage()));if(0===r.length)return;n.details=function(e,t){const n={};for(const{id:a,value:s,level:c,direction:l}of e){var r;const e=null!==(r=t.get(a))&&void 0!==r?r:0,d=2===s?e+aR("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:e;var i,o;t.set(a,d),n[a]?(2===s&&(n[a].value=s),c>n[a].level&&(n[a].level=c),"remote"===l&&(n[a].remoteUidCount+=1),n[a].totalTs=null!==(i=t.get(a))&&void 0!==i?i:0):n[a]={value:s,level:c,remoteUidCount:"local"===l?0:1,totalTs:null!==(o=t.get(a))&&void 0!==o?o:0}}return Object.keys(n).map((e=>{const{level:t,value:r,totalTs:i}=n[e];return{id:e,level:t,value:r,totalTs:i}}))}(r,e);const a=Date.now(),s=a>t?a:t+1;this.requestUpload&&this.requestUpload(jO.EXTENSION_USAGE_STATS,{usageStats:n,sendTs:s})}),aR("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class pj{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(e,t){jw(this,"uid",void 0),jw(this,"_uintid",void 0),jw(this,"_trust_in_room_",!0),jw(this,"_trust_audio_enabled_state_",!0),jw(this,"_trust_video_enabled_state_",!0),jw(this,"_trust_audio_mute_state_",!0),jw(this,"_trust_video_mute_state_",!0),jw(this,"_audio_muted_",!1),jw(this,"_video_muted_",!1),jw(this,"_audio_enabled_",!0),jw(this,"_video_enabled_",!0),jw(this,"_audio_added_",!1),jw(this,"_video_added_",!1),jw(this,"_is_pre_created",!1),jw(this,"_video_pre_subscribed",!1),jw(this,"_audio_pre_subscribed",!1),jw(this,"_trust_video_stream_added_state_",!0),jw(this,"_trust_audio_stream_added_state_",!0),jw(this,"_audioTrack",void 0),jw(this,"_videoTrack",void 0),jw(this,"_dataChannels",[]),jw(this,"_audioSSRC",void 0),jw(this,"_videoSSRC",void 0),jw(this,"_audioOrtc",void 0),jw(this,"_videoOrtc",void 0),jw(this,"_cname",void 0),jw(this,"_rtxSsrcId",void 0),jw(this,"_videoMid",void 0),jw(this,"_audioMid",void 0),this.uid=e,this._uintid=t}}let hj=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});function fj(e,t){var n;let r;switch(t){case _I.LocalAudioTrack:r=iI.Audio;break;case _I.LocalVideoTrack:r=Li(n=e._hints).call(n,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalVideoLowTrack:r=iI.Low}return r}function mj(e){const t=nL();if(e.some((e=>e._bypassWebAudio)))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function gj(e,t){mj(e);const n=t||new SP;return e.forEach((e=>n.addAudioTrack(e))),n}var vj,_j,yj,wj,bj,Ej,Sj,Tj,Cj,Rj,Oj,Ij;function Aj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aj(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let xj=(vj=Lj(hj.SEND_ONLY),_j=Lj(hj.SEND_ONLY),yj=Lj(),wj=Lj(hj.RECEIVE_ONLY),bj=Lj(hj.RECEIVE_ONLY),Ej=Lj(hj.RECEIVE_ONLY),Sj=Lj(hj.RECEIVE_ONLY),Tj=Lj(hj.RECEIVE_ONLY),Cj=Lj(hj.RECEIVE_ONLY),Rj=Lj(),Oj=Lj(hj.RECEIVE_ONLY),Ij=class extends YT{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(wI.StateChange,t,this._state)}constructor(e,t){super(),jw(this,"isPlanB",!1),jw(this,"store",void 0),jw(this,"statsUploader",void 0),jw(this,"sendConnection",void 0),jw(this,"recvConnection",void 0),jw(this,"localTrackMap",new Map),jw(this,"remoteUserMap",new Map),jw(this,"localDataChannels",[]),jw(this,"pendingLocalTracks",[]),jw(this,"pendingRemoteTracks",[]),jw(this,"statsCollector",void 0),jw(this,"dtlsFailedCount",0),jw(this,"sendMutex",new FC("P2PChannel2-send-mutex")),jw(this,"recvMutex",new FC("P2PChannel2-recv-mutex")),jw(this,"_state",yI.Disconnected),jw(this,"_restartStates",["disconnected","failed"]),jw(this,"reconnectInterval",void 0),jw(this,"uploadUnplinkStarted",!1),jw(this,"uploadDownlinkStarted",!1),jw(this,"uplinkStateUploadInterval",void 0),jw(this,"downlinkStatsUploadInterval",void 0),jw(this,"handleMuteLocalTrack",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==yI.Connected)return void n(new NT(LT.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const r=this.filterTobeMutedTracks(e);if(0===r.length)return void t();const a=r.find((e=>"videoLowTrack"===e[0]));a&&a[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(r.map((e=>{let[,{id:t}]=e;return t})));let s=!1;var i,o;s="video"===e.trackMediaType?!(null===(i=this.localTrackMap.get(_I.LocalAudioTrack))||void 0===i||!i.track._muted):void 0===(null===(o=this.localTrackMap.get(_I.LocalVideoTrack))||void 0===o?void 0:o.id);const c=this.createMuteMessage(r);await dC(this,wI.RequestMuteLocal,c);const l="video"===e.trackMediaType?xI.MUTE_LOCAL_VIDEO:xI.MUTE_LOCAL_AUDIO;await dC(this,wI.RequestP2PMuteLocal,{action:l,message:c,isMuteAll:s}),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleUnmuteLocalTrack",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==yI.Connected)return void n(new NT(LT.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const r=this.filterTobeUnmutedTracks(e);if(0===r.length)return void t();await this.sendConnection.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t})));const i=this.createUnmuteMessage(r),o="video"===e.trackMediaType?xI.UNMUTE_LOCAL_VIDEO:xI.UNMUTE_LOCAL_AUDIO;await dC(this,wI.RequestP2PMuteLocal,{action:o,message:i}),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleUpdateVideoEncoder",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const n=this.localTrackMap.get(_I.LocalVideoTrack);if(!this.sendConnection||!n||n.track!==e||this.state!==yI.Connected)return void t();const{id:r,track:i}=n;r&&(await this.sendConnection.updateSendParameters(r,i),await this.sendConnection.updateEncoderConfig(r,i),this.emit(wI.UpdateVideoEncoder,i)),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleUpdateVideoSendParameters",(async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const n=this.localTrackMap.get(_I.LocalVideoTrack);if(!this.sendConnection||!n||n.track!==e||this.state!==yI.Connected)return void t();const{id:r,track:i}=n;r&&await this.sendConnection.updateSendParameters(r,i),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleReplaceTrack",(async(e,t,n,r)=>{let i;SR.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(i=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var o;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!this.sendConnection||!n||void 0===n[1].id||this.state!==yI.Connected)return void t();if(await(null===(o=this.sendConnection)||void 0===o?void 0:o.replaceTrack(e,n[1].id)),n[0]===_I.LocalVideoTrack&&nL().supportDualStreamEncoding){const t=this.localTrackMap.get(_I.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new Ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}t()}catch(e){n(e)}finally{var a;null===(a=i)||void 0===a||a()}})),jw(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),jw(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),jw(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),jw(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new uj(e),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval((()=>{[this.sendConnection,this.recvConnection].forEach((e=>{e&&("disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))}))}),aR("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let n;try{if(t){this.recvConnection&&(SR.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),n=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new YU(e,this.store,BO.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const r=await this.recvConnection.establish(t);return{iceParameters:r.iceParameters,dtlsParameters:r.dtlsParameters,sdp:r.sdp}}{this.state=yI.New,this.sendConnection&&(SR.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),n=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new YU(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const t=await this.sendConnection.establish();return{iceParameters:t.iceParameters,dtlsParameters:t.dtlsParameters,sdp:t.sdp}}}finally{n&&n()}}async p2pConnect(e){if(!this.sendConnection)throw new NT(LT.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=yI.Connected}async addRemoteCandidate(e,t){if(t===BO.RECEIVE_ONLY){if(!this.sendConnection)throw new NT(LT.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new NT(LT.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,n){var r=this;return uU((function*(){const i=yield nU(r.sendMutex.lock("From P2PChannel.publish"));try{if(!r.sendConnection||r.state!==yI.Connected){r.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===r.pendingLocalTracks.indexOf(e)));return void(r.pendingLocalTracks=r.pendingLocalTracks.concat(t))}r.store.pubId=r.store.pubId+1,eU.markPublishStart(r.store.clientId,r.store.pubId);const i=r.filterTobePublishedTracks(e,t,n);if(0===i.length)return void(yield nU(r.tryToUnmuteAudio(e)));i.forEach((e=>{let{track:t,type:n}=e;const i=Date.now();r.store.publish(t.getTrackId(),n===_I.LocalAudioTrack?"audio":"video",i)})),r.bindLocalTrackEvents(i);const o=yield nU(r.sendConnection.send(i.map((e=>{let{track:t}=e;return t})),r.store.codec,r.store.audioCodec)),a=(yield nU(o.next())).value,s=r.createGatewayPublishMessage(i,a);try{yield s}catch(e){throw o.throw(e),(null==e?void 0:e.code)===LT.WS_ABORT&&i.forEach((e=>{let{track:t}=e;-1===r.pendingLocalTracks.indexOf(t)&&r.pendingLocalTracks.push(t)})),r.unbindLocalTrackEvents(i),e}yield nU(o.next()),i.forEach((e=>{let{type:t}=e;r.statsCollector.addLocalStats(t)})),r.statsUploader.startUploadOutboundStats(),r.assignLocalTracks(i,a),i.forEach((e=>{let{track:t,type:n}=e;const i=Date.now();r.store.publish(t.getTrackId(),n===_I.LocalAudioTrack?"audio":"video",void 0,i)})),r.startUploadUplinkState()}finally{i()}}))()}async unpublish(e){if(!this.sendConnection||this.state!==yI.Connected)return void(0===e.length?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter((t=>!Li(e).call(e,t))));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find((e=>"videoLowTrack"===e[0]));n&&n[1].track.close();const r=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:n}]=e;return{type:t,track:n}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===yI.Connected)return n&&n[1].track.close(),r;e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}))}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const e=[],t=[];Array.from(this.localTrackMap.entries()).forEach((n=>{let[r,{track:i,ssrcs:o}]=n;const a={stream_type:fj(i,r),ssrcs:o};i._muted||!i._enabled?e.push(a):t.push(a)})),e.length>0&&e.forEach((e=>{dC(this,wI.RequestMuteLocal,[e])})),t.length>0&&t.forEach((e=>{dC(this,wI.RequestUnmuteLocal,[e])}))};e(),this.uplinkStateUploadInterval=window.setInterval((()=>{e()}),3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return uU((function*(){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")}))()}async republish(){this.pendingLocalTracks.length>0&&(SR.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await lC(this,wI.RequestRePublish,this.pendingLocalTracks),this.emit(wI.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,n,r){var i;if(!this.recvConnection)throw new NT(LT.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if(null!==(i=this.remoteUserMap.get(e))&&void 0!==i&&i.has(t))return;const{track:o,mid:a,transceiver:s}=await this.recvConnection.receive(t,[{ssrcId:n}],String(e.uid),r);t===mI.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(o):(e._audioTrack=new RD(o,e.uid,e._uintid,this.store),SR.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),s&&e._audioTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=n,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(o):(e._videoTrack=new CD(o,e.uid,e._uintid,this.store),SR.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),s&&e._videoTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(e,e._videoTrack));const c=this.remoteUserMap.get(e);c?c.set(t,a):this.remoteUserMap.set(e,new Map([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const l=this.pendingRemoteTracks.findIndex((n=>{let{user:r,kind:i}=n;return r.uid===e.uid&&t===i}));-1!==l&&(this.pendingRemoteTracks.splice(l,1),this.emit(wI.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,n,r){if(!this.recvConnection)throw new NT(LT.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:n}],String(e.uid),r)}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter((n=>{let{user:r,kind:i}=n;return void 0!==t?r.uid===e.uid&&t===i:r.uid===e.uid}));if(r.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.recvConnection||n||r.forEach((t=>{let{kind:n}=t;var r;if(n===mI.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===mI.VIDEO){var i;null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0}})),!this.recvConnection)return;const i=this.filterTobeUnSubscribedTracks(e,t);0!==i.length&&(await this.recvConnection.stopReceiving(i.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawRemoteTracks(i),0===this.remoteUserMap.size&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),i.forEach((e=>{let[t,{kind:r}]=e;var i,o;if(r===mI.VIDEO&&t._videoSSRC&&(null===(i=this.recvConnection)||void 0===i||i.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===mI.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(r===mI.AUDIO){var a;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(a=t._audioTrack)||void 0===a||a._destroy(),t._audioTrack=void 0)}})),i.forEach((e=>{let[,{kind:t}]=e;dC(this,wI.RequestP2PMuteRemote,t)})))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach((e=>{let[,t]=e;[mI.VIDEO,mI.AUDIO].forEach((e=>{t.has(e)?dC(this,wI.RequestP2PUnmuteRemote,e):dC(this,wI.RequestP2PMuteRemote,e)}))}));e(),this.downlinkStatsUploadInterval=window.setInterval((()=>{e()}),3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new NT(LT.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;const n=this.remoteUserMap.get(e);if(!n)return void SR.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!n.get(t))return void SR.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===mI.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.recvConnection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;const n=this.remoteUserMap.get(e);n?n.get(t)||SR.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):SR.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."))}getAllTracks(e){const t=this.localTrackMap.get(_I.LocalAudioTrack);if((null==t?void 0:t.track)instanceof SP){const n=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==_I.LocalAudioTrack})).filter((t=>{let[n]=t;return!(e&&n===_I.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[n]=t;return!(e&&n===_I.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}reportPublishEvent(e,t,n,r,i){if(e){const n=this.localTrackMap.get(_I.LocalAudioTrack),o=r?this.localTrackMap.get(_I.LocalVideoLowTrack):this.localTrackMap.get(_I.LocalVideoTrack);LR.publish(this.store.sessionId,{eventElapse:eU.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(bL.SCREEN_TRACK)),audio:!!n,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;n||(n=[]);const a=n.find((e=>e instanceof wP)),s=r?null===(o=this.localTrackMap.get(_I.LocalVideoTrack))||void 0===o?void 0:o.track:n.find((e=>e instanceof lD));LR.publish(this.store.sessionId,{eventElapse:eU.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==a?void 0:a.getTrackLabel(),videoName:null==s?void 0:s.getTrackLabel(),screenshare:-1!==(null==s?void 0:s._hints.indexOf(bL.SCREEN_TRACK)),audio:!!a,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,n,r){const i=r===mI.VIDEO?n._videoSSRC:n._audioSSRC;i&&LR.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===mI.VIDEO,audio:r===mI.AUDIO,peerid:n.uid,subscribeRequestid:r===mI.VIDEO?n._videoSSRC:n._audioSSRC,p2pid:this.store.p2pId,eventElapse:eU.measureFromSubscribeStart(this.store.clientId,i)})}reset(){SR.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new FC("P2PChannel2-send-mutex"),this.sendMutex=new FC("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(_I.LocalAudioTrack);if((null==e?void 0:e.track)instanceof SP){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach((e=>{t.removeAudioTrack(e)}))}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=yI.Disconnected}getStats(e){var t,n;return e?null===(n=this.recvConnection)||void 0===n?void 0:n.getStats():null===(t=this.sendConnection)||void 0===t?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.recvConnection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(_I.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(_I.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof lD||t&&t.track instanceof wP?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(_I.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Wm(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(SR.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=yI.Reconnecting,aR("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t]=e;var n;t._videoTrack&&t._videoTrack._player&&(null===(n=t._videoTrack._player.getVideoElement())||void 0===n||n.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())})),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{var t;let[n,{track:r}]=e;switch(n){case _I.LocalVideoTrack:Li(t=r._hints).call(t,bL.LOW_STREAM)?r.close():this.pendingLocalTracks.push(r);break;case _I.LocalAudioTrack:r instanceof SP?this.pendingLocalTracks=this.pendingLocalTracks.concat(r.trackList):this.pendingLocalTracks.push(r);case _I.LocalVideoLowTrack:}})),this.emit(wI.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;Array.from(Yf(n).call(n)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(wI.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),SR.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:i}=n;if((e instanceof pj?e.uid:e)===r.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let n,r;if(e===BO.SEND_ONLY){if(!this.sendConnection)throw new NT(LT.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");n=await this.sendMutex.lock("From P2PChannel.restartICE"),r=this.sendConnection}else{if(!this.recvConnection)throw new NT(LT.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");n=await this.recvMutex.lock("From P2PChannel.restartICE"),r=this.recvConnection}try{if(t){const e=await r.restartICE(t);return r.isInRestartIce=!1,e}{const e=await r.restartICE();if(e){const t=await lC(this,wI.RequestP2PRestartICE,{direction:BO.RECEIVE_ONLY,iceParameter:e});await r.restartICE(t),r.isInRestartIce=!1}}}finally{n()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(_I.LocalVideoTrack),n=this.localTrackMap.get(_I.LocalAudioTrack),r=e.videoSend.find((e=>{var n;return e.ssrc===(null==t||null===(n=t.ssrcs)||void 0===n?void 0:n[0].ssrcId)})),i=e.audioSend.find((e=>{var t;return e.ssrc===(null==n||null===(t=n.ssrcs)||void 0===t?void 0:t[0].ssrcId)}));if(!r||!i)return 1;const o=uC(this,wI.NeedSignalRTT),a=r?r.rttMs:void 0,s=i?i.rttMs:void 0,c=a&&s?(a+s)/2:a||s,l=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*l/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,p=null==t?void 0:t.track;if(p&&p._encoderConfig&&-1===p._hints.indexOf(bL.SCREEN_TRACK)){const t=p._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return DR[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((n=>{let[r]=n;const i=r._audioSSRC,o=r._videoSSRC,a=e.audioRecv.find((e=>e.ssrc===i)),s=e.videoRecv.find((e=>e.ssrc===o));if(!a&&!s)return void(t+=1);const c=uC(this,wI.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=a?a.jitterMs:void 0,p=e.recvPacketLossRate;let h=.7*p*100/50+.3*d/1500;u&&(h=.6*p*100/50+.2*d/1500+.2*u/400),t+=h<.1?1:h<.17?2:h<.36?3:h<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new Ih(((t,n)=>{this.handleMuteLocalTrack(e,t,n)}))}filterTobePublishedTracks(e,t,n){const r=[],i=nL(),o=this.getAllTracks();e=mC(e=e.filter((e=>-1===o.indexOf(e))));let a=!1,s=!1;for(const o of e){if(o instanceof lD&&(this.localTrackMap.has(_I.LocalVideoTrack)||a?new NT(LT.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:o,type:_I.LocalVideoTrack}),a=!0),t)){const e=this.getLowVideoTrack(o,n);r.push({track:e,type:_I.LocalVideoLowTrack})}if(o instanceof wP){const e=this.localTrackMap.get(_I.LocalAudioTrack);if(e){if(!(e.track instanceof SP))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(o._bypassWebAudio)throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(o),this.bindLocalAudioTrackEvents(o,!0)}else if(s){const e=r.find((e=>{let{type:t}=e;return t===_I.LocalAudioTrack}));if(!(e.track instanceof SP))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(o._bypassWebAudio)throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(o)}else{if(!i.webAudioMediaStreamDest||o instanceof SP||o._bypassWebAudio)r.push({track:o,type:_I.LocalAudioTrack});else{const e=new SP;e.addAudioTrack(o),r.push({track:e,type:_I.LocalAudioTrack})}s=!0}}}return r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=mC(e=e.filter((e=>-1!==n.indexOf(e))));for(const n of e){if(n instanceof wP){const e=this.localTrackMap.get(_I.LocalAudioTrack);if(!e)continue;e.track instanceof SP?(e.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),0===e.track.trackList.length&&(t.push([_I.LocalAudioTrack,e]),e.track.close())):t.push([_I.LocalAudioTrack,e])}if(n instanceof lD){const e=this.localTrackMap.get(_I.LocalVideoTrack);if(!e)continue;t.push([_I.LocalVideoTrack,e]);const n=this.localTrackMap.get(_I.LocalVideoLowTrack);n&&t.push([_I.LocalVideoLowTrack,n])}}return t}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:n}=e;switch(n){case _I.LocalVideoTrack:t.addListener(wL.GET_STATS,this.handleGetLocalVideoStats),t.addListener(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(wL.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(wL.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.addListener(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case _I.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case _I.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof SP?e.trackList.forEach((e=>{e.addListener(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(wL.GET_STATS,this.handleGetLocalAudioStats),e.addListener(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(wL.GET_STATS,this.handleGetLocalAudioStats),e.addListener(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:n}]=e;return{track:n,type:t}}))),e.forEach((e=>{let{track:t,type:n}=e;switch(n){case _I.LocalVideoTrack:t.off(wL.GET_STATS,this.handleGetLocalVideoStats),t.off(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(wL.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(wL.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.off(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case _I.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case _I.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof SP?e.trackList.forEach((e=>{e.off(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(wL.GET_STATS,this.handleGetLocalAudioStats),e.off(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(wL.GET_STATS,this.handleGetLocalAudioStats),e.off(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof CD&&t.addListener(wL.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof RD&&t.addListener(wL.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(wL.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;n.has(mI.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(mI.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,n)=>{var r;let i,{track:o,type:a}=e;switch(a){case _I.LocalAudioTrack:i=iI.Audio;break;case _I.LocalVideoTrack:i=Li(r=o._hints).call(r,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalVideoLowTrack:i=iI.Low}return{kind:a===_I.LocalAudioTrack?mI.AUDIO:mI.VIDEO,stream_type:i,mid:t[n].id,ssrcs:t[n].localSSRC,isMuted:o.muted||!o.enabled}}))}createGatewayUnpublishMessage(e){return e.map((e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case _I.LocalVideoTrack:n=Li(t=i._hints).call(t,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalAudioTrack:n=iI.Audio;break;case _I.LocalVideoLowTrack:n=iI.Low}return{stream_type:n,ssrcs:o,mid:a}}))}assignLocalTracks(e,t){e.forEach(((e,n)=>{let{track:r,type:i}=e;this.localTrackMap.set(i,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var n;SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(wI.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(e.isInRestartIce=!1),Li(n=this._restartStates).call(n,t)&&!e.isInRestartIce&&("disconnected"===t&&await IC(800),"disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),LR.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:QT.TRACER}).onSuccess(),this.emit(wI.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(OL.FIRST_FRAME_DECODED),LR.firstRemoteFrame(this.store.sessionId,OR.FIRST_AUDIO_DECODE,IR.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));n&&LR.firstRemoteFrame(this.store.sessionId,OR.FIRST_AUDIO_RECEIVED,IR.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoReceived=e=>{var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));n&&LR.firstRemoteFrame(this.store.sessionId,OR.FIRST_VIDEO_RECEIVED,IR.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(wI.ConnectionTypeChange,n),SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(lA(t))," -> ").concat(JSON.stringify(lA(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(lA(t))," -> ").concat(JSON.stringify(lA(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(wI.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const t=e===BO.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,SR.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===BO.SEND_ONLY?this.restartICE(e):lC(this,wI.RequestP2PRestartICE,{direction:BO.SEND_ONLY}))}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(_I.LocalAudioTrack);if(e instanceof wP&&(null==n?void 0:n.track)instanceof SP)return n.track.isActive||t.push([_I.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r&&(t.push(r),r[0]===_I.LocalVideoTrack)){const e=this.localTrackMap.get(_I.LocalVideoLowTrack);e&&t.push([_I.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(_I.LocalAudioTrack);if(e instanceof wP&&(null==n?void 0:n.track)instanceof SP)return n.track.isActive&&t.push([_I.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r)if(r[0]===_I.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(_I.LocalVideoLowTrack);e&&t.push([_I.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map((e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case _I.LocalAudioTrack:n=iI.Audio;break;case _I.LocalVideoTrack:n=Li(t=i._hints).call(t,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalVideoLowTrack:n=iI.Low}return{stream_type:n,ssrcs:o,mid:a}}))}createUnmuteMessage(e){return e.map((e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case _I.LocalAudioTrack:n=iI.Audio;break;case _I.LocalVideoTrack:n=Li(t=i._hints).call(t,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalVideoLowTrack:n=iI.Low}return{stream_type:n,ssrcs:o,mid:a}}))}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const i=r.get(t);if(!i)return n;n.push([e,{kind:t,id:i}])}else Array.from(r.entries()).forEach((t=>{let[r,i]=t;n.push([e,{kind:r,id:i}])}));return n}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[n,{kind:r,id:i}]=e;switch(r){case mI.VIDEO:return void(n._videoSSRC&&t.push({stream_type:mI.VIDEO,ssrcId:n._videoSSRC}));case mI.AUDIO:return void(n._audioSSRC&&t.push({stream_type:mI.AUDIO,ssrcId:n._audioSSRC}))}})),t}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(_I.LocalVideoTrack),n=this.localTrackMap.get(_I.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),n&&e.low_stream_uplink&&await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return"connected"!==e&&"connected"!==t}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof wP){const n=this.filterTobeUnmutedTracks(e[t]);if(0===n.length)continue;const r=this.createUnmuteMessage(n);return void await dC(this,wI.RequestUnmuteLocal,r)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter((e=>{let[,{ssrcs:t}]=e;return!!t})),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.recvConnection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(wI.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(wI.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await IC(qC(this.dtlsFailedCount,HC)),this.emit(wI.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(_I.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof lD))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof lD)).length>1)throw new NT(LT.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof wP)).length>1&&(e.some((e=>e instanceof wP&&e._bypassWebAudio))||!nL().webAudioMediaStreamDest))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof lD&&this.pendingLocalTracks.some((e=>e instanceof lD)))throw new NT(LT.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof wP&&this.pendingLocalTracks.some((e=>e instanceof wP))&&(!nL().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof wP&&e._bypassWebAudio))))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const n=!aR("DISABLE_DUAL_STREAM_USE_ENCODING")&&nL().supportDualStreamEncoding,r=kj(kj({},{width:160,height:120,framerate:15,bitrate:50}),t);let i;i=n?e._mediaStreamTrack.clone():XU(e,r);const o=AC(8,"track-low-"),a=new lD(i,kj(kj({},n&&{scaleResolutionDownBy:cA(r,e)}),{},{frameRate:r.framerate,bitrateMax:r.bitrate,bitrateMin:r.bitrate}),void 0,void 0,o);return a.on(CL.TRANSCEIVER_UPDATED,(t=>{e._updateRtpTransceiver(t,EL.LOW_STREAM)})),a._hints.push(bL.LOW_STREAM),e.addListener(wL.NEED_CLOSE,(()=>{a.close()})),a}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,n,r){var i;const o=Array.from(Yf(i=this.remoteUserMap).call(i)).find((t=>t._videoSSRC===e));if(o){r||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const i=this.store.keyMetrics,a=i.subscribe.find((e=>e.userId===o.uid&&"video"===e.type));LR.firstRemoteVideoDecode(this.store.sessionId,OR.FIRST_VIDEO_DECODE,IR.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:i.requestAPEnd||0,apStart:i.requestAPStart||0,joinGwEnd:i.joinGatewayEnd||0,joinGwStart:i.joinGatewayStart||0,pcEnd:i.peerConnectionEnd||0,pcStart:i.peerConnectionStart||0,subscriberEnd:(null==a?void 0:a.subscribeEnd)||0,subscriberStart:(null==a?void 0:a.subscribeStart)||0,videoAddNotify:(null==a?void 0:a.streamAdded)||0,state:r?1:0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.recvConnection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const i=r.get(t);if(!i)return!1;const o=await this.recvConnection.getRemoteSSRC(i);return void 0!==o&&o!==n}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new NT(LT.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new NT(LT.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new NT(LT.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new NT(LT.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new NT(LT.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new NT(LT.NOT_SUPPORTED)}async preConnect(e){throw new NT(LT.NOT_SUPPORTED)}getEstablishParams(){throw new NT(LT.NOT_SUPPORTED)}async reSubscribe(e){throw new NT(LT.NOT_SUPPORTED)}async updateVideoStreamParameter(e,t){throw new NT(LT.NOT_SUPPORTED)}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:n}]=e;t===_I.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,EL.LOW_STREAM):n._updateRtpTransceiver(void 0)}))}},OO(Ij.prototype,"p2pConnect",[vj],Object.getOwnPropertyDescriptor(Ij.prototype,"p2pConnect"),Ij.prototype),OO(Ij.prototype,"unpublish",[_j],Object.getOwnPropertyDescriptor(Ij.prototype,"unpublish"),Ij.prototype),OO(Ij.prototype,"unpublishLowStream",[yj],Object.getOwnPropertyDescriptor(Ij.prototype,"unpublishLowStream"),Ij.prototype),OO(Ij.prototype,"subscribe",[wj],Object.getOwnPropertyDescriptor(Ij.prototype,"subscribe"),Ij.prototype),OO(Ij.prototype,"mockSubscribe",[bj],Object.getOwnPropertyDescriptor(Ij.prototype,"mockSubscribe"),Ij.prototype),OO(Ij.prototype,"unsubscribe",[Ej],Object.getOwnPropertyDescriptor(Ij.prototype,"unsubscribe"),Ij.prototype),OO(Ij.prototype,"muteRemote",[Sj],Object.getOwnPropertyDescriptor(Ij.prototype,"muteRemote"),Ij.prototype),OO(Ij.prototype,"unmuteRemote",[Tj],Object.getOwnPropertyDescriptor(Ij.prototype,"unmuteRemote"),Ij.prototype),OO(Ij.prototype,"hasRemoteMediaWithLock",[Cj],Object.getOwnPropertyDescriptor(Ij.prototype,"hasRemoteMediaWithLock"),Ij.prototype),OO(Ij.prototype,"disconnectForReconnect",[Rj],Object.getOwnPropertyDescriptor(Ij.prototype,"disconnectForReconnect"),Ij.prototype),OO(Ij.prototype,"remoteMediaSsrcChanged",[Oj],Object.getOwnPropertyDescriptor(Ij.prototype,"remoteMediaSsrcChanged"),Ij.prototype),Ij);function Lj(e){return function(t,n,r){const i=t[n];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return r.value=async function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];switch(e){case hj.SEND_ONLY:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(n));try{return await i.apply(this,r)}finally{e()}}case hj.RECEIVE_ONLY:{const e=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await i.apply(this,r)}finally{e()}}default:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(n)),t=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await i.apply(this,r)}finally{e(),t()}}}},r}}function Nj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nj(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Dj{constructor(e){jw(this,"store",void 0),jw(this,"onStatsException",void 0),jw(this,"onUploadPublishDuration",void 0),jw(this,"onStatsChanged",void 0),jw(this,"localStats",new Map),jw(this,"remoteStats",new Map),jw(this,"updateStatsInterval",void 0),jw(this,"trafficStats",void 0),jw(this,"trafficStatsPeerList",[]),jw(this,"uplinkStats",void 0),jw(this,"exceptionMonitor",void 0),jw(this,"p2pChannel",void 0),jw(this,"scalabilityMode",IO.L1T1),jw(this,"updateStats",(()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))})),this.store=e,this.exceptionMonitor=new QM,this.exceptionMonitor.on("exception",((e,t,n)=>{this.onStatsException&&this.onStatsException(e,t,n)}))}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(_I.LocalAudioTrack)||Pj({},kL)}getLocalVideoTrackStats(){return this.localStats.get(_I.LocalVideoTrack)||Pj({},xL)}getRemoteAudioTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return n&&(t.publishDuration=n.B_ppad+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.audioStats;i&&(n[e]=t(e,i))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[r,{audioStats:i}]=e;i&&(n[r]=t(r,i))}));return n}getRemoteNetworkQualityStats(e){const t={};if(e){var n;const r=null===(n=this.remoteStats.get(e))||void 0===n?void 0:n.networkStats;r&&(t[e]=r)}else Array.from(this.remoteStats.entries()).forEach((e=>{let[n,{networkStats:r}]=e;r&&(t[n]=r)}));return t}getRemoteVideoTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return n&&(t.publishDuration=n.B_ppvd+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.videoStats;i&&(n[e]=t(e,i))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[r,{videoStats:i}]=e;i&&(n[r]=t(r,i))}));return n}getRTCStats(){let e=0,t=0,n=0,r=0;const i=this.localStats.get(_I.LocalAudioTrack);i&&(e+=i.sendBytes,t+=i.sendBitrate);const o=this.localStats.get(_I.LocalVideoTrack);o&&(e+=o.sendBytes,t+=o.sendBitrate);const a=this.localStats.get(_I.LocalVideoLowTrack);a&&(e+=a.sendBytes,t+=a.sendBitrate),this.remoteStats.forEach((e=>{let{audioStats:t,videoStats:i}=e;t&&(n+=t.receiveBytes,r+=t.receiveBitrate),i&&(n+=i.receiveBytes,r+=i.receiveBitrate)}));let s=1;return this.trafficStats&&(s+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:s,SendBitrate:t,SendBytes:e,RecvBytes:n,RecvBitrate:r,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){e.peer_delay=e.peer_delay.filter((e=>void 0!==e.B_ppad||void 0!==e.B_ppvd)),e.peer_delay.filter((e=>-1===this.trafficStatsPeerList.indexOf(e.peer_uid))).forEach((e=>{var t;const n=null===(t=this.p2pChannel)||void 0===t?void 0:t.getRemoteMedia(e.peer_uid),r=null!=n&&n.videoSSRC?eU.measureFromSubscribeStart(this.store.clientId,n.videoSSRC):0,i=null!=n&&n.audioSSRC?eU.measureFromSubscribeStart(this.store.clientId,n.audioSSRC):0;void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,r>i?r:i),this.trafficStatsPeerList.push(e.peer_uid))})),this.trafficStats=e}updateUplinkStats(e){this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&SR.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,n){if(!e)return!1;const r=!!n&&t.framesDecodeFreezeTime>n.framesDecodeFreezeTime,i=!n||t.framesDecodeCount>n.framesDecodeCount;return r||!i}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){Array.from(this.localStats.entries()).forEach((t=>{let[n,r]=t;switch(n){case _I.LocalVideoTrack:case _I.LocalVideoLowTrack:{const t=r,o=Pj({},xL),a=e.getStats(),s=e.getLocalMedia(n);if(a){const n=a.videoSend.find((e=>e.ssrc===(null==s?void 0:s.ssrcs[0].ssrcId)));if(n){const r=e.getLocalVideoSize(),i=e.getEncoderConfig(_I.LocalVideoTrack);"H264"!==n.codec&&"H265"!==n.codec&&"VP8"!==n.codec&&"VP9"!==n.codec&&"AV1X"!==n.codec&&"AV1"!==n.codec||(o.codecType=n.codec),o.sendBytes=n.bytes,o.sendBitrate=t?8*Math.max(0,o.sendBytes-t.sendBytes):0,n.inputFrame?(o.captureFrameRate=n.inputFrame.frameRate,o.captureResolutionHeight=n.inputFrame.height,o.captureResolutionWidth=n.inputFrame.width):r&&(o.captureResolutionWidth=r.width,o.captureResolutionHeight=r.height),n.sentFrame?(o.sendFrameRate=n.sentFrame.frameRate,o.sendResolutionHeight=n.sentFrame.height,o.sendResolutionWidth=n.sentFrame.width):r&&(o.sendResolutionWidth=r.width,o.sendResolutionHeight=r.height),n.avgEncodeMs&&(o.encodeDelay=n.avgEncodeMs),i&&i.bitrateMax&&(o.targetSendBitrate=1e3*i.bitrateMax),o.sendPackets=n.packets,o.sendPacketsLost=n.packetsLost,o.sendJitterMs=n.jitterMs,o.sendRttMs=n.rttMs,o.totalDuration=t?t.totalDuration+1:1,o.totalFreezeTime=t?t.totalFreezeTime:0,this.isLocalVideoFreeze(n)&&(o.totalFreezeTime+=1),n.scalabilityMode&&this.scalabilityMode!==n.scalabilityMode&&(SR.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(n.scalabilityMode)),this.scalabilityMode=n.scalabilityMode)}this.trafficStats&&(o.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var i;this.localStats.set(n,o),((null==t?void 0:t.sendResolutionWidth)!==o.sendResolutionWidth||(null==t?void 0:t.sendResolutionHeight)!==o.sendResolutionHeight)&&(null===(i=this.onStatsChanged)||void 0===i||i.call(this,"resolution",{width:o.sendResolutionWidth,height:o.sendResolutionHeight})),o&&s&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,s.track,o);break}case _I.LocalAudioTrack:{const t=r,i=Pj({},kL),o=e.getStats(),a=e.getLocalMedia(n);if(o){const n=o.audioSend.find((e=>e.ssrc===(null==a?void 0:a.ssrcs[0].ssrcId)));if(n){if("opus"!==n.codec&&"aac"!==n.codec&&"PCMU"!==n.codec&&"PCMA"!==n.codec&&"G722"!==n.codec||(i.codecType=n.codec),n.inputLevel)i.sendVolumeLevel=Math.round(32767*n.inputLevel);else{const t=e.getLocalAudioVolume();t&&(i.sendVolumeLevel=Math.round(32767*t))}i.sendBytes=n.bytes,i.sendPackets=n.packets,i.sendPacketsLost=n.packetsLost,i.sendJitterMs=n.jitterMs,i.sendRttMs=n.rttMs,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0}}this.trafficStats&&(i.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(_I.LocalAudioTrack,i),i&&a&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,a.track,i);break}}}))}updateRemoteStats(e){Array.from(this.remoteStats.entries()).forEach((t=>{var n,r;let[i,{videoStats:o,audioStats:a,videoPcStats:s}]=t;const c=a,l=o,d=s,u=Pj({},LL),p=Pj({},PL),h=Pj({},NL),{audioTrack:f,videoTrack:m,audioSSRC:g,videoSSRC:v}=e.getRemoteMedia(i);let _;_=e instanceof xj?e.getStats(!0):e.getStats();const y=null===(n=_)||void 0===n?void 0:n.audioRecv.find((e=>e.ssrc===g)),w=null===(r=_)||void 0===r?void 0:r.videoRecv.find((e=>e.ssrc===v)),b=this.trafficStats&&this.trafficStats.peer_delay.find((e=>e.peer_uid===i));if(y&&("opus"!==y.codec&&"aac"!==y.codec&&"PCMU"!==y.codec&&"PCMA"!==y.codec&&"G722"!==y.codec||(u.codecType=y.codec),y.outputLevel?u.receiveLevel=Math.round(32767*y.outputLevel):f&&(u.receiveLevel=Math.round(32767*f.getVolumeLevel())),u.receiveBytes=y.bytes,u.receivePackets=y.packets,u.receivePacketsLost=y.packetsLost,u.receivePacketsDiscarded=y.packetsDiscarded,u.packetLossRate=u.receivePacketsLost/(u.receivePackets+u.receivePacketsLost),u.receiveBitrate=c?8*Math.max(0,u.receiveBytes-c.receiveBytes):0,u.totalDuration=c?c.totalDuration+1:1,u.totalFreezeTime=c?c.totalFreezeTime:0,u.freezeRate=u.totalFreezeTime/u.totalDuration,u.receiveDelay=y.jitterBufferMs,u.totalDuration>10&&Dj.isRemoteAudioFreeze(f)&&(u.totalFreezeTime+=1)),w){"H264"!==w.codec&&"H265"!==w.codec&&"VP8"!==w.codec&&"VP9"!==w.codec&&"AV1X"!==w.codec&&"AV1"!==w.codec||(p.codecType=w.codec),p.receiveBytes=w.bytes,p.receiveBitrate=l?8*Math.max(0,p.receiveBytes-l.receiveBytes):0,p.decodeFrameRate=w.decodeFrameRate<0?0:w.decodeFrameRate,p.renderFrameRate=w.decodeFrameRate<0?0:w.decodeFrameRate,w.outputFrame&&(p.renderFrameRate=w.outputFrame.frameRate),w.receivedFrame?(p.receiveFrameRate=w.receivedFrame.frameRate,p.receiveResolutionHeight=w.receivedFrame.height,p.receiveResolutionWidth=w.receivedFrame.width):m&&(p.receiveResolutionHeight=m._videoHeight||0,p.receiveResolutionWidth=m._videoWidth||0),void 0!==w.framesRateFirefox&&(p.receiveFrameRate=Math.round(w.framesRateFirefox)),p.receivePackets=w.packets,p.receivePacketsLost=w.packetsLost,p.packetLossRate=p.receivePacketsLost/(p.receivePackets+p.receivePacketsLost),p.totalDuration=l?l.totalDuration+1:1,p.totalFreezeTime=l?l.totalFreezeTime:0,p.receiveDelay=w.jitterBufferMs||0;const t=!!v&&e.getRemoteVideoIsReady(v);m&&t&&Dj.isRemoteVideoFreeze(m,w,d)&&(p.totalFreezeTime+=1),p.freezeRate=p.totalFreezeTime/p.totalDuration}b&&(u.end2EndDelay=b.B_ad,p.end2EndDelay=b.B_vd,u.transportDelay=b.B_ed,p.transportDelay=b.B_ed,u.currentPacketLossRate=b.B_ealr4/100,p.currentPacketLossRate=b.B_evlr4/100,h.uplinkNetworkQuality=b.B_punq?b.B_punq:0,h.downlinkNetworkQuality=b.B_pdnq?b.B_pdnq:0),this.remoteStats.set(i,{audioStats:u,videoStats:p,videoPcStats:w,networkStats:h}),f&&this.exceptionMonitor.setRemoteAudioStats(f,u),m&&this.exceptionMonitor.setRemoteVideoStats(m,p)}))}}class Mj{constructor(){jw(this,"destChannelMediaInfos",new Map),jw(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){$O(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){$O(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){HO(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function Uj(e){if(!(e instanceof Mj))return new GO(LT.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),n=e.getDestChannelMediaInfo();return t?0===n.size?new GO(LT.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new GO(LT.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}function jj(e){var t={},n=!1;function r(t,r){return n=!0,{done:!1,value:new tU(r=new sU((function(n){n(e[t](r))})),1)}}return t[void 0!==Pw&&Dw||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}var Vj,Bj=ce(cU);function Fj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fj(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hj(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let Wj=(Vj=class e extends fI{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Li(t=Object.keys(dR)).call(t,e)})))]}constructor(t,n){super(t,n),jw(this,"store",void 0),jw(this,"peerConnection",void 0),jw(this,"remoteSDP",void 0),jw(this,"initialOffer",void 0),jw(this,"statsFilter",void 0),jw(this,"useRTX",!1),jw(this,"localCapabilities",void 0),jw(this,"localCandidateCount",0),jw(this,"allCandidatesReceived",!1),jw(this,"establishPromise",void 0),jw(this,"mutex",new FC("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=GU(this.peerConnection,aR("STATS_UPDATE_INTERVAL"),void 0,lT()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=WD(e.sdp),n=qD(e.sdp,{filterRTX:!this.useRTX,filterVideoFec:aR("FILTER_VIDEO_FEC"),filterAudioFec:aR("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=n,this.initialOffer=e,qj(qj({},t),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:n},offerSDP:e.sdp})}catch(e){throw new NT(LT.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async updateRemoteConnect(){}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(e){jw(this,"sessionDesc",void 0),jw(this,"localCapabilities",void 0),jw(this,"rtpCapabilities",void 0),jw(this,"candidates",void 0),jw(this,"iceParameters",void 0),jw(this,"dtlsParameters",void 0),jw(this,"setup",void 0),jw(this,"currentMidIndex",void 0),jw(this,"cname",void 0),e=vC(e);const{iceParameters:t,dtlsParameters:n,candidates:r,rtpCapabilities:i,setup:o,localCapabilities:a,sdkCodec:s,cname:c}=e,l=BD.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=i,this.candidates=r,this.iceParameters=t,this.dtlsParameters=n,this.setup=o,this.localCapabilities=a,this.cname=c;for(let e=0;e<l.mediaDescriptions.length;e++){const a=l.mediaDescriptions[e];if(a.attributes.iceUfrag=t.iceUfrag,a.attributes.icePwd=t.icePwd,a.attributes.fingerprints=n.fingerprints,a.attributes.candidates=r,a.attributes.setup=o,"video"===a.media.mediaType){a.media.fmts=i.videoCodecs.map((e=>e.payloadType.toString(10)));let e=i.videoCodecs.filter((e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:Li(n=t.encodingName.toLowerCase()).call(n,s)}));0===e.length&&(e=i.videoCodecs),a.attributes.payloads=e,a.attributes.extmaps=i.videoExtensions}"audio"===a.media.mediaType&&(a.media.fmts=i.audioCodecs.map((e=>e.payloadType.toString(10))),a.attributes.payloads=i.audioCodecs,a.attributes.extmaps=i.audioExtensions),l.mediaDescriptions[e]=this.mungMediaDesc(a)}this.sessionDesc=l,this.currentMidIndex=l.mediaDescriptions.length-1}toString(){return BD.print(this.sessionDesc)}send(e,t,n){const{ssrcs:r,ssrcGroups:i}=JD(t,this.cname),o=this.sessionDesc.mediaDescriptions.find((t=>e===mI.VIDEO?"video"===t.media.mediaType:"audio"===t.media.mediaType)),a=r[0].attributes.label,s=r[0].attributes.mslabel;return o.attributes.ssrcs=o.attributes.ssrcs.concat(r),o.attributes.ssrcGroups=o.attributes.ssrcGroups.concat(i),{id:a,mslabel:s}}batchSend(e){return e.map((e=>{let{kind:t,ssrcMsg:n}=e;return this.send(t,n,void 0)}))}stopSending(e){this.sessionDesc.mediaDescriptions.forEach((t=>{const n=[],r=[],i=[];t.attributes.ssrcs.forEach((t=>{Li(e).call(e,t.attributes.label||"")?i.push(t):n.push(t)})),t.attributes.ssrcGroups.forEach((e=>{var t;Li(t=i.map((e=>e.ssrcId))).call(t,e.ssrcIds[0])||r.push(e)})),t.attributes.ssrcs=n,t.attributes.ssrcGroups=r}))}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}receive(e,t,n){e.forEach(((e,t)=>{const n=e._mediaStreamTrack,r=this.sessionDesc.mediaDescriptions.findIndex((e=>e.attributes.mid===n.kind)),i=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],e);this.sessionDesc.mediaDescriptions[r]=i}))}stopReceiving(e){}updateCandidates(e){e===gI.TCP?this.candidates.forEach((e=>{-1===this.candidates.findIndex((t=>"tcp"===t.transport&&t.connectionAddress===e.connectionAddress&&t.port===e.port))&&this.candidates.push(Gj(Gj({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))})):this.candidates=this.candidates.filter((e=>"tcp"!==e.transport));for(const e of this.sessionDesc.mediaDescriptions)e.attributes.candidates=this.candidates}restartICE(e){e=vC(e),this.iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}mungRecvMediaDsec(e,t){const n=vC(e);return XD(n,t),QD(n,t),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}updateTrackLabel(e,t,n){const r=this.sessionDesc.mediaDescriptions.find((t=>e===mI.VIDEO?"video"===t.attributes.mid:"audio"===t.attributes.mid));if(r){const e=r.attributes.ssrcs.find((e=>e.attributes.label===t));var i;e&&(e.attributes.label=n,null===(i=e.attributes.msid)||void 0===i||i.replace(t,n))}}mungMediaDesc(e){const t=vC(e);return ZD(t),function(e){const t=e.attributes.extmaps.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));t&&e.attributes.extmaps.splice(e.attributes.extmaps.indexOf(t),1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}(t),t}getSSRC(e){for(const t of this.sessionDesc.mediaDescriptions)for(const n of t.attributes.ssrcs)if(n.attributes.label===e)return[n]}}(qj(qj({},e),{},{rtpCapabilities:e.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const t=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:t})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async updateRemoteRTPCapabilities(e,t){throw new NT(LT.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(e){}send(e,t){var n=this;return uU((function*(){const r=yield nU(n.mutex.lock());try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const r=e.map((e=>n.peerConnection.addTrack(e._mediaStreamTrack))),i=yield nU(n.peerConnection.createOffer()),o=BD.parse(i.sdp),a=e.map((e=>{const t=e._mediaStreamTrack,r=o.mediaDescriptions.find((e=>e.attributes.mid===t.kind));if(!r)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t,n){const r=e.attributes.ssrcs.filter((e=>e.attributes.label===t)),i=e.attributes.ssrcGroups;if(0===r.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(i&&r.length>1){const e=i.find((e=>-1!==e.ssrcIds.indexOf(r[0].ssrcId)));return e?[{ssrcId:e.ssrcIds[0],rtx:n?e.ssrcIds[1]:void 0}]:[{ssrcId:r[0].ssrcId}]}return[{ssrcId:r[0].ssrcId}]}(r,t.id,n.useRTX)}));let s;try{s=yield a}catch(e){throw r.forEach((e=>{sT()&&e.replaceTrack(null),n.peerConnection.removeTrack(e)})),e}const c=n.mungSendOfferSDP(i.sdp,e);n.remoteSDP.receive(e,t,s);const l=n.remoteSDP.toString();return yield nU(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield nU(n.applySendEncodings(r,e)),yield nU(n.peerConnection.setRemoteDescription({type:"answer",sdp:l})),e.map(((e,t)=>{const n=e._mediaStreamTrack.id;return{localSSRC:a[t],id:n}}))}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{r()}}))()}async stopSending(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{sT()&&e.replaceTrack(null),this.peerConnection.removeTrack(e)}));const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:n,mslabel:i}=this.remoteSDP.send(e,t,r),o=new Ih(((t,r)=>{const o=setTimeout((()=>{r(new Error("Cannot receive track, id: ".concat(n)))}),1e4),a=r=>{const s=tT();if(("Safari"===s.name&&11===Number(s.version)||dT())&&r.track.id!==n&&r.streams[0].id===i){var c;const i=r.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(e,n,r.track.id),this.peerConnection.removeEventListener("track",a),clearTimeout(o),void t(i)}if(r.track.id===n)return this.peerConnection.removeEventListener("track",a),clearTimeout(o),void t(r.track)};this.peerConnection.addEventListener("track",a)})),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const s=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(s),{track:await o,id:n}}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(n)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("sender' length doesn't match mids' length.");t.map((e=>{if(sT()&&e.track)e.track.enabled=!1;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!1)),e.setParameters(t)}}))}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");t.map((async e=>{if(sT()&&e.track)e.track.enabled=!0;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!0)),await e.setParameters(t)}}));const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return uU((function*(){const n=yield nU(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(nL().supportPCSetConfiguration){const n=t.peerConnection.getConfiguration(),r=e===gI.RELAY?"relay":"all";n.iceTransportPolicy!==r&&(SR.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(n.iceTransportPolicy,"] to [").concat(r,"]")),n.iceTransportPolicy=r,t.peerConnection.setConfiguration(n))}else if(e===gI.RELAY)return;e!==gI.RELAY&&t.remoteSDP.updateCandidates(e);const n=yield nU(t.peerConnection.createOffer({iceRestart:!0}));if(!n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const r=WD(n.sdp),{remoteIceParameters:i}=yield r.iceParameters;t.remoteSDP.restartICE(i);const o=t.remoteSDP.toString();yield nU(t.peerConnection.setLocalDescription(n)),yield nU(t.peerConnection.setRemoteDescription({type:"answer",sdp:o}))}catch(e){SR.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}}))()}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const e=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(e.sdp,[t]);this.remoteSDP.updateRecvMedia(t._mediaStreamTrack.kind,t);const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getSenders().filter((t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e}));1===n.length&&await this.applySendEncodings(n,[t])}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getSenders().find((e=>{var n;return(null===(n=e.track)||void 0===n?void 0:n.id)===t}));n&&await n.replaceTrack(e._mediaStreamTrack)}createDataChannels(e,t){throw new NT(LT.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(e){throw new NT(LT.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,SR.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,SR.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),aR("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(nC(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),aR("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(n.iceTransportPolicy="relay")})))),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}async updateRtpSenderEncodings(e,t){var n;if(t||(t=this.peerConnection.getSenders().find((t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e._mediaStreamTrack.id}))),!t)return SR.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(!nL().supportSetRtpSenderParameters)return SR.warn("Browser not support set rtp-sender parameters");const r={},i={};if(e instanceof lD)switch(e._optimizationMode){case"motion":r.degradationPreference="maintain-framerate";break;case"detail":r.degradationPreference="maintain-resolution";break;default:r.degradationPreference="balanced"}if(aR("DSCP_TYPE")&&RT()){var o;const e=aR("DSCP_TYPE");Li(o=["very-low","low","medium","high"]).call(o,e)&&(i.networkPriority=e)}const a=t.getParameters(),s=null===(n=a.encodings)||void 0===n?void 0:n[0];s&&Object.assign(s,i),Object.assign(a,r),SR.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(a.encodings))),await t.setParameters(a)}async applySendEncodings(e,t){try{if(!nL().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];r&&i&&await this.updateRtpSenderEncodings(i,r)}}catch(e){SR.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t){const n=BD.parse(e);return t.forEach(((e,t)=>{const r=e._mediaStreamTrack,i=n.mediaDescriptions.find((e=>e.attributes.mid===r.kind));i&&XD(i,e)})),BD.print(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const t=this.remoteSDP.batchSend(e).map(((t,n)=>{let{id:r,mslabel:i}=t;const{kind:o}=e[n];return new Ih(((e,t)=>{const n=setTimeout((()=>{t(new Error("Cannot receive track, id: ".concat(r)))}),1e4),a=t=>{const s=tT();if("Safari"===s.name&&11===Number(s.version)&&t.track.id!==r&&t.streams[0].id===i){var c;const i=t.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(o,r,t.track.id),this.peerConnection.removeEventListener("track",a),clearTimeout(n),void e({track:i,id:r})}if(t.track.id===r)return this.peerConnection.removeEventListener("track",a),clearTimeout(n),void e({track:t.track,id:r})};this.peerConnection.addEventListener("track",a)}))})),n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const r=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(r),await Ih.all(t)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}setConfiguration(t){if(nL().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},OO(Vj.prototype,"connect",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"connect"),Vj.prototype),OO(Vj.prototype,"stopSending",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"stopSending"),Vj.prototype),OO(Vj.prototype,"receive",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"receive"),Vj.prototype),OO(Vj.prototype,"stopReceiving",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"stopReceiving"),Vj.prototype),OO(Vj.prototype,"muteRemote",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"muteRemote"),Vj.prototype),OO(Vj.prototype,"unmuteRemote",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"unmuteRemote"),Vj.prototype),OO(Vj.prototype,"muteLocal",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"muteLocal"),Vj.prototype),OO(Vj.prototype,"unmuteLocal",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"unmuteLocal"),Vj.prototype),OO(Vj.prototype,"close",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"close"),Vj.prototype),OO(Vj.prototype,"updateEncoderConfig",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"updateEncoderConfig"),Vj.prototype),OO(Vj.prototype,"updateSendParameters",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"updateSendParameters"),Vj.prototype),OO(Vj.prototype,"replaceTrack",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"replaceTrack"),Vj.prototype),OO(Vj.prototype,"getRemoteSSRC",[zj],Object.getOwnPropertyDescriptor(Vj.prototype,"getRemoteSSRC"),Vj.prototype),Vj);function zj(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("Locking from P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}function Kj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kj(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Jj="9";class Xj{get localCapabilities(){return vC(this._localCapabilities)}get rtpCapabilities(){return vC(this._rtpCapabilities)}get candidates(){return vC(this._candidates)}get iceParameters(){return vC(this._iceParameters)}get dtlsParameters(){return vC(this._dtlsParameters)}constructor(e){jw(this,"sessionDesc",void 0),jw(this,"_localCapabilities",void 0),jw(this,"_rtpCapabilities",void 0),jw(this,"_candidates",void 0),jw(this,"_iceParameters",void 0),jw(this,"_dtlsParameters",void 0),jw(this,"setup",void 0),jw(this,"currentMidIndex",void 0),jw(this,"cname",void 0),jw(this,"firefoxSsrcMidMap",new Map),e=vC(e);const{iceParameters:t,dtlsParameters:n,candidates:r,rtpCapabilities:i,setup:o,localCapabilities:a,cname:s}=e;this._rtpCapabilities=i,this._candidates=r,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=a,this.setup=o,this.cname=s,this.sessionDesc=this.updateRemoteRTPCapabilities(i),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(e){const t=this.candidates,n=this.dtlsParameters,r=this.iceParameters,i=this.rtpCapabilities.send;let o=this.sessionDesc.mediaDescriptions.length-1;for(let a=1;a<e;a++){const e=2*a+2e4,s=2*a+4e4,{ssrcs:c,ssrcGroups:l}=JD([{ssrcId:e}],this.cname),{ssrcs:d,ssrcGroups:u}=JD([{ssrcId:s,rtx:aR("USE_SUB_RTX")?s+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:Jj,protos:["UDP","TLS","RTP","SAVPF"],fmts:i.videoCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:t,extmaps:i.videoExtensions,fingerprints:n.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:d,ssrcGroups:u,rtcpFeedbackWildcards:[],payloads:i.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++o)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:Jj,protos:["UDP","TLS","RTP","SAVPF"],fmts:i.audioCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:t,extmaps:i.audioExtensions,fingerprints:n.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:c,ssrcGroups:l,rtcpFeedbackWildcards:[],payloads:i.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++o)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return BD.print(this.sessionDesc)}send(e,t,n,r){const{ssrcs:i,ssrcGroups:o}=JD(t,this.cname,aR("SYNC_GROUP")?n:void 0),a=this.findPreloadMediaDesc(i);if(a){if(lT()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,a.attributes.mid),r&&(r.twcc||r.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(a,r),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,i);let n;return-1===t||1===t&&(sT()||function(){const e=tT();return!(e.name!==ZS.CHROME||!e.osVersion)&&Number(e.version)<=90}())||0===t&&aR("USE_SUB_RTX")||_T()?(n=this.createOrRecycleSendMedia(e,i,o,"sendonly",r),this.updateBundleMids()):(n=vC(this.sessionDesc.mediaDescriptions[t]),n.attributes.direction="sendonly",n.attributes.ssrcs=i,n.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(n,r)),lT()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,n.attributes.mid),{mid:n.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:e,needExchangeSDP:t}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:e.attributes.mid,needExchangeSDP:t}}batchSend(e){const t=e.map((e=>{let{kind:t,ssrcMsg:n,mslabel:r}=e;return this.send(t,n,r)})),n=[];let r=!1;return t.forEach((e=>{let{mid:t,needExchangeSDP:i}=e;i&&(r=!0),n.push(t)})),{mids:n,needExchangeSDP:r}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{"0"===e.attributes.mid||lT()||_T()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")})),this.updateBundleMids()}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Li(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Li(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}receive(e,t,n,r){e.forEach(((e,i)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,n,r[i])})),this.updateBundleMids()}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}updateRemoteRTPCapabilities(e){const t=this.sessionDesc||BD.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=e;const n=this.rtpCapabilities.send,r=this.localCapabilities.send;for(const e of t.mediaDescriptions){if(e.attributes.iceUfrag=this._iceParameters.iceUfrag,e.attributes.icePwd=this._iceParameters.icePwd,e.attributes.fingerprints=this._dtlsParameters.fingerprints,e.attributes.candidates=this._candidates,e.attributes.setup=this.setup,"application"===e.media.mediaType&&(e.attributes.sctpPort="5000"),"video"===e.media.mediaType)if(0===n.videoCodecs.length){const t=r.videoCodecs.filter((e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:Li(n=t.encodingName.toLowerCase()).call(n,"vp8")}))||[r.videoCodecs[0]];e.media.fmts=t.map((e=>e.payloadType.toString(10))),e.attributes.payloads=t,e.attributes.extmaps=[]}else if(e.media.fmts=n.videoCodecs.map((e=>e.payloadType.toString(10))),e.attributes.payloads=n.videoCodecs,e.attributes.extmaps=n.videoExtensions,aR("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:t,ssrcGroups:n}=JD([{ssrcId:4e4,rtx:aR("USE_SUB_RTX")?40001:void 0}],this.cname);e.attributes.ssrcs=t,e.attributes.ssrcGroups=n}if("audio"===e.media.mediaType)if(0===n.audioCodecs.length){const t=r.audioCodecs.filter((e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:Li(n=t.encodingName.toLowerCase()).call(n,"opus")}))||[r.audioCodecs[0]];e.media.fmts=t.map((e=>e.payloadType.toString(10))),e.attributes.payloads=t,e.attributes.extmaps=[]}else if(e.media.fmts=n.audioCodecs.map((e=>e.payloadType.toString(10))),e.attributes.payloads=n.audioCodecs,e.attributes.extmaps=n.audioExtensions,aM(e),aR("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:t,ssrcGroups:n}=JD([{ssrcId:2e4}],this.cname);e.attributes.ssrcs=t,e.attributes.ssrcGroups=n}}return this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(e){const t=this._candidates.filter((e=>"udp"===e.transport));if(e===gI.TCP){if(0===t.length)return;if(aR("TCP_CANDIDATE_ONLY")){const e=this._candidates.filter((e=>"tcp"===e.transport));t.forEach((t=>{-1===e.findIndex((e=>e.connectionAddress===t.connectionAddress))&&e.push(Yj(Yj({},t),{},{foundation:"tcpcandidate",priority:Number(t.priority)-1+"",transport:"tcp",port:Number(t.port)+90+""}))})),this._candidates=e}else{const e=[];t.forEach((t=>{e.push(Yj(Yj({},t),{},{foundation:"tcpcandidate",priority:Number(t.priority)-1+"",transport:"tcp",port:Number(t.port)+90+""}))})),this._candidates=[...t,...e]}}else if(e===gI.RELAY){if(0!==t.length)return;{const e=this._candidates.filter((e=>"tcp"===e.transport));e.forEach((e=>{t.push(Yj(Yj({},e),{},{foundation:"udpcandidate",priority:Number(e.priority)+1+"",transport:"udp",port:Number(e.port)-90+""}))})),this._candidates=[...t,...e]}}else 0===t.length?(this._candidates.filter((e=>"tcp"===e.transport)).forEach((e=>{t.push(Yj(Yj({},e),{},{foundation:"udpcandidate",priority:Number(e.priority)+1+"",transport:"udp",port:Number(e.port)-90+""}))})),this._candidates=t):this._candidates=this._candidates.filter((e=>"tcp"!==e.transport));for(const e of this.sessionDesc.mediaDescriptions)e.attributes.candidates=this.candidates}restartICE(e){e=vC(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex((n=>{const r=n.media.mediaType===e&&"0"!==n.media.port&&("sendonly"===n.attributes.direction||"sendrecv"===n.attributes.direction)&&0===n.attributes.ssrcs.length;if(lT()){if(r){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==n.attributes.mid&&"1"!==n.attributes.mid)||!(!e||e!==n.attributes.mid)}return!1}return r}))}createOrRecycleDataChannel(){for(const e of this.sessionDesc.mediaDescriptions)if("application"===e.media.mediaType)return{mediaDesc:e,needExchangeSDP:!1};this.currentMidIndex+=1;const e="".concat(this.currentMidIndex),t={media:{mediaType:"application",port:Jj,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(e),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(t),{mediaDesc:t,needExchangeSDP:!0}}createOrRecycleRecvMedia(e,t,n,r,i,o){const a=e._mediaStreamTrack.kind,s=this.rtpCapabilities.recv,c=sM(a,s,this.localCapabilities.send,a===mI.VIDEO?r:i),l=a===mI.VIDEO?s.videoExtensions:s.audioExtensions;this.currentMidIndex+=1;const d="".concat(this.currentMidIndex);let u={media:{mediaType:a,port:Jj,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:l,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(d)}};u=this.mungRecvMediaDsec(u,e,o);const p=this.findFirstClosedMedia(a);if(p){const e=this.sessionDesc.mediaDescriptions.indexOf(p);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}updateRemoteCodec(e,t,n){const r=[...new Set(this._rtpCapabilities.recv.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Li(t=Object.keys(dR)).call(t,e)})))],i=new Set(t);if(r.every((e=>i.has(e))))return SR.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;const o=this._rtpCapabilities.recv.videoCodecs.filter((e=>t.some((t=>{var n;return Li(n=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(n,t)}))));if(0===o.length)return SR.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(r," codecs: ").concat(t)),!1;const a=[...new Set(o.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")))];let s;if(SR.debug("updateRemoteCodec, from ".concat(r," to ").concat(a)),0===e.length)s=this.sessionDesc.mediaDescriptions.filter((e=>"video"===e.media.mediaType&&"recvonly"===e.attributes.direction));else if(s=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&Li(e).call(e,t.attributes.mid)&&"recvonly"===t.attributes.direction)),s.length!==e.length)return SR.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;if(aR("USE_PUB_RTX")||aR("USE_SUB_RTX")){const e=cM(o,this.rtpCapabilities.recv.videoCodecs);o.push(...e)}this._rtpCapabilities.recv.videoCodecs=o;const c=this.localCapabilities.send,l=this.rtpCapabilities.recv,d=sM(mI.VIDEO,l,c,n);return s.forEach((e=>{const t=d.map((e=>e.payloadType.toString(10)));SR.debug("updateRemoteCodec mid: ".concat(e.attributes.mid,", from ").concat(e.attributes.payloads," to ").concat(d)),e.attributes.payloads=d,e.media.fmts=t})),!0}createOrRecycleSendMedia(e,t,n,r,i){const o=this.rtpCapabilities.send,a=e===mI.VIDEO?o.videoCodecs:o.audioCodecs,s=e===mI.VIDEO?o.videoExtensions:o.audioExtensions;this.currentMidIndex+=1;const c="".concat(this.currentMidIndex);let l={media:{mediaType:e,port:Jj,protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:s,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};l=this.mungSendMediaDesc(l,i);const d=this.findFirstClosedMedia(e);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}mungRecvMediaDsec(e,t,n){const r=vC(e);return ZD(r),XD(r,t),QD(r,t),$D(r),eM(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=vC(e);return eM(n,t,this.localCapabilities.recv),aM(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>lT()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId}))}getSSRC(e){var t;return null===(t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===t?void 0:t.attributes.ssrcs}}function Zj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zj(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let $j=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({});var eV=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(eV||{});const tV=new Map;function nV(e,t,n,r){let{scale:i}=e;if(0===i&&r===eV.UP||i>=t.length-1&&r===eV.DOWN)return e;let o=Qj(Qj({},e),{},{scale:r===eV.DOWN?++i:--i});switch(n){case"maintain-framerate":o=Qj(Qj({},o),t[i].motion);break;case"maintain-resolution":o=Qj(Qj({},o),t[i].detail);break;case"balanced":o=Qj(Qj({},o),t[i].balanced)}return o}function rV(e,t){if(t){const n={overUse:0,underUse:0,adaptationList:iV(t)};tV.set(e,n)}else tV.delete(e)}function iV(e){const t=Qj({},e),{bitrateMax:n,frameRate:r,scaleResolutionDownBy:i,bitrateMin:o}=t,{MIN_FRAME_RATE:a,MAX_THRESHOLD_FRAMERATE:s,MAX_SCALE:c,BITRATE_MIN_THRESHOLD:l,BITRATE_MAX_THRESHOLD:d,BWE_SCALE_UP_THRESHOLD:u,BWE_SCALE_DOWN_THRESHOLD:p,PERF_SCALE_DOWN_THRESHOLD:h,PERF_SCALE_UP_THRESHOLD:f,BALANCE_BITRATE_FACTOR:m,BALANCE_FRAMERATE_FACTOR:g,BALANCE_RESOLUTION_FACTOR:v,MOTION_RESOLUTION_FACTOR:_,MOTION_BITRATE_FACTOR:y,DETAIL_FRAMERATE_FACTOR:w,DETAIL_BITRATE_FACTOR:b}=nR,E=Math.min(t.frameRate,s),S=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(p,1)*n),bwe_up:n,fps_down:Math.round(Math.pow(h,1)*E),fps_up:r},balanced:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:o},motion:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:o},detail:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:o}}];for(let e=1;e<=c;e++){const t={bwe_up:Math.round(Math.pow(u,e)*n),bwe_down:Math.round(Math.pow(p,e+1)*n),fps_up:Math.round(Math.pow(f,e)*E),fps_down:Math.round(Math.pow(h,e+1)*E)},s={scaleResolutionDownBy:i/Math.pow(v,e),frameRate:Math.max(Math.round(Math.pow(g,e)*r),a),bitrateMax:Math.max(Math.round(Math.pow(m,e)*n),d),bitrateMin:Math.max(Math.round(Math.pow(m,e)*o),l)},c={scaleResolutionDownBy:i/Math.pow(_,e),frameRate:r,bitrateMax:Math.max(Math.round(Math.pow(y,e)*n),d),bitrateMin:Math.max(Math.round(Math.pow(y,e)*o),l)},T={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(w,e)*r),a),bitrateMax:Math.max(Math.round(Math.pow(b,e)*n),d),bitrateMin:Math.max(Math.round(Math.pow(b,e)*o),l)};S.push({scale:e,threshold:t,balanced:s,motion:c,detail:T})}return S}function oV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oV(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const sV=new Map;function cV(e,t){const n=sV.get(e);if(n){const{timer:t}=n;window.clearTimeout(t),sV.delete(e)}t.qualityLimitationReason=$j.NONE,rV(e)}var lV;function dV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dV(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let pV=(lV=class e extends fI{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Li(t=Object.keys(dR)).call(t,e)})))]}constructor(t,n){super(t,n),jw(this,"store",void 0),jw(this,"peerConnection",void 0),jw(this,"id",AC(5,"connection-")),jw(this,"remoteSDP",void 0),jw(this,"initialOffer",void 0),jw(this,"transportEventReceiver",void 0),jw(this,"statsFilter",void 0),jw(this,"extension",{useXR:aR("USE_XR")}),jw(this,"localCapabilities",void 0),jw(this,"remoteCodecs",void 0),jw(this,"localCandidateCount",0),jw(this,"allCandidatesReceived",!1),jw(this,"isPreallocation",!1),jw(this,"preSSRCMap",new Map),jw(this,"dataStreamChannelMap",new Map),jw(this,"establishPromise",void 0),jw(this,"recoveredDataChannelIds",[]),jw(this,"currentDataChannelId",1),jw(this,"mutex",new FC("P2PConnection-mutex")),jw(this,"qualityLimitationReason",$j.NONE),this.store=n,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=GU(this.peerConnection,aR("STATS_UPDATE_INTERVAL"),void 0,lT()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(e){const t=this.preSSRCMap.get(e);if(void 0!==t){const e=this.peerConnection.getTransceivers().find((e=>e.mid===t));if(e)return{transceiver:e,track:e.receiver.track,id:t}}}async updateRemoteRTPCapabilities(e,t){if(this.remoteCodecs=t,this.remoteSDP)if(this.remoteSDP.updateRemoteCodec(e,t,this.store.codec)){const e=await this.peerConnection.createOffer(),t=this.logSDPExchange(e.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(e);const n=this.remoteSDP.toString();null==t||t(n),await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}else SR.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.");else SR.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(t))}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=WD(e.sdp),n=await nM({filterRTX:!aR("USE_PUB_RTX")&&!aR("USE_SUB_RTX"),filterVideoFec:aR("FILTER_VIDEO_FEC"),filterAudioFec:aR("FILTER_AUDIO_FEC"),filterVideoCodec:aR("FILTER_VIDEO_CODEC")},this.extension);return this.localCapabilities=oM(n),this.initialOffer=e,uV(uV({},t),{},{rtpCapabilities:n,offerSDP:e.sdp})}catch(e){throw new NT(LT.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new Xj(uV(uV({},e),{},{localCapabilities:this.localCapabilities})),e.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const t=this.remoteSDP.toString(),n=dM(this.initialOffer.sdp,this.extension),r=this.logSDPExchange(n||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),null==r||r(t),await this.peerConnection.setRemoteDescription({type:"answer",sdp:t});const i=this.peerConnection.getTransceivers()[0];if(null!=i&&i.receiver&&this.tryBindTransportEvents(i.receiver),aR("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(aR("PRELOAD_MEDIA_COUNT"));const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t)}const{preSSRCs:o}=e;if(Array.isArray(o)&&o.length>0){const{mids:e}=this.remoteSDP.batchSend(o.map((e=>({kind:e.kind,ssrcMsg:[{ssrcId:e.ssrcId,rtx:e.rtx}],mslabel:e.mslabel}))));e.forEach(((e,t)=>{this.preSSRCMap.set(o[t].ssrcId,e)})),await lM(this.peerConnection,this.remoteSDP,this.extension),SR.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async updateRemoteConnect(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:t}=e;this.remoteSDP.updateRemoteRTPCapabilities(t),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:n}=e;if(Array.isArray(n)&&n.length>0){const{mids:e}=this.remoteSDP.batchSend(n.map((e=>Object.assign({},{kind:e.kind,ssrcMsg:[{ssrcId:e.ssrcId,rtx:e.rtx}],mslabel:e.mslabel}))));e.forEach(((e,t)=>{this.preSSRCMap.set(n[t].ssrcId,e)}))}await lM(this.peerConnection,this.remoteSDP,this.extension),SR.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return uU((function*(){const i=yield nU(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const o=[];e.forEach((e=>{const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});o.push(t),e._updateRtpTransceiver(t)})),lT()&&!0===aR("SIMULCAST")&&(yield nU(r.applySimulcastForFirefox(o,e)));const a=yield nU(r.peerConnection.createOffer()),s=r.remoteSDP.predictReceivingMids(e.length),c=r.mungSendOfferSDP(a.sdp,e,s),l=BD.parse(c),d=s.map((e=>{const t=l.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return zD(t,aR("USE_PUB_RTX"))}));let u;try{u=yield d}catch(i){u=[],r.remoteSDP.receive(e,t,n,u);const o=r.remoteSDP.toString();throw yield nU(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield nU(r.peerConnection.setRemoteDescription({type:"answer",sdp:o})),yield nU(r.stopSending(s,!0)),i}r.remoteSDP.receive(e,t,n,u);const p=r.remoteSDP.toString(),h=r.logSDPExchange(c,"offer","local","send");return yield nU(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield nU(r.applySimulcastEncodings(o,e)),yield nU(r.applySendEncodings(o,e)),null==h||h(p),yield nU(r.peerConnection.setRemoteDescription({type:"answer",sdp:p})),o.map(((e,t)=>{const n=s[t];return{localSSRC:d[t],id:n,transceiver:e}}))}catch(e){throw e instanceof NT?e:new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}}))()}async createDataChannels(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let n=this.dataStreamChannelMap.get(e);if(n&&"open"===n.readyState)SR.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const t=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if("number"!=typeof t)throw new Error("create DataChannel error, because cannot get dc id");n=this.peerConnection.createDataChannel("datastream-channel",{id:t,negotiated:!0,ordered:!1,maxRetransmits:aR("DATASTREAM_MAX_RETRANSMITS")}),n.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,n)}t.forEach((e=>{e._updateOriginDataChannel(n)}));const{needExchangeSDP:r}=this.remoteSDP.sendDataChannel();if(r){const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),SR.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else SR.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(e){throw e instanceof NT?e:new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(e.toString()))}}async stopDataChannels(e){try{const t=this.dataStreamChannelMap.get(e);return t&&(t.id&&this.recoveredDataChannelIds.push(t.id),t.close()),void this.dataStreamChannelMap.delete(e)}catch(e){throw e instanceof NT?e:new NT(LT.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(e.toString()))}}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{var t;cV(this.id+e.mid,this),e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);o&&(await lM(this.peerConnection,this.remoteSDP,this.extension),SR.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP.")));const a=this.peerConnection.getTransceivers().find((e=>e.mid===i));if(!a)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,id:i,transceiver:a}}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:n}=this.remoteSDP.batchSend(e);return n&&(await lM(this.peerConnection,this.remoteSDP,this.extension),SR.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),t.map((e=>{const t=this.peerConnection.getTransceivers().find((t=>t.mid===e));if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e,transceiver:t}}))}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");e.forEach((e=>{Array.from(this.preSSRCMap.entries()).some((t=>{let[n,r]=t;if(r===e)return this.preSSRCMap.delete(n),!0}))})),this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async(e,t)=>{e.direction="sendonly"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return uU((function*(){const n=yield nU(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(nL().supportPCSetConfiguration){const n=t.peerConnection.getConfiguration(),r=e===gI.RELAY?"relay":"all";n.iceTransportPolicy!==r&&(SR.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(n.iceTransportPolicy,"] to [").concat(r,"]")),n.iceTransportPolicy=r,t.peerConnection.setConfiguration(n))}else if(e===gI.RELAY)return;t.remoteSDP.updateCandidates(e);const n=yield nU(t.peerConnection.createOffer({iceRestart:!0}));if(!n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const r=WD(n.sdp),{remoteIceParameters:i}=yield r.iceParameters;t.remoteSDP.restartICE(i);const o=t.remoteSDP.toString(),a=t.logSDPExchange(n.sdp||"","offer","local","restartICE");t.store.descriptionStart(),yield nU(t.peerConnection.setLocalDescription(n)),null==a||a(o),yield nU(t.peerConnection.setRemoteDescription({type:"answer",sdp:o}))}catch(e){SR.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}}))()}close(){var e;this.peerConnection.getTransceivers().forEach((e=>{cV(this.id+e.mid,this)})),this.preSSRCMap.clear(),this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return uV(uV({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const i=this.remoteSDP.toString(),o=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==o||o(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new NT(LT.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===n.length&&(this.isVP8Simulcast(t)?lT()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find((e=>e.mid===t));n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:uV(uV({},RU),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:uV(uV({},RU),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,SR.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,SR.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),aR("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(nC(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),aR("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),aR("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(n.iceTransportPolicy="relay")})))),aR("ENABLE_ENCODED_TRANSFORM")&&nL().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(tA(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!aR("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}tryBindTransportEvents(e){const t=e.transport;if(t){this.transportEventReceiver=e,t.onstatechange=()=>{var e;null!=t&&t.state&&(null===(e=this.onDTLSTransportStateChange)||void 0===e||e.call(this,t.state))},t.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const n=t.iceTransport;n&&(n.onstatechange=()=>{const e=null==t?void 0:t.iceTransport.state;var n;e&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,e))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:e,remote:t}=n.getSelectedCandidatePair();SR.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:e.type,protocol:e.protocol}),", remote ").concat(JSON.stringify({candidateType:t.type,protocol:t.protocol,address:t.address,port:t.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n,r;if(!t){const n=this.peerConnection.getSenders();t=n.find((t=>t.track===e._mediaStreamTrack))}if(!t)return SR.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return SR.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!nL().supportSetRtpSenderParameters)return SR.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const i={},o={};switch(e._optimizationMode){case"motion":i.degradationPreference="maintain-framerate";break;case"detail":i.degradationPreference="maintain-resolution";break;case"balanced":i.degradationPreference="balanced"}const a=function(e,t){return e.getTransceivers().find((e=>e.sender.track===t||e.receiver.track===t))}(this.peerConnection,e._mediaStreamTrack),s=(e=>{const t=e._encoderConfig;if(!t)return;const{frameRate:n,width:r,height:i}=e.getMediaStreamTrackSettings();let{frameRate:o=n,width:a=r,height:s=i}=t;if(!o||!a||!s)return;a=UC(a),s=UC(s),o=UC(o);const{max:c,min:l}=function(e,t,n){const r=200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75);return{min:Math.floor(r),max:Math.floor(4*r)}}(a,s,o),{bitrateMax:d,bitrateMin:u}=t||{};d||SR.debug("calculate bitrate: [w: ".concat(a,", h: ").concat(s,", fps: ").concat(o,"] => [brMax: ").concat(d,", brMin: ").concat(u,"]"));const{maxFramerate:p}=aR("ENCODER_CONFIG_LIMIT");return p&&"number"==typeof p&&(o=Math.min(o,p)),{frameRate:o,bitrateMax:d||c,bitrateMin:u||l,scaleResolutionDownBy:1,scale:0}})(e);if(function(e){var t;return!(!aR("ENABLE_AG_ADAPTATION")||!(e instanceof dD||Li(t=e._hints).call(t,bL.CUSTOM_TRACK))||!aR("FORCE_SUPPORT_AG_ADAPTATION")&&!(function(e){const t=tT();if(t.os!==XS.IOS||!t.osVersion)return!1;const n=t.osVersion.split(".");return Number(n[0])>=14}()&&mT(17,4,!0)||fT(14)&&gT(17,4,!0)))}(e)&&a&&t&&s&&this.getLocalVideoStats&&Li(n=["vp8","vp9"]).call(n,this.store.codec)){var c;const n=i.degradationPreference||(Li(c=e._hints).call(c,bL.CUSTOM_TRACK)?aR("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");!function(e,t,n,r,i,o){if(cV(e,n),i(t),"balanced"!==r&&"maintain-framerate"!==r&&"maintain-resolution"!==r)return;let a=-1;rV(e,t);const s=window.setInterval((()=>{const s=sV.get(e);if(!aR("ENABLE_AG_ADAPTATION")||!s)return cV(e,n),void i(t);const c=o();if(c.sendPackets>0&&c.OutgoingAvailableBandwidth>0){if(-1===a)return void(a=Date.now());if(Date.now()-a<1e3)return;const o=c.sendFrameRate,l=c.OutgoingAvailableBandwidth,[d,u]=function(e,t,n,r,i,o){const a=tV.get(e)||{overUse:0,underUse:0,adaptationList:iV(i)},{adaptationList:s}=a;tV.set(e,a);const{OVERUSE_TIMES_THRESHOLD:c,UNDERUSE_TIMES_THRESHOLD:l}=nR,{scale:d}=r;let u,p;return"number"==typeof t&&t>0&&function(e,t,n,r){if(t>=n.length)return!1;let{threshold:{fps_down:i}}=n[t];return aR("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===r&&(i=n[0].threshold.fps_down),e<i}(t,d,s,o)&&(a.overUse++,p=$j.CPU,a.overUse>c)||"number"==typeof n&&n>0&&function(e,t,n){if(t>=n.length)return!1;const{threshold:{bwe_down:r}}=n[t];return e<r}(n,d,s)&&(a.overUse++,p=$j.BANDWIDTH,a.overUse>c)?(a.overUse=0,a.underUse=0,u=nV(r,s,o,eV.DOWN),[u,p]):("number"==typeof t&&t>0&&"number"==typeof n&&n>0&&function(e,t,n,r){if(0===t)return;let{threshold:{fps_up:i}}=n[t];return aR("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===r&&(i=n[1].threshold.fps_up),e>i}(t,d,s,o)&&function(e,t,n){if(0===t)return;const{threshold:{bwe_up:r}}=n[t];return e>r}(n,d,s)&&(a.underUse++,a.underUse>l&&(a.overUse=0,a.underUse=0,u=nV(r,s,o,eV.UP),0===u.scale&&(p=$j.NONE))),[u,p])}(e,o,l,s.adaptationConfig,t,r);u&&(n.qualityLimitationReason=u),d&&s.adaptationConfig.scale!==d.scale&&(SR.debug("[".concat(e,"] applyAdaptation: ").concat(n.qualityLimitationReason,"\n           sendFps ").concat(o,", bwe ").concat(l,", switch from ").concat(s.adaptationConfig.scale," to ").concat(d.scale," ")),s.adaptationConfig=aV(aV({},s.adaptationConfig),d),i(d))}}),aR("CHECK_LOCAL_STATS_INTERVAL")),c=aV({},t);sV.set(e,{timer:s,adaptationConfig:c,originConfig:t,adaptationFunc:i}),SR.debug("[".concat(e,"] start adaptation, originConfig: ").concat(JSON.stringify(t),", degradationPreference: ").concat(r))}(this.id+a.mid,s,this,n,(e=>{t&&this.updateAdaptation(t,e)}),this.getLocalVideoStats.bind(this))}if(e._encoderConfig){var l;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(o.maxBitrate=1e3*t),(Li(l=e._hints).call(l,bL.LOW_STREAM)||e.isUseScaleResolutionDownBy)&&(n&&(o.maxFramerate=rA(n)),r&&r>=1&&(o.scaleResolutionDownBy=r))}const{maxFramerate:d}=aR("ENCODER_CONFIG_LIMIT");if(d&&"number"==typeof d&&(o.maxFramerate=o.maxFramerate?Math.min(o.maxFramerate,d):d),aR("DSCP_TYPE")&&RT()){var u;const e=aR("DSCP_TYPE");Li(u=["very-low","low","medium","high"]).call(u,e)&&(o.networkPriority=e)}const p=t.getParameters(),h=null===(r=p.encodings)||void 0===r?void 0:r[0];lT()&&!h&&(i.encodings=[o]),h&&Object.assign(h,o),Object.assign(p,i),SR.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(p.encodings))),await t.setParameters(p),await async function(e,t,n){try{var r;if(!nL().supportSetRtpSenderParameters)return;if(!function(e){return"vp9"===e}(e)||!aR("ENABLE_SVC"))return;const i={},o={},a=t.getParameters(),s=null===(r=a.encodings)||void 0===r?void 0:r[0];o.scalabilityMode=FD(n),s&&Object.assign(s,o),Object.assign(a,i),await t.setParameters(a),SR.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(a.encodings)))}catch(e){SR.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",e)}}(this.store.codec,t,aR("SVC_MODE"))}async updateAdaptation(e,t){var n,r;if(!e)return SR.debug("[updateAdaptation] no rtpSender found");if(!nL().supportSetRtpSenderParameters)return SR.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const i={},{bitrateMax:o,frameRate:a,scaleResolutionDownBy:s}=t;o&&(i.maxBitrate=1e3*o),a&&(i.maxFramerate=rA(a)),s&&s>=1&&Li(n=["vp8","vp9"]).call(n,this.store.codec)&&(i.scaleResolutionDownBy=s);const c=e.getParameters(),l=null===(r=c.encodings)||void 0===r?void 0:r[0];l&&Object.assign(l,i),Object.assign(c,{});try{await e.setParameters(c),SR.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(c.encodings)))}catch(t){!("transport"in e)||e.transport&&"connected"===e.transport.state?"connected"!==this.peerConnectionState?SR.debug("[updateAdaptation] peerConnection not connected}"):SR.debug("[updateAdaptation] updateRtpSenderEncodings failed",t):SR.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(e,t){try{if(!nL().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];i instanceof lD&&!this.isVP8Simulcast(i)&&await this.updateRtpSenderEncodings(i,r.sender)}}catch(e){SR.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){const r=BD.parse(e);return t.forEach(((e,t)=>{const i=n[t],o=r.mediaDescriptions.find((e=>e.attributes.mid===i));o&&(XD(o,e),tM(o,e,this.store.codec))})),BD.print(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,i,o,a;const c=e[s],l=t[s];if(l instanceof lD&&!Li(n=l._hints).call(n,bL.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(i=l._encoderConfig)||void 0===i?void 0:i.bitrateMax)>200&&null!==(o=l._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!lT()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof lD&&this.isVP8Simulcast(r)){const t=e[n],i={},o={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};i.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,i))}}}isVP8Simulcast(e){var t,n,r,i,o;return!!(e instanceof lD&&aR("SIMULCAST")&&"vp8"===this.store.codec&&!Li(t=e._hints).call(t,bL.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(i=e._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(aR("SDP_LOGGING"))return SR.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return t&&0!==t.length?t[0].ssrcId:void 0}setConfiguration(t){if(nL().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},OO(lV.prototype,"updateRemoteRTPCapabilities",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"updateRemoteRTPCapabilities"),lV.prototype),OO(lV.prototype,"connect",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"connect"),lV.prototype),OO(lV.prototype,"updateRemoteConnect",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"updateRemoteConnect"),lV.prototype),OO(lV.prototype,"createDataChannels",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"createDataChannels"),lV.prototype),OO(lV.prototype,"receive",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"receive"),lV.prototype),OO(lV.prototype,"batchReceive",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"batchReceive"),lV.prototype),OO(lV.prototype,"stopReceiving",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"stopReceiving"),lV.prototype),OO(lV.prototype,"muteRemote",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"muteRemote"),lV.prototype),OO(lV.prototype,"unmuteRemote",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"unmuteRemote"),lV.prototype),OO(lV.prototype,"muteLocal",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"muteLocal"),lV.prototype),OO(lV.prototype,"unmuteLocal",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"unmuteLocal"),lV.prototype),OO(lV.prototype,"close",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"close"),lV.prototype),OO(lV.prototype,"updateEncoderConfig",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"updateEncoderConfig"),lV.prototype),OO(lV.prototype,"updateSendParameters",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"updateSendParameters"),lV.prototype),OO(lV.prototype,"replaceTrack",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"replaceTrack"),lV.prototype),OO(lV.prototype,"updateAdaptation",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"updateAdaptation"),lV.prototype),OO(lV.prototype,"getRemoteSSRC",[hV],Object.getOwnPropertyDescriptor(lV.prototype,"getRemoteSSRC"),lV.prototype),lV);function hV(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}var fV;function mV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mV(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vV(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Bj,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new _V(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function _V(e){function t(e){if(Object(e)!==e)return Ih.reject(new TypeError(e+" is not an object."));var t=e.done;return Ih.resolve(e.value).then((function(e){return{value:e,done:t}}))}return _V=function(e){this.s=e,this.n=e.next},_V.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Ih.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Ih.reject(e):t(n.apply(this.s,arguments))}},new _V(e)}let yV=(fV=class extends YT{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(wI.StateChange,t,this._state)}constructor(e,t){super(),jw(this,"isPlanB",void 0),jw(this,"store",void 0),jw(this,"statsUploader",void 0),jw(this,"connection",void 0),jw(this,"localTrackMap",new Map),jw(this,"remoteUserMap",new Map),jw(this,"localDataChannels",[]),jw(this,"remoteDataChannelMap",new Map),jw(this,"pendingLocalTracks",[]),jw(this,"pendingRemoteTracks",[]),jw(this,"pendingLocalDataChannels",[]),jw(this,"pendingRemoteDataChannels",[]),jw(this,"statsCollector",void 0),jw(this,"shouldForwardP2PCreation",void 0),jw(this,"iceFailedCount",0),jw(this,"dtlsFailedCount",0),jw(this,"mutex",new FC("P2PChannel-mutex")),jw(this,"_state",yI.Disconnected),jw(this,"_pcStatsUploadType",aR("NEW_ICE_RESTART")?vI.FIRST_CONNECTION:vI.OLD_FIRST_CONNECTION),jw(this,"_isInRestartIce",!1),jw(this,"_isStartRestartIce",!1),jw(this,"_restartStates",["disconnected","failed"]),jw(this,"_restartTimer",void 0),jw(this,"_isFirstConnected",!0),jw(this,"handleMuteLocalTrack",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==yI.Connected)return void n(new NT(LT.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const r=this.filterTobeMutedTracks(e);if(0===r.length)return void t();const i=r.find((e=>"videoLowTrack"===e[0]));i&&i[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(r.map((e=>{let[,{id:t}]=e;return t})));const o=this.createMuteMessage(r);await dC(this,wI.RequestMuteLocal,o),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleUnmuteLocalTrack",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==yI.Connected)return void n(new NT(LT.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const r=this.filterTobeUnmutedTracks(e);if(0===r.length)return void t();const i=r.find((e=>"videoLowTrack"===e[0]));if(i){const t=i[1];if(t.track._originMediaStreamTrack.stop(),!aR("DISABLE_DUAL_STREAM_USE_ENCODING")&&nL().supportDualStreamEncoding){const n=e._mediaStreamTrack.clone();t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}else{const n=XU(e,pC(this,wI.RequestLowStreamParameter));t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}await new Ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}await this.connection.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t})));const o=this.createUnmuteMessage(r);await dC(this,wI.RequestUnmuteLocal,o),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleUpdateVideoEncoder",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const n=this.localTrackMap.get(_I.LocalVideoTrack);if(!this.connection||!n||n.track!==e||this.state!==yI.Connected)return void t();const{id:r,track:i}=n;await this.connection.updateSendParameters(r,i),await this.connection.updateEncoderConfig(r,i),this.emit(wI.UpdateVideoEncoder,i),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleUpdateVideoSendParameters",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const n=this.localTrackMap.get(_I.LocalVideoTrack);if(!this.connection||!n||n.track!==e||this.state!==yI.Connected)return void t();const{id:r,track:i}=n;await this.connection.updateSendParameters(r,i),t()}catch(e){n(e)}finally{r()}})),jw(this,"handleReplaceMixingTrack",(async(e,t,n,r)=>{if(!this.connection||this.state!==yI.Connected)return void t();const i=gj([e]);let o;SR.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(i.getTrackId(),"]")),"boolean"==typeof r&&r||(o=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(e,i),t()}catch(e){n(e)}finally{var a;null===(a=o)||void 0===a||a()}})),jw(this,"handleReplaceTrack",(async(e,t,n,r)=>{let i;SR.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(i=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var o;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!this.connection||!n||this.state!==yI.Connected)return void t();if(await(null===(o=this.connection)||void 0===o?void 0:o.replaceTrack(e,n[1].id)),this.isPlanB){const t=n[1];t.id=e._mediaStreamTrack.id,this.localTrackMap.set(n[0],t)}if(n[0]===_I.LocalVideoTrack&&!aR("DISABLE_DUAL_STREAM_USE_ENCODING")&&nL().supportDualStreamEncoding){const t=this.localTrackMap.get(_I.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new Ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}t()}catch(e){n(e)}finally{var a;null===(a=i)||void 0===a||a()}})),jw(this,"handleGetRTCStats",(e=>{e(this.statsCollector.getRTCStats())})),jw(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),jw(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),jw(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),jw(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new uj(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!nL().supportUnifiedPlan||aR("CHROME_FORCE_PLAN_B")&&RT(),this.shouldForwardP2PCreation=aR("FORWARD_P2P_CREATION")&&nL().supportPCSetConfiguration&&CT(),this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new Wj({},this.store):new pV({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(e){var t;this.state=yI.New;const n=this.shouldForwardP2PCreation&&"closed"===(null===(t=this.connection)||void 0===t?void 0:t.peerConnectionState);if(this.shouldForwardP2PCreation&&!n||(n&&this.connection&&(SR.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.isPlanB?new Wj(e,this.store):new pV(e,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new NT(LT.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=aR("NEW_ICE_RESTART")?vI.FIRST_CONNECTION:vI.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new NT(LT.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");aR("ENABLE_PREALLOC_PC")&&this.state===yI.Connected?await this.connection.updateRemoteConnect(e):(this.store.peerConnectionStart(),await this.connection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=yI.Connected)}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter((e=>{var t;let[n]=e;return Li(t=[_I.LocalVideoLowTrack,_I.LocalVideoTrack]).call(t,n)})),n=t.map((e=>{let[,{id:t}]=e;return t})),r=t.map((e=>{let[t]=e;return t}));if(this.connection instanceof pV){if(LR.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(r),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!Li(e).call(e,this.store.codec)){const t=["vp9","vp8","h264"].find((t=>Li(e).call(e,t)));t&&(this.store.codec=t,SR.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(t,".")))}this.connection.updateRemoteRTPCapabilities(n,e)}}async getEstablishParams(){var e;if(this.connection instanceof pV&&"closed"!==this.connection.peerConnectionState&&Li(e=[yI.New,yI.Connected]).call(e,this.state))return this.connection.establishPromise}async publishDataChannel(e){if(!this.connection||this.state!==yI.Connected){if(this.state===yI.Disconnected)throw new NT(LT.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach((e=>{var t;Li(t=this.pendingLocalDataChannels).call(t,e)||this.pendingLocalDataChannels.push(e)})),[]}const t=this.filterTobePublishedDataChannels(e);return 0===t.length?[]:(t.forEach((e=>{const t=Date.now();this.store.publish(e.id.toString(),"datachannel",t)})),await this.connection.createDataChannels(this.store.uid,t),t.forEach((e=>{this.localDataChannels.push(e);const t=Date.now();this.store.publish(e.id+"","datachannel",void 0,t)})),e.map((e=>({streamId:e.id,ordered:e.ordered,maxRetransmits:e.maxRetransmits,metadata:e.metadata,channelId:e._originDataChannelId}))))}publish(e,t,n){var r=this;return uU((function*(){const i=yield nU(r.mutex.lock("From P2PChannel.publish"));try{if(!r.connection||r.state!==yI.Connected){if(r.state===yI.Disconnected)throw new NT(LT.UNEXPECTED_ERROR,"PeerConnection already disconnected.");r.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===r.pendingLocalTracks.indexOf(e)));return void(r.pendingLocalTracks=r.pendingLocalTracks.concat(t))}r.store.pubId=r.store.pubId+1,eU.markPublishStart(r.store.clientId,r.store.pubId);const i=r.filterTobePublishedTracks(e,t,n);if(0===i.length)return void(yield nU(r.tryToUnmuteAudio(e)));yield*jj(vV(r.doPublish(r.connection,i)))}finally{i()}}))()}doPublish(e,t){var n=this;return uU((function*(){t.forEach((e=>{let{track:t,type:r}=e;const i=Date.now();n.store.publish(t.getTrackId(),r===_I.LocalAudioTrack?"audio":"video",i)})),n.bindLocalTrackEvents(t);const r=t.map((e=>{let{track:t}=e;return t})),i=yield nU(e.send(t.map((e=>{let{track:t}=e;return t})),n.store.codec,n.store.audioCodec)),o=(yield nU(i.next())).value,a=n.createGatewayPublishMessage(t,o);let s;try{s=yield a}catch(e){throw i.throw(e),(null==e?void 0:e.code)===LT.WS_ABORT&&t.forEach((e=>{let{track:t}=e;-1===n.pendingLocalTracks.indexOf(t)&&n.pendingLocalTracks.push(t)})),n.unbindLocalTrackEvents(t),e}const c=n.mapPubResToRemoteConfig(a,s),l=(yield nU(i.next(c))).value,d=aR("ENABLE_VIDEO_SEI");r.forEach((async e=>{const t=e.getRTCRtpTransceiver();t&&d&&(e.trackMediaType===mI.VIDEO?await async function(e,t){if(!nL().supportWebRTCEncodedTransform)return void SR.warning("browser not support video encoded transform");if(DD.has(e))return;if(!e.track)return;const n={track:e.track};if(aT()){if(!e.createEncodedStreams)return void SR.warning("browser not support createEncodedStreams() API");let i=null;try{i=e.createEncodedStreams()}catch(e){return void SR.error("create video-encoded-streams error",e&&e.message)}let o=[];t.on("sei-to-send",(e=>{o.push(e)}));const a=new TransformStream({transform(t,i){n.controller||(n.controller=i),e.track&&e.track.id!==n.track.id&&(SR.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const a=o.shift();a&&(t.data=function(e,t){const n=function(e){const t=e.length;let n=[],r=0;for(;r<t;)r+2<t&&0===e[r]&&0===e[r+1]&&(0===e[r+2]||1===e[r+2]||2===e[r+2]||3===e[r+2])?(n.push(e[r],e[r+1],3,e[r+2]),r+=3):(n.push(e[r]),r++);return new Uint8Array(n)}(t),r=n.length,i=Math.floor(r/255),o=r%255,a=new Uint8Array(6+i+1+r+e.byteLength);a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=6,a[5]=101;let s=0;for(;s<i;)a[6+s]=255,s++;return a[6+s]=o,s++,a.set(n,6+s),a.set(new Uint8Array(e),6+s+r),a.buffer}(t.data,a)),i.enqueue(t)}});i.readable.pipeThrough(a).pipeTo(i.writable)}else{if(!sT())return;{if("undefined"==typeof RTCRtpScriptTransform)return void SR.warning("browser not support RTCRtpScriptTransform");const i=xD(),o=new MessageChannel;await new Ih((e=>i.onmessage=t=>{"registered"===t.data&&e(void 0)}));const a=new RTCRtpScriptTransform(i,{name:"tx",port:o.port2},[o.port2]);e.transform=a,await new Ih((e=>i.onmessage=t=>{"started"===t.data&&e(void 0)})),t.on("sei-to-send",(e=>{o.port1.postMessage({sei:e})})),o.port1.onmessage=t=>{var i;t.data.transformed&&e.track&&(null===(i=e.track)||void 0===i?void 0:i.id)!==n.track.id&&(SR.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r))},n.worker=i}}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}const t=DD.get(e);if(t){DD.delete(e);try{var n,i;null===(n=t.controller)||void 0===n||n.terminate(),null===(i=t.worker)||void 0===i||i.terminate()}catch(e){SR.warning(e&&e.message)}}}DD.set(e,n),e.track.addEventListener("ended",r)}(t.sender,e):e.trackMediaType===mI.AUDIO&&await async function(e){if(!nL().supportWebRTCEncodedTransform)return void SR.warning("browser not support audio encoded transform");if(LD.has(e))return;if(!e.track)return;const t={track:e.track};if(aT()){if(!e.createEncodedStreams)return void SR.warning("browser not support createEncodedStreams() API");let r=null;try{r=e.createEncodedStreams()}catch(e){return void SR.error("create audio-encoded-streams error",e&&e.message)}const i=new TransformStream({transform(r,i){t.controller||(t.controller=i),e.track&&e.track.id!==t.track.id&&(SR.debug("audio track changed: ".concat(t.track.id," => ").concat(e.track.id)),t.track.removeEventListener("ended",n),t.track=e.track,t.track.addEventListener("ended",n)),i.enqueue(r)}});r.readable.pipeThrough(i).pipeTo(r.writable)}else if(sT()){if("undefined"==typeof RTCRtpScriptTransform)return void SR.warning("browser not support RTCRtpScriptTransform");const r=xD(),i=new MessageChannel;await new Ih((e=>r.onmessage=t=>{"registered"===t.data&&e(void 0)}));const o=new RTCRtpScriptTransform(r,{name:"tx",port:i.port2},[i.port2]);e.transform=o,await new Ih((e=>r.onmessage=t=>{"started"===t.data&&e(void 0)})),i.port1.onmessage=r=>{var i;r.data.transformed&&e.track&&(null===(i=e.track)||void 0===i?void 0:i.id)!==t.track.id&&(SR.debug("audio track changed: ".concat(t.track.id," => ").concat(e.track.id)),t.track.removeEventListener("ended",n),t.track=e.track,t.track.addEventListener("ended",n))},t.worker=r}function n(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",n)}const t=LD.get(e);if(t){LD.delete(e);try{var r,i;null===(r=t.controller)||void 0===r||r.terminate(),null===(i=t.worker)||void 0===i||i.terminate()}catch(e){SR.warning(e&&e.message)}}}LD.set(e,t),e.track.addEventListener("ended",n)}(t.sender))})),t.forEach((e=>{let{type:t}=e;n.statsCollector.addLocalStats(t)})),n.assignLocalTracks(t,l),n.statsUploader.startUploadOutboundStats(),t.forEach((e=>{let{track:t,type:r}=e;const i=Date.now();n.store.publish(t.getTrackId(),r===_I.LocalAudioTrack?"audio":"video",void 0,i)}))}))()}async updateVideoStreamParameter(e,t){const n=this.localTrackMap.get(t);if(!n)return;if(!(n.track instanceof lD))return SR.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof pV||this.connection instanceof Wj))return SR.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:r}=n,i=function(e,t){const n={};return e.height&&e.width&&(n.scaleResolutionDownBy=cA(e,t)),n.maxFramerate=e.framerate?rA(e.framerate):void 0,n.maxBitrate=e.bitrate?1e3*e.bitrate:void 0,n}(e,r);if(r._encoderConfig||(r._encoderConfig={}),t!==_I.LocalVideoLowTrack||!aR("DISABLE_DUAL_STREAM_USE_ENCODING")&&nL().supportDualStreamEncoding)null!=i.scaleResolutionDownBy&&(r._encoderConfig.scaleResolutionDownBy=i.scaleResolutionDownBy);else{const t=r._originMediaStreamTrack;if(!t.canvas)return SR.warn("[".concat(r.getTrackId(),"] no canvas on track"));!function(e,t){const n=e.canvas;t.width&&(n.width=rA(t.width)),t.height&&(n.height=rA(t.height)),t.framerate&&(n.stopCapture&&n.stopCapture(),n.stopCapture=tN((()=>{!n.startCapture&&n.stopCapture&&n.stopCapture(),n.startCapture&&n.startCapture()}),rA(t.framerate)))}(t,e)}null!=i.maxBitrate&&(r._encoderConfig.bitrateMax=i.maxBitrate/1e3),null!=i.maxFramerate&&(r._encoderConfig.frameRate&&"object"==typeof r._encoderConfig.frameRate?r._encoderConfig.frameRate.max=i.maxFramerate:r._encoderConfig.frameRate={max:i.maxFramerate}),SR.debug("[".concat(r.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(r._encoderConfig))),await this.connection.updateRtpSenderEncodings(r)}publishLowStream(e){var t=this;return uU((function*(){if(!t.connection||t.state!==yI.Connected)return;const n=yield nU(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const n=t.localTrackMap.get(_I.LocalVideoTrack);if(!n)throw new NT(LT.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(_I.LocalVideoLowTrack))throw new NT(LT.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const i=[{track:t.getLowVideoTrack(n.track,e),type:_I.LocalVideoLowTrack}];if(yield*jj(vV(t.doPublish(t.connection,i))),n.track.muted||!n.track.enabled){var r;const e=null===(r=t.localTrackMap.get(_I.LocalVideoLowTrack))||void 0===r?void 0:r.id;void 0!==e&&(yield nU(t.connection.muteLocal([e])))}}finally{n()}}))()}async republish(){this.pendingLocalTracks.length>0&&(SR.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await lC(this,wI.RequestRePublish,this.pendingLocalTracks),this.emit(wI.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(SR.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await lC(this,wI.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(e){for(let e=this.pendingRemoteTracks.length-1;e>=0;e--){const{user:t,kind:n}=this.pendingRemoteTracks[e];(n!==mI.AUDIO||t._audio_added_&&t._audioSSRC)&&(n!==mI.VIDEO||t._video_added_&&t._videoSSRC)||this.pendingRemoteTracks.splice(e,1)}if(e)await lC(this,wI.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:e,kind:t}of this.pendingRemoteTracks)await this.subscribe(e,t,t===mI.VIDEO?e._videoSSRC:e._audioSSRC);this.pendingRemoteTracks.forEach((e=>{let{user:t}=e;this.emit(wI.MediaReconnectEnd,t.uid)})),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==yI.Connected)return void e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find((e=>"videoLowTrack"===e[0]));return n&&n[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==yI.Connected)return void e.forEach((e=>{const t=this.pendingLocalDataChannels.indexOf(e);-1!==t&&this.pendingLocalDataChannels.splice(t,1)}));const t=this.filterTobeUnpublishedDataChannels(e);return 0!==t.length?(t.forEach((e=>{const t=this.localDataChannels.indexOf(e);-1!==t&&this.localDataChannels.splice(t,1)})),0===this.localDataChannels.length&&await this.connection.stopDataChannels(this.store.uid),t.map((e=>e.id))):void 0}async unpublishLowStream(){if(!this.connection||this.state!==yI.Connected)return;const e=this.localTrackMap.get(_I.LocalVideoLowTrack);if(!e)return;e.track.close();const t=[[_I.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const n=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:n}]=e;return{type:t,track:n}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&this.statsUploader.stopUploadOutboundStats(),n}async subscribeDataChannel(e,t){if(!this.connection||this.state!==yI.Connected)throw new NT(LT.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const n=t.filter((t=>{var n;return!(null!==(n=this.remoteDataChannelMap.get(e))&&void 0!==n&&n.get(t.id))}));if(0!==n.length)return await this.connection.createDataChannels(e.uid,n),n.forEach((t=>{var n;this.remoteDataChannelMap.has(e)?null===(n=this.remoteDataChannelMap.get(e))||void 0===n||n.set(t.id,t):this.remoteDataChannelMap.set(e,new Map([[t.id,t]]));const r=this.pendingRemoteDataChannels.findIndex((n=>{let{user:r,id:i}=n;return r.uid===e.uid&&i===t.id}));-1!==r&&this.pendingRemoteDataChannels.splice(r,1)})),n.map((e=>e.id))}async subscribe(e,t,n,r,i){var o;if(!this.connection||this.state!==yI.Connected)throw new NT(LT.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(null!==(o=this.remoteUserMap.get(e))&&void 0!==o&&o.has(t))return;let a,s,c;const l=this.connection.getPreMedia(n);if(l)SR.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(n,", no need to send sub to gateway.")),c=l.transceiver,a=l.track,s=l.id;else if(i){const n=i.find((e=>{let{stream_type:n}=e;return n===t}));if(!n)throw new NT(LT.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const r=await this.connection.receive(t,n.ssrcs,String(e._uintid),n.attributes);this.connection instanceof pV&&(c=r.transceiver),a=r.track,s=r.id}else{const i=await this.connection.receive(t,[{ssrcId:n,rtx:r}],String(e._uintid),void 0);this.connection instanceof pV&&(c=i.transceiver),a=i.track,s=i.id}t===mI.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(a):(e._audioTrack=new RD(a,e.uid,e._uintid,this.store),SR.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),c&&e._audioTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(a):(e._videoTrack=new CD(a,e.uid,e._uintid,this.store),SR.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),c&&e._videoTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._videoTrack)),aR("ENABLE_VIDEO_SEI")&&c&&(t==mI.VIDEO?await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nL().supportWebRTCEncodedTransform)return void SR.warning("browser not support video encoded transform");if(!e.track)return;if(MD.has(e)){const n=MD.get(e);return void(n&&(n.onSei=t.onSei))}const n={track:e.track,onSei:t.onSei};if(aT()){if(!e.createEncodedStreams)return void SR.warning("browser not support createEncodedStreams() API");let t=null;try{t=e.createEncodedStreams()}catch(e){return void SR.error("create video-encoded-streams error",e&&e.message)}const i=new TransformStream({transform(t,i){n.controller||(n.controller=i),e.track&&e.track.id!==n.track.id&&(SR.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const o=function(e){const t=new DataView(e.data);let n=0;for(;n+4<e.data.byteLength;){if(0===t.getUint8(n+0)&&0===t.getUint8(n+1)&&0===t.getUint8(n+2)&&1===t.getUint8(n+3)&&6===t.getUint8(n+4)){let r=n+6,i=0,o=0;for(;255===(o=t.getUint8(r++));)i+=255;i+=o;const a=PD(e.data,r,i);return new Uint8Array(a)}n++}return null}(t);o&&n.onSei&&n.onSei(o),i.enqueue(t)}});t.readable.pipeThrough(i).pipeTo(t.writable)}else if(sT()){if("undefined"==typeof RTCRtpScriptTransform)return void SR.warning("browser not support RTCRtpScriptTransform");const t=xD(),i=new MessageChannel;await new Ih((e=>t.onmessage=t=>{"registered"===t.data&&e(void 0)}));const o=new RTCRtpScriptTransform(t,{name:"rx",port:i.port2},[i.port2]);e.transform=o,await new Ih((e=>t.onmessage=t=>{"started"===t.data&&e(void 0)})),i.port1.onmessage=t=>{var i;t.data.transformed&&e.track&&(null===(i=e.track)||void 0===i?void 0:i.id)!==n.track.id?(SR.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r)):t.data.sei&&n.onSei&&n.onSei(t.data.sei)},n.worker=t}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}!function(e){const t=MD.get(e);if(t){MD.delete(e);try{var n,r;null===(n=t.controller)||void 0===n||n.terminate(),null===(r=t.worker)||void 0===r||r.terminate()}catch(e){SR.warning(e&&e.message)}}}(e)}MD.set(e,n),e.track.addEventListener("ended",r)}(c.receiver,{onSei:t=>{var n;null===(n=e._videoTrack)||void 0===n||n._onSei(t)}}):t==mI.AUDIO&&await async function(e){if(!nL().supportWebRTCEncodedTransform)return void SR.warning("browser not support audio encoded transform");if(ND.has(e))return;const t={track:e.track};if(aT()){if(!e.createEncodedStreams)return void SR.warning("browser not support createEncodedStreams() API");let r=null;try{r=e.createEncodedStreams()}catch(e){return void SR.error("create audio-encoded-streams error",e&&e.message)}const i=new TransformStream({transform(r,i){t.controller||(t.controller=i),e.track&&e.track.id!==t.track.id&&(SR.debug("audio track changed: ".concat(t.track.id," => ").concat(e.track.id)),t.track.removeEventListener("ended",n),t.track=e.track,t.track.addEventListener("ended",n)),i.enqueue(r)}});r.readable.pipeThrough(i).pipeTo(r.writable)}else if(sT()){if("undefined"==typeof RTCRtpScriptTransform)return void SR.warning("browser not support RTCRtpScriptTransform");const r=xD(),i=new MessageChannel;await new Ih((e=>r.onmessage=t=>{"registered"===t.data&&e(void 0)}));const o=new RTCRtpScriptTransform(r,{name:"rx",port:i.port2},[i.port2]);e.transform=o,await new Ih((e=>r.onmessage=t=>{"started"===t.data&&e(void 0)})),i.port1.onmessage=r=>{var i;r.data.transformed&&e.track&&(null===(i=e.track)||void 0===i?void 0:i.id)!==t.track.id&&(SR.debug("audio track changed: ".concat(t.track.id," => ").concat(e.track.id)),t.track.removeEventListener("ended",n),t.track=e.track,t.track.addEventListener("ended",n))},t.worker=r}function n(){e.track.removeEventListener("ended",n),function(e){const t=ND.get(e);if(t){ND.delete(e);try{var n,r;null===(n=t.controller)||void 0===n||n.terminate(),null===(r=t.worker)||void 0===r||r.terminate()}catch(e){SR.warning(e&&e.message)}}}(e)}ND.set(e,t),e.track.addEventListener("ended",n)}(c.receiver));const d=this.remoteUserMap.get(e);d?d.set(t,s):this.remoteUserMap.set(e,new Map([[t,s]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const u=this.pendingRemoteTracks.findIndex((n=>{let{user:r,kind:i}=n;return r.uid===e.uid&&t===i}));-1!==u&&(this.pendingRemoteTracks.splice(u,1),this.emit(wI.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==yI.Connected)throw new NT(LT.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter((e=>{var t;let{user:n,mediaType:r}=e;return!(null!==(t=this.remoteUserMap.get(n))&&void 0!==t&&t.has(r))}));const t=[],n=new Map;e.forEach((e=>{if(!this.connection)return;const r=this.connection.getPreMedia(e.ssrcId);r?n.set(e.ssrcId,r):t.push(e)}));const r=await this.connection.batchReceive(t.map((e=>{let{user:t,mediaType:n,ssrcId:r,rtxSsrcId:i}=e;return{kind:n,ssrcMsg:[{ssrcId:r,rtx:i}],mslabel:String(t._uintid)}})));t.forEach(((e,t)=>{n.set(e.ssrcId,r[t])})),e.forEach((e=>{let{user:t,mediaType:r,ssrcId:i}=e;const o=n.get(i);if(!o)return void SR.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(t.uid," subscribe data,").concat(r,", ").concat(i));const{track:a,id:s,transceiver:c}=o;r===mI.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(a):(t._audioTrack=new RD(a,t.uid,t._uintid,this.store),SR.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),c&&t._audioTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(a):(t._videoTrack=new CD(a,t.uid,t._uintid,this.store),SR.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),c&&t._videoTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(t,t._videoTrack));const l=this.remoteUserMap.get(t);l?l.set(r,s):this.remoteUserMap.set(t,new Map([[r,s]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadInboundStats();const d=this.pendingRemoteTracks.findIndex((e=>{let{user:n,kind:i}=e;return n.uid===t.uid&&r===i}));-1!==d&&(this.pendingRemoteTracks.splice(d,1),this.emit(wI.MediaReconnectEnd,t.uid))}))}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter((n=>{let{user:r,kind:i}=n;return void 0!==t?r.uid===e.uid&&t===i:r.uid===e.uid}));if(r.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.connection&&this.state===yI.Connected||n||r.forEach((t=>{let{kind:n}=t;var r;if(n===mI.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===mI.VIDEO){var i;null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0}})),!this.connection||this.state!==yI.Connected)return;const i=this.filterTobeUnSubscribedTracks(e,t);if(0===i.length)return;await this.connection.stopReceiving(i.map((e=>{let[,{id:t}]=e;return t})));const o=this.createUnsubscribeMessage(i);return this.withdrawRemoteTracks(i),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),i.forEach((e=>{let[t,{kind:r}]=e;var i,o;if(r===mI.VIDEO&&t._videoSSRC&&(null===(i=this.connection)||void 0===i||i.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===mI.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(r===mI.AUDIO){var a;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(a=t._audioTrack)||void 0===a||a._destroy(),t._audioTrack=void 0)}})),o}async unsubscribeDataChannel(e,t){if(t.forEach((e=>{const t=this.pendingRemoteDataChannels.findIndex((t=>t.id===e.id));-1!==t&&this.pendingRemoteDataChannels.splice(t,1)})),!this.connection)return;const n=this.filterTobeUnSubscribedDataChannels(e,t);if(0===n.length)return;t.forEach((e=>{e._close()}));const r=this.remoteDataChannelMap.get(e);return n.forEach((e=>{r&&r.delete(e.id)})),r&&0===r.size&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),n.map((e=>e.id))}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:n,mediaType:r}of e){const e=this.pendingRemoteTracks.filter((e=>{let{user:t,kind:i}=e;return void 0!==r?t.uid===n.uid&&r===i:t.uid===n.uid}));e.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),t=t.concat(e)}if(!this.connection||this.state!==yI.Connected)return void t.forEach((e=>{let{user:t,kind:n}=e;var r;if(n===mI.AUDIO)null===(r=t._audioTrack)||void 0===r||r._destroy(),t._audioTrack=void 0;else if(n===mI.VIDEO){var i;null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0}}));const n=Ji(e).call(e,((e,t)=>{let{user:n,mediaType:r}=t;const i=this.filterTobeUnSubscribedTracks(n,r);return e.concat(i)}),[]);if(0===n.length)return;await this.connection.stopReceiving(n.map((e=>{let[,{id:t}]=e;return t})));const r=this.createUnsubscribeAllMessage(n);return this.withdrawRemoteTracks(n),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),n.forEach((e=>{let[t,{kind:n}]=e;var r,i;if(n===mI.VIDEO&&t._videoSSRC&&(null===(r=this.connection)||void 0===r||r.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),n===mI.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0;else if(n===mI.AUDIO){var o;this.unbindRemoteTrackEvents(t._audioTrack),null===(o=t._audioTrack)||void 0===o||o._destroy(),t._audioTrack=void 0}})),r}isPreSubScribe(e){return!(!this.connection||this.state!==yI.Connected)&&!!this.connection.getPreMedia(e)}async muteRemote(e,t){if(!this.connection)return;const n=this.remoteUserMap.get(e);if(!n)return void SR.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!n.get(t))return void SR.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===mI.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.connection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;const n=this.remoteUserMap.get(e);n?n.get(t)||SR.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):SR.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."))}getAllTracks(e){const t=this.localTrackMap.get(_I.LocalAudioTrack);if((null==t?void 0:t.track)instanceof SP){const n=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==_I.LocalAudioTrack})).filter((t=>{let[n]=t;return!(e&&n===_I.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[n]=t;return!(e&&n===_I.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,n,r,i){if(e){const n=this.localTrackMap.get(_I.LocalAudioTrack),o=r?this.localTrackMap.get(_I.LocalVideoLowTrack):this.localTrackMap.get(_I.LocalVideoTrack);LR.publish(this.store.sessionId,{eventElapse:eU.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(bL.SCREEN_TRACK)),audio:!!n,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;n||(n=[]);const a=n.find((e=>e instanceof wP)),s=r?null===(o=this.localTrackMap.get(_I.LocalVideoTrack))||void 0===o?void 0:o.track:n.find((e=>e instanceof lD));LR.publish(this.store.sessionId,{eventElapse:eU.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==a?void 0:a.getTrackLabel(),videoName:null==s?void 0:s.getTrackLabel(),screenshare:-1!==(null==s?void 0:s._hints.indexOf(bL.SCREEN_TRACK)),audio:!!a,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,n,r){const i=r===mI.VIDEO?n._videoSSRC:n._audioSSRC;i&&LR.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===mI.VIDEO,audio:r===mI.AUDIO,peerid:n.uid,subscribeRequestid:i,p2pid:this.store.p2pId,eventElapse:eU.measureFromSubscribeStart(this.store.clientId,i),preSsrc:this.isPreSubScribe(i)})}reset(){SR.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new FC("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new Wj({},this.store):new pV({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(_I.LocalAudioTrack);if((null==e?void 0:e.track)instanceof SP){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach((e=>{t.removeAudioTrack(e)}))}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=yI.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(_I.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(_I.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof lD||t&&t.track instanceof wP?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(_I.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Wm(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.connection&&(SR.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=yI.Reconnecting,aR("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t]=e;var n;t._videoTrack&&t._videoTrack._player&&(null===(n=t._videoTrack._player.getVideoElement())||void 0===n||n.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())})),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new Wj({},this.store):new pV({},this.store),this.bindConnectionEvents(this.connection)),0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{var t;let[n,{track:r}]=e;switch(n){case _I.LocalVideoTrack:Li(t=r._hints).call(t,bL.LOW_STREAM)?r.close():this.pendingLocalTracks.push(r);break;case _I.LocalAudioTrack:r instanceof SP?this.pendingLocalTracks=this.pendingLocalTracks.concat(r.trackList):this.pendingLocalTracks.push(r);case _I.LocalVideoLowTrack:}})),this.emit(wI.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;Array.from(Yf(n).call(n)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(wI.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),0!==this.localDataChannels.length&&(this.localDataChannels.forEach((e=>{this.pendingLocalDataChannels.push(e)})),this.localDataChannels.length=0),0!==this.remoteDataChannelMap.size&&(Array.from(this.remoteDataChannelMap.entries()).forEach((e=>{let[t,n]=e;Array.from(Yf(n).call(n)).forEach((e=>{this.setPendingRemoteDataChannel(t,e)}))})),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),SR.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(const n of this.pendingRemoteDataChannels){const{user:r,id:i}=n;if((e instanceof pj?e.uid:e)===r.uid&&i===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:i}=n;if((e instanceof pj?e.uid:e)===r.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return uU((function*(){if(!t.connection||t.state!==yI.Connected)return;const n=yield nU(t.mutex.lock("From P2PChannel.restartICE"));let r;try{r=yield nU(t.connection.restartICE(e));const n=yield nU(r.next());if(n.done)return;const i=n.value,o=yield i;switch(t.reportPCDisconnectedOrFailed(e),e){case gI.TCP:t._pcStatsUploadType=vI.TCP_RESTART;break;case gI.RELAY:t._pcStatsUploadType=vI.RELAY_RESTART;break;default:t._pcStatsUploadType=vI.OLD_RESTART}t._isInRestartIce=!0,r.next(o)}catch(e){var i;null===(i=r)||void 0===i||i.throw(e)}finally{n()}}))()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(_I.LocalVideoTrack),n=this.localTrackMap.get(_I.LocalAudioTrack),r=e.videoSend.find((e=>e.ssrc===(null==t?void 0:t.ssrcs[0].ssrcId))),i=e.audioSend.find((e=>e.ssrc===(null==n?void 0:n.ssrcs[0].ssrcId)));if(!r||!i)return 1;const o=uC(this,wI.NeedSignalRTT),a=r?r.rttMs:void 0,s=i?i.rttMs:void 0,c=a&&s?(a+s)/2:a||s,l=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*l/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,p=null==t?void 0:t.track;if(p&&p._encoderConfig&&-1===p._hints.indexOf(bL.SCREEN_TRACK)){const t=p._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return DR[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((n=>{let[r]=n;const i=r._audioSSRC,o=r._videoSSRC,a=e.audioRecv.find((e=>e.ssrc===i)),s=e.videoRecv.find((e=>e.ssrc===o));if(!a&&!s)return void(t+=1);const c=uC(this,wI.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=a?a.jitterMs:void 0,p=e.recvPacketLossRate;let h=.7*p*100/50+.3*d/1500;u&&(h=.6*p*100/50+.2*d/1500+.2*u/400),t+=h<.1?1:h<.17?2:h<.36?3:h<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new Ih(((t,n)=>{this.handleMuteLocalTrack(e,t,n)}))}async replaceTrack(e,t){var n;if(SR.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!this.connection||this.state!==yI.Connected)return;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!r)return;const i=r[0];if(e!==t&&(this.unbindLocalTrackEvents([{track:e,type:i}]),this.bindLocalTrackEvents([{track:t,type:i}]),r[1].track=t),await(null===(n=this.connection)||void 0===n?void 0:n.replaceTrack(t,r[1].id)),this.isPlanB){const e=r[1];e.id=t._mediaStreamTrack.id,this.localTrackMap.set(i,e)}if(i===_I.LocalVideoTrack&&!aR("DISABLE_DUAL_STREAM_USE_ENCODING")&&nL().supportDualStreamEncoding){const t=this.localTrackMap.get(_I.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new Ih(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}}filterTobePublishedTracks(e,t,n){const r=[],i=this.getAllTracks();e=mC(e=e.filter((e=>-1===i.indexOf(e))));let o,a=!1;const s=this.localTrackMap.get(_I.LocalAudioTrack);for(const i of e){if(i instanceof lD&&(this.localTrackMap.has(_I.LocalVideoTrack)||a?new NT(LT.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:i,type:_I.LocalVideoTrack}),a=!0),t)){const e=this.getLowVideoTrack(i,n);r.push({track:e,type:_I.LocalVideoLowTrack})}if(i instanceof wP)if(s){const e=s.track;if(e instanceof SP)mj([i]),e.addAudioTrack(i),this.bindLocalAudioTrackEvents(i,!0);else{const t=gj([e,i]);SR.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(t.getTrackId(),"]")),this.replaceTrack(e,t)}}else o instanceof SP?(mj([i]),o.addAudioTrack(i)):o=o||!i._useAudioElement&&nL().webAudioMediaStreamDest&&!i._bypassWebAudio?gj(o?[i,o]:[i]):i}return o&&(SR.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(o.getTrackId(),"]")),r.push({track:o,type:_I.LocalAudioTrack})),r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=mC(e=e.filter((e=>-1!==n.indexOf(e))));for(const n of e){if(n instanceof wP){const e=this.localTrackMap.get(_I.LocalAudioTrack);if(!e)continue;e.track instanceof SP?(e.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),0===e.track.trackList.length&&(t.push([_I.LocalAudioTrack,e]),e.track.close())):t.push([_I.LocalAudioTrack,e])}if(n instanceof lD){const e=this.localTrackMap.get(_I.LocalVideoTrack);if(!e)continue;t.push([_I.LocalVideoTrack,e]);const n=this.localTrackMap.get(_I.LocalVideoLowTrack);n&&t.push([_I.LocalVideoLowTrack,n])}}return t}filterTobePublishedDataChannels(e){return(e=mC(e)).filter((e=>-1===this.localDataChannels.findIndex((t=>t.id===e.id))))}filterTobeUnpublishedDataChannels(e){return(e=(e=mC(e)).filter((e=>-1!==this.localDataChannels.indexOf(e)))).filter((e=>e._originDataChannel))}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:n}=e;switch(n){case _I.LocalVideoTrack:t.addListener(wL.GET_STATS,this.handleGetLocalVideoStats),t.addListener(wL.GET_RTC_STATS,this.handleGetRTCStats),t.addListener(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(wL.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(wL.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.addListener(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case _I.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case _I.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof SP?e.trackList.forEach((e=>{e.addListener(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(wL.GET_STATS,this.handleGetLocalAudioStats),e.addListener(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(wL.GET_STATS,this.handleGetLocalAudioStats),e.addListener(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(wL.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:n}]=e;return{track:n,type:t}}))),e.forEach((e=>{let{track:t,type:n}=e;switch(n){case _I.LocalVideoTrack:t.off(wL.GET_STATS,this.handleGetLocalVideoStats),t.off(wL.GET_RTC_STATS,this.handleGetRTCStats),t.off(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(wL.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(wL.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.off(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case _I.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case _I.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof SP?e.trackList.forEach((e=>{e.off(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(wL.GET_STATS,this.handleGetLocalAudioStats),e.off(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(wL.GET_STATS,this.handleGetLocalAudioStats),e.off(wL.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(wL.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(wL.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(wL.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(wL.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof CD&&t.addListener(wL.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof RD&&t.addListener(wL.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(wL.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;n.has(mI.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(mI.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,n)=>{var r;let i,o,{track:a,type:s}=e;switch(s){case _I.LocalAudioTrack:i=iI.Audio,o={dtx:a instanceof bP&&a._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case _I.LocalVideoTrack:i=Li(r=a._hints).call(r,bL.SCREEN_TRACK)?iI.Screen:iI.High,o=gV(gV({},iA(a)),{},{codec:this.store.codec,svc_mode:FD()});break;case _I.LocalVideoLowTrack:i=iI.Low,o=gV(gV({},iA(a)),{},{codec:this.store.codec,svc_mode:FD()})}return{stream_type:i,attributes:o,ssrcs:t[n]}}))}createGatewayUnpublishMessage(e){return e.map((e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case _I.LocalVideoTrack:n=Li(t=i._hints).call(t,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalAudioTrack:n=iI.Audio;break;case _I.LocalVideoLowTrack:n=iI.Low}return{stream_type:n,ssrcs:o,mid:a}}))}assignLocalTracks(e,t){e.forEach(((e,n)=>{let{track:r,type:i}=e;this.localTrackMap.set(i,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(wI.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),aR("NEW_ICE_RESTART")){var n;if(Li(n=this._restartStates).call(n,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const t=t=>{"disconnected"!==e.iceConnectionState&&"checking"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||(SR.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(t)),"CONNECTED"===uC(this,wI.QueryClientConnectionState)&&this.emit(wI.RequestRestartICE,t))},n=()=>{"disconnected"!==e.iceConnectionState&&"checking"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),SR.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout((()=>this.emit(wI.P2PLost)),0),this.iceFailedCount+=1,this.requestReconnect())},r=aR("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout((()=>{if(aR("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&nL().supportPCSetConfiguration)t(gI.RELAY),this._restartTimer=window.setTimeout(n,r);else if(lT())t(gI.UDP),this._restartTimer=window.setTimeout(n,4e3);else{if(t(gI.TCP),nL().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout((()=>{t(gI.RELAY),this._restartTimer=window.setTimeout(n,r)}),r));this._restartTimer=window.setTimeout(n,r)}}),800))}}else{if("disconnected"===t&&"disconnected"===e.iceConnectionState)return setTimeout((()=>{"disconnected"===e.iceConnectionState&&aR("ICE_RESTART")&&"CONNECTED"===uC(this,wI.QueryClientConnectionState)&&this.emit(wI.RequestRestartICE)}),800),void setTimeout((()=>{"disconnected"===e.peerConnectionState&&(SR.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout((()=>this.emit(wI.P2PLost)),0),this.iceFailedCount+=1,this.requestReconnect())}),4e3);"failed"===t&&(SR.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout((()=>this.emit(wI.P2PLost)),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),LR.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:QT.TRACER}).onSuccess(),this.emit(wI.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(OL.FIRST_FRAME_DECODED),LR.firstRemoteFrame(this.store.sessionId,OR.FIRST_AUDIO_DECODE,IR.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));n&&LR.firstRemoteFrame(this.store.sessionId,OR.FIRST_AUDIO_RECEIVED,IR.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoReceived=e=>{var t;const n=Array.from(Yf(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));n&&LR.firstRemoteFrame(this.store.sessionId,OR.FIRST_VIDEO_RECEIVED,IR.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(wI.ConnectionTypeChange,n),SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(lA(t))," -> ").concat(JSON.stringify(lA(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{SR.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(lA(t))," -> ").concat(JSON.stringify(lA(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const e=this.statsCollector.getLocalVideoTrackStats(),t=this.statsCollector.getRTCStats();return gV(gV({},e),t)}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.getLocalVideoStats=void 0}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(_I.LocalAudioTrack);if(e instanceof wP&&(null==n?void 0:n.track)instanceof SP)return n.track.isActive||t.push([_I.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r&&(t.push(r),r[0]===_I.LocalVideoTrack)){const e=this.localTrackMap.get(_I.LocalVideoLowTrack);e&&t.push([_I.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(_I.LocalAudioTrack);if(e instanceof wP&&(null==n?void 0:n.track)instanceof SP)return n.track.isActive&&t.push([_I.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r)if(r[0]===_I.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(_I.LocalVideoLowTrack);e&&t.push([_I.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map((e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case _I.LocalAudioTrack:n=iI.Audio;break;case _I.LocalVideoTrack:n=Li(t=i._hints).call(t,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalVideoLowTrack:n=iI.Low}return{stream_type:n,ssrcs:o,mid:a}}))}createUnmuteMessage(e){return e.map((e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case _I.LocalAudioTrack:n=iI.Audio;break;case _I.LocalVideoTrack:n=Li(t=i._hints).call(t,bL.SCREEN_TRACK)?iI.Screen:iI.High;break;case _I.LocalVideoLowTrack:n=iI.Low}return{stream_type:n,ssrcs:o,mid:a}}))}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const i=r.get(t);if(!i)return n;n.push([e,{kind:t,id:i}])}else Array.from(r.entries()).forEach((t=>{let[r,i]=t;n.push([e,{kind:r,id:i}])}));return n}filterTobeUnSubscribedDataChannels(e,t){const n=[];return t.forEach((t=>{var r;null!==(r=this.remoteDataChannelMap.get(e))&&void 0!==r&&r.has(t.id)&&n.push(t)})),n}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[n,{kind:r,id:i}]=e;switch(r){case mI.VIDEO:return void(n._videoSSRC&&t.push({stream_type:mI.VIDEO,ssrcId:n._videoSSRC}));case mI.AUDIO:return void(n._audioSSRC&&t.push({stream_type:mI.AUDIO,ssrcId:n._audioSSRC}))}})),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach((e=>{let[n,{kind:r}]=e;if(t.has(n)){let e=t.get(n);r===mI.VIDEO?e|=sI.Video:e|=sI.Audio,t.set(n,e)}else r===mI.VIDEO?t.set(n,sI.Video):t.set(n,sI.Audio)})),{users:Array.from(t.entries()).map((e=>{let[t,n]=e;return{stream_id:t.uid,stream_type:n}}))}}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(_I.LocalVideoTrack),n=this.localTrackMap.get(_I.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),n&&e.low_stream_uplink&&await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(e,t){return e.map(((e,n)=>{var r;let{stream_type:i}=e;return null===(r=t.find((e=>{let{stream_type:t}=e;return i===t})))||void 0===r?void 0:r.attributes}))}async tryToUnmuteAudio(e){for(let n=0;n<e.length;n++)if(e[n]instanceof wP){var t;const r=this.filterTobeUnmutedTracks(e[n]);if(0===r.length)continue;await(null===(t=this.connection)||void 0===t?void 0:t.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t}))));const i=this.createUnmuteMessage(r);return void await dC(this,wI.RequestUnmuteLocal,i)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(wI.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(wI.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await IC(qC(this.dtlsFailedCount,HC)),this.emit(wI.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await lC(this,wI.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(wI.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(_I.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof lD))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof lD)).length>1)throw new NT(LT.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof wP)).length>1&&(e.some((e=>e instanceof wP&&e._bypassWebAudio))||!nL().webAudioMediaStreamDest))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof lD&&this.pendingLocalTracks.some((e=>e instanceof lD)))throw new NT(LT.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof wP&&this.pendingLocalTracks.some((e=>e instanceof wP))&&(!nL().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof wP&&e._bypassWebAudio))))throw new NT(LT.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const n=!aR("DISABLE_DUAL_STREAM_USE_ENCODING")&&nL().supportDualStreamEncoding,r=gV(gV({},{width:160,height:120,framerate:15,bitrate:50}),t);let i;i=n?e._mediaStreamTrack.clone():XU(e,r);const o=AC(8,"track-low-"),a=new lD(i,gV(gV({},n&&{scaleResolutionDownBy:cA(r,e)}),{},{frameRate:r.framerate,bitrateMax:r.bitrate,bitrateMin:r.bitrate}),void 0,void 0,o);return a.on(CL.TRANSCEIVER_UPDATED,(t=>{e._updateRtpTransceiver(t,EL.LOW_STREAM)})),a._hints.push(bL.LOW_STREAM),e.on("sei-to-send",(e=>{a.emit("sei-to-send",e)})),e.addListener(wL.NEED_CLOSE,(()=>{a.close()})),a}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.connection&&this.connection instanceof pV){var i,o,a,s;const c=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:l,dtlsTransportState:d,peerConnectionState:u}=this.connection,{local:p,remote:h}=await this.connection.getSelectedCandidatePair();LR.pcStats(this.store.sessionId,{startTime:c,eventElapse:e-c||0,iceconnectionsate:l,dtlsstate:d,connectionstate:u,intSucc:t?1:2,error:r,selectedLocalCandidateProtocol:null!==(i=null==p?void 0:p.protocol)&&void 0!==i?i:"",selectedLocalCandidateType:null!==(o=p.candidateType)&&void 0!==o?o:"",selectedLocalCandidateAddress:"".concat(p.address,":").concat(p.port),selectedRemoteCandidateProtocol:null!==(a=h.protocol)&&void 0!==a?a:"",selectedRemoteCandidateType:null!==(s=h.candidateType)&&void 0!==s?s:"",selectedRemoteCandidateAddress:"".concat(h.address,":").concat(h.port),restartCnt:n,preallocation:this.connection.isPreallocation})}}reportVideoFirstFrameDecoded(e,t,n,r){var i;const o=Array.from(Yf(i=this.remoteUserMap).call(i)).find((t=>t._videoSSRC===e));if(o){r||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const i=this.store.keyMetrics,a=i.subscribe.find((e=>e.userId===o.uid&&"video"===e.type));LR.firstRemoteVideoDecode(this.store.sessionId,OR.FIRST_VIDEO_DECODE,IR.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:eU.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:i.requestAPEnd||0,apStart:i.requestAPStart||0,joinGwEnd:i.joinGatewayEnd||0,joinGwStart:i.joinGatewayStart||0,pcEnd:i.peerConnectionEnd||0,pcStart:i.peerConnectionStart||0,subscriberEnd:(null==a?void 0:a.subscribeEnd)||0,subscriberStart:(null==a?void 0:a.subscribeStart)||0,videoAddNotify:(null==a?void 0:a.streamAdded)||0,state:r?1:0,firstFrame:(null==a?void 0:a.firstFrame)||0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.connection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const i=r.get(t);if(!i)return!1;const o=await this.connection.getRemoteSSRC(i);return void 0!==o&&o!==n}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:n}]=e;t===_I.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,EL.LOW_STREAM):n._updateRtpTransceiver(void 0)}))}reportPCDisconnectedOrFailed(e){this.connection&&this.connection instanceof pV&&("disconnected"!==this.connection.iceConnectionState&&"checking"!==this.connection.iceConnectionState&&"failed"!==this.connection.iceConnectionState||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===vI.TCP_RESTART&&e===gI.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,vI.DISCONNECTED_OR_FAILED)))}},OO(fV.prototype,"startP2PConnection",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"startP2PConnection"),fV.prototype),OO(fV.prototype,"connect",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"connect"),fV.prototype),OO(fV.prototype,"updateRemoteRTPCapabilities",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"updateRemoteRTPCapabilities"),fV.prototype),OO(fV.prototype,"publishDataChannel",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"publishDataChannel"),fV.prototype),OO(fV.prototype,"unpublish",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"unpublish"),fV.prototype),OO(fV.prototype,"unpublishDataChannel",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"unpublishDataChannel"),fV.prototype),OO(fV.prototype,"unpublishLowStream",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"unpublishLowStream"),fV.prototype),OO(fV.prototype,"subscribeDataChannel",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"subscribeDataChannel"),fV.prototype),OO(fV.prototype,"subscribe",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"subscribe"),fV.prototype),OO(fV.prototype,"massSubscribe",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"massSubscribe"),fV.prototype),OO(fV.prototype,"unsubscribe",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"unsubscribe"),fV.prototype),OO(fV.prototype,"unsubscribeDataChannel",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"unsubscribeDataChannel"),fV.prototype),OO(fV.prototype,"massUnsubscribe",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"massUnsubscribe"),fV.prototype),OO(fV.prototype,"muteRemote",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"muteRemote"),fV.prototype),OO(fV.prototype,"unmuteRemote",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"unmuteRemote"),fV.prototype),OO(fV.prototype,"hasRemoteMediaWithLock",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"hasRemoteMediaWithLock"),fV.prototype),OO(fV.prototype,"disconnectForReconnect",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"disconnectForReconnect"),fV.prototype),OO(fV.prototype,"updateBitrateLimit",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"updateBitrateLimit"),fV.prototype),OO(fV.prototype,"remoteMediaSsrcChanged",[wV],Object.getOwnPropertyDescriptor(fV.prototype,"remoteMediaSsrcChanged"),fV.prototype),fV);function wV(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PChannel.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}const bV={};function EV(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&SR.debug("install service ".concat(e.name)),bV[e.name]=e}function SV(e){const t=bV[e];if(!t)throw new NT(LT.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function TV(e,t){return SV("DataStream").create(e,t)}function CV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function RV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?CV(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const OV=Date.now(),IV=20,AV=new Map,kV=new Map;async function xV(e){const t=AV.get(e),n=Array.isArray(t)&&t[t.length-1],r=kV.get(e);if(!n)return void(r.isSyncing=!1);const i={uid:n.uid,payload:n.payload};0===r.firstRecvTs&&(r.firstRecvTs=n.recvTs,r.firstSendTs=n.sendTs);const o=n.sendTs-r.firstSendTs,a=o-(Date.now()-r.firstRecvTs);a>0&&(r.firstRecvTs=Date.now()-o);let s=n.mediaDelay+a;s<=0?(t.pop(),LV(n.context,i),s=0):s=Math.min(s,IV),setTimeout((()=>t.length&&xV(e)),s)}function LV(e,t){e.safeEmit(oC.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function NV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return LV(n,{uid:e.uid,payload:e.payload});const r="".concat(n.id,"-").concat(e.uid),i=AV.get(r)||[],o=i.findIndex((t=>e.sendTs>=t.sendTs)),a=RV(RV({},e),{},{context:n,mediaDelay:t,recvTs:Date.now()});-1===o?i.push(a):i.splice(o,0,a),AV.set(r,i);let s=!1;var c;kV.has(r)?s=!(null===(c=kV.get(r))||void 0===c||!c.isSyncing):kV.set(r,{isSyncing:s,firstRecvTs:0,firstSendTs:0}),s||xV(r)}const PV=tT().name;function DV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DV(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const UV="websdk_ng_cache_parameter",jV=aR("MAX_PRELOAD_ASYNC_LENGTH"),VV=new Map,BV=[];let FV=null,GV=0,HV=0;const qV=new Map,WV=function(e,t){const n=[];let r=0;const i=async()=>{const e=n.shift();e&&await e(),n.length>0&&r<t?i():r--};return async function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return new Ih((async(o,s)=>{n.push((async()=>{try{const t=await e(...a);o(t)}catch(e){s(e)}})),r<t&&(r++,i())}))}}(KV,jV),zV=qS.CancelToken.source();async function KV(e,t,n,r,i,o){try{if(!aR("ENABLE_PRELOAD"))return;if(!nL().supportWebCrypto)return void wC((()=>{SR.warn("Your browser does not support preloading, this feature  be run in a secure environment")}),"preload_webcrypto_not_supported");if(!n&&null!==n)throw new NT(LT.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&jT(n,"token",1,2047),jT(e,"appid",1,2047),HO(t),r&&qO(r);const a=kC();SR.debug("preload channel ".concat(t,", uid is ").concat(r));const s={appId:e,cname:t,token:n||e,uid:"string"!=typeof r?r:null,sid:a,proxyServer:i};let c,l;"string"==typeof r?(s.stringUid=r,[l,c]=await Ih.all([WM(r,{sid:a,appId:e},zV.token),zM(MV(MV({},s),{},{token:n||e,uid:0}),zV.token)]),s.uid=l.uid,c.gatewayInfo.uid=s.uid,c.gatewayInfo.res.uid=s.uid):(o&&(s.stringUid=o),c=await zM(s,zV.token));const d={sid:a,appId:e,cname:t,token:n||e,uid:s.stringUid||r,intUid:s.uid||c.gatewayInfo.uid,stringUid:s.stringUid,ts:Date.now(),sua:l,ap:c};await async function(e){let t;try{e.uid&&JV({appId:e.appId,cname:e.cname,token:e.token,uid:e.uid,stringUid:e.stringUid});const n=tB(e),r=await async function(e,t){try{const n=await window.crypto.subtle.importKey("raw",SC(t),"AES-GCM",!1,["encrypt"]),r=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},n,bC(window.btoa(JSON.stringify(e))));return EC(new Uint8Array(r))}catch(e){return}}(e,e.token||e.appId);if(!r)return;t=$V(UV);const i=t?JSON.parse(t):[];i.push({[n]:r}),i.length>aR("AP_CACHE_NUM")&&i.shift(),eB(UV,JSON.stringify(i))}catch(e){SR.warn("Error caching server parameters:",e.message),eB(UV,"")}}(d),GV++}catch(e){throw HV++,function(e){FV||(FV=window.setTimeout((()=>{let t="";qV.forEach(((e,n)=>{t+="".concat(n,": ").concat(e," ;")})),LR.reportApiInvoke(null,{name:ZT.PRELOAD,options:{success:GV,failed:HV,err:t}}).onError(e),GV=0,HV=0,qV.clear(),FV=null}),1e4));const t=qV.get(e.code)||0;qV.set(e.code,t+1)}(e),e}}async function YV(e){try{const t=JV(e);if(!t||"disabled"!==e.cloudProxyServer)return;const n=await async function(e,t){try{const n=await window.crypto.subtle.importKey("raw",SC(t),"AES-GCM",!1,["decrypt"]),r=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},n,bC(e));return JSON.parse(window.atob(EC(new Uint8Array(r))))}catch(e){return}}(t,e.token||e.appId);if(!n)return;if(!function(e,t){return!(e.cname!==t.cname||e.appId!==t.appId||e.token!==t.token)&&(t.stringUid?e.stringUid===t.stringUid:"number"==typeof t.uid?e.uid===t.uid:e.uid==t.uid)}(n,e))return;if(n&&Date.now()-n.ts<aR("AP_CACHE_LIFETIME"))return n}catch(e){SR.warn("Error get preloadInfo",e.message)}}function JV(e){let t;try{if(t=$V(UV),!t)return;const n=JSON.parse(t),r=tB(e),i=function(e,t){for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n;return-1}(n,(e=>r in e));if(-1===i)return;const o=n.splice(i,1)[0];return eB(UV,JSON.stringify(n)),o[r]}catch(e){SR.warn("Error delete preload info: ".concat(t),e.message),eB(UV,"")}}function XV(e){if(e){let t=VV.get(e);t&&(window.clearTimeout(t),t=null,VV.delete(e)),Li(BV).call(BV,e)||"disabled"!==e.cloudProxyServer||BV.push(e)}if(VV.size<aR("AP_CACHE_NUM")&&BV.length>0){const e=BV.shift();VV.set(e,window.setTimeout((async()=>{const{appId:t,cname:n,token:r,stringUid:i,uid:o,proxyServer:a}=e;try{await WV(t,n,r,o,a,i),VV.has(e)&&XV(e)}catch(t){SR.warn("update preload failed",t.message),ZV(e)}}),aR("AP_UPDATE_INTERVAL")))}}function ZV(e){const t=BV.indexOf(e);-1!==t&&BV.splice(t,1);let n=VV.get(e);n&&(window.clearTimeout(n),n=null,VV.delete(e),XV())}function QV(e,t){const n=e.sua,r=e.ap;t&&n&&LR.reqUserAccount(e.sid,{lts:n.requestTime,elapse:n.elapse,success:!0,serverAddr:n.url,stringUid:t,uid:e.intUid,errorCode:null,extend:n.req}),LR.reportResourceTiming(e.ap.url,e.sid),LR.joinWebProxyAP(e.sid,{lts:r.requestTime,elapse:r.elapse,sucess:1,apServerAddr:r.url,turnServerAddrList:r.proxyInfo.addresses.map((e=>e.ip)).join(","),eventType:"disabled",unilbsServerIds:[QI.CHOOSE_SERVER,QI.CLOUD_PROXY_FALLBACK].toString()}),LR.joinChooseServer(e.sid,{lts:r.requestTime,elapse:r.elapse,succ:!0,csAddr:r.url,opid:r.opid,serverList:r.gatewayInfo.gatewayAddrs.map((e=>e.address)),ec:null,cid:r.gatewayInfo.cid.toString(),uid:r.gatewayInfo.uid.toString(),csIp:r.gatewayInfo.csIp,unilbsServerIds:[QI.CHOOSE_SERVER].toString(),isHttp3:r.isHttp3})}function $V(e){return window.atob(window.localStorage.getItem(e)||"")}function eB(e,t){window.localStorage.setItem(e,window.btoa(t))}function tB(e){let t="".concat(e.appId,"_").concat(e.cname);return"string"==typeof e.uid&&(t+="_s_".concat(e.uid)),"number"==typeof e.uid&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),jC(t)}function nB(e,t){switch(t){case 0:for(;128&pB(e););break;case 2:oB(e,fB(e));break;case 5:oB(e,4);break;case 1:oB(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function rB(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let iB=[];function oB(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function aB(e){return e.offset>=e.limit}function sB(e,t){let n=e.bytes,r=e.offset,i=e.limit,o=r+t;if(o>n.length){let t=new Uint8Array(2*o);t.set(n),e.bytes=t}return e.offset=o,o>i&&(e.limit=o),r}function cB(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function lB(e,t){let n=sB(e,t.length);e.bytes.set(t,n)}function dB(e,t){let n=cB(e,t),r=String.fromCharCode,i=e.bytes,o="",a="";for(let e=0;e<t;e++){let s,c,l,d,u=i[e+n];0==(128&u)?a+=r(u):192==(224&u)?e+1>=t?a+=o:(s=i[e+n+1],128!=(192&s)?a+=o:(d=(31&u)<<6|63&s,d<128?a+=o:(a+=r(d),e++))):224==(240&u)?e+2>=t?a+=o:(s=i[e+n+1],c=i[e+n+2],32896!=(49344&(s|c<<8))?a+=o:(d=(15&u)<<12|(63&s)<<6|63&c,d<2048||d>=55296&&d<=57343?a+=o:(a+=r(d),e+=2))):240==(248&u)?e+3>=t?a+=o:(s=i[e+n+1],c=i[e+n+2],l=i[e+n+3],8421504!=(12632256&(s|c<<8|l<<16))?a+=o:(d=(7&u)<<18|(63&s)<<12|(63&c)<<6|63&l,d<65536||d>1114111?a+=o:(d-=65536,a+=r(55296+(d>>10),56320+(1023&d)),e+=3))):a+=o}return a}function uB(e,t){let n=t.length,r=0;for(let e=0;e<n;e++){let i=t.charCodeAt(e);i>=55296&&i<=56319&&e+1<n&&(i=(i<<10)+t.charCodeAt(++e)-56613888),r+=i<128?1:i<2048?2:i<65536?3:4}mB(e,r);let i=sB(e,r),o=e.bytes;for(let e=0;e<n;e++){let r=t.charCodeAt(e);r>=55296&&r<=56319&&e+1<n&&(r=(r<<10)+t.charCodeAt(++e)-56613888),r<128?o[i++]=r:(r<2048?o[i++]=r>>6&31|192:(r<65536?o[i++]=r>>12&15|224:(o[i++]=r>>18&7|240,o[i++]=r>>12&63|128),o[i++]=r>>6&63|128),o[i++]=63&r|128)}}function pB(e){return e.bytes[cB(e,1)]}function hB(e,t){let n=sB(e,1);e.bytes[n]=t}function fB(e){let t,n=0,r=0;do{t=pB(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function mB(e,t){for(t>>>=0;t>=128;)hB(e,127&t|128),t>>>=7;hB(e,t)}function gB(e,t){let n,r=0,i=0,o=0;return n=pB(e),r=127&n,128&n&&(n=pB(e),r|=(127&n)<<7,128&n&&(n=pB(e),r|=(127&n)<<14,128&n&&(n=pB(e),r|=(127&n)<<21,128&n&&(n=pB(e),i=127&n,128&n&&(n=pB(e),i|=(127&n)<<7,128&n&&(n=pB(e),i|=(127&n)<<14,128&n&&(n=pB(e),i|=(127&n)<<21,128&n&&(n=pB(e),o=127&n,128&n&&(n=pB(e),o|=(127&n)<<7))))))))),{low:r|i<<28,high:i>>>4|o<<24,unsigned:t}}function vB(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=0===i?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10,a=sB(e,o),s=e.bytes;switch(o){case 10:s[a+9]=i>>>7&1;case 9:s[a+8]=9!==o?128|i:127&i;case 8:s[a+7]=8!==o?r>>>21|128:r>>>21&127;case 7:s[a+6]=7!==o?r>>>14|128:r>>>14&127;case 6:s[a+5]=6!==o?r>>>7|128:r>>>7&127;case 5:s[a+4]=5!==o?128|r:127&r;case 4:s[a+3]=4!==o?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==o?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==o?n>>>7|128:n>>>7&127;case 1:s[a]=1!==o?128|n:127&n}}const _B={},yB={},wB=4294967296,bB=wB*wB,EB=bB/2,SB=IB(0,!0),TB=IB(0),CB=AB(0,-2147483648,!1),RB=AB(-1,2147483647,!1),OB=AB(-1,-1,!0);function IB(e,t){let n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=yB[e],r)?r:(n=AB(e,0,!0),i&&(yB[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=_B[e],r)?r:(n=AB(e,e<0?-1:0,!1),i&&(_B[e]=n),n)}function AB(e,t,n){return{low:0|e,high:0|t,unsigned:!!n}}function kB(e,t){if(isNaN(e))return t?SB:TB;if(t){if(e<0)return SB;if(e>=bB)return OB}else{if(e<=-EB)return CB;if(e+1>=EB)return RB}return e<0?t?SB:TB:AB(e%wB|0,e/wB|0,t)}function xB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}class LB extends YT{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(OI.CONNECTION_STATE_CHANGE,e,t)}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this._qualityRatio}),6e4))}constructor(e){var t;super(),jw(this,"name","AgoraRTCImageModeration"),jw(this,"_connectionState",RI.CONNECTING),jw(this,"_sequence",0),jw(this,"_moderationStartTime",void 0),jw(this,"_workerConnection",void 0),jw(this,"_workerMessageLengthLimit",void 0),jw(this,"_qualityRatio",void 0),jw(this,"_connectInfo",void 0),jw(this,"_cancelTokenSource",qS.CancelToken.source()),jw(this,"_retryConfig",void 0),jw(this,"_moderationInterval",void 0),jw(this,"_moderationTimer",null),jw(this,"_moderationMode",1),jw(this,"_quality",1),jw(this,"_qualityTimer",null),jw(this,"_ticket",void 0),jw(this,"_moderationIntervalMinimum",void 0),jw(this,"_uploadFailedNum",0),jw(this,"_uploadNum",0),jw(this,"_uploadTimer",null),jw(this,"_extraInfo",void 0),jw(this,"_vendor",""),jw(this,"_encoder",new TextEncoder),jw(this,"_moderationId",void 0),jw(this,"inspectImage",(()=>{if(this.connectionState!==RI.CONNECTED)throw new GO(LT.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval((()=>{this.connectionState===RI.CONNECTED?this.requestToInspectImage():SR.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)}),this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()})),this._moderationId=AC(5,"image-moderation-"),this._workerMessageLengthLimit=aR("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=aR("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),this._qualityRatio=aR("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new XI("worker-"+this._moderationId,HC),this.on(OI.STATE_CHANGE,((e,t)=>{SR.debug("[".concat(this._moderationId,"] Moderation operation :").concat(II[e]," ").concat(t||""))})),this.handleWorkerEvents()}async init(e,t){this.emit(OI.STATE_CHANGE,II.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new Ih(((r,i)=>{this.on(OI.CONNECTION_STATE_CHANGE,((e,t)=>{e===RI.CONNECTED&&r()})),this.requestAP(e,n,t).then((e=>{this.connectWorker(e)})).catch((e=>{i(e)}))}))}updateConfig(e){var t;this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),SR.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(e))),this.connectionState===RI.CONNECTED&&this.inspectImage()}async requestAP(e,t,n){const r=aR("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),i=await function(e,t,n,r){let{appId:i,areaCode:o,cname:a,sid:s,token:c,uid:l}=t;jM++;const d="moderation_plugin",u={service_name:d,json_body:JSON.stringify({appId:i,areaCode:o,cname:a,command:"allocateEdge",requestId:jM,seq:jM,sid:s,appToken:c,ts:Date.now(),uid:l+""})};let p,h,f=e[0];return WC((async()=>{p=Date.now();const e=await yM(f,{data:u,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(h=Date.now()-p,0!==e.code){const t=new GO(LT.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+e.code,{retry:!0,responseTime:h});throw SR.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new GO(LT.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:h});throw SR.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new GO(LT.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:t.code,responseTime:h});throw SR.error(e.toString()),e}if(!t.servers.some((e=>!!e.wss))){const e=new GO(LT.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:t.code,responseTime:h});throw SR.error(e.toString()),e}const r=aR("IMAGE_MODERATION_WORKER_HOST");return{addressList:t.servers.map((e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(r,":").concat(n,"/moderation")})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,ticket:t.appTicket,responseTime:h}}),((t,n)=>(LR.apworkerEvent(s,{success:!0,sc:200,serviceName:d,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:h,serverIp:e[n%e.length]}),!1)),((t,n)=>(LR.apworkerEvent(s,{success:!1,sc:t.data&&t.data.code||200,serviceName:d,responseTime:h,serverIp:e[n%e.length]}),!!(t.code!==LT.OPERATION_ABORTED&&t.code!==LT.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(f=e[(n+1)%e.length],!0))),r)}(r,e,t,n);this.emit(OI.STATE_CHANGE,II.AP_CONNECTED);const{addressList:o,ticket:a}=i;return this._ticket=a,o}async connectWorker(e){this.emit(OI.STATE_CHANGE,II.CONNECT_WORKER),await this._workerConnection.init(e,1e4)}handleWorkerEvents(){this._workerConnection.on(FO.CONNECTED,(async()=>{this.emit(OI.STATE_CHANGE,II.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=RI.CONNECTED})),this._workerConnection.on(FO.CLOSED,(()=>{this.connectionState=RI.CLOSED})),this._workerConnection.on(FO.FAILED,(()=>{this.connectionState=RI.CLOSED})),this._workerConnection.on(FO.RECONNECTING,(()=>{this.connectionState=this.connectionState===RI.CONNECTED?RI.RECONNECTING:RI.CONNECTING})),this._workerConnection.on(FO.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const t=function(e){return function(e){let t={};e:for(;!aB(e);){let n=fB(e);switch(n>>>3){case 0:break e;case 1:t.code=fB(e);break;case 2:t.msg=dB(e,fB(e));break;case 3:t.requestId=dB(e,fB(e));break;case 4:t.timestamp=gB(e,!1);break;default:nB(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}(new Uint8Array(e.data));aR("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&SR.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(t)),this._uploadNum++,void 0===t.code||0===t.code||(this._uploadFailedNum++,SR.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(t.code,", msg is ").concat(t.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout((()=>{LR.reportApiInvoke(this._connectInfo.sid||null,{name:ZT.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,t.code],tag:QT.TRACER}).onError(new GO(LT.IMAGE_MODERATION_UPLOAD_FAILED,t.msg)),this._uploadTimer=null}),aR("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else SR.error("[".concat(this._moderationId,"] Unexpected message type from worker"))})),this._workerConnection.on(FO.WILL_RECONNECT,((e,t,n)=>{"recover"===e&&n(e),n("tryNext")})),this._workerConnection.on(FO.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){const e=uC(this,OI.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void(aR("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&SR.debug("Only the track being played can be inspected"));this._sequence++;const n=await this.generateRequestData(e,t);this._workerConnection.sendMessage(n,!0,!0)}else aR("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&SR.debug("Only the track being published can be inspected")}async generateRequestData(e,t){let{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s}=t;const c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await xN(l,n,r),u=this._sequence+"-"+i+"-"+s+"-"+c+"-"+AC(12,""),p={appId:n,cid:i,cname:r,deviceId:"",elapse:LB.intToLong(Number(c-this._moderationStartTime)),fileSize:l.buffer.byteLength,height:l.height,width:l.width,jpg:d,networkType:6,osType:7,requestId:u,sdkVersion:"4.22.0",sequence:this._sequence,sid:a,timestamp:kB(c),uid:s,vid:o,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};void 0===this._extraInfo&&delete p.callbackData;const h=function(e){let t=function(){const e=iB.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(e,t){let n=e.appId;void 0!==n&&(mB(t,10),uB(t,n));let r=e.cid;void 0!==r&&(mB(t,16),mB(t,r));let i=e.cname;void 0!==i&&(mB(t,26),uB(t,i));let o=e.deviceId;void 0!==o&&(mB(t,34),uB(t,o));let a=e.elapse;void 0!==a&&(mB(t,40),vB(t,a));let s=e.fileSize;void 0!==s&&(mB(t,48),vB(t,rB(s)));let c=e.height;void 0!==c&&(mB(t,56),vB(t,rB(c)));let l=e.jpg;void 0!==l&&(mB(t,66),mB(t,l.length),lB(t,l));let d=e.networkType;void 0!==d&&(mB(t,72),vB(t,rB(d)));let u=e.osType;void 0!==u&&(mB(t,80),vB(t,rB(u)));let p=e.requestId;void 0!==p&&(mB(t,90),uB(t,p));let h=e.sdkVersion;void 0!==h&&(mB(t,98),uB(t,h));let f=e.sequence;void 0!==f&&(mB(t,104),vB(t,rB(f)));let m=e.sid;void 0!==m&&(mB(t,114),uB(t,m));let g=e.timestamp;void 0!==g&&(mB(t,120),vB(t,g));let v=e.uid;void 0!==v&&(mB(t,128),mB(t,v));let _=e.vid;void 0!==_&&(mB(t,136),mB(t,_));let y=e.width;void 0!==y&&(mB(t,144),vB(t,rB(y)));let w=e.service;void 0!==w&&(mB(t,152),mB(t,w));let b=e.callbackData;void 0!==b&&(mB(t,162),mB(t,b.length),lB(t,b));let E=e.ticket;void 0!==E&&(mB(t,170),uB(t,E));let S=e.vendorConfigs;void 0!==S&&(mB(t,178),uB(t,S))}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}(p);if(h.byteLength<this._workerMessageLengthLimit){if(aR("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xB(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xB(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p);delete e.jpg,SR.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(e))}return h}{const t=this.quality*this._qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=qS.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=RI.CLOSED,this.emit(OI.STATE_CHANGE,II.CLOSED)}}function NB(e){if(MT(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new GO(LT.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new GO(LT.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const PB={name:"ImageModeration",create:function(e){let{config:t}=e;return NB(t),new LB(t)}};var DB,MB,UB,jB,VB,BB,FB,GB,HB,qB,WB,zB,KB,YB,JB,XB,ZB,QB,$B,eF,tF,nF,rF,iF,oF,aF,sF,cF,lF,dF,uF,pF,hF,fF,mF,gF,vF,_F,yF,wF,bF;function EF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?EF(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}FC.setLogger(SR);let TF=(DB=xR(),MB=xR({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof YL))return[t];t=[t]}return t.map((e=>e?Object(e).toString():"null"))}}),UB=xR({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==IL.DATA?(Array.isArray(t)||(t=[t]),t.map((e=>e.getTrackId()))):[t.getChannelId()])}),jB=xR({argsMap:(e,t,n,r)=>["object"==typeof t?t.uid:t,n,r]}),VB=xR({argsMap:(e,t,n)=>[t,n]}),BB=xR({argsMap:(e,t)=>t.map((e=>{let{user:t,mediaType:n}=e;return[null==t?void 0:t.uid,n]}))}),FB=xR({argsMap:(e,t,n,r)=>["object"==typeof t?t.uid:t,n,r]}),GB=xR({argsMap:(e,t)=>t.map((e=>{let{user:t,mediaType:n}=e;return{uid:null==t?void 0:t.uid,mediaType:n}}))}),HB=xR(),qB=xR(),WB=xR(),zB=xR(),KB=xR(),YB=xR(),JB=xR(),XB=xR(),ZB=xR(),QB=xR(),$B=xR(),eF=xR(),tF=xR(),nF=xR(),rF=xR({argsMap:(e,t)=>[t]}),iF=xR(),oF=xR(),aF=xR(),sF=xR(),cF=xR(),lF=xR(),dF=xR(),uF=xR(),pF=xR({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),hF=xR(),fF=xR(),mF=xR(),gF=xR(),vF=xR(),_F=xR(),yF=xR({reportResult:!0}),wF=xR(),bF=class extends YT{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return(null===(e=this._config)||void 0===e?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e){let t;if(super(),jw(this,"store",void 0),jw(this,"_uid",void 0),jw(this,"_channelName",void 0),jw(this,"_uintUid",void 0),jw(this,"_users",[]),jw(this,"_config",void 0),jw(this,"_clientId",void 0),jw(this,"_appId",void 0),jw(this,"_sessionId",null),jw(this,"_key",void 0),jw(this,"_rtmConfig",{}),jw(this,"_joinInfo",void 0),jw(this,"_gateway",void 0),jw(this,"_statsCollector",void 0),jw(this,"_configDistribute",void 0),jw(this,"_leaveMutex",new FC("client-leave")),jw(this,"_publishMutex",new FC("client-publish")),jw(this,"_renewTokenMutex",new FC("client-renewtoken")),jw(this,"_subscribeMutex",new FC("client-subscribe")),jw(this,"_encryptionMode","none"),jw(this,"_encryptionSecret",null),jw(this,"_encryptionSalt",null),jw(this,"_encryptDataStream",!1),jw(this,"_encryptDataStreamKey",null),jw(this,"_encryptDataStreamIv",null),jw(this,"_proxyServer",void 0),jw(this,"_turnServer",{servers:[],mode:"auto"}),jw(this,"_cloudProxyServerMode","disabled"),jw(this,"_isDualStreamEnabled",!1),jw(this,"_defaultStreamFallbackType",void 0),jw(this,"_lowStreamParameter",void 0),jw(this,"_streamFallbackTypeCacheMap",new Map),jw(this,"_remoteStreamTypeCacheMap",new Map),jw(this,"_axiosCancelSource",qS.CancelToken.source()),jw(this,"_audioVolumeIndicationInterval",void 0),jw(this,"_networkQualityInterval",void 0),jw(this,"_userOfflineTimeout",void 0),jw(this,"_streamRemovedTimeout",void 0),jw(this,"_liveTranscodeStreamingClient",void 0),jw(this,"_liveRawStreamingClient",void 0),jw(this,"_channelMediaRelayClient",void 0),jw(this,"_networkQualitySensitivity","normal"),jw(this,"_p2pChannel",void 0),jw(this,"_useLocalAccessPoint",!1),jw(this,"_setLocalAPVersion",void 0),jw(this,"_joinAndNotLeaveYet",!1),jw(this,"_numberOfJoinCount",0),jw(this,"_remoteDefaultVideoStreamType",void 0),jw(this,"_inspect",void 0),jw(this,"_moderation",void 0),jw(this,"_license",void 0),jw(this,"_pendingPublishedUsers",[]),jw(this,"ntpAlignErrorCount",0),jw(this,"remoteInboundOffset",0),jw(this,"_handleLocalTrackEnable",((e,t,n)=>{this.publish(e,!1).then(t).catch(n)})),jw(this,"_handleLocalTrackDisable",((e,t,n)=>{this.unpublish(e).then(t).catch(n)})),jw(this,"_handleUserOnline",(e=>{if(aR("BLOCK_LOCAL_CLIENT")&&UR(e.uid,this.channelName))return void SR.debug("[".concat(e.uid,"] will be ignored in local"));this.isStringUID&&"string"!=typeof e.uid&&SR.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const t=this._users.find((t=>t.uid===e.uid));if(t)t._trust_in_room_=!0,t._is_pre_created&&(t._is_pre_created=!1,this.safeEmit(oC.USER_JOINED,t));else{const t=new pj(e.uid,e.uint_id||e.uid);this._users.push(t),SR.debug("[".concat(this._clientId,"] user online"),e.uid),this.safeEmit(oC.USER_JOINED,t)}})),jw(this,"_handleUserOffline",(e=>{if(aR("BLOCK_LOCAL_CLIENT")&&UR(e.uid,this.channelName))return;const t=this._users.find((t=>t.uid===e.uid));t&&(this._handleRemoveStream(e),this._handleRemoveDataChannels(e),t._audio_pre_subscribed||t._video_pre_subscribed?t._is_pre_created=!0:fC(this._users,t),this._remoteStreamTypeCacheMap.delete(t.uid),this._streamFallbackTypeCacheMap.delete(t.uid),SR.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),this.safeEmit(oC.USER_LEAVED,t,e.reason))})),jw(this,"_handleAddAudioOrVideoStream",((e,t,n,r,i,o,a)=>{if(aR("BLOCK_LOCAL_CLIENT")&&UR(t,this.channelName))return;const s=this._users.find((e=>e.uid===t));if(!s)return void SR.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));SR.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(s.uid,e,void 0,void 0,void 0,Date.now());const c="audio"===e?s.hasAudio:s.hasVideo;s._uintid||(s._uintid=i||t),"audio"===e?s._trust_audio_stream_added_state_=!0:s._trust_video_stream_added_state_=!0,"audio"===e?(s._audio_added_=!0,void 0!==n&&(s._audioSSRC=n),void 0!==r&&(s._cname=r),o&&(s._audioOrtc=o)):(s._video_added_=!0,void 0!==n&&(s._videoSSRC=n),void 0!==r&&(s._cname=r),void 0!==a&&(s._rtxSsrcId=a),o&&(s._videoOrtc=o)),("audio"===e?s.hasAudio:s.hasVideo)&&!c&&(SR.info("[".concat(this._clientId,"] remote user ").concat(s.uid," published ").concat(e)),this.safeEmit(oC.USER_PUBLISHED,s,e)),"video"===e?LR.onGatewayStream(this._sessionId,OR.ON_ADD_VIDEO_STREAM,IR.ON_ADD_VIDEO_STREAM,{peer:i||t,ssrc:s._videoSSRC}):LR.onGatewayStream(this._sessionId,OR.ON_ADD_AUDIO_STREAM,IR.ON_ADD_AUDIO_STREAM,{peer:i||t,ssrc:s._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(s,e,n).then((t=>{if(t&&(SR.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(s.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof yV))return this._p2pChannel.unsubscribe(s,e,!0).then((()=>this._subscribe(s,e,!0).catch((e=>{SR.error("[".concat(this._clientId,"] resubscribe error"),e.toString())}))))})),this._p2pChannel.hasPendingRemoteMedia(s,e)&&(SR.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(s.uid," after reconnect.")),this._subscribe(s,e,!0).catch((e=>{SR.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})))})),jw(this,"_handleRemoveStream",(e=>{if(aR("BLOCK_LOCAL_CLIENT")&&UR(e.uid,this.channelName))return;const t=this._users.find((t=>t.uid===e.uid));if(!t)return void SR.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));SR.debug("[".concat(this._clientId,"] stream removed with uid ").concat(e.uid));let n=()=>{};t.hasAudio&&t.hasVideo?n=()=>{SR.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(oC.USER_UNPUBLISHED,t,"audio"),SR.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(oC.USER_UNPUBLISHED,t,"video")}:t.hasVideo?n=()=>{SR.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(oC.USER_UNPUBLISHED,t,"video")}:t.hasAudio&&(n=()=>{SR.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(oC.USER_UNPUBLISHED,t,"audio")}),t._video_pre_subscribed||t._audio_pre_subscribed||(t._trust_audio_stream_added_state_=!0,t._trust_video_stream_added_state_=!0,t._audio_added_=!1,t._video_added_=!1,this._p2pChannel instanceof yV&&this._p2pChannel.unsubscribe(t).then((e=>{if(e)return this._gateway.unsubscribe(e,t.uid)})),t._audioSSRC=void 0,t._videoSSRC=void 0,t._audioOrtc=void 0,t._videoOrtc=void 0,t._rtxSsrcId=void 0),LR.onGatewayStream(this._sessionId,OR.ON_REMOVE_STREAM,IR.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),n()})),jw(this,"_handleSetStreamLocalEnable",((e,t,n)=>{if(aR("BLOCK_LOCAL_CLIENT")&&UR(t,this.channelName))return;const r=this._users.find((e=>e.uid===t));if(!r)return void SR.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));SR.debug("[".concat(this._clientId,"] local ").concat(e," ").concat(n?"enabled":"disabled"," with uid ").concat(t));const i="audio"===e?r.hasAudio:r.hasVideo;if("audio"===e){r._trust_audio_enabled_state_=!0;const e=r._audio_enabled_;if(r._audio_enabled_=n,r._audio_enabled_===e)return;{const e=r._audio_enabled_?"enable-local-audio":"disable-local-audio";SR.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(oC.USER_INFO_UPDATED,t,e)}}else{r._trust_video_enabled_state_=!0;const e=r._video_enabled_;if(r._video_enabled_=n,r._video_enabled_===e)return;{const e=r._video_enabled_?"enable-local-video":"disable-local-video";SR.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(oC.USER_INFO_UPDATED,t,e)}}const o="audio"===e?r.hasAudio:r.hasVideo;return i!==o?!i&&o?(SR.info("[".concat(this._clientId,"] remote user ").concat(t," published ").concat(e)),void this.safeEmit(oC.USER_PUBLISHED,r,e)):("video"===e&&r._videoTrack&&r._videoTrack._destroy(),"audio"===e&&r._audioTrack,this._p2pChannel.muteRemote(r,e),SR.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished ").concat(e)),void this.safeEmit(oC.USER_UNPUBLISHED,r,e)):void 0})),jw(this,"_handleMuteStream",((e,t,n)=>{if(aR("BLOCK_LOCAL_CLIENT")&&UR(e,this.channelName))return;SR.debug("[".concat(this._clientId,"] receive mute message"),e,t,n);const r=this._users.find((t=>t.uid===e));if(!r)return void SR.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(e));const i="audio"===t?r.hasAudio:r.hasVideo;if("audio"===t){r._trust_audio_mute_state_=!0;const t=r._audio_muted_;if(r._audio_muted_=n,r._audio_muted_===t)return;{const t=r._audio_muted_?"mute-audio":"unmute-audio";SR.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(oC.USER_INFO_UPDATED,e,t)}}else{r._trust_video_mute_state_=!0;const t=r._video_muted_;if(r._video_muted_=n,r._video_muted_===t)return;{const t=r._video_muted_?"mute-video":"unmute-video";SR.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(oC.USER_INFO_UPDATED,e,t)}}const o="audio"===t?r.hasAudio:r.hasVideo;if(i!==o){if(!i&&o)return("audio"===t?r._audioSSRC:r._videoSSRC)?(SR.info("[".concat(this._clientId,"] remote user ").concat(e," published ").concat(t)),void this.safeEmit(oC.USER_PUBLISHED,r,t)):void SR.warning("[".concat(this._clientId,"] remote user ").concat(e," receive ").concat(t," unmute message  before add stream message, ").concat(t," SSRC doesn't exist yet."));"video"===t&&r._videoTrack&&!r._video_pre_subscribed&&r._videoTrack._destroy(),"audio"===t&&r._audioTrack,this._p2pChannel.muteRemote(r,t),SR.info("[".concat(this._clientId,"] remote user ").concat(e," unpublished ").concat(t)),this.safeEmit(oC.USER_UNPUBLISHED,r,t)}})),jw(this,"_handleP2PLost",(async e=>{SR.debug("[".concat(this._clientId,"] receive p2p lost"),e),parseInt(e.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():SR.warning("[".concat(this._clientId,"] P2PLost stream not found"),e)})),jw(this,"_handleTokenWillExpire",(()=>{SR.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(oC.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)})),jw(this,"_handleBeforeUnload",(e=>{"beforeunload"===e.type&&void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),SR.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))})),jw(this,"_handleUpdateNetworkQuality",(()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.safeEmit(oC.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const e={downlinkNetworkQuality:0,uplinkNetworkQuality:0};e.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),e.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(oC.NETWORK_QUALITY,e)})),jw(this,"_handleP2PAddAudioOrVideoStream",((e,t,n,r)=>{const i=this._users.find((e=>e.uid===t));if(!i)return void SR.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));SR.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(i.uid,e,void 0,void 0,void 0,Date.now());const o="audio"===e?i.hasAudio:i.hasVideo;"audio"===e?i._trust_audio_stream_added_state_=!0:i._trust_video_stream_added_state_=!0,"audio"===e?(i._audio_added_=!0,void 0!==n&&(i._audioSSRC=n),void 0!==r&&(i._audioMid=r)):(i._video_added_=!0,void 0!==n&&(i._videoSSRC=n),void 0!==r&&(i._videoMid=r)),("audio"===e?i.hasAudio:i.hasVideo)&&!o&&(SR.info("[".concat(this._clientId,"] remote user ").concat(i.uid," published ").concat(e)),this.safeEmit(oC.USER_PUBLISHED,i,e)),this._p2pChannel.hasPendingRemoteMedia(i,e)&&(SR.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(i.uid," after reconnect.")),this._subscribe(i,e,!0).catch((e=>{SR.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})))})),this._config=e,this._clientId=AC(5,"client-"),this.store=new lR(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),SR.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat($C," build: ").concat(rR,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{iC(e.clientRoleOptions),t=Object.assign({},e.clientRoleOptions)}catch(e){SR.warning("[".concat(this._clientId,"] ").concat(e.toString()))}this._statsCollector=new Dj(this.store),this._statsCollector.onStatsException=(e,t,n)=>{SR.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(e,", msg: ").concat(t,", uid: ").concat(n)),this.safeEmit(oC.EXCEPTION,{code:e,msg:t,uid:n})},this._statsCollector.onUploadPublishDuration=(e,t,n,r)=>{const i=this._users.find((t=>t.uid===e));i&&LR.peerPublishStatus(this._sessionId,{subscribeElapse:r,audioPublishDuration:t,videoPublishDuration:n,peer:i._uintid})},this.store.useP2P="p2p"===e.mode,this._gateway=new gM(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||HC,httpRetryConfig:e.httpRetryConfig||HC,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:t}),this._configDistribute=new ZM,this.store.useP2P?(this._p2pChannel=new xj(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new yV(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];oR("JOIN_GATEWAY_USE_443PORT_ONLY",o),oR("JOIN_GATEWAY_USE_DUAL_DOMAIN",a);const s=this._gateway.signal.websocket;return s instanceof JI&&(s.use443PortOnly=o,s.tryDoubleDomain=a),async function(e,t,n){KS.get(e)||KS.set(e,[]),YS.get(e)||YS.set(e,t),JS.get(e)||JS.set(e,0);const r=KS.get(e),i=YS.get(e);if(!r||!i)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(JS.get(e)===i){const e=zS();r.push(e),await e.promise}JS.set(e,JS.get(e)+1);for(var o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];const c=await n(...a);return JS.set(e,JS.get(e)-1),JS.get(e)===i-1&&r.length>0&&(r[0].resolve(),r.shift()),0===JS.get(e)&&(KS.set(e,[]),YS.set(e,0),JS.set(e,0)),c}("client.join",aR("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,n,r,i)}async join(e,t,n,r,i){const o=++this._numberOfJoinCount;this.store.joinStart(),r&&(this.store.uid=r);const a="HTTPS"===(KC||KC||(KC=(window.location.protocol.split(":")[0]||"").toUpperCase(),KC)),s=QC()?window.isSecureContext:"Browser Not Support";if(!QC()&&!a||!window.isSecureContext){const e="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";SR.warning(e)}"DISCONNECTED"===this.connectionState&&(this.store.avoidJoinStart=Math.round(Date.now()),SR.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),LR.setAppId(e);try{if(!n&&null!==n)throw new GO(LT.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&jT(n,"token",1,2047),jT(e,"appid",1,2047),HO(t),r&&qO(r),i&&jT(i,"optionalInfo",1,2047)}catch(i){throw LR.reportApiInvoke(kC(),{name:ZT.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:QT.TRACER}).onError(i),i}if(this._leaveMutex.isLocked&&(SR.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),SR.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,"DISCONNECTED"!==this.connectionState){const i=new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw LR.reportApiInvoke(kC(),{name:ZT.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:QT.TRACER}).onError(i),i}this._gateway.state="CONNECTING";const c=await YV({appId:e,cname:t,uid:r,stringUid:"string"==typeof r?r:void 0,token:n||e,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const l=(null==c?void 0:c.sid)||kC();SR.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(o)),this._sessionId||(this._sessionId=l,this.store.sessionId=this._sessionId);const d=LR.reportApiInvoke(l,{name:ZT.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:QT.TRACER}),u=SF(SF({},this._rtmConfig),{},{clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof r?r:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:n||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:i,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!c},void 0!==this._remoteDefaultVideoStreamType&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(u.setLocalAPVersion=this._setLocalAPVersion),"string"==typeof r&&(u.stringUid=r,this._uintUid?(u.uid=this._uintUid,this._uintUid=void 0):u.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret){if(u.aesmode=this._encryptionMode,u.aespassword=await(async e=>{const t=function(e){const t=window.atob("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),n=new Uint8Array(new ArrayBuffer(t.length));for(let e=0;e<t.length;e+=1)n[e]=t.charCodeAt(e);return n}(),n=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),r=WT(e),i=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,r);return function(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}(new Uint8Array(i))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(u.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&("aes-128-gcm2"===this._encryptionMode||"aes-256-gcm2"===this._encryptionMode))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const e=new TextEncoder,t=aR("USE_PURE_ENCRYPTION_MASTER_KEY")?e.encode(u.appId+this._encryptionSecret+this._encryptionSecret):e.encode(u.appId+u.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(e,t,n){const r=await window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"]),i="aes-128-gcm2"===e?128:256,o=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:n},r,i+96);return new Uint8Array(o).subarray(i/8)}(this._encryptionMode,t,bC(this._encryptionSalt)),this._encryptDataStreamKey=await async function(e,t,n){const r=await window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"]),i="aes-128-gcm2"===e?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:n},r,{name:"AES-GCM",length:i},!0,["encrypt","decrypt"])}(this._encryptionMode,t,bC(this._encryptionSalt))}else s?SR.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):SR.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,SR.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:t,appId:e,stringUid:u.stringUid});const p=this._sessionId;setTimeout((()=>{"CONNECTING"===this.connectionState&&p===this._sessionId&&LR.joinChannelTimeout(this._sessionId,5)}),5e3);try{var h;let r;const i=u.cloudProxyServer;if(Li(h=["proxy3","proxy4","proxy5"]).call(h,i)){const e=aR("PROXY_SERVER_TYPE3");Array.isArray(e)?u.proxyServer=e[0]:u.proxyServer=e}if(LR.setProxyServer(u.proxyServer),SR.setProxyServer(u.proxyServer),this.store.requestAPStart(),c){if(SR.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(u.stringUid?", ".concat(u.stringUid," => ").concat(c.intUid):""," ")),u.stringUid&&!u.uid&&(u.uid=c.intUid),r={gatewayInfo:c.ap.gatewayInfo},aR("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&"auto"===u.turnServer.mode)if(0===c.ap.proxyInfo.addresses.length)SR.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const e=(await sA(c.ap.proxyInfo,c.ap.gatewayInfo.uid)).map((e=>({turnServerURL:e.address,tcpport:e.tcpport||PR.tcpport,udpport:e.udpport||PR.udpport,username:e.username||PR.username,password:e.password||PR.password,forceturn:!1,security:!0})));u.turnServer={mode:"manual",servers:e}}QV(c,u.stringUid)}else{if(u.stringUid&&!u.uid){let e;[e,r]=await Ih.all([qM(u.stringUid,u,this._axiosCancelSource.token,this._config.httpRetryConfig||HC,this.store),HM(u,this._axiosCancelSource.token,this._config.httpRetryConfig||HC,!0,this.store)]),SR.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(u.stringUid," => ").concat(e)),u.uid=e,r.gatewayInfo.uid=e,r.gatewayInfo.res.uid=e}else r=await HM(u,this._axiosCancelSource.token,this._config.httpRetryConfig||HC,!0,this.store);if(!this._joinAndNotLeaveYet)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout((()=>{this._configDistribute.startGetConfigDistribute(u,this._axiosCancelSource.token),this._configDistribute.on(pI.UPDATE_BITRATE_LIMIT,(e=>{this._p2pChannel.updateBitrateLimit(e)}))}),0),this._key=n||e;const o=r.gatewayInfo,a=u.uid?u.uid:o.uid;this._joinInfo=SF(SF({},u),{},{cid:o.cid,uid:a,vid:o.vid,apResponse:o.res,apGatewayAddress:o.apGatewayAddress,uni_lbs_ip:o.uni_lbs_ip,gatewayAddrs:o.gatewayAddrs}),this.store.intUid=a;const s=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));d.onSuccess(s),this._appId=e,this._channelName=u.cname,this._uid=s,this.store.uid=s,setTimeout((()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(sT()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()}),0);const l=u.stringUid?"string uid: ".concat(u.stringUid,",uid: ").concat(u.uid):"uid: ".concat(this._uid);return SR.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(l)),setTimeout((()=>{SR.startUpload()}),5e3),this.store.joinEnd(),this,Li(MR).call(MR,this)||MR.push(this),"disabled"===this._cloudProxyServerMode&&nL().supportWebCrypto&&aR("ENABLE_PRELOAD")&&XV(this._joinInfo),s}catch(e){const t=Array.isArray(e)?e[0]:e;throw t&&t.code===LT.OPERATION_ABORTED?SR.warning("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),t):SR.error("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),t),t.code!==LT.OPERATION_ABORTED&&this._numberOfJoinCount===o&&(this._gateway.state="DISCONNECTED",this._reset()),d.onError(t),t}}_joinGateway(){if(!this._joinInfo||!this._key)throw new GO(LT.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!aR("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){SR.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(sT()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(e){const t=MR.indexOf(e);-1!==t&&MR.splice(t,1)}(this),this._statsCollector.stopUpdateStats();const e=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return SR.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave("CONNECTED"!==this.connectionState),SR.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Array.isArray(e)){if(!(e instanceof YL))return this._publishDataChannel(e);e=[e]}if(0===e.length)throw new GO(LT.INVALID_PARAMS,"param list is empty");const n=e;if("audience"===this._gateway.role)throw new GO(LT.INVALID_OPERATION,"audience can not publish stream");for(const e of n){if(!(e instanceof YL))throw new GO(LT.INVALID_PARAMS,"parameter is not local track");if(!e._enabled&&t)throw new GO(LT.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(e.getTrackId()))}SR.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(n.map((e=>"".concat(e.getTrackId()," ")))));const r=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&n.forEach((e=>{const t=this._configDistribute.getBitrateLimit();e instanceof lD&&t&&e.setBitrateLimit(t.uplink)}));try{await this._publishHighStream(n),SR.info("[".concat(this._clientId,"] Publish success, id ").concat(n.map((e=>"".concat(e.getTrackId()," ")))))}catch(e){throw SR.error("[".concat(this._clientId,"] publish error"),e.toString()),e}finally{r()}}async _publishDataChannel(e){MT(e.id,"id",0,65535,!0),PT(e.ordered,"ordered"),jT(e.metadata,"metadata",0,512),SR.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const t=await this._publishMutex.lock();try{if(-1!==this._p2pChannel.getAllDataChannels().findIndex((t=>t.id===e.id)))throw new GO(LT.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||void 0===this._uid)throw new GO(LT.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&aR("FORCE_TURN")&&!aR("TURN_ENABLE_TCP")&&!aR("TURN_ENABLE_UDP"))throw new GO(LT.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const t=function(e){return TV(e,!1)}(e),n=await this._p2pChannel.publishDataChannel([t]);if(n.length>0){if("number"!=typeof t._originDataChannelId)throw SR.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new GO(LT.CREATE_DATACHANNEL_ERROR);try{await Ih.all(n.map((e=>this._uid&&this._gateway.publishDataChannel(this._uid,e,!0)))),await t._waitTillOpen()}catch(e){if(e.code!==LT.DISCONNECT_P2P)throw e}}return SR.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(t.id)),t}catch(e){throw SR.error("[".concat(this._clientId,"] publish datachannels error"),e.toString()),e}finally{t()}}async unpublish(e){if(!this._joinInfo||void 0===this._uid)throw new GO(LT.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof YL))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);SR.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map((e=>"".concat(e.getTrackId()," ")))," "));const n=await this._publishMutex.lock();try{if(this._p2pChannel instanceof xj){const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.sendExtensionMessage(AI.UNPUBLISH,{unpubMsg:e},!0)}else{const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.unpublish(e,this._uid),SR.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map((e=>"".concat(e.getTrackId())))))}}catch(e){throw SR.error("[".concat(this._clientId,"] unpublish error"),e.toString()),e}finally{n&&n()}}async _unpublishDataChannel(e){void 0!==e&&0!==e.length||(e=this._p2pChannel.getAllDataChannels()),SR.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map((e=>"".concat(e.id," ")))," "));const t=await this._publishMutex.lock();try{const t=await this._p2pChannel.unpublishDataChannel(e);t&&await this._gateway.unpublishDataChannel(t),SR.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map((e=>"".concat(e.id)))))}catch(e){throw SR.error("[".concat(this._clientId,"] unpublish dataChannel error"),e.toString()),e}finally{t&&t()}}async subscribe(e,t,n){if(!(e instanceof pj)){const t=this.remoteUsers.find((t=>t.uid===e));if(!t)throw new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");e=t}return"datachannel"===t?this._subscribeDataChannel(e,n):this._subscribe(e,t)}async presubscribe(e,t){if(DT(t,"mediaType",["audio","video"]),this._p2pChannel instanceof xj)throw new GO(LT.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"can't presub when not join");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const n=t===mI.AUDIO,r=t===mI.VIDEO,i=await this._subscribeMutex.lock();try{const{ssrcId:i,ortc:o,rtxSsrcId:a,cname:s,uint_id:c}=await this._gateway.presubscribe(e,t,!0);if(null==i)throw new GO(LT.UNEXPECTED_RESPONSE,"no ssrc id");let l=this._users.find((t=>t.uid===e));l||(l=new pj(e,c||e),l._is_pre_created=!0,this._users.push(l)),s&&(l._cname=s),l._uintid||(l._uintid=c||e),n&&(l._audioSSRC=i,l._audio_pre_subscribed=!0,o&&(l._audioOrtc=o)),r&&(l._videoSSRC=i,l._video_pre_subscribed=!0,o&&(l._videoOrtc=o),null!=a&&(l._rtxSsrcId=a)),SR.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(i)),await this._p2pChannel.subscribe(l,t,i,a,o);const d=n?l._audioTrack:l._videoTrack;if(!d)throw new GO(LT.UNEXPECTED_ERROR,"can not find remote track in user");return n&&(l._trust_audio_stream_added_state_=!0,l._audio_added_=!0),r&&(l._trust_video_stream_added_state_=!0,l._video_added_=!0),d}catch(t){throw SR.error("[".concat(this._clientId,"] presub user ").concat(e," error"),t),t}finally{i()}}async _subscribeDataChannel(e,t){var n;if(MT(t,"channelId",0,65535,!0),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));const r=this._users.find((t=>t===e));if(!r)throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&0===e._dataChannels.length)throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new GO(LT.INVALID_REMOTE_USER,"user is not published");const i=null===(n=e._dataChannels)||void 0===n?void 0:n.find((e=>e.id===t));if(!i)throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new GO(LT.REMOTE_USER_IS_NOT_PUBLISHED);const o=await this._subscribeMutex.lock();SR.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const n=await this._p2pChannel.subscribeDataChannel(e,[i]);if(n&&Li(n).call(n,i.id))try{var a;if("number"!=typeof i._originDataChannelId)throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new GO(LT.CREATE_DATACHANNEL_ERROR);const t={id:i.id,datachannelId:i._originDataChannelId,ordered:i.ordered,maxRetransmits:i.maxRetransmits,metadata:null!==(a=i.metadata)&&void 0!==a?a:""};await this._gateway.subscribeDataChannel(e.uid,t,!0),await i._waitTillOpen()}catch(t){if((null==t?void 0:t.code)!==LT.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[i]),t;await this._p2pChannel.unsubscribeDataChannel(e,[i]),this._p2pChannel.setPendingRemoteDataChannel(e,i.id)}return SR.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),i}finally{o()}}async _p2pSubscribe(e,t,n){if(DT(t,"mediaType",["audio","video"]),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=this._users.find((t=>t===e));if(!r){const t=new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new GO(LT.INVALID_REMOTE_USER,"user is not published");throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!n&&("audio"===t&&!e.hasAudio||"video"===t&&!e.hasVideo)){const n=new GO(LT.REMOTE_USER_IS_NOT_PUBLISHED);throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),n}const i=await this._subscribeMutex.lock();SR.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const n="audio"===t?e._audioSSRC:e._videoSSRC,r="audio"===t?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this._p2pChannel instanceof xj&&await this._p2pChannel.subscribe(e,t,n,r)}catch(e){throw e}SR.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{SR.warning("[".concat(this._clientId,"] auto set fallback failed"),e)}));const n="audio"===t?e._audioTrack:e._videoTrack;if(!n)throw new GO(LT.UNEXPECTED_ERROR,"can not find remote track in user object");return n}catch(t){throw SR.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{i()}}async _subscribe(e,t,n){if(this._p2pChannel instanceof xj)return this._p2pSubscribe(e,t);if(DT(t,"mediaType",["audio","video"]),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=this._users.find((t=>t===e));if(!r){const t=new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new GO(LT.INVALID_REMOTE_USER,"user is not published");throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!(n||("audio"!==t||e.hasAudio&&void 0!==e._audioSSRC)&&("video"!==t||e.hasVideo&&void 0!==e._videoSSRC))){const n=new GO(LT.REMOTE_USER_IS_NOT_PUBLISHED);throw SR.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),n}let i="audio"===t?e._audioSSRC:e._videoSSRC,o="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?mI.AUDIO:mI.VIDEO,ssrcId:i};const c=await this._subscribeMutex.lock();SR.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const r="audio"===t?e._audioSSRC:e._videoSSRC;void 0!==r&&r!==i&&(i=r,o="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?mI.AUDIO:mI.VIDEO,ssrcId:i}),eU.markSubscribeStart(this.store.clientId,i),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,i,a,o);try{this._p2pChannel.isPreSubScribe(i)||await this._gateway.subscribe(e.uid,s,!0)}catch(n){if((null==n?void 0:n.code)!==LT.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),n;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(n){throw this._p2pChannel.reportSubscribeEvent(!1,null==n?void 0:n.code,e,t),n}SR.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{SR.warning("[".concat(this._clientId,"] auto set fallback failed"),e)}));const r="audio"===t?e._audioTrack:e._videoTrack;if(!r)throw new GO(LT.UNEXPECTED_ERROR,"can not find remote track in user object");return r}catch(t){throw SR.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{c()}}async massSubscribe(e){if(VT(e,"subscribeList"),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const t=Date.now(),n=new Map,r=await this._subscribeMutex.lock();SR.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)})).join("; ")));const i=(e=[...e]).map((e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n}})),o=await this._p2pChannel.globalLock();try{var a;for(let t=e.length-1;t>=0;t--){const r=e[t],{user:o,mediaType:a}=r;if(DT(a,"mediaType",["audio","video"]),!o){const e=new GO(LT.INVALID_PARAMS,"user property does not exist in subscribeList item");throw SR.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),e}const s=this._users.find((e=>e===o));if(!s){const n=new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");SR.error("[".concat(this._clientId,"] can not massSubscribe ").concat(o.uid,", this user is not in the channel")),i[t].error=n,e.splice(t,1);continue}if("audio"===a&&(!o.hasAudio||void 0===o._audioSSRC)||"video"===a&&(!o.hasVideo||void 0===o._videoSSRC)){const n=new GO(LT.REMOTE_USER_IS_NOT_PUBLISHED);SR.error("[".concat(this._clientId,"] can not subscribe ").concat(o.uid," with mediaType ").concat(a,", remote user is not published")),i[t].error=n,e.splice(t,1);continue}const c=sI.Video|sI.LwoVideo,l=n.get(o);if(l){if("video"===a?l&c:l&sI.Audio){e.splice(t,1),SR.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(o.uid,", mediaType:").concat(a," twice"));continue}n.set(o,l|("video"===a?c:sI.Audio))}else n.set(o,"video"===a?c:sI.Audio)}for(let t=e.length-1;t>=0;t--){const r=e[t],{user:i,mediaType:o}=r,a=sI.Video|sI.LwoVideo;if(this._p2pChannel.hasRemoteMedia(i,o)){await this._p2pChannel.unmuteRemoteNoLock(i,o);const r=n.get(i);n.set(i,"video"===o?r^a:r^sI.Audio),e.splice(t,1)}}this.store.massSubscribe(e.map((e=>({userId:e.user.uid,type:e.mediaType}))),t);let r=Ji(a=Array.from(n.entries())).call(a,((e,t)=>{let[n,r]=t;if(0===r)return e;const i={stream_id:n.uid,stream_type:r};return r&sI.Audio&&(i.audio_ssrc=n._audioSSRC),r&sI.Video&&(i.video_ssrc=n._videoSSRC),e.push(i),e}),[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map((e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n,ssrcId:n===mI.VIDEO?t._videoSSRC:t._audioSSRC,rtxSsrcId:n===mI.VIDEO?t._rtxSsrcId:void 0}})));const n=new Map;if(r=r.filter((e=>e.video_ssrc&&!this._p2pChannel.isPreSubScribe(e.video_ssrc)||e.audio_ssrc&&!this._p2pChannel.isPreSubScribe(e.audio_ssrc)||!e.video_ssrc&&!e.audio_ssrc)),r.length>0){const e=await this._gateway.subscribeAll(r,!0);((null==e?void 0:e.users)||[]).forEach((e=>{let{stream_id:t,video_error_code:r,audio_error_code:i,error_code:o}=e;(r||i||o)&&n.set(t,{video_error_code:r,audio_error_code:i,error_code:o})}))}if(Array.from(n.entries()).length>0){const e=[];Array.from(n.entries()).forEach((t=>{let[n,r]=t;const i=this.remoteUsers.find((e=>e.uid===n));if(i){let t;r.error_code||r.video_error_code&&r.audio_error_code?t=void 0:r.video_error_code?t=mI.VIDEO:r.audio_error_code&&(t=mI.AUDIO),e.push({user:i,mediaType:t})}})),e.length>0&&await this._p2pChannel.massUnsubscribeNoLock(e)}for(const e of i){const t=n.get(e.user.uid);if(t){const n=t.error_code||"audio"===e.mediaType&&t.audio_error_code||"video"===e.mediaType&&t.video_error_code;if(n){const t=MI(n);SR.error("user:".concat(e.user.uid," mediaType:").concat(e.mediaType," has massSubscribe error ").concat(t.desc)),e.error=new GO(LT.SUBSCRIBE_FAILED,"code ".concat(n,": ").concat(t.desc))}}e.error||("video"===e.mediaType?e.track=e.user.videoTrack:e.track=e.user.audioTrack)}return this.store.massSubscribe(i.filter((e=>!e.error)).map((e=>({userId:e.user.uid,type:e.mediaType}))),void 0,Date.now()),i.forEach((e=>{var n;LR.subscribe(this.store.sessionId,{succ:!!e.error,ec:(null===(n=e.error)||void 0===n?void 0:n.code)||null,video:e.mediaType===mI.VIDEO,audio:e.mediaType===mI.AUDIO,peerid:e.user.uid,subscribeRequestid:e.mediaType===mI.VIDEO?e.user._videoSSRC:e.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t),preSsrc:this._p2pChannel.isPreSubScribe(e.user._videoSSRC)},!0)})),SR.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)})).join("; "))),i}catch(t){throw await this._p2pChannel.massUnsubscribeNoLock(e),t}}finally{o(),r()}}async unsubscribe(e,t,n){if(!(e instanceof pj)){const t=this.remoteUsers.find((t=>t.uid===e));if(!t)throw new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");e=t}if(t||this.store.useP2P){if("datachannel"===t)return this._unsubscribeDataChannel(e,n)}else await this._unsubscribeDataChannel(e,n);if(t&&DT(t,"mediaType",["audio","video"]),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const r=this._users.find((t=>t===e));if(!r){const t=new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");throw SR.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}SR.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const i=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof xj)await this._p2pChannel.unsubscribe(e,t);else{const n=await this._p2pChannel.unsubscribe(e,t);n&&await this._gateway.unsubscribe(n,e.uid),t&&"audio"!==t||(e._audio_pre_subscribed=!1),t&&"video"!==t||(e._video_pre_subscribed=!1),e._is_pre_created&&fC(this._users,e),SR.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(t){if(t.code===LT.DISCONNECT_P2P)return void SR.warning("disconnecting p2p, abort unsubscribe request.");throw SR.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}finally{i()}}async _unsubscribeDataChannel(e,t){if(t&&MT(t,"id",0,65535,!0),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");const n=this._users.find((t=>t===e));if(!n){const t=new GO(LT.INVALID_REMOTE_USER,"user is not in the channel");throw SR.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}let r;if("number"==typeof t){const n=e._dataChannels.find((e=>e.id===t));n&&(r=[n])}else r=e._dataChannels;if(void 0===r){const n=new GO(LT.REMOTE_USER_IS_NOT_PUBLISHED);throw SR.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),n}SR.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(r.map((e=>e.id))));try{const t=await this._p2pChannel.unsubscribeDataChannel(e,r);t&&await this._gateway.unsubscribeDataChannel(t,e.uid),SR.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(t))}catch(t){if(t.code===LT.DISCONNECT_P2P)return void SR.warning("disconnecting p2p, abort unsubscribe request.");throw SR.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}}async massUnsubscribe(e){if(VT(e,"unsubscribeList"),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");SR.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")})).join())),e=[...e];const t=new Map;for(let n=e.length-1;n>=0;n--){const{user:r,mediaType:i}=e[n];if(!r){const e=new GO(LT.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw SR.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),e}DT(i,"mediaType",["video","audio",void 0]);const o=this._users.find((e=>e===r));if(!o){SR.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),e.splice(n,1);continue}const a=sI.Video|sI.LwoVideo;if(t.has(r)){const o=t.get(r);let s;switch(i){case"video":s=o&a;break;case"audio":s=o&sI.Audio;break;default:s=o&(sI.Audio|a)}if(s){SR.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(r.uid,",mediaType:").concat(i," twice.")),e.splice(n,1);continue}i?"audio"===i?t.set(r,o|sI.Audio):"video"===i&&t.set(r,o|a):t.set(r,o|sI.Audio|a)}else i?"audio"===i?t.set(r,sI.Audio):"video"===i&&t.set(r,a):t.set(r,sI.Audio|a)}try{const t=await this._p2pChannel.massUnsubscribe(e);t&&await this._gateway.massUnsubscribe(t),SR.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")})).join()))}catch(e){if(e.code===LT.DISCONNECT_P2P)return void SR.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw SR.error("[".concat(this._clientId,"] massUnsubscribe error"),e.toString()),e}}async setLowStreamParameter(e){!function(e){if(!e)throw new NT(LT.INVALID_PARAMS);BT(e.width)||UT(e.width,"streamParameter.width"),BT(e.height)||UT(e.height,"streamParameter.height"),BT(e.framerate)||UT(e.framerate,"streamParameter.framerate"),BT(e.bitrate)||MT(e.bitrate,"streamParameter.bitrate")}(e),(!e.width&&e.height||e.width&&!e.height)&&SR.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),SR.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,_I.LocalVideoLowTrack)}async enableDualStream(){if(!nL().supportDualStream)throw LR.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new GO(LT.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new GO(LT.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw LR.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,LR.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),SR.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(_I.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw LR.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,LR.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),SR.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(e){DT(e,"role",["audience","host"])}(e),t&&iC(t),"rtc"===this.mode||"p2p"===this.mode)throw SR.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new GO(LT.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&"host"===e)throw new GO(LT.INVALID_OPERATION,"host mode can not set audience latency level");if("audience"===e&&this._p2pChannel.hasLocalMedia())throw new GO(LT.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(e,t),this._config.role=e,SR.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))}getRemoteInboundOffset(){var e;const t=null===(e=this._p2pChannel.getStats())||void 0===e?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const n=t.timestamp-Date.now();return Math.abs(n)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?n:0}getNtpWallTimeInMs(){return"visible"===document.visibilityState&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(jT(e,"proxyServer"),!t){if("DISCONNECTED"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new GO(LT.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,LR.setProxyServer(this._proxyServer),SR.setProxyServer(this._proxyServer),SR.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if("DISCONNECTED"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new GO(LT.INVALID_OPERATION,"You have already set the proxy")}if(nC(e))return this._turnServer={servers:e,mode:"original-manual"},void SR.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map((e=>e.urls)).join(","),"."));e.forEach((e=>rC(e))),this._turnServer={servers:e,mode:"manual"},SR.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if("DISCONNECTED"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"you should set license before join channel");if(jT(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new GO(LT.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,SR.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if("DISCONNECTED"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint)throw new GO(LT.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let n;switch(void 0===e&&(e=3),e){case 1:case 2:throw new GO(LT.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:n="proxy3";break;case 4:n="proxy4";break;case 5:n="proxy5";break;default:throw new GO(LT.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=n,this.store.cloudProxyServerMode=n,SR.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if("DISCONNECTED"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"Stop proxy server after leave channel");LR.setProxyServer(),SR.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",SR.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new GO(LT.INVALID_PARAMS,"accessPoints is required.");VT(e.accessPoints.serverList,"accessPoints.serverList"),jT(e.accessPoints.domain,"accessPoints.domain");const t=(e,t)=>{MT(e,t,0,65535,!0)};let n=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),n=e.accessPoints.port),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new GO(LT.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");aR("CLOSE_AFB_FOR_LOCAL_AP")&&(oR("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),oR("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const r=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,i=e.accessPoints.domain,o=e.accessPoints.serverList.map((e=>r.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(i):e)),a=o.map((e=>"".concat(e,":").concat(n)));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,oR("WEBCS_DOMAIN",a),oR("WEBCS_DOMAIN_BACKUP_LIST",a),oR("GATEWAY_DOMAINS",[i]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(VT(e.report.hostname,"report.hostname"),oR("EVENT_REPORT_DOMAIN",e.report.hostname[0]),oR("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(oR("EVENT_REPORT_DOMAIN",o[0]),oR("EVENT_REPORT_BACKUP_DOMAIN",o[1]||o[0]));let s=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),s=e.report.port),oR("STATS_COLLECTOR_PORT",s),e.report?oR("ENABLE_EVENT_REPORT",!0):oR("ENABLE_EVENT_REPORT",!1);let c="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(VT(e.log.hostname,"log.hostname"),c=e.log.hostname[0]):c=o[0];let l=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),l=e.log.port),oR("LOG_UPLOAD_SERVER","".concat(c,":").concat(l));let d=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(VT(e.cds.hostname,"cds.hostname"),d=e.cds.hostname):d=o;let u=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),u=e.cds.port),oR("CDS_AP",d.map((e=>"".concat(e,":").concat(u)))),e.cds?oR("ENABLE_CONFIG_DISTRIBUTE",!0):oR("ENABLE_CONFIG_DISTRIBUTE",!1),SR.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(VT(e,"serverList"),jT(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new GO(LT.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map((e=>n.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(t):e)),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,oR("WEBCS_DOMAIN",e),oR("WEBCS_DOMAIN_BACKUP_LIST",e),oR("GATEWAY_DOMAINS",[t]),oR("EVENT_REPORT_DOMAIN",e[0]),oR("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),oR("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),SR.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(DT(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(e){throw SR.error("[".concat(this._clientId,"] set default remote video stream type error"),e.toString()),e}else SR.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){DT(t,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout((()=>{const t=this._users.find((t=>t.uid===e));t&&t.videoTrack&&t.videoTrack.updateMediaStreamTrackResolution()}),2e3)}catch(e){throw SR.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),e}SR.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){DT(t,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw SR.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),e}SR.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,n,r){!function(e){DT(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),jT(t,"secret");const i=["aes-128-gcm2","aes-256-gcm2"];if(Li(i).call(i,e)){if(!n||!(n instanceof Uint8Array&&32===n.length))throw new GO(LT.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(n)throw new GO(LT.INVALID_PARAMS,"current encrypt mode does not need salt");if(r){if(PT(r,"encryptDataStream"),!Li(i).call(i,e))throw new GO(LT.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||SR.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,n&&(this._encryptionSalt=EC(n))}async renewToken(e){if(jT(e,"token",1,2047),!this._key||!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"renewToken should not be called before user join");const t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const n=await this._renewTokenMutex.lock();try{if(aR("USE_NEW_TOKEN")){SR.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const t=await YM(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||HC);SR.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:t})}else SR.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});SR.debug("[".concat(this._clientId,"] renewToken success"))}catch(e){throw this._key=t,this._joinInfo.token=t,SR.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),e}finally{n()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?SR.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval((()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(oC.VOLUME_INDICATOR,e)}),aR("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if("h264"!==this.codec)throw new GO(LT.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new GO(LT.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new GO(LT.LIVE_STREAMING_TASK_CONFLICT);const n=t?WO.TRANSCODE:WO.RAW;return this._createLiveStreamingClient(n).startLiveStreamingTask(e,n)}setLiveTranscoding(e){return this._createLiveStreamingClient(WO.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter((t=>t&&t.hasUrl(e)));if(!t.length)throw new GO(LT.INVALID_PARAMS,"can not find live streaming url to stop");await Ih.all(t.map((t=>t&&t.stopLiveStreamingTask(e))))}async startChannelMediaRelay(e){Uj(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}async updateChannelMediaRelay(e){Uj(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}async stopChannelMediaRelay(){const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}async sendStreamMessage(e){var t;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"can not send data stream, not joined");if(("string"==typeof e||e instanceof Uint8Array)&&(e={payload:e}),"string"==typeof e.payload){const t=new TextEncoder;e.payload=t.encode(e.payload)}let r=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Li(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)&&(r=!0,e.payload=await async function(e,t,n){var r;const i=Ji(r=Array.from(n)).call(r,((e,t)=>e+t),0),o={serverTs:0,seq:pR++,length:n.length,checkSum:i},a=new Uint8Array(MC(i,2)),s=new ArrayBuffer(uR),c=new DataView(s);c.setUint32(0,o.serverTs),c.setUint16(4,o.seq),c.setUint16(6,o.length),c.setUint16(8,o.checkSum);const l=16-n.length%16;n=TC(n,new Uint8Array(l));const d=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:e,tagLength:128,additionalData:a},t,n);return TC(new Uint8Array(s),new Uint8Array(d))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new GO(LT.INVALID_PARAMS,r?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(UO.DATA_STREAM,{payload:EC(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-OV},!n)}sendMetadata(e){if(!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new GO(LT.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(UO.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:EC(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(CR),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"can not send custom report, not joined");await LR.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){DT(t.spatialLayer,"spatialLayer",[0,1,2,3]),DT(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw SR.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),e}}async setRTMConfig(e){const{apRTM:t=!1,rtmFlag:n}=e;if(PT(t,"apRTM"),MT(n,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=n,SR.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState)&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=n,this._gateway.setRTM2Flag(n)}_reset(){if(SR.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=qS.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&ZV(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach((e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach((e=>e._close())),e._dataChannels.length=0)})),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new FC("client-publish"),this._subscribeMutex=new FC("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch(e){}if(this._moderation)try{this.setImageModeration(!1)}catch(e){}}_startSession(e,t){var n;const r=e||kC();e?SR.debug("[".concat(this._clientId,"] new Session ").concat(r)):SR.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(r));const i=e?"":this._sessionId||"";this._sessionId=r,this.store.sessionId=r;const o={lts:(new Date).getTime(),mode:this.mode,buildFormat:2,stringUid:(null==t?void 0:t.stringUid)||(null===(n=this._joinInfo)||void 0===n?void 0:n.stringUid),channelProfile:"live"===this.mode?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:i,clientRole:"audience"===this.role?2:1};LR.sessionInit(this._sessionId,SF({cname:t.channel,appid:t.appId},o)),this._joinInfo&&(this._joinInfo.sid=r),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=r)}async _publishHighStream(e){if(!this._joinInfo||void 0===this._uid)throw new GO(LT.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&aR("FORCE_TURN")&&!aR("TURN_ENABLE_TCP")&&!aR("TURN_ENABLE_UDP"))throw new GO(LT.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");SR.debug("[".concat(this._clientId,"] publish high stream"));try{const n=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof xj){const t=(await n.next()).value;if(t){try{await this._gateway.sendExtensionMessage(AI.PUBLISH,t,!0)}catch(e){throw n.throw(e),e}await n.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const r=(await n.next()).value;if(r){var t;let i;try{i=await this._gateway.publish(this._uid,r,!0)}catch(e){if(e.code!==LT.DISCONNECT_P2P)throw n.throw(e),e}await n.next((null===(t=i)||void 0===t?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const t of e)t instanceof lD&&t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig),!t.muted&&t.enabled||await this._p2pChannel.muteLocalTrack(t)}}catch(t){if(this._p2pChannel.reportPublishEvent(!1,null==t?void 0:t.code,e),(null==t?void 0:t.code)===LT.WS_ABORT)return;throw t}}async _publishLowStream(){if(!this._joinInfo||void 0===this._uid)throw new GO(LT.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));SR.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const e=await this._p2pChannel.publishLowStream(this._lowStreamParameter),n=(await e.next()).value;if(n){var t;let r;try{r=await this._gateway.publish(this._uid,n,!0)}catch(t){if(t.code!==LT.DISCONNECT_P2P)throw e.throw(t),t}e.next((null===(t=r)||void 0===t?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(e){if(this._p2pChannel.reportPublishEvent(!1,null==e?void 0:e.code,void 0,!0),(null==e?void 0:e.code)===LT.WS_ABORT)return;throw e}}_createLiveStreamingClient(e){const t=()=>{if(!this._joinInfo||!this._appId)return new GO(LT.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const e=(t={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},SV("LiveStreaming").create(t));var t;return e.onLiveStreamError=(e,t)=>{LR.reportApiInvoke(this._sessionId,{name:ZT.ON_LIVE_STREAM_ERROR,options:[e,t],tag:QT.TRACER}).onSuccess(),this.safeEmit(oC.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{LR.reportApiInvoke(this._sessionId,{name:ZT.ON_LIVE_STREAM_WARNING,options:[e,t],tag:QT.TRACER}).onSuccess(),this.safeEmit(oC.LIVE_STREAMING_WARNING,e,t)},e.on(ZO.REQUEST_WORKER_MANAGER_LIST,((e,t,n)=>{if(!this._joinInfo)return n(new GO(LT.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(e,t,n,r){const i=aR("UAP_AP").slice(0,aR("AJAX_REQUEST_CONCURRENT")).map((e=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")));return await function(e,t,n,r,i){xM+=1;const o={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:xM,requestId:xM,version:$C,cname:n.cname},a={service_name:t,json_body:JSON.stringify(o)};let s,c,l=e[0];return WC((async()=>{s=Date.now();const e=await yM(l,{data:a,cancelToken:r,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-s,0!==e.code){const t=new GO(LT.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw SR.error(t.toString()),t}const n=JSON.parse(e.json_body);if(200!==n.code){const e=new GO(LT.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(n.code,", reason: ").concat(n.reason),{code:n.code,responseTime:c});throw SR.error(e.toString()),e}if(!n.servers||0===n.servers.length){const e=new GO(LT.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:n.code,responseTime:c});throw SR.error(e.toString()),e}const i=function(e,t){return{addressList:e.servers.map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(aR("WORKER_DOMAIN"),":").concat(e.wss,"?serviceName=").concat(encodeURIComponent(t)))),workerToken:e.workerToken,vid:e.vid}}(n,t);return aR("LIVE_STREAMING_ADDRESS")&&(i.addressList=aR("LIVE_STREAMING_ADDRESS")instanceof Array?aR("LIVE_STREAMING_ADDRESS"):[aR("LIVE_STREAMING_ADDRESS")]),kM(kM({},i),{},{responseTime:c})}),((r,i)=>(LR.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(r.addressList),firstSuccess:0===i,responseTime:c,serverIp:e[i%e.length]}),!1)),((r,i)=>(LR.apworkerEvent(n.sid,{success:!1,sc:r.data&&r.data.code||200,serviceName:t,responseTime:c,serverIp:e[i%e.length]}),!!(r.code!==LT.OPERATION_ABORTED&&r.code!==LT.UNEXPECTED_RESPONSE||r.data&&r.data.retry)&&(l=e[(i+1)%e.length],!0))),i)}(i,e,t,n,r)})(e,this._joinInfo,this._axiosCancelSource.token,HC).then(t).catch(n)})),e};return e===WO.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new GO(LT.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:n}=this.getLocalVideoStats(),r=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:n}},SV("ChannelMediaRelay").create(e));r.on("state",(e=>{e===nI.RELAY_STATE_FAILURE&&r&&r.dispose(),this.safeEmit(oC.CHANNEL_MEDIA_RELAY_STATE,e)})),r.on("event",(e=>{this.safeEmit(oC.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._channelMediaRelayClient=r,this._statsCollector.onStatsChanged=(e,t)=>{var n;"resolution"===e&&(null===(n=this._channelMediaRelayClient)||void 0===n||n.setVideoProfile(t))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:n,deleted:r}=e,i=[];if(t){const e=[];this._users.forEach((t=>{t._dataChannels.forEach((r=>{n.every((e=>e.uid!==t._uintid||e.stream_id!==r.id))&&e.push({uid:t._uintid,stream_id:r.id,ordered:r.ordered,max_retrans_times:r.maxRetransmits,metadata:r.metadata})}))})),e.length>0&&this._handleUpdateDataChannel({added:[],deleted:e})}Array.isArray(n)&&n.length>0&&n.forEach((e=>{const{uid:n,stream_id:r,ordered:o,max_retrans_times:a,metadata:s}=e,c=this._users.find((e=>e._uintid===n));if(c){if(SR.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(n)),Li(i).call(i,c)||i.push(c),c._uintid||(c._uintid=n),-1===c._dataChannels.findIndex((t=>t.id===e.stream_id))){const e={id:r,ordered:!!o,maxRetransmits:a,metadata:s},n=function(e){return TV(e,!0)}(e);c._dataChannels.push(n),SR.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published datachannel")),t||this.safeEmit(oC.USER_PUBLISHED,c,"datachannel",e)}this._p2pChannel.hasPendingRemoteDataChannel(c,e.stream_id)&&(SR.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(c.uid," after reconnect.")),this._subscribeDataChannel(c,e.stream_id).catch((e=>{SR.error("[".concat(this._clientId,"] resubscribe datachannel error"),e.toString())})))}else SR.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"))})),t&&(this.safeEmit(oC.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(r)&&r.length>0&&r.forEach((e=>{const{uid:t,stream_id:n}=e,r=this._users.find((e=>e._uintid===t));if(!r)return void SR.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const i=r._dataChannels.find((t=>t.id===e.stream_id));i&&(SR.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(t)),this._p2pChannel.unsubscribeDataChannel(r,[i]).then((e=>{if(r._dataChannels=r._dataChannels.filter((e=>e!==i)),e)return this._gateway.unsubscribeDataChannel(e,r.uid)})),SR.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished datachannel ,id:").concat(i.id)),this.safeEmit(oC.USER_UNPUBLISHED,r,"datachannel",i._config))}))}_handleRemoveDataChannels(e){const t=this._users.find((t=>t.uid===e.uid));if(t){if(void 0!==t._dataChannels&&t._dataChannels.length>0){SR.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const n=()=>{SR.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach((e=>{this.safeEmit(oC.USER_UNPUBLISHED,t,"datachannel",e._config)}))};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then((e=>{if(e)return this._gateway.unsubscribeDataChannel(e,t.uid)})),n()}}else SR.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(oI.DISCONNECT_P2P,(async()=>{await this._p2pChannel.disconnectForReconnect()})),this._gateway.on(oI.CONNECTION_STATE_CHANGE,((e,t,n)=>{var r;if(n===tC.FALLBACK)return;const i=()=>{this.safeEmit(oC.CONNECTION_STATE_CHANGE,e,t,n)};if(LR.reportApiInvoke(this._sessionId||(null===(r=this._gateway.joinInfo)||void 0===r?void 0:r.sid)||null,{name:ZT.CONNECTION_STATE_CHANGE,options:[e,t,n],tag:QT.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:n})),SR.info("[".concat(this._clientId,"] connection state change: ").concat(t," -> ").concat(e)),"DISCONNECTED"===e)return this._reset(),void i();if("RECONNECTING"===e)this._users.forEach((e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_audio_stream_added_state_=!1,e._trust_video_stream_added_state_=!1,e._is_pre_created||(e._audio_pre_subscribed||(e._audioSSRC=void 0,e._audioOrtc=void 0),e._video_pre_subscribed||(e._videoSSRC=void 0,e._videoOrtc=void 0,e._rtxSsrcId=void 0),e._cname=void 0)})),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var o;this._streamFallbackTypeCacheMap.forEach(((e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch((e=>{SR.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e)}))})),this._remoteStreamTypeCacheMap.forEach(((e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch((e=>{SR.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e)}))})),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(o=this._joinInfo)||void 0===o?void 0:o.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then((()=>{SR.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))})).catch((e=>{SR.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(e))})),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter((e=>!e._trust_in_room_)).forEach((e=>{SR.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(e.uid)),this._handleUserOffline({uid:e.uid})})))}),3e3),this._streamRemovedTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach((e=>{e._trust_audio_mute_state_||(SR.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,mI.AUDIO,!1)),e._trust_video_mute_state_||(SR.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,mI.VIDEO,!1)),e._trust_audio_enabled_state_||(SR.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),e._trust_video_enabled_state_||(SR.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_video_stream_added_state_||(SR.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(e.uid)),this._handleResetAddStream(e,"video")),e._trust_audio_stream_added_state_||(SR.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(e.uid)),this._handleResetAddStream(e,"audio")),e._video_added_||e._audio_added_||(SR.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))})))}),1e3))}i()})),this._gateway.on(oI.REQUEST_NEW_GATEWAY_LIST,(async(e,t)=>{if(!this._joinInfo)return t(new GO(LT.UNEXPECTED_ERROR,"can not recover, no join info"));try{let t;const n=await YV(SF(SF({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));n?(t=n.ap,QV(n),this._joinInfo.preload=!0):(t=await GM(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||HC,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res,this._joinInfo.gatewayAddrs=t.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=t.gatewayInfo.uni_lbs_ip);const r=[];t.gatewayInfo.gatewayAddrs.forEach((e=>{let{address:t}=e;const[n,i]=t.split(":");this._joinInfo&&this._joinInfo.proxyServer?r.push({proxy:this._joinInfo.proxyServer,host:n,port:i}):r.push({host:n,port:i})})),e(r)}catch(e){t(e)}})),this._gateway.on(oI.NETWORK_QUALITY,(e=>{"normal"===this._networkQualitySensitivity&&this.safeEmit(oC.NETWORK_QUALITY,e)})),this._gateway.on(oI.STREAM_TYPE_CHANGE,((e,t)=>{this.safeEmit(oC.STREAM_TYPE_CHANGED,e,t),LR.reportApiInvoke(this._sessionId,{name:ZT.STREAM_TYPE_CHANGE,options:[e,t],tag:QT.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))})),this._gateway.on(oI.IS_P2P_DISCONNECTED,(e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)})),this._gateway.on(oI.REQUEST_P2P_CONNECTION_PARAMS,(async(e,t,n)=>{try{let n=await this._p2pChannel.getEstablishParams();aR("ENABLE_PREALLOC_PC")&&n||(n=await this._p2pChannel.startP2PConnection(e)),t(n)}catch(e){n(e)}})),this._gateway.on(oI.JOIN_RESPONSE,((e,t)=>{if(this.store.useP2P)return;const n=KD(e.ortc,t,e.attributes.userAttributes.preSubSsrcs);this._p2pChannel.connect(n)})),this._gateway.on(oI.PRE_CONNECT_PC,(async e=>{const{candidates:t,fingerprint:n}=e;if(this._joinInfo&&t.length>0&&!this._p2pChannel.isPlanB){var r;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:e,cid:i}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(i,"_").concat(e),icePwd:"".concat(i,"_").concat(e)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:null!==(r=aR("FINGERPRINT"))&&void 0!==r?r:n}]},candidates:t,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}}))}_handleGatewaySignalEvents(){this._gateway.signal.on(VO.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(VO.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(VO.ON_ADD_AUDIO_STREAM,(e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc))),this._gateway.signal.on(VO.ON_ADD_VIDEO_STREAM,(e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId))),this._gateway.signal.on(VO.ON_REMOTE_DATASTREAM_UPDATE,(e=>{this._handleUpdateDataChannel(e)})),this._gateway.signal.on(VO.ON_REMOTE_FULL_DATASTREAM_INFO,(e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)})),this._gateway.signal.on(VO.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(VO.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(VO.MUTE_AUDIO,(e=>this._handleMuteStream(e.uid,mI.AUDIO,!0))),this._gateway.signal.on(VO.UNMUTE_AUDIO,(e=>this._handleMuteStream(e.uid,mI.AUDIO,!1))),this._gateway.signal.on(VO.MUTE_VIDEO,(e=>this._handleMuteStream(e.uid,mI.VIDEO,!0))),this._gateway.signal.on(VO.UNMUTE_VIDEO,(e=>this._handleMuteStream(e.uid,mI.VIDEO,!1))),this._gateway.signal.on(VO.RECEIVE_METADATA,(e=>{const t=bC(e.metadata);this.safeEmit(oC.RECEIVE_METADATA,e.uid,t)})),this._gateway.signal.on(VO.ON_DATA_STREAM,(async e=>{var t;if(!e)return;let n=bC(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Li(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)){if(e.payload.length<uR)throw new GO(LT.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(uR));const t=await async function(e,t,n){const r=n.subarray(0,uR),i=r.slice(8,uR),o=(i[0]<<8)+i[1],a=(r[6]<<8)+r[7],s=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:e,tagLength:128,additionalData:new Uint8Array(MC(o,2))},t,n.subarray(uR));return new Uint8Array(s).subarray(0,a)}(this._encryptDataStreamIv,this._encryptDataStreamKey,n);n=t}let r=0;if(e.ordered||e.syncWithAudio){const t=this._p2pChannel.getStats(),n=this.remoteUsers.find((t=>t.uid===e.uid)),i=null==t?void 0:t.audioRecv.find((e=>e.ssrc===(null==n?void 0:n._audioSSRC)));r=null==i?void 0:i.jitterBufferMs}null==r&&(r=0),NV(SF(SF({},e),{},{payload:n}),r,{id:this._clientId,onStreamMessage:"function"==typeof this.onStreamMessage?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})})),this._gateway.signal.on(VO.ON_CRYPT_ERROR,(()=>{wC((()=>{SR.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(oC.CRYPT_ERROR)}),this._sessionId)})),this._gateway.signal.on(VO.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(VO.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{SR.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,tC.TOKEN_EXPIRE),this.safeEmit(oC.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()})),this._gateway.signal.on(VO.ON_STREAM_FALLBACK_UPDATE,(e=>{SR.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(oC.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")})),this._gateway.signal.on(VO.ON_PUBLISH_STREAM,(e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),SR.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))})),this._gateway.signal.on(VO.ENABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)})),this._gateway.signal.on(VO.DISABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)})),this._gateway.signal.on(MO.REQUEST_TIMEOUT,((e,t)=>{if(this._joinInfo)switch(e){case UO.PUBLISH:{if(!t)return;const e=t.ortc;if(e){var n,r;const i=e.some((e=>{let{stream_type:t}=e;return t===iI.Audio})),o=e.some((e=>{let{stream_type:t}=e;return t!==iI.Audio})),a=e.some((e=>{let{stream_type:t}=e;return t===iI.Screen||t===iI.ScreenLow}));"offer"===t.state&&LR.publish(this._joinInfo.sid,{eventElapse:eU.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:LT.TIMEOUT,audio:i,video:o,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:a,audioName:i?null===(n=e.find((e=>{let{stream_type:t}=e;return t===iI.Audio})))||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId.toString():void 0,videoName:o?null===(r=e.find((e=>{let{stream_type:t}=e;return t!==iI.Audio})))||void 0===r||null===(r=r.ssrcs[0])||void 0===r?void 0:r.ssrcId.toString():void 0})}break}case UO.SUBSCRIBE:t&&LR.subscribe(this._joinInfo.sid,{succ:!1,ec:LT.TIMEOUT,audio:t.stream_type===mI.AUDIO,video:t.stream_type===mI.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:eU.measureFromSubscribeStart(this.store.clientId,t.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(t.ssrcId)})}})),this._gateway.signal.on(VO.ON_P2P_OK,(e=>{this.uid,this._uid})),this._gateway.signal.on(VO.ON_PUBLISHED_USER_LIST,(e=>{if(null==e||!e.users)return;aR("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter((e=>!UR(e.string_id||e.stream_id,this.channelName))));const t=[],n=[];for(const r of e.users){let e=this._users.find((e=>e._uintid===r.stream_id));e?e._trust_in_room_=!0:(e=new pj(r.string_id||r.stream_id,r.stream_id),this._users.push(e),0===this.getListeners(oC.PUBLISHED_USER_LIST).length&&(SR.debug("[".concat(this._clientId,"] user online"),r.stream_id),this.safeEmit(oC.USER_JOINED,e)));const i=sI.Audio&r.stream_type,o=(sI.Video|sI.LwoVideo)&r.stream_type,a=0!=(65280&r.stream_type),s=i&&e.hasAudio,c=o&&e.hasVideo;o&&(e._trust_video_stream_added_state_=!0,e._video_added_=!0,e._videoSSRC=r.video_ssrc,e._rtxSsrcId=r.video_rtx),i&&(e._trust_audio_stream_added_state_=!0,e._audio_added_=!0,e._audioSSRC=r.audio_ssrc),i&&!s&&0===this.getListeners(oC.PUBLISHED_USER_LIST).length&&(SR.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published audio")),this.safeEmit(oC.USER_PUBLISHED,e,"audio")),o&&!c&&0===this.getListeners(oC.PUBLISHED_USER_LIST).length&&(SR.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published video")),this.safeEmit(oC.USER_PUBLISHED,e,"video")),(i&&!s||o&&!c||a)&&t.push(e),o&&this._p2pChannel.hasPendingRemoteMedia(e,"video")&&n.push({user:e,mediaType:"video"}),i&&this._p2pChannel.hasPendingRemoteMedia(e,"audio")&&n.push({user:e,mediaType:"audio"})}n.length>0&&(SR.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(n.map((e=>"user: ".concat(e.user.uid,", mediaType: ").concat(e.mediaType))).join("; ")," ")),this.massSubscribe(n).catch((e=>{SR.error("[".concat(this._clientId,"] mass resubscribe error"),e.toString())}))),this.getListeners(oC.PUBLISHED_USER_LIST).length>0?aR("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(SR.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map((e=>e.uid)).join(", "))),this.safeEmit(oC.PUBLISHED_USER_LIST,t)):SR.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map((e=>e.uid)).join(", ")))})),this._gateway.signal.on(VO.ON_RTP_CAPABILITY_CHANGE,(e=>{const{video_codec:t}=e;this._p2pChannel instanceof yV&&this._p2pChannel.updateRemoteRTPCapabilities(t.map((e=>e.toLowerCase())).filter((e=>{var t;return Li(t=Object.keys(dR)).call(t,e)})))}))}_handleP2PEvents(){this._gateway.signal.on(VO.ON_USER_OFFLINE,(()=>{this._p2pChannel.disconnectForReconnect()})),this._gateway.signal.on(AI.PUBLISH,((e,t,n)=>{const{uid:r}=e;e.forEach((e=>{const{kind:i,ssrcs:o,mid:a,isMuted:s}=e;this._handleP2PAddAudioOrVideoStream(i,r,o[0].ssrcId,a);const c=this._users.find((e=>e.uid===r));return c&&this._p2pChannel instanceof xj?this._p2pChannel.mockSubscribe(c,i,o[0].ssrcId,a).then((()=>{t()})).catch(n):t(),this._handleMuteStream(r,i,!!s)}))})),this._gateway.signal.on(AI.CALL,(async(e,t,n)=>{if(this._p2pChannel instanceof xj)try{var r;t(await this._p2pChannel.startP2P({turnServer:null===(r=this._joinInfo)||void 0===r?void 0:r.turnServer},e))}catch(e){n(e)}})),this._gateway.signal.on(MO.P2P_CONNECTION,(async e=>{this._p2pChannel instanceof xj&&await this._p2pChannel.p2pConnect(e)})),this._gateway.signal.on(AI.UNPUBLISH,(async(e,t,n)=>{if(this._p2pChannel instanceof xj){const{unpubMsg:r,uid:i}=e,o=this._users.find((e=>e.uid===i));if(!o)return SR.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(i)),void t();try{r.forEach((async e=>{let{stream_type:t}=e;const n=t===iI.Audio?mI.AUDIO:mI.VIDEO;await this._p2pChannel.unsubscribe(o,n),this._handleMuteStream(i,n,!0)})),t()}catch(e){n(e)}}})),this._gateway.signal.on(AI.CONTROL,(async(e,t)=>{const{action:n}=e;switch(n){case xI.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,mI.VIDEO,!0);break;case xI.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,mI.AUDIO,!0);break;case xI.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,mI.VIDEO,!1);break;case xI.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,mI.AUDIO,!1)}})),this._gateway.signal.on(AI.RESTART_ICE,(async(e,t,n)=>{if(this._p2pChannel instanceof xj)try{const{direction:n,iceParameter:r}=e;n!==BO.SEND_ONLY||r?t(await this._p2pChannel.restartICE(n,r)):(this._p2pChannel.handleDisconnect(n),t())}catch(e){n(e)}})),this._gateway.signal.on(AI.CANDIDATE,(e=>{if(this._p2pChannel instanceof xj){const{candidate:t,direction:n}=e;this._p2pChannel.addRemoteCandidate(t,n)}})),this._p2pChannel.on(wI.RequestP2PRestartICE,(async(e,t,n)=>{try{const{direction:n}=e;t(await this._gateway.sendExtensionMessage(AI.RESTART_ICE,e,n===BO.SEND_ONLY))}catch(e){n(e)}})),this._p2pChannel.on(wI.LocalCandidate,(e=>{this._gateway.sendExtensionMessage(AI.CANDIDATE,JSON.stringify(e),!0)})),this._p2pChannel.on(wI.RequestP2PMuteLocal,(async(e,t,n)=>{try{await this._gateway.sendExtensionMessage(AI.CONTROL,e,!0),t()}catch(e){n(e)}})),this._p2pChannel.on(wI.RequestP2PUnmuteRemote,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===LT.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(wI.RequestP2PMuteRemote,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===LT.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(wI.StateChange,((e,t)=>{t===yI.Connected&&this._p2pChannel.republish()}))}_handleP2PChannelEvents(){this._p2pChannel.on(wI.RequestMuteLocal,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===LT.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(wI.RequestUnmuteLocal,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===LT.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(wI.RequestRePublish,((e,t,n)=>{this.publish(e,!1).then(t).catch(n)})),this._p2pChannel.on(wI.RequestRePublishDataChannel,((e,t,n)=>{Ih.all(e.map((async e=>{const t=await this._p2pChannel.publishDataChannel([e]);try{t.forEach((e=>{this._uid&&this._gateway.publishDataChannel(this._uid,e,!0)}))}catch(e){if(e.code!==LT.DISCONNECT_P2P)throw e}}))).then(t).catch(n)})),this._p2pChannel.on(wI.RequestReSubscribe,(async(e,t,n)=>{try{for(const{user:t,kind:n}of e)n===mI.VIDEO?await this.subscribe(t,"video"):await this.subscribe(t,"audio");t()}catch(e){n(e)}})),this._p2pChannel.on(wI.RequestUpload,((e,t)=>{this._gateway.upload(e,t)})),this._p2pChannel.on(wI.RequestUploadStats,(e=>{this._gateway.uploadWRTCStats(e)})),this._p2pChannel.on(wI.MediaReconnectStart,(e=>{this.safeEmit(oC.MEDIA_RECONNECT_START,e)})),this._p2pChannel.on(wI.MediaReconnectEnd,(e=>{this.safeEmit(oC.MEDIA_RECONNECT_END,e)})),this._p2pChannel.on(wI.NeedSignalRTT,(e=>{e(this._gateway.getSignalRTT())})),this._p2pChannel.on(wI.RequestRestartICE,(async e=>{if(this._p2pChannel instanceof xj)return;const t=await this._p2pChannel.restartICE(e),n=await t.next();if(n.done)return;const r=n.value;let i;try{i=await this._gateway.restartICE({iceParameters:r})}catch(e){return void t.throw(e)}const{iceParameters:o}=function(e){const t=e.iceParameters;return{iceParameters:{iceUfrag:t.iceUfrag,icePwd:t.icePwd}}}(i);await t.next({remoteIceParameters:o})})),this._p2pChannel.on(wI.RequestReconnect,(async()=>{this._gateway.reconnect()})),this._p2pChannel.on(wI.RequestReconnectPC,(async()=>{var e;const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=await this._p2pChannel.startP2PConnection({turnServer:null===(e=this._joinInfo)||void 0===e?void 0:e.turnServer}),{gatewayEstablishParams:i,gatewayAddress:o}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:n,rtpCapabilities:r}),a=KD(i,o);await this._p2pChannel.connect(a),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()})),this._p2pChannel.on(wI.RequestUnpublishForReconnectPC,(async(e,t,n)=>{this._joinInfo&&void 0!==this._uid?(await this._gateway.unpublish(e,this._uid),t()):n()})),this._p2pChannel.on(wI.P2PLost,(()=>{this.safeEmit(oC.P2P_LOST,this.store.uid)})),this._p2pChannel.on(wI.UpdateVideoEncoder,(e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)})),this._p2pChannel.on(wI.ConnectionTypeChange,(e=>{this.safeEmit(oC.IS_USING_CLOUD_PROXY,e)})),this._p2pChannel.on(wI.RequestLowStreamParameter,(e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})})),this._p2pChannel.on(wI.QueryClientConnectionState,(e=>{e(this.connectionState)}))}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||"CONNECTED"!==this.connectionState)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const n=(t={config:e},SV("ContentInspect").create(t));this._inspect=n,this.handleVideoInspectEvents(n);const{appId:r,cname:i,sid:o,token:a,uid:s,cid:c,vid:l}=this._joinInfo;await n.init({appId:r,areaCode:"",cname:i,sid:o,token:a,uid:s,cid:c,vid:l?Number(l):0},HC)}catch(e){throw Array.isArray(e)?e[0]:e}var t}handleVideoInspectEvents(e){e.on(SI.CONNECTION_STATE_CHANGE,((t,n)=>{if(this.safeEmit(oC.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,n),n===bI.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.safeEmit(oC.CONTENT_INSPECT_ERROR,new GO(LT.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}})),e.on(SI.INSPECT_RESULT,((e,t)=>{var n;if((null==t?void 0:t.code)===LT.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return SR.debug("Stop inspect content because that has left channel"),null==this||null===(n=this._inspect)||void 0===n||n.close(),void(this._inspect=void 0);this.safeEmit(oC.CONTENT_INSPECT_RESULT,e,t)})),e.on(SI.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}async disableContentInspect(){if(!this._inspect)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(PT(e,"enabled"),e){if(!t)throw new GO(LT.INVALID_PARAMS,"config is required");if(NB(t),!this._joinInfo)throw new GO(LT.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(t);else{const e=(n={config:t},SV("ImageModeration").create(n));this._moderation=e,this.handleImageModerationEvents(e);const{appId:r,cname:i,sid:o,token:a,uid:s,cid:c,vid:l}=this._joinInfo;await e.init({appId:r,areaCode:"",cname:i,sid:o,token:a,uid:s,cid:c,vid:l?Number(l):0},HC)}}catch(e){throw Array.isArray(e)?e[0]:e}}else{var n;if(!this._moderation)throw new GO(LT.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}}handleImageModerationEvents(e){e.on(OI.CONNECTION_STATE_CHANGE,((t,n)=>{if(this.safeEmit(oC.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,n),t===RI.CONNECTED){if("CONNECTED"!==this.connectionState)throw this.setImageModeration(!1),new GO(LT.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}})),e.on(OI.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}setP2PTransport(e){if(function(e){DT(e,"transport",["default","auto","relay","sd-rtn"])}(e),"p2p"!==this.mode)throw new GO(LT.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,SR.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return SR.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){PT(e,"enabled"),oR("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},OO(bF.prototype,"leave",[DB],Object.getOwnPropertyDescriptor(bF.prototype,"leave"),bF.prototype),OO(bF.prototype,"publish",[MB],Object.getOwnPropertyDescriptor(bF.prototype,"publish"),bF.prototype),OO(bF.prototype,"unpublish",[UB],Object.getOwnPropertyDescriptor(bF.prototype,"unpublish"),bF.prototype),OO(bF.prototype,"subscribe",[jB],Object.getOwnPropertyDescriptor(bF.prototype,"subscribe"),bF.prototype),OO(bF.prototype,"presubscribe",[VB],Object.getOwnPropertyDescriptor(bF.prototype,"presubscribe"),bF.prototype),OO(bF.prototype,"massSubscribe",[BB],Object.getOwnPropertyDescriptor(bF.prototype,"massSubscribe"),bF.prototype),OO(bF.prototype,"unsubscribe",[FB],Object.getOwnPropertyDescriptor(bF.prototype,"unsubscribe"),bF.prototype),OO(bF.prototype,"massUnsubscribe",[GB],Object.getOwnPropertyDescriptor(bF.prototype,"massUnsubscribe"),bF.prototype),OO(bF.prototype,"setLowStreamParameter",[HB],Object.getOwnPropertyDescriptor(bF.prototype,"setLowStreamParameter"),bF.prototype),OO(bF.prototype,"enableDualStream",[qB],Object.getOwnPropertyDescriptor(bF.prototype,"enableDualStream"),bF.prototype),OO(bF.prototype,"disableDualStream",[WB],Object.getOwnPropertyDescriptor(bF.prototype,"disableDualStream"),bF.prototype),OO(bF.prototype,"setClientRole",[zB],Object.getOwnPropertyDescriptor(bF.prototype,"setClientRole"),bF.prototype),OO(bF.prototype,"setProxyServer",[KB],Object.getOwnPropertyDescriptor(bF.prototype,"setProxyServer"),bF.prototype),OO(bF.prototype,"setTurnServer",[YB],Object.getOwnPropertyDescriptor(bF.prototype,"setTurnServer"),bF.prototype),OO(bF.prototype,"setLicense",[JB],Object.getOwnPropertyDescriptor(bF.prototype,"setLicense"),bF.prototype),OO(bF.prototype,"startProxyServer",[XB],Object.getOwnPropertyDescriptor(bF.prototype,"startProxyServer"),bF.prototype),OO(bF.prototype,"stopProxyServer",[ZB],Object.getOwnPropertyDescriptor(bF.prototype,"stopProxyServer"),bF.prototype),OO(bF.prototype,"setLocalAccessPointsV2",[QB],Object.getOwnPropertyDescriptor(bF.prototype,"setLocalAccessPointsV2"),bF.prototype),OO(bF.prototype,"setLocalAccessPoints",[$B],Object.getOwnPropertyDescriptor(bF.prototype,"setLocalAccessPoints"),bF.prototype),OO(bF.prototype,"setRemoteDefaultVideoStreamType",[eF],Object.getOwnPropertyDescriptor(bF.prototype,"setRemoteDefaultVideoStreamType"),bF.prototype),OO(bF.prototype,"setRemoteVideoStreamType",[tF],Object.getOwnPropertyDescriptor(bF.prototype,"setRemoteVideoStreamType"),bF.prototype),OO(bF.prototype,"setStreamFallbackOption",[nF],Object.getOwnPropertyDescriptor(bF.prototype,"setStreamFallbackOption"),bF.prototype),OO(bF.prototype,"setEncryptionConfig",[rF],Object.getOwnPropertyDescriptor(bF.prototype,"setEncryptionConfig"),bF.prototype),OO(bF.prototype,"renewToken",[iF],Object.getOwnPropertyDescriptor(bF.prototype,"renewToken"),bF.prototype),OO(bF.prototype,"enableAudioVolumeIndicator",[oF],Object.getOwnPropertyDescriptor(bF.prototype,"enableAudioVolumeIndicator"),bF.prototype),OO(bF.prototype,"startLiveStreaming",[aF],Object.getOwnPropertyDescriptor(bF.prototype,"startLiveStreaming"),bF.prototype),OO(bF.prototype,"setLiveTranscoding",[sF],Object.getOwnPropertyDescriptor(bF.prototype,"setLiveTranscoding"),bF.prototype),OO(bF.prototype,"stopLiveStreaming",[cF],Object.getOwnPropertyDescriptor(bF.prototype,"stopLiveStreaming"),bF.prototype),OO(bF.prototype,"startChannelMediaRelay",[lF],Object.getOwnPropertyDescriptor(bF.prototype,"startChannelMediaRelay"),bF.prototype),OO(bF.prototype,"updateChannelMediaRelay",[dF],Object.getOwnPropertyDescriptor(bF.prototype,"updateChannelMediaRelay"),bF.prototype),OO(bF.prototype,"stopChannelMediaRelay",[uF],Object.getOwnPropertyDescriptor(bF.prototype,"stopChannelMediaRelay"),bF.prototype),OO(bF.prototype,"sendCustomReportMessage",[pF],Object.getOwnPropertyDescriptor(bF.prototype,"sendCustomReportMessage"),bF.prototype),OO(bF.prototype,"pickSVCLayer",[hF],Object.getOwnPropertyDescriptor(bF.prototype,"pickSVCLayer"),bF.prototype),OO(bF.prototype,"setRTMConfig",[fF],Object.getOwnPropertyDescriptor(bF.prototype,"setRTMConfig"),bF.prototype),OO(bF.prototype,"enableContentInspect",[mF],Object.getOwnPropertyDescriptor(bF.prototype,"enableContentInspect"),bF.prototype),OO(bF.prototype,"disableContentInspect",[gF],Object.getOwnPropertyDescriptor(bF.prototype,"disableContentInspect"),bF.prototype),OO(bF.prototype,"setImageModeration",[vF],Object.getOwnPropertyDescriptor(bF.prototype,"setImageModeration"),bF.prototype),OO(bF.prototype,"setP2PTransport",[_F],Object.getOwnPropertyDescriptor(bF.prototype,"setP2PTransport"),bF.prototype),OO(bF.prototype,"getJoinChannelServiceRecords",[yF],Object.getOwnPropertyDescriptor(bF.prototype,"getJoinChannelServiceRecords"),bF.prototype),OO(bF.prototype,"setPublishAudioFilterEnabled",[wF],Object.getOwnPropertyDescriptor(bF.prototype,"setPublishAudioFilterEnabled"),bF.prototype),bF);class CF{constructor(e,t){jw(this,"id",0),jw(this,"element",void 0),jw(this,"peerPair",void 0),jw(this,"context",void 0),jw(this,"audioPlayerElement",void 0),jw(this,"audioTrack",void 0),CF.count+=1,this.id=CF.count,this.element=e,this.context=t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const t=document.createElement("audio");t.srcObject=new MediaStream([e.track]),t.play(),this.audioPlayerElement=t}}async switchSdp(){if(!this.peerPair)return;const e=async(e,t)=>{const n="offer"===t?await e.createOffer():await e.createAnswer();return await e.setLocalDescription(n),"complete"===e.iceGatheringState?e.localDescription:new Ih((t=>{e.onicegatheringstatechange=()=>{"complete"===e.iceGatheringState&&t(e.localDescription)}}))},t=async(e,t)=>await e.setRemoteDescription(t);try{const n=await e(this.peerPair[0],"offer");await t(this.peerPair[1],n);const r=await e(this.peerPair[1],"answer");await t(this.peerPair[0],r)}catch(e){throw new GO(LT.LOCAL_AEC_ERROR,e.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let t;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(t)}catch(e){throw new GO(LT.LOCAL_AEC_ERROR,e.toString()).print()}if(!t)throw new GO(LT.LOCAL_AEC_ERROR,"no dest node when local aec").print();const n=t.stream.getAudioTracks()[0];return this.audioTrack=n,n}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,t=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(t),await this.switchSdp()}close(){SR.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach((e=>{e.close()})),this.peerPair=void 0,this.audioPlayerElement=void 0}}var RF,OF;jw(CF,"count",0);const IF=window.AudioContext||window.webkitAudioContext,AF=new(RF=xR({report:LR}),OO((OF=class{constructor(){jw(this,"units",[]),jw(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return SR.debug("the system does not need to process local aec"),-1;this.context||(this.context=new IF);let t=this.units.find((t=>t&&t.getElement()===e));return t||(t=new CF(e,this.context),this.units.push(t)),t.startEchoCancellation(),SR.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return tT().name!==ZS.SAFARI}}).prototype,"processExternalMediaAEC",[RF],Object.getOwnPropertyDescriptor(OF.prototype,"processExternalMediaAEC"),OF.prototype),OF);function kF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kF(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kF(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const LF=window||document;function NF(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!LF)return;const n=UW._cspEventHandlerPointer;if(n&&t)return void console.error(n,t);const r=e=>{if(!(e&&e.blockedURI&&(UW.onSecurityPolicyViolation||UW.getListeners(CI.SECURITY_POLICY_VIOLATION).length>0)))return;const t=e.blockedURI;aR("CSP_DETECTED_HOSTNAME_LIST").some((e=>Li(t).call(t,e)))&&(UW.onSecurityPolicyViolation&&"function"==typeof UW.onSecurityPolicyViolation&&UW.onSecurityPolicyViolation(e),UW.getListeners(CI.SECURITY_POLICY_VIOLATION).length>0&&UW.safeEmit(CI.SECURITY_POLICY_VIOLATION,e))};n&&LF.removeEventListener("securitypolicyviolation",n),(t||e&&"function"==typeof e||UW.getListeners(CI.SECURITY_POLICY_VIOLATION).length>0)&&LF.addEventListener("securitypolicyviolation",r),UW._cspEventHandlerPointer=r}var PF=ge,DF=_E,MF=RegExp.prototype,UF=ce((function(e){return e===MF||PF(MF,e)?DF(e):e.flags}));function jF(e){let t=e.length;for(;--t>=0;)e[t]=0}const VF=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),BF=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),FF=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),GF=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),HF=new Array(576);jF(HF);const qF=new Array(60);jF(qF);const WF=new Array(512);jF(WF);const zF=new Array(256);jF(zF);const KF=new Array(29);jF(KF);const YF=new Array(30);function JF(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let XF,ZF,QF;function $F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}jF(YF);const eG=e=>e<256?WF[e]:WF[256+(e>>>7)],tG=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},nG=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,tG(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},rG=(e,t,n)=>{nG(e,n[2*t],n[2*t+1])},iG=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},oG=(e,t,n)=>{const r=new Array(16);let i,o,a=0;for(i=1;i<=15;i++)a=a+n[i-1]<<1,r[i]=a;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=iG(r[t]++,t))}},aG=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},sG=e=>{e.bi_valid>8?tG(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},cG=(e,t,n,r)=>{const i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]},lG=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&cG(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!cG(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},dG=(e,t,n)=>{let r,i,o,a,s=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+s++],r+=(255&e.pending_buf[e.sym_buf+s++])<<8,i=e.pending_buf[e.sym_buf+s++],0===r?rG(e,i,t):(o=zF[i],rG(e,o+256+1,t),a=VF[o],0!==a&&(i-=KF[o],nG(e,i,a)),r--,o=eG(r),rG(e,o,n),a=BF[o],0!==a&&(r-=YF[o],nG(e,r,a)))}while(s<e.sym_next);rG(e,256,t)},uG=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let a,s,c,l=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<o;a++)0!==n[2*a]?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=r[2*c+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)lG(e,n,a);c=o;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],lG(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[2*c]=n[2*a]+n[2*s],e.depth[c]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[2*a+1]=n[2*s+1]=c,e.heap[1]=c++,lG(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,d,u,p,h,f,m=0;for(p=0;p<=15;p++)e.bl_count[p]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],p=n[2*n[2*d+1]+1]+1,p>c&&(p=c,m++),n[2*d+1]=p,d>r||(e.bl_count[p]++,h=0,d>=s&&(h=a[d-s]),f=n[2*d],e.opt_len+=f*(p+h),o&&(e.static_len+=f*(i[2*d+1]+h)));if(0!==m){do{for(p=c-1;0===e.bl_count[p];)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[c]--,m-=2}while(m>0);for(p=c;0!==p;p--)for(d=e.bl_count[p];0!==d;)u=e.heap[--l],u>r||(n[2*u+1]!==p&&(e.opt_len+=(p-n[2*u+1])*n[2*u],n[2*u+1]=p),d--)}})(e,t),oG(n,l,e.bl_count)},pG=(e,t,n)=>{let r,i,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<c&&i===a||(s<l?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(c=138,l=3):i===a?(c=6,l=3):(c=7,l=4))},hG=(e,t,n)=>{let r,i,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<c&&i===a)){if(s<l)do{rG(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(rG(e,i,e.bl_tree),s--),rG(e,16,e.bl_tree),nG(e,s-3,2)):s<=10?(rG(e,17,e.bl_tree),nG(e,s-3,3)):(rG(e,18,e.bl_tree),nG(e,s-11,7));s=0,o=i,0===a?(c=138,l=3):i===a?(c=6,l=3):(c=7,l=4)}};let fG=!1;const mG=(e,t,n,r)=>{nG(e,0+(r?1:0),3),sG(e),tG(e,n),tG(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var gG={_tr_init:e=>{fG||((()=>{let e,t,n,r,i;const o=new Array(16);for(n=0,r=0;r<28;r++)for(KF[r]=n,e=0;e<1<<VF[r];e++)zF[n++]=r;for(zF[n-1]=r,i=0,r=0;r<16;r++)for(YF[r]=i,e=0;e<1<<BF[r];e++)WF[i++]=r;for(i>>=7;r<30;r++)for(YF[r]=i<<7,e=0;e<1<<BF[r]-7;e++)WF[256+i++]=r;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)HF[2*e+1]=8,e++,o[8]++;for(;e<=255;)HF[2*e+1]=9,e++,o[9]++;for(;e<=279;)HF[2*e+1]=7,e++,o[7]++;for(;e<=287;)HF[2*e+1]=8,e++,o[8]++;for(oG(HF,287,o),e=0;e<30;e++)qF[2*e+1]=5,qF[2*e]=iG(e,5);XF=new JF(HF,VF,257,286,15),ZF=new JF(qF,BF,0,30,15),QF=new JF(new Array(0),FF,0,19,7)})(),fG=!0),e.l_desc=new $F(e.dyn_ltree,XF),e.d_desc=new $F(e.dyn_dtree,ZF),e.bl_desc=new $F(e.bl_tree,QF),e.bi_buf=0,e.bi_valid=0,aG(e)},_tr_stored_block:mG,_tr_flush_block:(e,t,n,r)=>{let i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),uG(e,e.l_desc),uG(e,e.d_desc),a=(e=>{let t;for(pG(e,e.dyn_ltree,e.l_desc.max_code),pG(e,e.dyn_dtree,e.d_desc.max_code),uG(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*GF[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?mG(e,t,n,r):4===e.strategy||o===i?(nG(e,2+(r?1:0),3),dG(e,HF,qF)):(nG(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(nG(e,t-257,5),nG(e,n-1,5),nG(e,r-4,4),i=0;i<r;i++)nG(e,e.bl_tree[2*GF[i]+1],3);hG(e,e.dyn_ltree,t-1),hG(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),dG(e,e.dyn_ltree,e.dyn_dtree)),aG(e),r&&sG(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(zF[n]+256+1)]++,e.dyn_dtree[2*eG(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{nG(e,2,3),rG(e,256,HF),(e=>{16===e.bi_valid?(tG(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},vG=(e,t,n,r)=>{let i=65535&e|0,o=e>>>16&65535|0,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{i=i+t[r++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16|0};const _G=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var yG=(e,t,n,r)=>{const i=_G,o=r+n;e^=-1;for(let n=r;n<o;n++)e=e>>>8^i[255&(e^t[n])];return-1^e},wG={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},bG={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:EG,_tr_stored_block:SG,_tr_flush_block:TG,_tr_tally:CG,_tr_align:RG}=gG,{Z_NO_FLUSH:OG,Z_PARTIAL_FLUSH:IG,Z_FULL_FLUSH:AG,Z_FINISH:kG,Z_BLOCK:xG,Z_OK:LG,Z_STREAM_END:NG,Z_STREAM_ERROR:PG,Z_DATA_ERROR:DG,Z_BUF_ERROR:MG,Z_DEFAULT_COMPRESSION:UG,Z_FILTERED:jG,Z_HUFFMAN_ONLY:VG,Z_RLE:BG,Z_FIXED:FG,Z_DEFAULT_STRATEGY:GG,Z_UNKNOWN:HG,Z_DEFLATED:qG}=bG,WG=258,zG=262,KG=42,YG=113,JG=666,XG=(e,t)=>(e.msg=wG[t],t),ZG=e=>2*e-(e>4?9:0),QG=e=>{let t=e.length;for(;--t>=0;)e[t]=0},$G=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let eH=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const tH=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},nH=(e,t)=>{TG(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,tH(e.strm)},rH=(e,t)=>{e.pending_buf[e.pending++]=t},iH=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},oH=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=vG(e.adler,t,i,n):2===e.state.wrap&&(e.adler=yG(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},aH=(e,t)=>{let n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match;const c=e.strstart>e.w_size-zG?e.strstart-(e.w_size-zG):0,l=e.window,d=e.w_mask,u=e.prev,p=e.strstart+WG;let h=l[o+a-1],f=l[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,l[n+a]===f&&l[n+a-1]===h&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<p);if(r=WG-(p-o),o=p-WG,r>a){if(e.match_start=t,a=r,r>=s)break;h=l[o+a-1],f=l[o+a]}}}while((t=u[t&d])>c&&0!=--i);return a<=e.lookahead?a:e.lookahead},sH=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-zG)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),$G(e),r+=t),0===e.strm.avail_in)break;if(n=oH(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=eH(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=eH(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<zG&&0!==e.strm.avail_in)},cH=(e,t)=>{let n,r,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<o&&(0===n&&t!==kG||t===OG||n!==r+e.strm.avail_in))break;a=t===kG&&n===r+e.strm.avail_in?1:0,SG(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,tH(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(oH(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==OG&&t!==kG&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(oH(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=o||(r||t===kG)&&t!==OG&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,a=t===kG&&0===e.strm.avail_in&&n===r?1:0,SG(e,e.block_start,n,a),e.block_start+=n,tH(e.strm)),a?3:1)},lH=(e,t)=>{let n,r;for(;;){if(e.lookahead<zG){if(sH(e),e.lookahead<zG&&t===OG)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=eH(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-zG&&(e.match_length=aH(e,n)),e.match_length>=3)if(r=CG(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=eH(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=eH(e,e.ins_h,e.window[e.strstart+1]);else r=CG(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(nH(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===kG?(nH(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(nH(e,!1),0===e.strm.avail_out)?1:2},dH=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<zG){if(sH(e),e.lookahead<zG&&t===OG)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=eH(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-zG&&(e.match_length=aH(e,n),e.match_length<=5&&(e.strategy===jG||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=CG(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=eH(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(nH(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=CG(e,0,e.window[e.strstart-1]),r&&nH(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=CG(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===kG?(nH(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(nH(e,!1),0===e.strm.avail_out)?1:2};function uH(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const pH=[new uH(0,0,0,0,cH),new uH(4,4,8,4,lH),new uH(4,5,16,8,lH),new uH(4,6,32,32,lH),new uH(4,4,16,16,dH),new uH(8,16,32,32,dH),new uH(8,16,128,128,dH),new uH(8,32,128,256,dH),new uH(32,128,258,1024,dH),new uH(32,258,258,4096,dH)];function hH(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=qG,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),QG(this.dyn_ltree),QG(this.dyn_dtree),QG(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),QG(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),QG(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const fH=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==KG&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==YG&&t.status!==JG?1:0},mH=e=>{if(fH(e))return XG(e,PG);e.total_in=e.total_out=0,e.data_type=HG;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?KG:YG,e.adler=2===t.wrap?0:1,t.last_flush=-2,EG(t),LG},gH=e=>{const t=mH(e);return t===LG&&(e=>{e.window_size=2*e.w_size,QG(e.head),e.max_lazy_match=pH[e.level].max_lazy,e.good_match=pH[e.level].good_length,e.nice_match=pH[e.level].nice_length,e.max_chain_length=pH[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},vH=(e,t,n,r,i,o)=>{if(!e)return PG;let a=1;if(t===UG&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>9||n!==qG||r<8||r>15||t<0||t>9||o<0||o>FG||8===r&&1!==a)return XG(e,PG);8===r&&(r=9);const s=new hH;return e.state=s,s.strm=e,s.status=KG,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=o,s.method=n,gH(e)};var _H={deflateInit:(e,t)=>vH(e,t,qG,15,8,GG),deflateInit2:vH,deflateReset:gH,deflateResetKeep:mH,deflateSetHeader:(e,t)=>fH(e)||2!==e.state.wrap?PG:(e.state.gzhead=t,LG),deflate:(e,t)=>{if(fH(e)||t>xG||t<0)return e?XG(e,PG):PG;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===JG&&t!==kG)return XG(e,0===e.avail_out?MG:PG);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(tH(e),0===e.avail_out)return n.last_flush=-1,LG}else if(0===e.avail_in&&ZG(t)<=ZG(r)&&t!==kG)return XG(e,MG);if(n.status===JG&&0!==e.avail_in)return XG(e,MG);if(n.status===KG&&0===n.wrap&&(n.status=YG),n.status===KG){let t=qG+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=VG||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,iH(n,t),0!==n.strstart&&(iH(n,e.adler>>>16),iH(n,65535&e.adler)),e.adler=1,n.status=YG,tH(e),0!==n.pending)return n.last_flush=-1,LG}if(57===n.status)if(e.adler=0,rH(n,31),rH(n,139),rH(n,8),n.gzhead)rH(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),rH(n,255&n.gzhead.time),rH(n,n.gzhead.time>>8&255),rH(n,n.gzhead.time>>16&255),rH(n,n.gzhead.time>>24&255),rH(n,9===n.level?2:n.strategy>=VG||n.level<2?4:0),rH(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(rH(n,255&n.gzhead.extra.length),rH(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=yG(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(rH(n,0),rH(n,0),rH(n,0),rH(n,0),rH(n,0),rH(n,9===n.level?2:n.strategy>=VG||n.level<2?4:0),rH(n,3),n.status=YG,tH(e),0!==n.pending)return n.last_flush=-1,LG;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=yG(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,tH(e),0!==n.pending)return n.last_flush=-1,LG;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=yG(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=yG(e.adler,n.pending_buf,n.pending-r,r)),tH(e),0!==n.pending)return n.last_flush=-1,LG;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,rH(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=yG(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=yG(e.adler,n.pending_buf,n.pending-r,r)),tH(e),0!==n.pending)return n.last_flush=-1,LG;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,rH(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=yG(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(tH(e),0!==n.pending))return n.last_flush=-1,LG;rH(n,255&e.adler),rH(n,e.adler>>8&255),e.adler=0}if(n.status=YG,tH(e),0!==n.pending)return n.last_flush=-1,LG}if(0!==e.avail_in||0!==n.lookahead||t!==OG&&n.status!==JG){let r=0===n.level?cH(n,t):n.strategy===VG?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(sH(e),0===e.lookahead)){if(t===OG)return 1;break}if(e.match_length=0,n=CG(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(nH(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===kG?(nH(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(nH(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===BG?((e,t)=>{let n,r,i,o;const a=e.window;for(;;){if(e.lookahead<=WG){if(sH(e),e.lookahead<=WG&&t===OG)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){o=e.strstart+WG;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o);e.match_length=WG-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=CG(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=CG(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(nH(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===kG?(nH(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(nH(e,!1),0===e.strm.avail_out)?1:2})(n,t):pH[n.level].func(n,t);if(3!==r&&4!==r||(n.status=JG),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),LG;if(2===r&&(t===IG?RG(n):t!==xG&&(SG(n,0,0,!1),t===AG&&(QG(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),tH(e),0===e.avail_out))return n.last_flush=-1,LG}return t!==kG?LG:n.wrap<=0?NG:(2===n.wrap?(rH(n,255&e.adler),rH(n,e.adler>>8&255),rH(n,e.adler>>16&255),rH(n,e.adler>>24&255),rH(n,255&e.total_in),rH(n,e.total_in>>8&255),rH(n,e.total_in>>16&255),rH(n,e.total_in>>24&255)):(iH(n,e.adler>>>16),iH(n,65535&e.adler)),tH(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?LG:NG)},deflateEnd:e=>{if(fH(e))return PG;const t=e.state.status;return e.state=null,t===YG?XG(e,DG):LG},deflateSetDictionary:(e,t)=>{let n=t.length;if(fH(e))return PG;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==KG||r.lookahead)return PG;if(1===i&&(e.adler=vG(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(QG(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,sH(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=eH(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,sH(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,r.wrap=i,LG},deflateInfo:"pako deflate (from Nodeca project)"};const yH=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var wH={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)yH(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n}};let bH=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){bH=!1}const EH=new Uint8Array(256);for(let e=0;e<256;e++)EH[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;EH[254]=EH[254]=1;var SH={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,o,a=e.length,s=0;for(i=0;i<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const o=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){o[i++]=t;continue}let a=EH[t];if(a>4)o[i++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&bH)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+EH[e[n]]>t?n:t}},TH=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const CH=Object.prototype.toString,{Z_NO_FLUSH:RH,Z_SYNC_FLUSH:OH,Z_FULL_FLUSH:IH,Z_FINISH:AH,Z_OK:kH,Z_STREAM_END:xH,Z_DEFAULT_COMPRESSION:LH,Z_DEFAULT_STRATEGY:NH,Z_DEFLATED:PH}=bG;function DH(e){this.options=wH.assign({level:LH,method:PH,chunkSize:16384,windowBits:15,memLevel:8,strategy:NH},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new TH,this.strm.avail_out=0;let n=_H.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==kH)throw new Error(wG[n]);if(t.header&&_H.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?SH.string2buf(t.dictionary):"[object ArrayBuffer]"===CH.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=_H.deflateSetDictionary(this.strm,e),n!==kH)throw new Error(wG[n]);this._dict_set=!0}}function MH(e,t){const n=new DH(t);if(n.push(e,!0),n.err)throw n.msg||wG[n.err];return n.result}DH.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?AH:RH,"string"==typeof e?n.input=SH.string2buf(e):"[object ArrayBuffer]"===CH.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(o===OH||o===IH)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=_H.deflate(n,o),i===xH)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=_H.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===kH;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},DH.prototype.onData=function(e){this.chunks.push(e)},DH.prototype.onEnd=function(e){e===kH&&(this.result=wH.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var UH={Deflate:DH,deflate:MH,deflateRaw:function(e,t){return(t=t||{}).raw=!0,MH(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,MH(e,t)},constants:bG};const jH=16209;var VH=function(e,t){let n,r,i,o,a,s,c,l,d,u,p,h,f,m,g,v,_,y,w,b,E,S,T,C;const R=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,C=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),s=R.dmax,c=R.wsize,l=R.whave,d=R.wnext,u=R.window,p=R.hold,h=R.bits,f=R.lencode,m=R.distcode,g=(1<<R.lenbits)-1,v=(1<<R.distbits)-1;e:do{h<15&&(p+=T[n++]<<h,h+=8,p+=T[n++]<<h,h+=8),_=f[p&g];t:for(;;){if(y=_>>>24,p>>>=y,h-=y,y=_>>>16&255,0===y)C[i++]=65535&_;else{if(!(16&y)){if(0==(64&y)){_=f[(65535&_)+(p&(1<<y)-1)];continue t}if(32&y){R.mode=16191;break e}e.msg="invalid literal/length code",R.mode=jH;break e}w=65535&_,y&=15,y&&(h<y&&(p+=T[n++]<<h,h+=8),w+=p&(1<<y)-1,p>>>=y,h-=y),h<15&&(p+=T[n++]<<h,h+=8,p+=T[n++]<<h,h+=8),_=m[p&v];n:for(;;){if(y=_>>>24,p>>>=y,h-=y,y=_>>>16&255,!(16&y)){if(0==(64&y)){_=m[(65535&_)+(p&(1<<y)-1)];continue n}e.msg="invalid distance code",R.mode=jH;break e}if(b=65535&_,y&=15,h<y&&(p+=T[n++]<<h,h+=8,h<y&&(p+=T[n++]<<h,h+=8)),b+=p&(1<<y)-1,b>s){e.msg="invalid distance too far back",R.mode=jH;break e}if(p>>>=y,h-=y,y=i-o,b>y){if(y=b-y,y>l&&R.sane){e.msg="invalid distance too far back",R.mode=jH;break e}if(E=0,S=u,0===d){if(E+=c-y,y<w){w-=y;do{C[i++]=u[E++]}while(--y);E=i-b,S=C}}else if(d<y){if(E+=c+d-y,y-=d,y<w){w-=y;do{C[i++]=u[E++]}while(--y);if(E=0,d<w){y=d,w-=y;do{C[i++]=u[E++]}while(--y);E=i-b,S=C}}}else if(E+=d-y,y<w){w-=y;do{C[i++]=u[E++]}while(--y);E=i-b,S=C}for(;w>2;)C[i++]=S[E++],C[i++]=S[E++],C[i++]=S[E++],w-=3;w&&(C[i++]=S[E++],w>1&&(C[i++]=S[E++]))}else{E=i-b;do{C[i++]=C[E++],C[i++]=C[E++],C[i++]=C[E++],w-=3}while(w>2);w&&(C[i++]=C[E++],w>1&&(C[i++]=C[E++]))}break}}break}}while(n<r&&i<a);w=h>>3,n-=w,h-=w<<3,p&=(1<<h)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<a?a-i+257:257-(i-a),R.hold=p,R.bits=h};const BH=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),FH=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),GH=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),HH=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var qH=(e,t,n,r,i,o,a,s)=>{const c=s.bits;let l,d,u,p,h,f,m=0,g=0,v=0,_=0,y=0,w=0,b=0,E=0,S=0,T=0,C=null;const R=new Uint16Array(16),O=new Uint16Array(16);let I,A,k,x=null;for(m=0;m<=15;m++)R[m]=0;for(g=0;g<r;g++)R[t[n+g]]++;for(y=c,_=15;_>=1&&0===R[_];_--);if(y>_&&(y=_),0===_)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(v=1;v<_&&0===R[v];v++);for(y<v&&(y=v),E=1,m=1;m<=15;m++)if(E<<=1,E-=R[m],E<0)return-1;if(E>0&&(0===e||1!==_))return-1;for(O[1]=0,m=1;m<15;m++)O[m+1]=O[m]+R[m];for(g=0;g<r;g++)0!==t[n+g]&&(a[O[t[n+g]]++]=g);if(0===e?(C=x=a,f=20):1===e?(C=BH,x=FH,f=257):(C=GH,x=HH,f=0),T=0,g=0,m=v,h=o,w=y,b=0,u=-1,S=1<<y,p=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){I=m-b,a[g]+1<f?(A=0,k=a[g]):a[g]>=f?(A=x[a[g]-f],k=C[a[g]-f]):(A=96,k=0),l=1<<m-b,d=1<<w,v=d;do{d-=l,i[h+(T>>b)+d]=I<<24|A<<16|k|0}while(0!==d);for(l=1<<m-1;T&l;)l>>=1;if(0!==l?(T&=l-1,T+=l):T=0,g++,0==--R[m]){if(m===_)break;m=t[n+a[g]]}if(m>y&&(T&p)!==u){for(0===b&&(b=y),h+=v,w=m-b,E=1<<w;w+b<_&&(E-=R[w+b],!(E<=0));)w++,E<<=1;if(S+=1<<w,1===e&&S>852||2===e&&S>592)return 1;u=T&p,i[u]=y<<24|w<<16|h-o|0}}return 0!==T&&(i[h+T]=m-b<<24|64<<16|0),s.bits=y,0};const{Z_FINISH:WH,Z_BLOCK:zH,Z_TREES:KH,Z_OK:YH,Z_STREAM_END:JH,Z_NEED_DICT:XH,Z_STREAM_ERROR:ZH,Z_DATA_ERROR:QH,Z_MEM_ERROR:$H,Z_BUF_ERROR:eq,Z_DEFLATED:tq}=bG,nq=16180,rq=16190,iq=16191,oq=16192,aq=16194,sq=16199,cq=16200,lq=16206,dq=16209,uq=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function pq(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const hq=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<nq||t.mode>16211?1:0},fq=e=>{if(hq(e))return ZH;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=nq,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,YH},mq=e=>{if(hq(e))return ZH;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,fq(e)},gq=(e,t)=>{let n;if(hq(e))return ZH;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?ZH:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,mq(e))},vq=(e,t)=>{if(!e)return ZH;const n=new pq;e.state=n,n.strm=e,n.window=null,n.mode=nq;const r=gq(e,t);return r!==YH&&(e.state=null),r};let _q,yq,wq=!0;const bq=e=>{if(wq){_q=new Int32Array(512),yq=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(qH(1,e.lens,0,288,_q,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;qH(2,e.lens,0,32,yq,0,e.work,{bits:5}),wq=!1}e.lencode=_q,e.lenbits=9,e.distcode=yq,e.distbits=5},Eq=(e,t,n,r)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(t.subarray(n-r,n-r+i),o.wnext),(r-=i)?(o.window.set(t.subarray(n-r,n),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var Sq={inflateReset:mq,inflateReset2:gq,inflateResetKeep:fq,inflateInit:e=>vq(e,15),inflateInit2:vq,inflate:(e,t)=>{let n,r,i,o,a,s,c,l,d,u,p,h,f,m,g,v,_,y,w,b,E,S,T=0;const C=new Uint8Array(4);let R,O;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(hq(e)||!e.output||!e.input&&0!==e.avail_in)return ZH;n=e.state,n.mode===iq&&(n.mode=oq),a=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,l=n.hold,d=n.bits,u=s,p=c,S=YH;e:for(;;)switch(n.mode){case nq:if(0===n.wrap){n.mode=oq;break}for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,C[0]=255&l,C[1]=l>>>8&255,n.check=yG(n.check,C,2,0),l=0,d=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=dq;break}if((15&l)!==tq){e.msg="unknown compression method",n.mode=dq;break}if(l>>>=4,d-=4,E=8+(15&l),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=dq;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:iq,l=0,d=0;break;case 16181:for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(n.flags=l,(255&UF(n))!==tq){e.msg="unknown compression method",n.mode=dq;break}if(57344&UF(n)){e.msg="unknown header flags set",n.mode=dq;break}n.head&&(n.head.text=l>>8&1),512&UF(n)&&4&n.wrap&&(C[0]=255&l,C[1]=l>>>8&255,n.check=yG(n.check,C,2,0)),l=0,d=0,n.mode=16182;case 16182:for(;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.head&&(n.head.time=l),512&UF(n)&&4&n.wrap&&(C[0]=255&l,C[1]=l>>>8&255,C[2]=l>>>16&255,C[3]=l>>>24&255,n.check=yG(n.check,C,4,0)),l=0,d=0,n.mode=16183;case 16183:for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&UF(n)&&4&n.wrap&&(C[0]=255&l,C[1]=l>>>8&255,n.check=yG(n.check,C,2,0)),l=0,d=0,n.mode=16184;case 16184:if(1024&UF(n)){for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.length=l,n.head&&(n.head.extra_len=l),512&UF(n)&&4&n.wrap&&(C[0]=255&l,C[1]=l>>>8&255,n.check=yG(n.check,C,2,0)),l=0,d=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&UF(n)&&(h=n.length,h>s&&(h=s),h&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(o,o+h),E)),512&UF(n)&&4&n.wrap&&(n.check=yG(n.check,r,h,o)),s-=h,o+=h,n.length-=h),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&UF(n)){if(0===s)break e;h=0;do{E=r[o+h++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&h<s);if(512&UF(n)&&4&n.wrap&&(n.check=yG(n.check,r,h,o)),s-=h,o+=h,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&UF(n)){if(0===s)break e;h=0;do{E=r[o+h++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&h<s);if(512&UF(n)&&4&n.wrap&&(n.check=yG(n.check,r,h,o)),s-=h,o+=h,E)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&UF(n)){for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=dq;break}l=0,d=0}n.head&&(n.head.hcrc=UF(n)>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=iq;break;case 16189:for(;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}e.adler=n.check=uq(l),l=0,d=0,n.mode=rq;case rq:if(0===n.havedict)return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=l,n.bits=d,XH;e.adler=n.check=1,n.mode=iq;case iq:if(t===zH||t===KH)break e;case oq:if(n.last){l>>>=7&d,d-=7&d,n.mode=lq;break}for(;d<3;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}switch(n.last=1&l,l>>>=1,d-=1,3&l){case 0:n.mode=16193;break;case 1:if(bq(n),n.mode=sq,t===KH){l>>>=2,d-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=dq}l>>>=2,d-=2;break;case 16193:for(l>>>=7&d,d-=7&d;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=dq;break}if(n.length=65535&l,l=0,d=0,n.mode=aq,t===KH)break e;case aq:n.mode=16195;case 16195:if(h=n.length,h){if(h>s&&(h=s),h>c&&(h=c),0===h)break e;i.set(r.subarray(o,o+h),a),s-=h,o+=h,c-=h,a+=h,n.length-=h;break}n.mode=iq;break;case 16196:for(;d<14;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(n.nlen=257+(31&l),l>>>=5,d-=5,n.ndist=1+(31&l),l>>>=5,d-=5,n.ncode=4+(15&l),l>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=dq;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;d<3;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.lens[I[n.have++]]=7&l,l>>>=3,d-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,R={bits:n.lenbits},S=qH(0,n.lens,0,19,n.lencode,0,n.work,R),n.lenbits=R.bits,S){e.msg="invalid code lengths set",n.mode=dq;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;T=n.lencode[l&(1<<n.lenbits)-1],g=T>>>24,v=T>>>16&255,_=65535&T,!(g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(_<16)l>>>=g,d-=g,n.lens[n.have++]=_;else{if(16===_){for(O=g+2;d<O;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(l>>>=g,d-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=dq;break}E=n.lens[n.have-1],h=3+(3&l),l>>>=2,d-=2}else if(17===_){for(O=g+3;d<O;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=g,d-=g,E=0,h=3+(7&l),l>>>=3,d-=3}else{for(O=g+7;d<O;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=g,d-=g,E=0,h=11+(127&l),l>>>=7,d-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=dq;break}for(;h--;)n.lens[n.have++]=E}}if(n.mode===dq)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=dq;break}if(n.lenbits=9,R={bits:n.lenbits},S=qH(1,n.lens,0,n.nlen,n.lencode,0,n.work,R),n.lenbits=R.bits,S){e.msg="invalid literal/lengths set",n.mode=dq;break}if(n.distbits=6,n.distcode=n.distdyn,R={bits:n.distbits},S=qH(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R),n.distbits=R.bits,S){e.msg="invalid distances set",n.mode=dq;break}if(n.mode=sq,t===KH)break e;case sq:n.mode=cq;case cq:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=l,n.bits=d,VH(e,p),a=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,l=n.hold,d=n.bits,n.mode===iq&&(n.back=-1);break}for(n.back=0;T=n.lencode[l&(1<<n.lenbits)-1],g=T>>>24,v=T>>>16&255,_=65535&T,!(g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(v&&0==(240&v)){for(y=g,w=v,b=_;T=n.lencode[b+((l&(1<<y+w)-1)>>y)],g=T>>>24,v=T>>>16&255,_=65535&T,!(y+g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=y,d-=y,n.back+=y}if(l>>>=g,d-=g,n.back+=g,n.length=_,0===v){n.mode=16205;break}if(32&v){n.back=-1,n.mode=iq;break}if(64&v){e.msg="invalid literal/length code",n.mode=dq;break}n.extra=15&v,n.mode=16201;case 16201:if(n.extra){for(O=n.extra;d<O;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;T=n.distcode[l&(1<<n.distbits)-1],g=T>>>24,v=T>>>16&255,_=65535&T,!(g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(0==(240&v)){for(y=g,w=v,b=_;T=n.distcode[b+((l&(1<<y+w)-1)>>y)],g=T>>>24,v=T>>>16&255,_=65535&T,!(y+g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=y,d-=y,n.back+=y}if(l>>>=g,d-=g,n.back+=g,64&v){e.msg="invalid distance code",n.mode=dq;break}n.offset=_,n.extra=15&v,n.mode=16203;case 16203:if(n.extra){for(O=n.extra;d<O;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=dq;break}n.mode=16204;case 16204:if(0===c)break e;if(h=p-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=dq;break}h>n.wnext?(h-=n.wnext,f=n.wsize-h):f=n.wnext-h,h>n.length&&(h=n.length),m=n.window}else m=i,f=a-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do{i[a++]=m[f++]}while(--h);0===n.length&&(n.mode=cq);break;case 16205:if(0===c)break e;i[a++]=n.length,c--,n.mode=cq;break;case lq:if(n.wrap){for(;d<32;){if(0===s)break e;s--,l|=r[o++]<<d,d+=8}if(p-=c,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=UF(n)?yG(n.check,i,p,a-p):vG(n.check,i,p,a-p)),p=c,4&n.wrap&&(UF(n)?l:uq(l))!==n.check){e.msg="incorrect data check",n.mode=dq;break}l=0,d=0}n.mode=16207;case 16207:if(n.wrap&&UF(n)){for(;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=dq;break}l=0,d=0}n.mode=16208;case 16208:S=JH;break e;case dq:S=QH;break e;case 16210:return $H;default:return ZH}return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=l,n.bits=d,(n.wsize||p!==e.avail_out&&n.mode<dq&&(n.mode<lq||t!==WH))&&Eq(e,e.output,e.next_out,p-e.avail_out),u-=e.avail_in,p-=e.avail_out,e.total_in+=u,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=UF(n)?yG(n.check,i,p,e.next_out-p):vG(n.check,i,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===iq?128:0)+(n.mode===sq||n.mode===aq?256:0),(0===u&&0===p||t===WH)&&S===YH&&(S=eq),S},inflateEnd:e=>{if(hq(e))return ZH;let t=e.state;return t.window&&(t.window=null),e.state=null,YH},inflateGetHeader:(e,t)=>{if(hq(e))return ZH;const n=e.state;return 0==(2&n.wrap)?ZH:(n.head=t,t.done=!1,YH)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,o;return hq(e)?ZH:(r=e.state,0!==r.wrap&&r.mode!==rq?ZH:r.mode===rq&&(i=1,i=vG(i,t,n,0),i!==r.check)?QH:(o=Eq(e,t,n,n),o?(r.mode=16210,$H):(r.havedict=1,YH)))},inflateInfo:"pako inflate (from Nodeca project)"},Tq=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Cq=Object.prototype.toString,{Z_NO_FLUSH:Rq,Z_FINISH:Oq,Z_OK:Iq,Z_STREAM_END:Aq,Z_NEED_DICT:kq,Z_STREAM_ERROR:xq,Z_DATA_ERROR:Lq,Z_MEM_ERROR:Nq}=bG;function Pq(e){this.options=wH.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new TH,this.strm.avail_out=0;let n=Sq.inflateInit2(this.strm,t.windowBits);if(n!==Iq)throw new Error(wG[n]);if(this.header=new Tq,Sq.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=SH.string2buf(t.dictionary):"[object ArrayBuffer]"===Cq.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Sq.inflateSetDictionary(this.strm,t.dictionary),n!==Iq)))throw new Error(wG[n])}function Dq(e,t){const n=new Pq(t);if(n.push(e),n.err)throw n.msg||wG[n.err];return n.result}Pq.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Oq:Rq,"[object ArrayBuffer]"===Cq.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),o=Sq.inflate(n,a),o===kq&&i&&(o=Sq.inflateSetDictionary(n,i),o===Iq?o=Sq.inflate(n,a):o===Lq&&(o=kq));n.avail_in>0&&o===Aq&&n.state.wrap>0&&0!==e[n.next_in];)Sq.inflateReset(n),o=Sq.inflate(n,a);switch(o){case xq:case Lq:case kq:case Nq:return this.onEnd(o),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||o===Aq))if("string"===this.options.to){let e=SH.utf8border(n.output,n.next_out),t=n.next_out-e,i=SH.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==Iq||0!==s){if(o===Aq)return o=Sq.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Pq.prototype.onData=function(e){this.chunks.push(e)},Pq.prototype.onEnd=function(e){e===Iq&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=wH.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Mq={Inflate:Pq,inflate:Dq,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Dq(e,t)},ungzip:Dq,constants:bG};const{Deflate:Uq,deflate:jq,deflateRaw:Vq,gzip:Bq}=UH,{Inflate:Fq,inflate:Gq,inflateRaw:Hq,ungzip:qq}=Mq;var Wq=jq,zq=Gq,Kq=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(Kq||{});class Yq{constructor(){jw(this,"_sequence",0),jw(this,"_startTime",Date.now()),jw(this,"isUseOneByte",!0)}get startTime(){const e=Date.now()-this._startTime;return e<Math.pow(2,16)?e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(e){const t={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:e};if(e.byteLength>128){const n=new Uint8Array(4);n.set([1,0,0,0]);const r={id:0,length:4,data:n.buffer},i={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[r]};t.commonPacketHeader.extension=1,t.extension=i,t.payload=this.compress(e),t.commonPacketHeader.length=8+(t.extension.length+2)+t.payload.byteLength}else t.commonPacketHeader.length=8+t.payload.byteLength;aR("SHOW_DATASTREAM2_LOG")&&SR.debug("send data header: ".concat(JSON.stringify(t.commonPacketHeader)));const n=new ArrayBuffer(t.commonPacketHeader.length),r=new Uint8Array(n),i=new DataView(n);let o=0;if(i.setUint16(o,t.commonPacketHeader.extension<<15|t.commonPacketHeader.reserved<<14|t.commonPacketHeader.length,!0),o+=2,i.setUint32(o,t.commonPacketHeader.sequence,!0),o+=4,i.setUint16(o,t.commonStreamHeader,!0),o+=2,t.extension){const e=this.serializeExtension(t.extension);r.set(new Uint8Array(e),o),o+=e.byteLength}if(r.set(new Uint8Array(t.payload),o),o+=t.payload.byteLength,o!==t.commonPacketHeader.length)throw Error("serialize error!");return n}deserialize(e){if(e.byteLength<4)return new ArrayBuffer(0);const t=new DataView(e);let n=0;const r=t.getUint16(n,!0);n+=2;const i={length:16383&r,reserved:(16384&r)>>14,extension:(32768&r)>>15,sequence:t.getUint16(n+2,!0)<<16|t.getUint16(n,!0)};let o,a;if(n+=4,aR("SHOW_DATASTREAM2_LOG")&&SR.debug("receive data header: ".concat(JSON.stringify(i))),t.getUint16(n,!0),n+=2,i.extension){a=this.deserializeExtension(e.slice(n)),n+=2+a.length,o=e.slice(n);let t=!1;if(a.datas.length>0){const e=a.datas.find((e=>0===e.id));e&&(t=1==(1&new DataView(e.data).getUint32(0,!0)))}o=t?this.decompress(o):o}else o=e.slice(8);return o}serializeExtension(e){const{profile:t,length:n,datas:r}=e,i=new ArrayBuffer(n+2),o=new Uint8Array(i),a=new DataView(i);let s=0;if(a.setUint8(s++,t),a.setUint8(s++,n),r.forEach((e=>{t?(a.setUint8(s++,e.id),a.setUint8(s++,e.length),o.set(new Uint8Array(e.data),s),s+=e.data.byteLength):(a.setUint8(s++,e.id|e.length<<4),o.set(new Uint8Array(e.data),s),s+=e.data.byteLength)})),s!==n+2)throw Error("serialize extension error, is ".concat(s,"!==").concat(n+2));return i}deserializeExtension(e){const t=new DataView(e);let n=0;const r=t.getUint8(n);n++;const i=t.getUint8(n);n++;const o=r===Kq.TWO_BYTE,a=[],s=new DataView(e,2);let c=0;for(;c<i;){let e=0,t=0,n=new ArrayBuffer(0);o?(e=s.getUint8(c),c++,t=s.getUint8(c),c++):(e=15&s.getUint8(c),t=s.getUint8(c)>>4,c++),t>0&&(n=s.buffer.slice(c+2,c+2+t),c+=n.byteLength),a.push({id:e,length:t,data:n})}if(c!==i)throw Error("parse error");return{profile:r,length:i,datas:a}}decompress(e){return zq(new Uint8Array(e))}compress(e){return Wq(new Uint8Array(e))}}const Jq={name:"DataStream",create:(e,t)=>{const n=t?new AD(e):new kD(e);return n.useDataStream(new Yq),n}};class Xq extends YT{constructor(e,t,n){super(),jw(this,"ws",void 0),jw(this,"requestId",1),jw(this,"heartBeatTimer",void 0),jw(this,"joinInfo",void 0),jw(this,"clientId",void 0),jw(this,"onOpen",(()=>{this.emit("open"),this.startHeartBeatCheck()})),jw(this,"onClose",(e=>{this.emit("close"),this.dispose()})),jw(this,"onMessage",(e=>{const t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(this.emit("status",t.serverStatus),void this.emit(t.serverStatus.command,t.serverStatus)):void 0;this.emit("req_".concat(t.requestId),t)})),this.joinInfo=e,this.clientId=t,this.ws=new XI("cross-channel-".concat(this.clientId),n),this.ws.on(FO.RECONNECTING,(()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")})),this.ws.on(FO.CONNECTED,this.onOpen),this.ws.on(FO.ON_MESSAGE,this.onMessage),this.ws.on(FO.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(e){const t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new Ih(((t,n)=>{const r=window.setTimeout((()=>{n(new GO(LT.TIMEOUT,"wait status timeout, status: ".concat(e)))}),5e3);this.once(e,(i=>{window.clearTimeout(r),i.state&&0!==i.state?n(new GO(LT.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)})),this.once("dispose",(()=>{window.clearTimeout(r),n(new GO(LT.WS_ABORT))}))}))}async request(e){if("closed"===this.ws.state)throw new GO(LT.WS_DISCONNECT);"connected"!==this.ws.state&&await(()=>new Ih(((e,t)=>{this.ws.once(FO.CLOSED,(()=>t(new GO(LT.WS_ABORT)))),this.ws.once(FO.CONNECTED,e)})))();const t=this.sendMessage(e),n=new Ih(((e,n)=>{const r=()=>{n(new GO(LT.WS_ABORT))};this.ws.once(FO.RECONNECTING,r),this.ws.once(FO.CLOSED,r),this.once("req_".concat(t),e),IC(3e3).then((()=>{this.removeAllListeners("req_".concat(t)),this.ws.off(FO.RECONNECTING,r),this.ws.off(FO.CLOSED,r),n(new GO(LT.TIMEOUT,"cross channel ws request timeout"))}))})),r=await n;if(!r||200!==r.code)throw new GO(LT.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(r)));return r}async connect(e){this.ws.removeAllListeners(FO.REQUEST_NEW_URLS),this.ws.on(FO.REQUEST_NEW_URLS,(t=>{t(e)})),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval((()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})}),3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Zq extends YT{set state(e){e!==this._state&&(e!==nI.RELAY_STATE_FAILURE&&(this.errorCode=rI.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,t,n,r,i){super(),jw(this,"joinInfo",void 0),jw(this,"sid",void 0),jw(this,"clientId",void 0),jw(this,"cancelToken",qS.CancelToken.source()),jw(this,"workerToken",void 0),jw(this,"requestId",0),jw(this,"signal",void 0),jw(this,"prevChannelMediaConfig",void 0),jw(this,"httpRetryConfig",void 0),jw(this,"_resolution",void 0),jw(this,"_state",nI.RELAY_STATE_IDLE),jw(this,"errorCode",rI.RELAY_OK),jw(this,"onStatus",(e=>{SR.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&this.emit("event",tI.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&this.emit("event",tI.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(this.errorCode=rI.SRC_TOKEN_EXPIRED,this.state=nI.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===e.command&&(this.errorCode=rI.DEST_TOKEN_EXPIRED,this.state=nI.RELAY_STATE_FAILURE))})),jw(this,"onReconnect",(async()=>{SR.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",tI.NETWORK_DISCONNECTED),this.state=nI.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch((e=>{this.state!==nI.RELAY_STATE_IDLE&&(SR.error("auto restart channel media relay failed",e.toString()),this.errorCode=rI.SERVER_CONNECTION_LOST,this.state=nI.RELAY_STATE_FAILURE)}))})),this.joinInfo=e,this.clientId=t,this.sid=kC(),this.signal=new Xq(this.joinInfo,this.clientId,n),this.httpRetryConfig=r,this._resolution=i}async startChannelMediaRelay(e){if(this.state!==nI.RELAY_STATE_IDLE)throw new GO(LT.INVALID_OPERATION);this.state=nI.RELAY_STATE_CONNECTING,await this.connect(),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(e){if(e.data&&e.data.serverResponse&&"SetSourceChannel"===e.data.serverResponse.command)throw new GO(LT.CROSS_CHANNEL_FAILED_JOIN_SRC);if(e.data&&e.data.serverResponse&&"SetDestChannelStatus"===e.serverResponse.command)throw new GO(LT.CROSS_CHANNEL_FAILED_JOIN_DEST);if(e.data&&e.data.serverResponse&&"StartPacketTransfer"===e.serverResponse.command)throw new GO(LT.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);throw e}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==nI.RELAY_STATE_RUNNING)throw new GO(LT.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async setVideoProfile(e){if(this._resolution=e,this.state!==nI.RELAY_STATE_RUNNING)throw new GO(LT.INVALID_OPERATION);const t=this.genMessage(eI.SetVideoProfile);await this.signal.request(t),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),SR.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=nI.RELAY_STATE_IDLE,this.dispose()}dispose(){SR.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=qS.CancelToken.source(),this.state=nI.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await async function(e,t,n){const r=aR("UAP_AP").slice(0,aR("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1?action=uap"):"https://".concat(t,"/api/v1?action=uap"))),i=r.map((r=>function(e,t,n,r){const i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:Date.now(),version:$C,cname:t.cname,uid:t.uid.toString(),requestId:LM,seq:LM};LM+=1;const o={service_name:"tele_channel",json_body:JSON.stringify(i)};return WC((async()=>{const t=await yM(e,{data:o,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==t.code){const e=new GO(LT.UNEXPECTED_RESPONSE,"cross channel ap error, code"+t.code,{retry:!0});throw SR.error(e.toString()),e}const r=JSON.parse(t.json_body);if(200!==r.code){const e=new GO(LT.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(r.code,", reason: ").concat(r.reason));throw SR.error(e.toString()),e}if(!r.servers||0===r.servers.length){const e=new GO(LT.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw SR.error(e.toString()),e}return{vid:r.vid,workerToken:r.workerToken,addressList:(aR("CHANNEL_MEDIA_RELAY_SERVERS")||r.servers).map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(aR("WORKER_DOMAIN"),":").concat(e.wss)))}}),void 0,(e=>!!(e.code!==LT.OPERATION_ABORTED&&e.code!==LT.UNEXPECTED_RESPONSE||e.data&&e.data.retry)),r)}(r,e,t,n)));try{const e=await VM(i);return i.forEach((e=>e.cancel())),e}catch(e){throw e[0]}}(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",tI.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const t=this.genMessage(eI.StopPacketTransfer);await this.signal.request(t),await this.signal.waitStatus("Normal Quit"),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const n=this.genMessage(eI.SetSdkProfile,e);await this.signal.request(n),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const r=this.genMessage(eI.SetSourceChannel,e);await this.signal.request(r),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",tI.PACKET_JOINED_SRC_CHANNEL),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const i=this.genMessage(eI.SetSourceUserId,e);await this.signal.request(i),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const o=this.genMessage(eI.SetDestChannel,e);await this.signal.request(o),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",tI.PACKET_JOINED_DEST_CHANNEL),SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const a=this.genMessage(eI.StartPacketTransfer,e);await this.signal.request(a),this.emit("event",tI.PACKET_SENT_TO_DEST_CHANNEL),this.state=nI.RELAY_STATE_RUNNING,SR.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(e){const t=this.genMessage(eI.UpdateDestChannel,e);await this.signal.request(t),this.emit("event",tI.PACKET_UPDATE_DEST_CHANNEL),SR.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(eI.StopPacketTransfer);await this.signal.request(e),SR.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){const n=[],r=[],i=[];this.requestId+=1;const o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:$C,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.22.0"===o.sdkVersion&&(o.sdkVersion="0.0.1");let a=null,s=null;switch(e){case eI.SetSdkProfile:return o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},o;case eI.SetSourceChannel:if(s=t&&t.getSrcChannelMediaInfo(),!s)throw new GO(LT.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:s.channelName,token:s.token||this.joinInfo.appId},o;case eI.SetSourceUserId:if(s=t&&t.getSrcChannelMediaInfo(),!s)throw new GO(LT.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceUserId",uid:s.uid+""},o;case eI.SetDestChannel:if(a=t&&t.getDestChannelMediaInfo(),!a)throw new GO(LT.UNEXPECTED_ERROR,"can not find dest config");return a.forEach((e=>{n.push(e.channelName),r.push(e.uid+""),i.push(e.token||this.joinInfo.appId)})),o.clientRequest={command:"SetDestChannel",channelName:n,uid:r,token:i},o;case eI.StartPacketTransfer:return o.clientRequest={command:"StartPacketTransfer"},o;case eI.Reconnect:return o.clientRequest={command:"Reconnect"},o;case eI.StopPacketTransfer:return o.clientRequest={command:"StopPacketTransfer"},o;case eI.UpdateDestChannel:if(a=t&&t.getDestChannelMediaInfo(),!a)throw new GO(LT.UNEXPECTED_ERROR,"can not find dest config");return a.forEach((e=>{n.push(e.channelName),r.push(e.uid+""),i.push(e.token||this.joinInfo.appId)})),o.clientRequest={command:"UpdateDestChannel",channelName:n,uid:r,token:i},o;case eI.SetVideoProfile:o.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return o}}const Qq={name:"ChannelMediaRelay",create:function(e){return new Zq(e.joinInfo,e.clientId,e.websocketRetryConfig||HC,e.httpRetryConfig||HC,e.resolution)}};function $q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eW(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$q(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class tW extends YT{constructor(e,t,n,r){super(),jw(this,"spec",void 0),jw(this,"token",void 0),jw(this,"websocket",void 0),jw(this,"pingpongTimer",void 0),jw(this,"reconnectMode","retry"),jw(this,"serviceMode",void 0),jw(this,"reqId",0),jw(this,"commandReqId",0),jw(this,"handleWebSocketOpen",(()=>{this.reconnectMode="retry",this.startPingPong()})),jw(this,"handleWebSocketMessage",(e=>{if(!e.data)return;const t=JSON.parse(e.data);t.requestId?this.emit("@".concat(t.requestId,"-").concat(t.sid),t):(LR.workerEvent(this.spec.sid,{actionType:"status",serverCode:t.code,workerType:this.serviceMode===WO.TRANSCODE?1:2}),this.emit(XO.PUBLISH_STREAM_STATUS,t))})),this.spec=t,this.token=e,this.serviceMode=r,this.websocket=new XI("live-streaming",n),this.websocket.on(FO.CONNECTED,this.handleWebSocketOpen),this.websocket.on(FO.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(FO.REQUEST_NEW_URLS,((e,t)=>{lC(this,XO.REQUEST_NEW_ADDRESS).then(e).catch(t)})),this.websocket.on(FO.RECONNECTING,(()=>{this.websocket.reconnectMode=this.reconnectMode}))}init(e){return this.websocket.init(e)}async request(e,t,n,r){this.reqId+=1,"request"===e&&(this.commandReqId+=1);const i=this.commandReqId,o=this.reqId;if(!o||!this.websocket)throw new GO(LT.UNEXPECTED_ERROR);const a=eW({command:e,sdkVersion:"4.22.0"===$C?"0.0.1":$C,seq:o,requestId:o,allocate:n,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t);if("closed"===this.websocket.state)throw new GO(LT.WS_DISCONNECT);const s=()=>new Ih(((e,t)=>{this.websocket.once(FO.CLOSED,(()=>t(new GO(LT.WS_ABORT)))),this.websocket.once(FO.CONNECTED,e)}));"connected"!==this.websocket.state&&await s(),a.clientRequest&&(a.clientRequest.workerToken=this.token);const c=new Ih(((e,t)=>{const n=()=>{t(new GO(LT.WS_ABORT))};this.websocket.once(FO.RECONNECTING,n),this.websocket.once(FO.CLOSED,n),this.once("@".concat(o,"-").concat(this.spec.sid),(t=>{e(t)}))}));r&&LR.workerEvent(this.spec.sid,eW(eW({},r),{},{requestId:i,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0}));const l=Date.now();this.websocket.sendMessage(a);let d=null;try{d=await c}catch(r){if("closed"===this.websocket.state)throw r;return await s(),await this.request(e,t,n)}return r&&LR.workerEvent(this.spec.sid,eW(eW({},r),{},{requestId:i,actionType:"response",payload:JSON.stringify(d.serverResponse),serverCode:d.code,success:200===d.code,responseTime:Date.now()-l})),200!==d.code&&this.handleResponseError(d),d}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e="4.22.0"===$C?"0.0.1":$C;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case QO.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void SR.warning("live stream response already exists stream");case QO.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case QO.LIVE_STREAM_RESPONSE_BAD_STREAM:case QO.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new GO(LT.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case QO.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command)return;throw new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case QO.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new GO(LT.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case QO.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const t=new GO(LT.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(XO.WARNING,t,e.serverResponse.url)}case QO.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const t=new GO(LT.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(XO.WARNING,t,e.serverResponse.url)}case QO.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case QO.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new GO(LT.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case QO.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const t=new GO(LT.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(XO.WARNING,t,e.serverResponse.url)}case QO.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case QO.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case QO.LIVE_STREAM_RESPONSE_WORKER_LOST:case QO.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command)return;throw new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case QO.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command)return;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case QO.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case QO.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case QO.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case QO.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new GO(LT.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(xC)}),6e3)}}function nW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rW(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nW(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nW(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class iW extends YT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:HC;super(),jw(this,"onLiveStreamWarning",void 0),jw(this,"onLiveStreamError",void 0),jw(this,"spec",void 0),jw(this,"retryTimeout",1e4),jw(this,"connection",void 0),jw(this,"httpRetryConfig",void 0),jw(this,"wsRetryConfig",void 0),jw(this,"streamingTasks",new Map),jw(this,"isStartingStreamingTask",!1),jw(this,"taskMutex",new FC("live-streaming")),jw(this,"cancelToken",qS.CancelToken.source()),jw(this,"transcodingConfig",void 0),jw(this,"uapResponse",void 0),jw(this,"lastTaskId",1),jw(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=n,this.wsRetryConfig=t}async setTranscodingConfig(e){const t=rW(rW({},JO),e);66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(SR.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(t.videoCodecProfile," -> 100")),t.videoCodecProfile=100),t.transcodingUsers||(t.transcodingUsers=t.userConfigs),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map((e=>rW(rW(rW({},zO),e),{},{zOrder:e.zOrder?e.zOrder+1:1})))),function(e){BT(e.width)||MT(e.width,"config.width",0,1e4),BT(e.height)||MT(e.height,"config.height",0,1e4),BT(e.videoBitrate)||MT(e.videoBitrate,"config.videoBitrate",1,1e6),BT(e.videoFrameRate)||MT(e.videoFrameRate,"config.videoFrameRate"),BT(e.lowLatency)||PT(e.lowLatency,"config.lowLatency"),BT(e.audioSampleRate)||DT(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),BT(e.audioBitrate)||MT(e.audioBitrate,"config.audioBitrate",1,128),BT(e.audioChannels)||DT(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),BT(e.videoGop)||MT(e.videoGop,"config.videoGop"),BT(e.videoCodecProfile)||DT(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),BT(e.userCount)||MT(e.userCount,"config.userCount",0,17),BT(e.backgroundColor)||MT(e.backgroundColor,"config.backgroundColor",0,16777215),BT(e.userConfigExtraInfo)||jT(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&!BT(e.transcodingUsers)&&(VT(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach(((e,t)=>{qO(e.uid),BT(e.x)||MT(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),BT(e.y)||MT(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),BT(e.width)||MT(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),BT(e.height)||MT(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),BT(e.zOrder)||MT(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),BT(e.alpha)||MT(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)}))),BT(e.watermark)||YO(e.watermark,"watermark"),BT(e.backgroundImage)||YO(e.backgroundImage,"backgroundImage"),e.images&&!BT(e.images)&&(VT(e.images,"config.images"),e.images.forEach(((e,t)=>{YO(e,"images[".concat(t,"]"))})))}(t);const n=[];t.images&&n.push(...t.images.map((e=>rW(rW(rW({},KO),e),{},{zOrder:255})))),t.backgroundImage&&(n.push(rW(rW(rW({},KO),t.backgroundImage),{},{zOrder:0})),delete t.backgroundImage),t.watermark&&(n.push(rW(rW(rW({},KO),t.watermark),{},{zOrder:255})),delete t.watermark),t.images=n,t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map((e=>rW({},e))),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers);const r=(t.userConfigs||[]).map((e=>"number"==typeof e.uid?Ih.resolve(e.uid):qM(e.uid,this.spec,this.cancelToken.token,this.httpRetryConfig)));if((await Ih.all(r)).forEach(((e,n)=>{t.userConfigs&&t.userConfigs[n]&&(t.userConfigs[n].uid=e)})),this.transcodingConfig=t,this.connection)try{var i;const e=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(yA(i=this.streamingTasks).call(i)).map((e=>e.taskId)).join("#")});SR.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(e.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(e){if(!e.data||!e.data.retry)throw e;e.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach((t=>{SR.warning("[".concat(this.spec.clientId,"] live streaming receive error"),e.toString(),"try to republish",t.url),this.startLiveStreamingTask(t.url,t.mode,e).then((()=>{SR.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(t.url," success"))})).catch((e=>{SR.error("[".concat(this.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),this.onLiveStreamError&&this.onLiveStreamError(t.url,e)}))}))}}async startLiveStreamingTask(e,t,n){if(!this.transcodingConfig&&t===WO.TRANSCODE)throw new GO(LT.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const r={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};SR.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(t));const i=await this.taskMutex.lock();if(!this.connection&&n)return void i();if(this.streamingTasks.get(e)&&!n)return i(),new GO(LT.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(e){throw i(),e}switch(t){case WO.TRANSCODE:r.transcodingConfig=rW({},this.transcodingConfig);case WO.RAW:}this.uapResponse&&this.uapResponse.vid&&(r.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const o=this.lastTaskId++;try{const a=new Ih(((t,r)=>{IC(this.retryTimeout).then((()=>{if(n)return r(n);const t=this.statusError.get(e);return t?(this.statusError.delete(e),r(t)):void 0}))})),s=await Ih.race([this.connection.request("request",{clientRequest:r},!0,{url:e,command:"PublishStream",workerType:t===WO.TRANSCODE?1:2,requestByUser:!n,tid:o.toString()}),a]);this.isStartingStreamingTask=!1,SR.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(s.code)),this.streamingTasks.set(e,{clientRequest:r,mode:t,url:e,taskId:o}),i()}catch(r){if(i(),this.isStartingStreamingTask=!1,!r.data||!r.data.retry||n)throw r;return r.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,r)):await this.startLiveStreamingTask(e,t,r)}}stopLiveStreamingTask(e){return new Ih(((t,n)=>{const r=this.streamingTasks.get(e);if(!r||!this.connection)return new GO(LT.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const i=r.mode;r.abortTask=()=>{SR.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:r.url}},!1,{url:e,command:"UnPublishStream",workerType:i===WO.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then((n=>{SR.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(n.code)),this.streamingTasks.delete(e),0===this.streamingTasks.size&&(this.connection&&this.connection.close(),this.connection=void 0),t()})).catch(n)}))}resetAllTask(){var e;const t=Array.from(yA(e=this.streamingTasks).call(e));this.terminate();for(const e of t)this.startLiveStreamingTask(e.url,e.mode).catch((t=>{this.onLiveStreamError&&this.onLiveStreamError(e.url,t)}))}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=qS.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new GO(LT.UNEXPECTED_ERROR,"live streaming connection has already connected");const t=await lC(this,ZO.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new tW(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(XO.WARNING,((e,t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e))),this.connection.on(XO.PUBLISH_STREAM_STATUS,(e=>this.handlePublishStreamServer(e))),this.connection.on(XO.REQUEST_NEW_ADDRESS,((t,n)=>{if(!this.connection)return n(new GO(LT.UNEXPECTED_ERROR,"can not get new live streaming address list"));lC(this,ZO.REQUEST_WORKER_MANAGER_LIST,e).then((e=>{this.uapResponse=e,t(e.addressList)})).catch(n)})),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){const t=e.serverStatus&&e.serverStatus.url||"empty_url",n=this.streamingTasks.get(t),r=e.reason;switch(e.code){case QO.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case QO.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case QO.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case QO.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const r=new GO(LT.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(n)return SR.error(r.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,r);if(!this.isStartingStreamingTask)return;this.statusError.set(t,r)}case QO.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const e=new GO(LT.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,r);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)}case QO.LIVE_STREAM_RESPONSE_WORKER_LOST:case QO.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var i;if(!this.connection)return;this.connection.tryNextAddress();const t=Array.from(yA(i=this.streamingTasks).call(i));for(const n of t)n.abortTask?n.abortTask():(SR.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",n.url),this.startLiveStreamingTask(n.url,n.mode,new GO(LT.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((()=>{SR.debug("[".concat(this.spec.clientId,"] republish live stream success"),n.url)})).catch((e=>{SR.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(n.url,e)})));return}}}hasUrl(e){return this.streamingTasks.has(e)}}const oW={name:"LiveStreaming",create:function(e){return new iW(e.joinInfo,e.websocketRetryConfig||HC,e.httpRetryConfig||HC)}};function aW(e){let t={};e:for(;!_W(e);){let n=IW(e);switch(n>>>3){case 0:break e;case 1:t.requestId=bW(e,IW(e));break;case 2:t.requestType=IW(e)>>>0;break;case 3:t.scorePorn=RW(e);break;case 4:t.scoreSexy=RW(e);break;case 5:t.scoreNeutral=RW(e);break;case 6:t.requestScene=IW(e)>>>0;break;case 7:t.scene=IW(e)>>>0;break;default:lW(e,7&n)}}return t}function sW(e,t){let n=e.service;void 0!==n&&(AW(t,8),AW(t,n));let r=e.vendor;void 0!==r&&(AW(t,16),AW(t,r));let i=e.token;void 0!==i&&(AW(t,26),EW(t,i));let o=e.callbackUrl;void 0!==o&&(AW(t,34),EW(t,o))}function cW(e){let t=IW(e),n=e.limit;return e.limit=e.offset+t,n}function lW(e,t){switch(t){case 0:for(;128&TW(e););break;case 2:vW(e,IW(e));break;case 5:vW(e,4);break;case 1:vW(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let dW=new Float32Array(1);new Uint8Array(dW.buffer);let uW=new Float64Array(1),pW=new Uint8Array(uW.buffer);function hW(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let fW=[];function mW(){const e=fW.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function gW(e){fW.push(e)}function vW(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function _W(e){return e.offset>=e.limit}function yW(e,t){let n=e.bytes,r=e.offset,i=e.limit,o=r+t;if(o>n.length){let t=new Uint8Array(2*o);t.set(n),e.bytes=t}return e.offset=o,o>i&&(e.limit=o),r}function wW(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function bW(e,t){let n=wW(e,t),r=String.fromCharCode,i=e.bytes,o="",a="";for(let e=0;e<t;e++){let s,c,l,d,u=i[e+n];0==(128&u)?a+=r(u):192==(224&u)?e+1>=t?a+=o:(s=i[e+n+1],128!=(192&s)?a+=o:(d=(31&u)<<6|63&s,d<128?a+=o:(a+=r(d),e++))):224==(240&u)?e+2>=t?a+=o:(s=i[e+n+1],c=i[e+n+2],32896!=(49344&(s|c<<8))?a+=o:(d=(15&u)<<12|(63&s)<<6|63&c,d<2048||d>=55296&&d<=57343?a+=o:(a+=r(d),e+=2))):240==(248&u)?e+3>=t?a+=o:(s=i[e+n+1],c=i[e+n+2],l=i[e+n+3],8421504!=(12632256&(s|c<<8|l<<16))?a+=o:(d=(7&u)<<18|(63&s)<<12|(63&c)<<6|63&l,d<65536||d>1114111?a+=o:(d-=65536,a+=r(55296+(d>>10),56320+(1023&d)),e+=3))):a+=o}return a}function EW(e,t){let n=t.length,r=0;for(let e=0;e<n;e++){let i=t.charCodeAt(e);i>=55296&&i<=56319&&e+1<n&&(i=(i<<10)+t.charCodeAt(++e)-56613888),r+=i<128?1:i<2048?2:i<65536?3:4}AW(e,r);let i=yW(e,r),o=e.bytes;for(let e=0;e<n;e++){let r=t.charCodeAt(e);r>=55296&&r<=56319&&e+1<n&&(r=(r<<10)+t.charCodeAt(++e)-56613888),r<128?o[i++]=r:(r<2048?o[i++]=r>>6&31|192:(r<65536?o[i++]=r>>12&15|224:(o[i++]=r>>18&7|240,o[i++]=r>>12&63|128),o[i++]=r>>6&63|128),o[i++]=63&r|128)}}function SW(e,t){let n=yW(e,t.limit),r=e.bytes,i=t.bytes;for(let e=0,o=t.limit;e<o;e++)r[e+n]=i[e]}function TW(e){return e.bytes[wW(e,1)]}function CW(e,t){let n=yW(e,1);e.bytes[n]=t}function RW(e){let t=wW(e,8),n=e.bytes;return pW[0]=n[t++],pW[1]=n[t++],pW[2]=n[t++],pW[3]=n[t++],pW[4]=n[t++],pW[5]=n[t++],pW[6]=n[t++],pW[7]=n[t++],uW[0]}function OW(e,t){let n=yW(e,8),r=e.bytes;uW[0]=t,r[n++]=pW[0],r[n++]=pW[1],r[n++]=pW[2],r[n++]=pW[3],r[n++]=pW[4],r[n++]=pW[5],r[n++]=pW[6],r[n++]=pW[7]}function IW(e){let t,n=0,r=0;do{t=TW(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function AW(e,t){for(t>>>=0;t>=128;)CW(e,127&t|128),t>>>=7;CW(e,t)}function kW(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=0===i?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10,a=yW(e,o),s=e.bytes;switch(o){case 10:s[a+9]=i>>>7&1;case 9:s[a+8]=9!==o?128|i:127&i;case 8:s[a+7]=8!==o?r>>>21|128:r>>>21&127;case 7:s[a+6]=7!==o?r>>>14|128:r>>>14&127;case 6:s[a+5]=6!==o?r>>>7|128:r>>>7&127;case 5:s[a+4]=5!==o?128|r:127&r;case 4:s[a+3]=4!==o?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==o?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==o?n>>>7|128:n>>>7&127;case 1:s[a]=1!==o?128|n:127&n}}function xW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const LW=new Map([["moderation",1],["supervise",2]]);function NW(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}class PW extends YT{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(SI.CONNECTION_STATE_CHANGE,t,e)}get inspectType(){return this._inspectType}set inspectType(e){var t;this._inspectMode=Ji(t=e.map((e=>LW.get(e)||0))).call(t,((e,t)=>e+t)),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this.qualityRatio}),6e4))}constructor(e){super(),jw(this,"name","AgoraRTCVideoContentInspect"),jw(this,"_connectionState",bI.CONNECTING),jw(this,"_innerConnectionState",void 0),jw(this,"sequence",0),jw(this,"inspectStartTime",void 0),jw(this,"workerManagerConnection",void 0),jw(this,"workerConnection",void 0),jw(this,"workerMessageLengthLimit",void 0),jw(this,"inspectIntervalMinimum",void 0),jw(this,"qualityRatio",void 0),jw(this,"_connectInfo",void 0),jw(this,"_cancelTokenSource",qS.CancelToken.source()),jw(this,"_retryConfig",void 0),jw(this,"wmSequence",0),jw(this,"inspectInterval",void 0),jw(this,"inspectTimer",null),jw(this,"ossFilePrefix",void 0),jw(this,"extraInfo",void 0),jw(this,"_inspectType",void 0),jw(this,"_inspectMode",void 0),jw(this,"_quality",1),jw(this,"qualityTimer",null),jw(this,"_inspectId",void 0),jw(this,"_needWorkUrlOnly",!1),jw(this,"inspectImage",(()=>{if(this.connectionState!==bI.CONNECTED)throw new GO(LT.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval((()=>{this.connectionState===bI.CONNECTED?this.requestToInspectImage():SR.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)}),this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()})),this._inspectId=AC(5,"inspect-"),this.workerMessageLengthLimit=aR("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=aR("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=aR("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new XI("worker-manager-"+this._inspectId,HC),this.on(SI.STATE_CHANGE,((e,t)=>{this._innerConnectionState=e,SR.debug("[".concat(this._inspectId,"] Inspect operation :").concat(EI[e]," ").concat(t||""))})),this.handleWorkerManagerEvents(),this.workerConnection=new XI("worker-"+this._inspectId,HC),this.handleWorkerEvents()}async init(e,t){this.emit(SI.STATE_CHANGE,EI.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new Ih(((r,i)=>{this.on(SI.CONNECTION_STATE_CHANGE,((e,t)=>{t===bI.CONNECTED&&r()})),this.requestAP(e,n,t).then((e=>{this.connectWorkerManager(e)})).catch((e=>{i(e)}))}))}async requestAP(e,t,n){const r=aR("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),i=await function(e,t,n,r){let{appId:i,areaCode:o,cname:a,sid:s,token:c,uid:l}=t;jM++;const d="image_moderation_api",u={service_name:d,json_body:JSON.stringify({appId:i,areaCode:o,cname:a,command:"allocateEdge",requestId:jM,seq:jM,sid:s,token:c,ts:Date.now(),uid:l+""})};let p,h,f=e[0];return WC((async()=>{p=Date.now();const e=await yM(f,{data:u,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(h=Date.now()-p,0!==e.code){const t=new GO(LT.UNEXPECTED_RESPONSE,"image inspect ap error, code"+e.code,{retry:!0,responseTime:h});throw SR.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new GO(LT.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:h});throw SR.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new GO(LT.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:t.code,responseTime:h});throw SR.error(e.toString()),e}const r=aR("VIDEO_INSPECT_WORKER_MANAGER_HOST"),i=aR("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:t.servers.map((e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(r,":").concat(i||n)})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,responseTime:h}}),((t,n)=>(LR.apworkerEvent(s,{success:!0,sc:200,serviceName:d,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:h,serverIp:e[n%e.length]}),!1)),((t,n)=>(LR.apworkerEvent(s,{success:!1,sc:t.data&&t.data.code||200,serviceName:d,responseTime:h,serverIp:e[n%e.length]}),!!(t.code!==LT.OPERATION_ABORTED&&t.code!==LT.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(f=e[(n+1)%e.length],!0))),r)}(r,e,t,n);this.emit(SI.STATE_CHANGE,EI.AP_CONNECTED);const{addressList:o}=i;return this.wmSequence++,o}async connectWorkerManager(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._needWorkUrlOnly=t,this.emit(SI.STATE_CHANGE,EI.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(FO.CONNECTED,(async()=>{this.emit(SI.STATE_CHANGE,EI.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.22.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)})),this.workerManagerConnection.on(FO.CLOSED,(()=>{this._innerConnectionState<EI.GET_WORKER_MANAGER_RESPONSE&&SR.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))})),this.workerManagerConnection.on(FO.FAILED,(()=>{this._innerConnectionState<EI.GET_WORKER_MANAGER_RESPONSE&&SR.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))})),this.workerManagerConnection.on(FO.RECONNECTING,(()=>{this._innerConnectionState<EI.GET_WORKER_MANAGER_RESPONSE&&SR.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))})),this.workerManagerConnection.on(FO.ON_MESSAGE,(async e=>{this.emit(SI.STATE_CHANGE,EI.GET_WORKER_MANAGER_RESPONSE);const t=this.workerManagerConnection.url;this.workerManagerConnection.close();const n=JSON.parse(e.data);if(200!==n.code)throw SR.error("[".concat(this._inspectId,"] Unexpected code ").concat(n.code," from worker manager")),new GO(LT.UNEXPECTED_RESPONSE,"response code of worker is unexpected",n);if(!(n.serverResponse&&n.serverResponse.portWss&&t))throw SR.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(n))),new GO(LT.UNEXPECTED_RESPONSE,"response content of worker is unexpected",n);{const e=aR("VIDEO_INSPECT_WORKER_PORT")||n.serverResponse.portWss,r=t.replace(/:\d+\/?$/,":".concat(e));this.emit(SI.STATE_CHANGE,EI.CONNECT_WORKER,r),this._needWorkUrlOnly?this.emit(SI.REQUEST_NEW_WORKER_URL,r):await this.connectWorker(r)}})),this.workerManagerConnection.on(FO.WILL_RECONNECT,((e,t,n)=>{n(e)})),this.workerManagerConnection.on(FO.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}handleWorkerEvents(){this.workerConnection.on(FO.CONNECTED,(async()=>{this.emit(SI.STATE_CHANGE,EI.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=bI.CONNECTED})),this.workerConnection.on(FO.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const n=function(e){return function(e){let t={};e:for(;!_W(e);){let n=IW(e);switch(n>>>3){case 0:break e;case 1:t.code=IW(e);break;case 2:t.msg=bW(e,IW(e));break;case 3:{let n=cW(e);t.data=aW(e),e.limit=n;break}default:lW(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}(new Uint8Array(e.data));if(aR("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&SR.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(n)),200===n.code){if(Array.isArray(this.inspectType)&&1===this.inspectType.length&&"supervise"===this.inspectType[0])return void this.emit(SI.INSPECT_RESULT,void 0,void 0);if(n.data&&n.data.scorePorn&&n.data.scoreSexy&&n.data.scoreNeutral){var t;const e={porn:n.data.scorePorn,sexy:n.data.scoreSexy,neutral:n.data.scoreNeutral},r=Ji(t=Object.keys(e)).call(t,((t,n)=>e[t]>e[n]?t:n),"porn"),i=Object.keys(e).find((e=>e===r));this.emit(SI.INSPECT_RESULT,i)}else this.emit(SI.INSPECT_RESULT,void 0,new GO(LT.UNEXPECTED_RESPONSE,n.code+"","There is an unexpected data on message"))}else this.emit(SI.INSPECT_RESULT,void 0,new GO(LT.UNEXPECTED_RESPONSE,n.code+"",n.msg))}else SR.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(SI.INSPECT_RESULT,void 0,new GO(LT.UNEXPECTED_RESPONSE,"invalid worker message type"))})),this.workerConnection.on(FO.CLOSED,(()=>{this.connectionState=bI.CLOSED})),this.workerConnection.on(FO.FAILED,(()=>{this.connectionState=bI.CLOSED})),this.workerConnection.on(FO.RECONNECTING,(()=>{this.connectionState=this.connectionState===bI.CONNECTED?bI.RECONNECTING:bI.CONNECTING})),this.workerConnection.on(FO.WILL_RECONNECT,((e,t,n)=>{"recover"===e&&n(e),n("tryNext")})),this.workerConnection.on(FO.REQUEST_NEW_URLS,((e,t)=>{this.workerManagerConnection.close(),this.once(SI.REQUEST_NEW_WORKER_URL,(t=>{e([t])})),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then((e=>{this.connectWorkerManager(e,!0)})).catch((e=>{t(e)}))}))}async requestToInspectImage(){this.sequence++;const e=uC(this,SI.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(SI.INSPECT_RESULT,void 0,new GO(LT.INVALID_OPERATION,"Only the track being played can be inspected"));const n=await this.generateRequestData(e,t);this.workerConnection.sendMessage(n,!0,!0)}else this.emit(SI.INSPECT_RESULT,void 0,new GO(LT.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,t){let{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s}=t;const c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await xN(l,n,r),u=this.sequence+"-"+i+"-"+s+"-"+c+"-"+AC(12,""),p={appId:n,cid:i,cname:r,deviceId:"",elapse:NW(Number(c-this.inspectStartTime)),fileSize:d.byteLength,jpgEncryption:2,height:l.height,width:l.width,jpg:d,networkType:6,osType:7,requestId:u,sdkVersion:"4.22.0",sequence:this.sequence,sid:a,timestamp:NW(c),uid:s,vid:o,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};void 0===this.extraInfo&&delete p.callbackData,void 0===this.ossFilePrefix&&delete p.ossFilePrefix;const h=function(e){let t=mW();return function(e,t){let n=e.appId;void 0!==n&&(AW(t,10),EW(t,n));let r=e.cid;void 0!==r&&(AW(t,16),AW(t,r));let i=e.cname;void 0!==i&&(AW(t,26),EW(t,i));let o=e.deviceId;void 0!==o&&(AW(t,34),EW(t,o));let a=e.elapse;void 0!==a&&(AW(t,40),kW(t,a));let s=e.fileSize;void 0!==s&&(AW(t,48),kW(t,hW(s)));let c=e.height;void 0!==c&&(AW(t,56),kW(t,hW(c)));let l=e.jpg;void 0!==l&&(AW(t,66),AW(t,l.length),function(e,t){let n=yW(e,t.length);e.bytes.set(t,n)}(t,l));let d=e.networkType;void 0!==d&&(AW(t,72),kW(t,hW(d)));let u=e.osType;void 0!==u&&(AW(t,80),kW(t,hW(u)));let p=e.requestId;void 0!==p&&(AW(t,90),EW(t,p));let h=e.sdkVersion;void 0!==h&&(AW(t,98),EW(t,h));let f=e.sequence;void 0!==f&&(AW(t,104),kW(t,hW(f)));let m=e.sid;void 0!==m&&(AW(t,114),EW(t,m));let g=e.timestamp;void 0!==g&&(AW(t,120),kW(t,g));let v=e.uid;void 0!==v&&(AW(t,128),AW(t,v));let _=e.vid;void 0!==_&&(AW(t,136),AW(t,_));let y=e.width;void 0!==y&&(AW(t,144),kW(t,hW(y)));let w=e.service;void 0!==w&&(AW(t,152),AW(t,w));let b=e.callbackData;void 0!==b&&(AW(t,162),EW(t,b));let E=e.jpgEncryption;void 0!==E&&(AW(t,168),AW(t,E));let S=e.requestType;void 0!==S&&(AW(t,176),AW(t,S));let T=e.scorePorn;void 0!==T&&(AW(t,185),OW(t,T));let C=e.scoreSexy;void 0!==C&&(AW(t,193),OW(t,C));let R=e.scoreNeutral;void 0!==R&&(AW(t,201),OW(t,R));let O=e.scene;void 0!==O&&(AW(t,208),AW(t,O));let I=e.ossFilePrefix;void 0!==I&&(AW(t,218),EW(t,I));let A=e.serviceVendor;if(void 0!==A)for(let e of A){AW(t,226);let n=mW();sW(e,n),AW(t,n.limit),SW(t,n),gW(n)}}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}(p);if(h.byteLength<this.workerMessageLengthLimit){if(aR("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xW(Object(n),!0).forEach((function(t){jw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xW(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p);delete e.jpg,SR.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(e))}return h}{const t=this.quality*this.qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=qS.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=bI.CLOSED,this.emit(SI.STATE_CHANGE,EI.CLOSED)}}const DW={name:"ContentInspect",create:function(e){let{config:t}=e;return function(e){if(!e)throw new GO(LT.INVALID_PARAMS,"inspectConfig is necessary.");if(!e.inspectType||!Array.isArray(e.inspectType))throw new GO(LT.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const t=[...new Set(e.inspectType)];t.forEach((e=>{var t;if(!Li(t=["supervise","moderation"]).call(t,e))throw new GO(LT.INVALID_PARAMS,"".concat(e," is not a valid inspect type."))})),e.inspectType=t}if(e&&e.extraInfo&&e.extraInfo.length>1024)throw new GO(LT.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new PW(t)}};oR("PROCESS_ID","process-".concat(AC(8,""),"-").concat(AC(4,""),"-").concat(AC(4,""),"-").concat(AC(4,""),"-").concat(AC(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void SR.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();SR.debug("Loading global parameters from cache",t),Object.keys(t).forEach((e=>{if(Object.prototype.hasOwnProperty.call(iR,e)){const{value:r,expires:i}=t[e];if(i&&i<=n)return;sR[e]=r,iR[e]=r}}))}catch(t){SR.error("Error loading mutableParamsCache: ".concat(e),t.message)}}(),Array.isArray(sR.AREAS)&&sR.AREAS.length>0&&IM(sR.AREAS,!0);const MW=(e,t,n)=>{SR.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),oR(e,t,n)};EV(Qq,!1),EV(oW,!1),EV(PB,!1),EV(DW,!1),EV(Jq,!1);const UW=function(e){const t=new YT,n=e,r={getListeners:t.getListeners.bind(t),on:(e,n)=>(function(e,t){e===CI.SECURITY_POLICY_VIOLATION&&NF(t,!0)}(e,n),t.on.bind(t)(e,n)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return xF(xF({},n),r)}({__TRACK_LIST__:_L,VERSION:$C,BUILD:rR,ESM_BUNDLER:!1,ESM:!0,UMD:!1,DEV:!1,setParameter:MW,getParameter:aR,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;const n=await async function(e){let t;return nL().supportUnifiedPlan?(e.addTransceiver("video",{direction:"recvonly"}),e.addTransceiver("audio",{direction:"recvonly"}),t=(await e.createOffer()).sdp):t=(await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,t}(t);if(!n)return e;t.close(),t=null,e=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ H265/i)&&t.video.push("H265"),e.match(/ opus/i)&&t.audio.push("OPUS"),e.match(/ PCMU/i)&&t.audio.push("PCMU"),e.match(/ PCMA/i)&&t.audio.push("PCMA"),e.match(/ G722/i)&&t.audio.push("G722"),t}(n)}catch(e){throw new GO(LT.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return e},checkSystemRequirements:function(){const e=LR.reportApiInvoke(null,{name:ZT.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:QT.TRACER});let t=!1;try{const e=window.RTCPeerConnection,n=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket;t=!!(e&&n&&r),t&&CT()&&pT(75)&&(new e).close()}catch(e){return SR.error("check system requirement failed: ",e),!1}let n=!1;const r=tT();r.name===ZS.CHROME&&Number(r.version)>=58&&("WebKit"!==$S.engine.name||function(){const e=tT();if(oT()){if(e.os===XS.MAC_OS)return!0;if(e.os===XS.IOS){const e=$S.os.version&&$S.os.version.split(".");if(e&&14===Number(e[0])&&e[1]&&Number(e[1])>=3)return!0;if(e&&Number(e[0])>14)return!0}}return!1}())&&(n=!0),(r.name===ZS.FIREFOX&&Number(r.version)>=56||r.name===ZS.OPERA&&Number(r.version)>=45||r.name===ZS.SAFARI&&Number(r.version)>=11||"WebKit"===r.name&&(dT()||ET())&&r.osVersion&&Number(r.osVersion.split(".")[0])>=11||ST()||tT().name===ZS.QQ)&&(n=!0),SR.debug("checkSystemRequirements, api:",t,"browser",n);const i=t&&n;return e.onSuccess(i),i},getDevices:function(e){return fN.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return fN.getRecordingDevices(e)},getCameras:function(e){return fN.getCamerasDevices(e)},getElectronScreenSources:aN,getPlaybackDevices:function(e){return fN.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const n=LR.reportApiInvoke(null,{name:ZT.CREATE_CLIENT,options:[t],tag:QT.TRACER});try{!function(e){DT(e.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),DT(e.mode,"config.mode",["rtc","live","p2p"]),void 0!==e.audioCodec&&DT(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==e.proxyServer&&jT(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&rC(e.turnServer),void 0!==e.httpRetryConfig&&$T(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&$T(e.websocketRetryConfig)}(t)}catch(e){throw n.onError(e),e}return(mT(16,0,!0)||gT(16,0,!0))&&("vp9"===t.codec&&(t.codec="vp8",SR.debug("browser not support vp9, force use vp8")),oR("UNSUPPORTED_VIDEO_CODEC",["vp9"])),void 0===t.audioCodec&&(t.audioCodec="opus"),n.onSuccess(),new TF(SF(SF({forceWaitGatewayResponse:!0},t),{},{role:Li(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}))},createCameraVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=aR("CAMERA_CAPTURE_CONFIG"),n=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_CAM_VIDEO_TRACK,options:[zL({},e),t]});t&&(e.encoderConfig=t);const r=AN(e),i=AC(8,"track-cam-");let o=null;SR.info("start create camera video track with config",JSON.stringify(e),"trackId",i);try{o=(await dN({video:r},i)).getVideoTracks()[0]||null}catch(e){throw n.onError(e),e}if(!o){const e=new NT(LT.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(e),e.throw(SR)}e.optimizationMode&&uD(i,o,e,hL(e.encoderConfig));const a=new dD(o,e,r,e.scalabiltyMode?mL(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i);return n.onSuccess(a.getTrackId()),SR.info("create camera video success, trackId:",i),a},createCustomVideoTrack:function(e){const t=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),n=new lD(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?mL(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,AC(8,"track-cus-"),[bL.CUSTOM_TRACK]);return t.onSuccess(n.getTrackId()),SR.info("create custom video track success with config",e,"trackId",n.getTrackId()),n},createScreenVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const n=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_SCREEN_VIDEO_TRACK,options:[zL({},e),t]});e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const r=function(e){const t={};e.screenSourceType&&(t.mediaSource=e.screenSourceType),e.extensionId&&aT()&&(t.extensionId=e.extensionId);const{displaySurface:n,selfBrowserSurface:r,surfaceSwitching:i,systemAudio:o}=e;(uT(107)||hT(107)||vT(93))&&(n&&(DT(n,"displaySurface",["browser","window","monitor"]),t.displaySurface=n),r?(DT(r,"selfBrowserSurface",["exclude","include"]),t.selfBrowserSurface=r):t.selfBrowserSurface="include",i&&(DT(i,"surfaceSwitching",["exclude","include"]),t.surfaceSwitching=i)),(uT(105)||hT(105)||vT(91))&&o&&(DT(o,"systemAudio",["exclude","include"]),t.systemAudio=o),e.electronScreenSourceId&&(t.sourceId=e.electronScreenSourceId);const a=e.encoderConfig?fL(e.encoderConfig):null;return t.mandatory={chromeMediaSource:"desktop",maxWidth:a?a.width:void 0,maxHeight:a?a.height:void 0},a&&(a.frameRate&&("number"==typeof a.frameRate?(t.mandatory.maxFrameRate=a.frameRate,t.mandatory.minFrameRate=a.frameRate):(t.mandatory.maxFrameRate=a.frameRate.max||a.frameRate.ideal||a.frameRate.exact||void 0,t.mandatory.minFrameRate=a.frameRate.min||a.frameRate.ideal||a.frameRate.exact||void 0),t.frameRate=a.frameRate),a.width&&(t.width=a.width),a.height&&(t.height=a.height)),t}(e),i=AC(8,"track-scr-v-");let o=null,a=null;const s=nL();if(!s.supportShareAudio&&"enable"===t){const e=new NT(LT.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return n.onError(e),e.throw(SR)}SR.info("start create screen video track with config",e,"withAudio",t,"trackId",i);try{const e=await dN({screen:r,screenAudio:"auto"===t?s.supportShareAudio:"enable"===t},i);o=e.getVideoTracks()[0]||null,a=e.getAudioTracks()[0]||null}catch(e){throw n.onError(e),e}if(!o){const e=new NT(LT.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(e),e.throw(SR)}if(!a&&"enable"===t){o&&o.stop();const e=new NT(LT.SHARE_AUDIO_NOT_ALLOWED);return n.onError(e),e.throw(SR)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(uD(i,o,e,e.encoderConfig&&fL(e.encoderConfig)||void 0),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const c=new lD(o,e.encoderConfig?fL(e.encoderConfig):{},e.scalabiltyMode?mL(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i,[bL.SCREEN_TRACK]);if(!a)return n.onSuccess(c.getTrackId()),SR.info("create screen video track success","video:",c.getTrackId()),c;const l=new wP(a,void 0,AC(8,"track-scr-a-"),!1);return n.onSuccess([c.getTrackId(),l.getTrackId()]),SR.info("create screen video track success","video:",c.getTrackId(),"audio:",l.getTrackId()),[c,l]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=aR("CAMERA_CAPTURE_CONFIG"),r=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_MIC_AND_CAM_TRACKS,options:[e,t,n]});n&&(t.encoderConfig=n);const i=AN(t),o=kN(e),a=AC(8,"track-mic-"),s=AC(8,"track-cam-");let c=null,l=null;SR.info("start create camera video track(".concat(s,") and microphone audio track(").concat(a,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{const e=await dN({audio:o,video:i},"".concat(a,"-").concat(s));c=e.getAudioTracks()[0],l=e.getVideoTracks()[0]}catch(e){throw r.onError(e),e}if(!c||!l){const e=new NT(LT.UNEXPECTED_ERROR,"can not find tracks in media stream");return r.onError(e),e.throw(SR)}t.optimizationMode&&uD(s,l,t,hL(t.encoderConfig));const d=new bP(c,e,o,a),u=new dD(l,t,i,t.scalabiltyMode?mL(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,s);return r.onSuccess([d.getTrackId(),u.getTrackId()]),SR.info("create camera video track(".concat(s,") and microphone audio track(").concat(a,") success")),[d,u]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_MIC_AUDIO_TRACK,options:[e]}),n=kN(e),r=AC(8,"track-mic-");let i=null;SR.info("start create microphone audio track with config",JSON.stringify(e),"trackId",r);try{i=(await dN({audio:n},r)).getAudioTracks()[0]||null}catch(e){throw t.onError(e),e}if(!i){const e=new NT(LT.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw(SR)}const o=new bP(i,e,n,r);return t.onSuccess(o.getTrackId()),SR.info("create microphone audio track success, trackId:",r),o},createCustomAudioTrack:function(e){const t=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),n=new wP(e.mediaStreamTrack,e.encoderConfig?vL(e.encoderConfig):{},AC(8,"track-cus-"),!1);return SR.info("create custom audio track success with config",e,"trackId",n.getTrackId()),t.onSuccess(n.getTrackId()),n},createBufferSourceAudioTrack:async function(e){var t;const{cacheOnlineFile:n,encoderConfig:r}=e;let{source:i}=e;const o={source:i instanceof AudioBuffer?"AudioBuffer":i instanceof File?null!==(t=File.name)&&void 0!==t?t:"File":i,cacheOnlineFile:n,encoderConfig:r},a=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CREATE_BUFFER_AUDIO_TRACK,options:[o]});if(aR("DISABLE_WEBAUDIO"))throw new NT(LT.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const s=AC(8,"track-buf-");SR.info("start create buffer source audio track with config",JSON.stringify(o),"trackId",s);const c=i;if(!(i instanceof AudioBuffer))try{i=await async function(e,t){let n=null;if("string"==typeof e){const t=CP.get(e);if(t)return SR.debug("use cached audio resource: ",e),t;try{n=(await WC((()=>qS.get(e,{responseType:"arraybuffer"})),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new NT(LT.FETCH_AUDIO_FILE_FAILED,e.toString())}}else{const t=new Ih(((t,n)=>{const r=new FileReader;r.onload=e=>{e.target?t(e.target.result):n(new NT(LT.READ_LOCAL_AUDIO_FILE_ERROR))},r.onerror=()=>{n(new NT(LT.READ_LOCAL_AUDIO_FILE_ERROR))},r.readAsArrayBuffer(e)}));n=await t}const r=await function(e){const t=QL();return new Ih(((n,r)=>{t.decodeAudioData(e,(e=>{n(e)}),(e=>{r(new NT(LT.DECODE_AUDIO_FILE_FAILED,e.toString()))}))}))}(n);return"string"==typeof e&&t&&CP.set(e,r),r}(i,n)}catch(e){return a.onError(e),e.throw(SR)}const l=new TP(i),d=new EP(c,l,r?vL(r):{},s);return SR.info("create buffer source audio track success, trackId:",s),a.onSuccess(d.getTrackId()),d},setAppType:function(e){if(SR.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw SR.debug("Invalid appType"),new GO(LT.INVALID_PARAMS,"invalid app type",e);oR("APP_TYPE",Math.floor(e))},setLogLevel:function(e){SR.setLogLevel(e)},enableLogUpload:function(){aR("USE_NEW_LOG")?oR("UPLOAD_LOG",!0):SR.enableLogUpload()},disableLogUpload:function(){aR("USE_NEW_LOG")?oR("UPLOAD_LOG",!1):SR.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new Mj},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof wP||e instanceof RD)){const e=new GO(LT.INVALID_TRACK,"the parameter is not a audio track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof wP?e.getTrackLabel():"remote_track",i=e.getVolumeLevel();let o=i,a=i;const s=Date.now();return new Ih((i=>{const c=setInterval((()=>{const l=e.getVolumeLevel();o=l>o?l:o,a=l<a?l:a;const d=o-a>1e-4,u=Date.now()-s;if(d||u>t){clearInterval(c);const t=d,a={duration:u,deviceLabel:r,maxVolumeLevel:o,result:t};SR.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(a))),n.onSuccess(a),i(t)}}),200)}))},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=LR.reportApiInvoke(null,{tag:QT.TRACER,name:ZT.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof lD||e instanceof CD)){const e=new GO(LT.INVALID_TRACK,"the parameter is not a video track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof lD?e.getTrackLabel():"remote_track",i=e.getMediaStreamTrack(!0),o=document.createElement("video");o.style.width="1px",o.style.height="1px",o.setAttribute("muted",""),o.muted=!0,o.setAttribute("playsinline",""),o.controls=!1,(sT()||oT())&&(o.style.opacity="0.01",o.style.position="fixed",o.style.left="0",o.style.top="0",document.body.appendChild(o)),o.srcObject=new MediaStream([i]),o.play();const a=document.createElement("canvas");a.width=160,a.height=120;let s=0,c=0;try{const e=Date.now();s=await function(e,t,n,r){let i,o=0,a=null;return new Ih(((r,s)=>{setTimeout((()=>{i&&(i(),r(o))}),t),i=tN((()=>{!function(){o>4&&i&&(i(),r(o));const t=n.getContext("2d");if(!t){const e=new GO(LT.UNEXPECTED_ERROR,"can not get canvas 2d context.");return SR.error(e.toString()),void s(e)}t.drawImage(e,0,0,160,120);const c=t.getImageData(0,0,n.width,n.height),l=Math.floor(c.data.length/3);if(a){for(let e=0;e<l;e+=3)if(c.data[e]!==a[e])return o+=1,void(a=c.data);a=c.data}else a=c.data}()}),30)}))}(o,t,a),c=Date.now()-e}catch(e){throw n.onError(e),e}PV===ZS.SAFARI&&(o.pause(),o.remove()),o.srcObject=null;const l=s>4,d={duration:c,changedPicNum:s,deviceLabel:r,result:l};return SR.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(d))),n.onSuccess(d),l},setArea:IM,audioElementPlayCenter:wN,resumeAudioContext:function(){wN.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){AF.processExternalMediaAEC(e)},registerExtensions:function(e){const t=aR("PLUGIN_INFO")||[];e.forEach((e=>{"name"in e&&!Li(t).call(t,e.name)&&t.push(e.name);const n=e;n.__registered__=!0,n.logger.hookLog=SR.extLog,n.reporter.hookApiInvoke=LR.extApiInvoke,n.parameters&&Object.keys(n.parameters).forEach((e=>{n.parameters[e]=aR(e)}))})),MW("PLUGIN_INFO",t)},ChannelMediaRelayError:rI,ChannelMediaRelayEvent:tI,ChannelMediaRelayState:nI,RemoteStreamFallbackType:TL,RemoteStreamType:SL,ConnectionDisconnectedReason:tC,AudienceLatencyLevelType:eC,AREAS:cI,preload:async function(e,t,n,r){return KV(e,t,n,r)}});function jW(e){return jW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jW(e)}function VW(){VW=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==jW(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function BW(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function FW(e,t,n,r){return GW.apply(this,arguments)}function GW(){return GW=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){BW(o,r,i,a,s,"next",e)}function s(e){BW(o,r,i,a,s,"throw",e)}a(void 0)}))}}(VW().mark((function e(t,n,r,i){var o,a;return VW().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("video"!==r){e.next=5;break}return o=this.videoInputDevices.find((function(e){return e.label===i})),e.next=4,this.localVideoTrack.setDevice(o.deviceId);case 4:(o.label.toLowerCase().includes("back")||o.label.toLowerCase().includes("rear"))&&(n.querySelector("#localVideoContainer video").style.transform="rotateY(0deg)");case 5:if("audio"!==r){e.next=9;break}return a=this.audioInputDevices.find((function(e){return e.label===i})),e.next=9,this.localAudioTrack.setDevice(a.deviceId);case 9:case"end":return e.stop()}}),e,this)}))),GW.apply(this,arguments)}Object.defineProperties(UW,{onAudioAutoplayFailed:{get:()=>gN.onAudioAutoplayFailed,set:e=>{gN.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>gN.onAutoplayFailed,set:e=>{gN.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>UW._onSecurityPolicyViolation,set(e){UW._onSecurityPolicyViolation=e,NF(e)}},__CLIENT_LIST__:{get:()=>aR("SHOW_GLOBAL_CLIENT_LIST")?MR:[]}}),fN.on(jL.CAMERA_DEVICE_CHANGED,(e=>{SR.info("camera device changed",JSON.stringify(e)),UW.onCameraChanged&&UW.onCameraChanged(e),UW.safeEmit(CI.CAMERA_CHANGED,e)})),fN.on(jL.RECORDING_DEVICE_CHANGED,(e=>{SR.info("microphone device changed",JSON.stringify(e)),UW.onMicrophoneChanged&&UW.onMicrophoneChanged(e),UW.safeEmit(CI.MICROPHONE_CHANGED,e)})),fN.on(jL.PLAYOUT_DEVICE_CHANGED,(e=>{SR.debug("playout device changed",JSON.stringify(e)),UW.onPlaybackDeviceChanged&&UW.onPlaybackDeviceChanged(e),UW.safeEmit(CI.PLAYBACK_DEVICE_CHANGED,e)})),wN.onAutoplayFailed=()=>{SR.info("detect audio element autoplay failed"),gN.onAudioAutoplayFailed&&gN.onAudioAutoplayFailed()},ZL.on("autoplay-failed",(()=>{SR.info("detect webaudio autoplay failed"),gN.onAudioAutoplayFailed&&gN.onAudioAutoplayFailed(),UW.safeEmit(CI.AUTOPLAY_FAILED)})),ZL.on(oL.STATE_CHANGE,((e,t)=>{SR.info("audio context state changed: ".concat(t," => ").concat(e)),UW.onAudioContextStateChanged&&UW.onAudioContextStateChanged(e,t),UW.safeEmit(CI.AUDIO_CONTEXT_STATE_CHANGED,e,t)})),hC.on(cC.NETWORK_STATE_CHANGE,((e,t)=>{SR.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))})),window&&(window.__ARTC__=UW);var HW=function(e,t,n){var r=t.querySelector("#inputDeviceSettings");if("open"===n){var i=t.querySelector(".saleassist-video-call-more-options-control");r.style.display="flex",i.classList.remove("more-options-control-active")}"close"===n&&(r.style.display="none")};function qW(e){return qW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qW(e)}function WW(){WW=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==qW(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function zW(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function KW(e,t,n){return YW.apply(this,arguments)}function YW(){return YW=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){zW(o,r,i,a,s,"next",e)}function s(e){zW(o,r,i,a,s,"throw",e)}a(void 0)}))}}(WW().mark((function e(t,n,r){var i,o=this;return WW().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.videoInputDevices.length>1)){e.next=5;break}return this.videoInputDevices[0].label===this.localVideoTrack._deviceName?this.videoInputDevices.map((function(e,t){(e.label.toLowerCase().includes("back")||e.label.toLowerCase().includes("rear"))&&(i=o.videoInputDevices[t],r.selectedIndex=t)})):(i=this.videoInputDevices[0],r.selectedIndex=0),e.next=4,this.localVideoTrack.setDevice(i.deviceId);case 4:(i.label.toLowerCase().includes("back")||i.label.toLowerCase().includes("rear"))&&(n.querySelector("#localVideoContainer video").style.transform="rotateY(0deg)");case 5:case"end":return e.stop()}}),e,this)}))),YW.apply(this,arguments)}var JW=__webpack_require__(6240);function XW(e,t){var n=e.querySelector("#videoCallContainer"),r=t.split("~"),i=r[0]||"",o=r[1]||"";"NotAllowedError"===t&&(i="Your camera and microphone are blocked",o='Meet requires access to your device\'s camera and microphone. </br> \n                <ul>\n                  <li>\n                    <span class="steps">Step 1</span>\n                    <span class="item">\n                      Click on Site Settings Icon \n                      <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 7h-9"></path><path d="M14 17H5"></path><circle cx="17" cy="17" r="3"></circle><circle cx="7" cy="7" r="3"></circle></svg> or \n                      <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>\n                      at the starting of the address bar.\n                    </span>\n                  </li>\n                  \n                  <li>\n                    <span class="steps">Step 2</span>\n                    <span class="item"><span class="mobile-view">Click on Permissions, then </span>Allow Camera and Microphone.</span>\n                  </li>\n\n                  <li>\n                    <span class="steps">Step 3</span>\n                    <span class="item">Reload the Page.</span>\n                  </li>\n                </ul>'),"NotReadableError"===t&&(i="Something is worng with your camera or microphone",o="Meet is unable to access your camera or microphone, but you will be still able to join the call.");var a=document.createElement("div");a.innerHTML=JW({headerText:i,bodyText:o}),n.appendChild(a),a.querySelector(".sa-device-access-error-dismiss-btn").addEventListener("click",(function(){n.removeChild(a)}))}function ZW(e){return ZW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZW(e)}function QW(){QW=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==ZW(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function $W(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ez(e,t,n){return tz.apply(this,arguments)}function tz(){return tz=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){$W(o,r,i,a,s,"next",e)}function s(e){$W(o,r,i,a,s,"throw",e)}a(void 0)}))}}(QW().mark((function e(t,n,r){var i,o,a,s;return QW().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"video_call"!==this.message_type){e.next=11;break}return e.next=4,r.getDevices();case 4:return e.next=6,r.getCameras();case 6:this.videoInputDevices=e.sent,i=n.querySelector("#videoInputDeviceSetting"),o="",this.videoInputDevices.map((function(e){o+='<option value="'.concat(e.label,'">').concat(e.label.length>24?e.label.slice(0,21)+"...":e.label,"</option>")})),i.innerHTML+="<select>".concat(o,"</select>");case 11:return this.videoInputDevices&&this.videoInputDevices.length>1&&(n.querySelector("#flipCamera").style.display="flex"),e.next=14,r.getMicrophones();case 14:this.audioInputDevices=e.sent,a=n.querySelector("#audioInputDeviceSetting"),s="",this.audioInputDevices.map((function(e){s+='<option value="'.concat(e.label,'">').concat(e.label.length>24?e.label.slice(0,21)+"...":e.label,"</option>")})),a.innerHTML+="<select>".concat(s,"</select>"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),XW(n,"Devices Error~"+e.t0.message),console.error("Devices Error:",e.t0.message);case 25:case"end":return e.stop()}}),e,this,[[0,21]])}))),tz.apply(this,arguments)}function nz(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rz(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var iz=function(e){if(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e)){var t=nz(e.split("@"),2),n=t[0];t[1];return n}if(/^\+?\d{1,3}[-.\s]?\d{1,14}$/.test(e)){var r=e.match(/\d/g).slice(-4).join("");return e.replace(r,"***")}return e};function oz(e,t,n){var r=t.querySelector("#videoCallMainScreen"),i=t.querySelector("#videoCallMainScreen div"),o=t.querySelectorAll("#videoCallVideoTiles .video-call-wrapper"),a=t.querySelector("#videoCallVideoTiles");n.id!==i.id&&o.forEach((function(e){e.id===n.id&&(a.appendChild(i),r.appendChild(e))}))}function az(e,t,n){var r=t.querySelector("#videoCallVideoTiles");n.classList.toggle("transform-videoCallVideoTilesToggleBtn"),r.classList.toggle("video-call-video-tiles-transition-expand")}function sz(e){e.setParameter("AUDIO_VOLUME_INDICATION_INTERVAL",200),this.client.enableAudioVolumeIndicator(),this.client.on("volume-indicator",(function(e){e.forEach((function(e){var t=document.querySelector(".active-speaker-".concat(e.uid," .volume-indicator")),n=document.querySelector(".active-speaker-".concat(e.uid)),r=n.querySelector(".speaking-wave-effect");e.level>=60?(cz(e.level,t,!0),n.style.borderColor="#1a73e8",r.style.width="200px",r.style.height="200px"):(cz(e.level,t,!1),n.style.borderColor="#7d7d7d",r.style.width="0px",r.style.height="0px")}))}))}function cz(e,t,n){var r=n?e/100*40:15,i=n?e/100*60:15;t.querySelector("#bar1").style.height=r+"%",t.querySelector("#bar2").style.height=i+"%",t.querySelector("#bar3").style.height=r+"%"}function lz(e){return lz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lz(e)}function dz(e){return function(e){if(Array.isArray(e))return hz(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||pz(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uz(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||pz(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pz(e,t){if(e){if("string"==typeof e)return hz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hz(e,t):void 0}}function hz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fz(Object(n),!0).forEach((function(t){gz(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fz(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gz(e,t,n){return(t=_z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_z(r.key),r)}}function _z(e){var t=function(e,t){if("object"!==lz(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==lz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===lz(t)?t:String(t)}var yz="[MessageService]",wz=0,bz=1,Ez=2,Sz="user.transcription",Tz="assistant.transcription",Cz="message.interrupt",Rz={TEXT:"text",WORD:"word",AUTO:"auto"};var Oz=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._messageCache={},this._messageCacheTimeout=3e5,this._legacyMode=!1,this._mode=Rz.AUTO,this._queue=[],this._interval=200,this._intervalRef=null,this._pts=0,this._lastPoppedQueueItem=null,this._isRunning=!1,this._rtcEngine=t,this.messageList=[],this.onMessageListUpdate=null!=r?r:null,this._listenRtcEvents(),this.run({legacyMode:!1}),this.setMode(null!=n?n:Rz.AUTO)}var t,n,r;return t=e,n=[{key:"_listenRtcEvents",value:function(){var e=this;this._rtcEngine&&(this._rtcEngine.on("audio-metadata",(function(t){var n=Number(new DataView(t.buffer).getBigUint64(0,!0));e.setPts(n)})),this._rtcEngine.on("stream-message",(function(t,n){e.handleStreamMessage(n)})))}},{key:"run",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._isRunning=!0,this._legacyMode=null!==(e=null==t?void 0:t.legacyMode)&&void 0!==e&&e}},{key:"setupInterval",value:function(){this._isRunning?(this._intervalRef&&(clearInterval(this._intervalRef),this._intervalRef=null),this._intervalRef=setInterval(this._handleQueue.bind(this),this._interval)):console.error(yz,"Message service is not running")}},{key:"teardownInterval",value:function(){this._intervalRef&&(clearInterval(this._intervalRef),this._intervalRef=null)}},{key:"setPts",value:function(e){this._pts<e&&(this._pts=e)}},{key:"handleStreamMessage",value:function(e){if(this._isRunning){var t=this.streamMessage2Chunk(e);this._legacyMode?this.handleChunk(t,this.handleMessageLegacy.bind(this)):this.handleChunk(t,this.handleMessage.bind(this))}else console.log(yz,"Message service is not running")}},{key:"handleMessageLegacy",value:function(e){var t;if((null==e?void 0:e.text)&&(null===(t=e.text)||void 0===t?void 0:t.trim().length)>0){var n=this.messageList.findLast((function(t){return t.uid===e.stream_id&&t.status===bz})),r=this.messageList.findLast((function(t){return t.uid===e.stream_id&&t.status===wz}));if(n){if(n._time>=e.text_ts)return;r?(r._time=e.text_ts,r.text=e.text,r.status=e.is_final?bz:wz):this._appendChatHistory({uid:e.stream_id,turn_id:e.text_ts,_time:e.text_ts,text:e.text,status:e.is_final?bz:wz,metadata:null})}else r?(r._time=e.text_ts,r.text=e.text,r.status=e.is_final?bz:wz):this._appendChatHistory({uid:e.stream_id,turn_id:e.text_ts,_time:e.text_ts,text:e.text,status:e.is_final?bz:wz,metadata:null});this.messageList.sort((function(e,t){return e._time-t._time})),this._mutateChatHistory()}}},{key:"handleMessage",value:function(e){var t=e.object===Tz,n=e.object===Sz,r=e.object===Cz;(t||n||r)&&(t&&this._mode===Rz.AUTO&&(e.words?(this.setupInterval(),this.setMode(Rz.WORD)):this.setMode(Rz.TEXT)),t&&this._mode===Rz.WORD?this.handleWordAgentMessage(e):t&&this._mode===Rz.TEXT||n?this.handleTextMessage(e):r?this.handleMessageInterrupt(e):console.error(yz,"Unknown mode",e))}},{key:"handleTextMessage",value:function(e){var t=e.turn_id,n=e.text||"",r=e.stream_id,i=bz,o=this.messageList.find((function(e){return e.turn_id===t&&e.uid===r}));o?(o.text=n,o.status=i,o.metadata=e):this._appendChatHistory({turn_id:t,uid:r,_time:(new Date).getTime(),text:n,status:i,metadata:e}),this._mutateChatHistory()}},{key:"handleMessageInterrupt",value:function(e){var t=e.turn_id,n=e.start_ms;this._interruptQueue({turn_id:t,start_ms:n}),this._mutateChatHistory()}},{key:"handleWordAgentMessage",value:function(e){var t;if(void 0!==e.turn_status){var n=e.turn_id,r=e.text||"",i=e.words||[],o=e.stream_id,a=null===(t=this._lastPoppedQueueItem)||void 0===t?void 0:t.turn_id;a&&0!==n&&n<=a||this._pushToQueue({turn_id:n,words:i,text:r,status:e.turn_status,stream_id:o})}}},{key:"sortWordsWithStatus",value:function(e,t){if(0===e.length)return e;var n=e.map((function(e){return mz(mz({},e),{},{word_status:wz})})).sort((function(e,t){return e.start_ms-t.start_ms})).reduce((function(e,t){return e.find((function(e){return e.start_ms===t.start_ms}))||e.push(t),e}),[]);return t!==wz&&(n[n.length-1].word_status=t),n}},{key:"setMode",value:function(e){this._mode===Rz.AUTO?e!==Rz.AUTO?this._mode=e:console.log(yz,"Unknown mode should not be set again","current mode:",this._mode):console.log(yz,"Mode should only be set once, but it is set again","current mode:",this._mode)}},{key:"cleanMessageCache",value:function(){this._messageCache={}}},{key:"cleanup",value:function(){console.log(yz,"Cleanup message service"),this._isRunning=!1,this._legacyMode=!1,this.cleanMessageCache(),this.teardownInterval(),this._queue=[],this._lastPoppedQueueItem=null,this._pts=0,this.messageList=[],this._mode=Rz.AUTO}},{key:"streamMessage2Chunk",value:function(e){return function(e){return(new TextDecoder).decode(e)}(e)}},{key:"handleChunk",value:function(e,t){var n=this;try{var r,i=uz(e.split("|"),4),o=i[0],a=i[1],s=i[2],c=i[3],l={message_id:o,part_idx:parseInt(a,10),part_sum:"???"===s?-1:parseInt(s,10),content:c};if(-1===l.part_sum)return;if(this._messageCache[l.message_id]||(this._messageCache[l.message_id]=[],setTimeout((function(){n._messageCache[l.message_id]&&n._messageCache[l.message_id].length<l.part_sum&&delete n._messageCache[l.message_id]}),this._messageCacheTimeout)),null!==(r=this._messageCache[l.message_id])&&void 0!==r&&r.find((function(e){return e.part_idx===l.part_idx}))||this._messageCache[l.message_id].push(l),this._messageCache[l.message_id].sort((function(e,t){return e.part_idx-t.part_idx})),this._messageCache[l.message_id].length===l.part_sum){var d=this._messageCache[l.message_id].map((function(e){return e.content})).join(""),u=JSON.parse(atob(d));null==t||t(u),delete this._messageCache[l.message_id]}return}catch(e){return void console.error(yz,"handleChunk error",e)}}},{key:"_pushToQueue",value:function(e){var t=this._queue.find((function(t){return t.turn_id===e.turn_id})),n=this._queue.reduce((function(e,t){return Math.max(e,t.turn_id)}),0);if(t)t.text=e.text,t.words=this.sortWordsWithStatus([].concat(dz(t.words),dz(e.words)),e.status),t.status!==wz&&e.status===wz||(t.status=e.status);else{if(e.turn_id<n)return;var r={turn_id:e.turn_id,text:e.text,words:this.sortWordsWithStatus(e.words,e.status),status:e.status,stream_id:e.stream_id};this._queue.push(r)}}},{key:"_handleQueue",value:function(){var e=this._queue.length;if(0!==e){var t=this._pts;if(1===e){var n=this._queue[0];return this._handleTurnObj(n,t),void this._mutateChatHistory()}if(e>2&&console.error(yz,"Queue length is greater than 2, but it should not happen"),e>1){this._queue=this._queue.sort((function(e,t){return e.turn_id-t.turn_id}));var r=this._queue[this._queue.length-1],i=this._queue[this._queue.length-2];if(r.words[0].start_ms>t)return this._handleTurnObj(i,t),void this._mutateChatHistory();var o=this.messageList.find((function(e){return e.turn_id===i.turn_id&&e.uid===i.stream_id}));return o?(o.status=Ez,this._lastPoppedQueueItem=this._queue.shift(),this._handleTurnObj(r,t),void this._mutateChatHistory()):void console.log(yz,"No corresponding messageList item found",i)}}}},{key:"_interruptQueue",value:function(e){var t=e.turn_id,n=e.start_ms,r=this._queue.find((function(e){return e.turn_id===t}));if(r){r.status=Ez;var i=r.words.filter((function(e){return e.start_ms<=n})),o=r.words.filter((function(e){return e.start_ms>n}));0===i.length?r.words.forEach((function(e){e.word_status=Ez})):(i[i.length-1].word_status=Ez,o.forEach((function(e){e.word_status=Ez})),r.words=[].concat(dz(i),dz(o)))}}},{key:"_handleTurnObj",value:function(e,t){var n,r,i=this.messageList.find((function(t){return t.turn_id===e.turn_id&&t.uid===e.stream_id}));i||(i={turn_id:e.turn_id,uid:e.stream_id,_time:(new Date).getTime(),text:"",status:e.status,metadata:e},this._appendChatHistory(i)),i._time=(new Date).getTime(),i.metadata=e,e.status===Ez&&(i.status=Ez);var o,a=[],s=[],c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=pz(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(e.words);try{for(c.s();!(o=c.n()).done;){var l=o.value;l.start_ms<=t?a.push(l):s.push(l)}}catch(e){c.e(e)}finally{c.f()}var d=0===s.length,u=(null===(n=a[a.length-1])||void 0===n?void 0:n.word_status)!==wz;if(d&&u)return i.text=e.text,i.status=e.status,void(this._lastPoppedQueueItem=this._queue.shift());var p=a.filter((function(e){return e.word_status===wz})).map((function(e){return e.word})).join("");i.text=p,(null===(r=a[a.length-1])||void 0===r?void 0:r.word_status)===Ez&&(this._lastPoppedQueueItem=this._queue.shift())}},{key:"_appendChatHistory",value:function(e){this.messageList.push(e)}},{key:"_mutateChatHistory",value:function(){var e;null===(e=this.onMessageListUpdate)||void 0===e||e.call(this,this.messageList)}}],n&&vz(t.prototype,n),r&&vz(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Iz=new WeakMap;function Az(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e)if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var t=Iz.get(e);null!=t&&t.handleInteraction&&t.handleInteraction()}else if(!Iz.has(e)){var n,r=function(){var t=e.querySelectorAll("#videoCallContainer #videoCallVideoTiles .video-call-wrapper");t.length>1&&t.forEach((function(e){return e.classList.add("transform-video-tile")}))},i=function(){clearTimeout(n),n=setTimeout(r,5e3)},o=function(){e.querySelectorAll("#videoCallContainer #videoCallVideoTiles .video-call-wrapper").forEach((function(e){return e.classList.remove("transform-video-tile")})),i()},a=e.querySelector("#videoCallContainer #videoContainer");a.addEventListener("mouseover",o),a.addEventListener("mouseout",i),a.addEventListener("touchstart",o),a.addEventListener("touchend",i),Iz.set(e,{handleInteraction:o,startAddClassTimer:i}),i()}}function kz(e){return kz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kz(e)}function xz(){xz=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==kz(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function Lz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lz(Object(n),!0).forEach((function(t){Pz(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lz(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pz(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==kz(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==kz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===kz(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dz(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Mz(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Dz(o,r,i,a,s,"next",e)}function s(e){Dz(o,r,i,a,s,"throw",e)}a(void 0)}))}}var Uz=__webpack_require__(5494),jz=__webpack_require__(8958),Vz=__webpack_require__(2025),Bz=__webpack_require__(7565);function Fz(e,t,n){return Gz.apply(this,arguments)}function Gz(){return Gz=Mz(xz().mark((function e(t,n,r){var i,a,s,c,d,u,p,h,f,m,g=this;return xz().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=function(){g.client.on("user-joined",function(){var e=Mz(xz().mark((function e(t){var r,i,a,s,c,d,u,p,h,f,m,v,_,y,w,b,E,S,T,C;return xz().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(5!==t.uid.toString().length){e.next=2;break}return e.abrupt("return");case 2:return r=!1,e.next=5,l.get(o.url.ACTIONS,"/meeting/".concat(g.copy_url_id));case 5:if(i=e.sent,"live_streaming"!==g.is_streaming||g.streaming_moderators.includes(i.uid_map[t.uid].user_display_name)){e.next=8;break}return e.abrupt("return");case 8:for(a in g.remoteUsers)a in i.uid_map&&i.uid_map[a].user_display_name.includes("screen-share")&&(r=!0);s=iz(i.uid_map[t.uid]?i.uid_map[t.uid].user_display_name:"User-".concat(t.uid)),g.remoteUsers[t.uid]=Nz(Nz({},t),{},{user_display_name:s}),n.querySelector("#remoteVideo_".concat(t.uid))||((c=document.createElement("div")).id="remoteVideo_".concat(t.uid),c.className="video-call-wrapper active-speaker-".concat(t.uid," ").concat(s.includes("screen-share")?"screen-share":""),c.setAttribute("user-name",s[0].toUpperCase()),c.addEventListener("click",(function(){oz(0,n,c)})),(d=document.createElement("span")).id="remoteUserPlaceholder",(u=document.createElement("span")).className="speaking-wave-effect",(p=document.createElement("span")).className="user-display-name",p.innerHTML=s[0].toUpperCase(),d.appendChild(u),d.appendChild(p),(h=document.createElement("span")).className="mic-status-indicator",h.setAttribute("user-name",s),h.innerHTML=jz(),(f=document.createElement("span")).className="network-quality-info",f.innerHTML=Bz(),(m=document.createElement("span")).className="username-indicator",m.innerHTML=s,(v=document.createElement("span")).className="volume-indicator",(_=document.createElement("span")).id="bar1",_.className="bars",(y=document.createElement("span")).id="bar2",y.className="bars",(w=document.createElement("span")).id="bar3",w.className="bars",v.appendChild(_),v.appendChild(y),v.appendChild(w),s.includes("screen-share")&&((b=document.createElement("div")).style.cssText="display: flex; flex-direction: column; place-content: center; place-items: center; gap: 20px",E=document.createElement("span"),(S=document.createElement("div")).style.cssText="position: relative; min-width: 90px; min-height: 90px",(T=document.createElement("div")).style.cssText="width: 100%; height: 100%; border: 5px solid #000; border-top: 5px solid #fff; border-radius: 50%; animation: screen-share-spinner 1s linear infinite",(C=document.createElement("div")).innerHTML='<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M21 3H3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h18c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 16.02H3V4.98h18v14.04zM10 12H8l4-4 4 4h-2v4h-4v-4z"></path></svg>',C.style.cssText="position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); font-size: 40px; display: flex; place-content: center; place-items: center",E.innerText="".concat(s.replace("screen-share-","")," (Presenting)"),E.style.textWrap="nowrap",E.style.fontSize="18px",S.appendChild(T),S.appendChild(C),b.appendChild(S),b.appendChild(E),d.appendChild(b),h.querySelector("svg").style.display="none",h.style.right="85px",f.style.display="none",u.style.display="none",p.style.display="none",v.style.display="none"),c.appendChild(d),c.appendChild(h),c.appendChild(f),c.appendChild(m),c.appendChild(v),("live_streaming"===g.is_streaming?n.querySelector("#videoCallMainScreen"):n.querySelector("#videoCallVideoTiles")).appendChild(c),r||oz(0,n,c),Az(n,!0),new Audio("https://client-static.saleassist.ai/Call_join.mp3").play().catch((function(e){return console.error("Audio play failed:",e)})));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g.client.on("user-published",function(){var e=Mz(xz().mark((function e(t,r){var i,o,a,s;return xz().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.client.subscribe(t,r);case 2:"video"===r&&(i=setInterval((function(){var e;n.querySelector("#remoteVideo_".concat(t.uid))&&(null===(e=t.videoTrack)||void 0===e||e.play("remoteVideo_".concat(t.uid)),clearInterval(i))}),500)),"audio"===r&&((null===(o=g.screen_creds)||void 0===o||null===(a=o.widget_creds)||void 0===a?void 0:a.uid)!==t.uid&&t.audioTrack.play(),s=setInterval((function(){var e=n.querySelector("#remoteVideo_".concat(t.uid," .mic-status-indicator"));e&&(e.innerHTML=Uz(),clearInterval(s))}),500));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),g.client.on("user-unpublished",function(){var e=Mz(xz().mark((function e(t,r){var i;return xz().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"audio"===r&&(i=n.querySelector("#remoteVideo_".concat(t.uid," .mic-status-indicator")))&&(i.innerHTML=jz());case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),g.client.on("user-left",(function(e){var t=e.uid;delete g.remoteUsers[t];var r=n.querySelector("#remoteVideo_".concat(e.uid));if(r){r.remove();var i=n.querySelectorAll("#videoCallVideoTiles .video-call-wrapper"),o=n.querySelectorAll("#videoCallMainScreen .video-call-wrapper"),a=n.querySelector("#videoCallMainScreen");i.length>0&&0===o.length&&a.appendChild(i[0]),Az(n,!0)}}))},e.next=4,this.client.enableDualStream();case 4:return a(),(D()[t].is_enable_ai_audio_call_agent_all||D()[t].is_enable_ai_audio_call_agent_offline)&&(this.messageEngine=new Oz(this.client,Rz.TEXT,(function(e){window.postMessage({type:"captions",chatCaptionHistory:e})}))),e.next=8,this.client.join(this.agoraAppId,this.agoraChannelName,this.agoraToken,this.agoraUID);case 8:if("live_streaming"!==this.is_streaming){e.next=11;break}return sz.call(this,r),e.abrupt("return");case 11:return e.next=13,r.createMicrophoneAudioTrack({encoderConfig:"high_quality_stereo"});case 13:if(this.localAudioTrack=e.sent,!((null===(i=this.videoInputDevices)||void 0===i?void 0:i.length)>0)){e.next=19;break}if("video_call"!==this.message_type){e.next=19;break}return e.next=18,r.createCameraVideoTrack({facingMode:"user",optimizationMode:"motion"});case 18:this.localVideoTrack=e.sent;case 19:if(this.client.setStreamFallbackOption(this.agoraUID,1),"video_call"!==this.message_type){e.next=33;break}if(!this.localAudioTrack||!this.localVideoTrack){e.next=29;break}return this.localVideoTrack.play("localVideoContainer"),e.next=25,this.localVideoTrack.setMuted(!0);case 25:return e.next=27,this.client.publish([this.localAudioTrack,this.localVideoTrack]);case 27:e.next=31;break;case 29:return e.next=31,this.client.publish([this.localAudioTrack]);case 31:e.next=37;break;case 33:if("audio_call"!==this.message_type){e.next=37;break}if(!this.localAudioTrack){e.next=37;break}return e.next=37,this.client.publish([this.localAudioTrack]);case 37:(s=n.querySelector("#localVideoContainer")).addEventListener("click",(function(){oz(0,n,s)})),(c=n.querySelector(".videoCallVideoTilesToggleBtn")).addEventListener("click",(function(){az(0,n,c)})),sz.call(this,r),e.next=64;break;case 44:if(e.prev=44,e.t0=e.catch(0),!e.t0.message.includes("NotReadableError")){e.next=63;break}if(!this.localAudioTrack||"object"!==kz(this.localAudioTrack)){e.next=52;break}return e.next=50,this.client.publish([this.localAudioTrack]);case 50:return e.next=52,this.localAudioTrack.setMuted(!0);case 52:d=n.querySelector("#toggleCamera"),u=n.querySelector("#toggleAudio"),p=n.querySelector("#localVideoContainer .mic-status-indicator"),this.localVideoTrackMuted=!0,this.localAudioTrackMuted=!0,d.innerHTML=Vz(),u.innerHTML=jz(),p.innerHTML=jz(),XW(n,"NotReadableError"),e.next=64;break;case 63:e.t0.message.includes("NotAllowedError")?(h=n.querySelector("#toggleCamera"),f=n.querySelector("#toggleAudio"),m=n.querySelector("#localVideoContainer .mic-status-indicator"),this.localVideoTrackMuted=!0,this.localAudioTrackMuted=!0,h.innerHTML=Vz(),f.innerHTML=jz(),m.innerHTML=jz(),XW(n,"NotAllowedError")):(XW(n,"Failed to join the channel~"+e.t0.message),console.error("Failed to join the channel:",e.t0.message));case 64:case"end":return e.stop()}}),e,this,[[0,44]])}))),Gz.apply(this,arguments)}const Hz=Object.create(null);Hz.open="0",Hz.close="1",Hz.ping="2",Hz.pong="3",Hz.message="4",Hz.upgrade="5",Hz.noop="6";const qz=Object.create(null);Object.keys(Hz).forEach((e=>{qz[Hz[e]]=e}));const Wz={type:"error",data:"parser error"},zz="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Kz="function"==typeof ArrayBuffer,Yz=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Jz=({type:e,data:t},n,r)=>zz&&t instanceof Blob?n?r(t):Xz(t,r):Kz&&(t instanceof ArrayBuffer||Yz(t))?n?r(t):Xz(new Blob([t]),r):r(Hz[e]+(t||"")),Xz=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function Zz(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Qz;const $z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eK="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)eK[$z.charCodeAt(e)]=e;const tK="function"==typeof ArrayBuffer,nK=(e,t)=>{if("string"!=typeof e)return{type:"message",data:iK(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:rK(e.substring(1),t)};return qz[n]?e.length>1?{type:qz[n],data:e.substring(1)}:{type:qz[n]}:Wz},rK=(e,t)=>{if(tK){const n=(e=>{let t,n,r,i,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const l=new ArrayBuffer(a),d=new Uint8Array(l);for(t=0;t<s;t+=4)n=eK[e.charCodeAt(t)],r=eK[e.charCodeAt(t+1)],i=eK[e.charCodeAt(t+2)],o=eK[e.charCodeAt(t+3)],d[c++]=n<<2|r>>4,d[c++]=(15&r)<<4|i>>2,d[c++]=(3&i)<<6|63&o;return l})(e);return iK(n,t)}return{base64:!0,data:e}},iK=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,oK=String.fromCharCode(30);function aK(){return new TransformStream({transform(e,t){!function(e,t){zz&&e.data instanceof Blob?e.data.arrayBuffer().then(Zz).then(t):Kz&&(e.data instanceof ArrayBuffer||Yz(e.data))?t(Zz(e.data)):Jz(e,!1,(e=>{Qz||(Qz=new TextEncoder),t(Qz.encode(e))}))}(e,(n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!=typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)}))}})}let sK;function cK(e){return e.reduce(((e,t)=>e+t.length),0)}function lK(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function dK(e){if(e)return function(e){for(var t in dK.prototype)e[t]=dK.prototype[t];return e}(e)}dK.prototype.on=dK.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},dK.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},dK.prototype.off=dK.prototype.removeListener=dK.prototype.removeAllListeners=dK.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},dK.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},dK.prototype.emitReserved=dK.prototype.emit,dK.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},dK.prototype.hasListeners=function(e){return!!this.listeners(e).length};const uK="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function pK(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const hK=uK.setTimeout,fK=uK.clearTimeout;function mK(e,t){t.useNativeTimers?(e.setTimeoutFn=hK.bind(uK),e.clearTimeoutFn=fK.bind(uK)):(e.setTimeoutFn=uK.setTimeout.bind(uK),e.clearTimeoutFn=uK.clearTimeout.bind(uK))}class gK extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class vK extends dK{constructor(e){super(),this.writable=!1,mK(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new gK(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=nK(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}const _K="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),yK=64,wK={};let bK,EK=0,SK=0;function TK(e){let t="";do{t=_K[e%yK]+t,e=Math.floor(e/yK)}while(e>0);return t}function CK(){const e=TK(+new Date);return e!==bK?(EK=0,bK=e):e+"."+TK(EK++)}for(;SK<yK;SK++)wK[_K[SK]]=SK;let RK=!1;try{RK="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}const OK=RK;function IK(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||OK))return new XMLHttpRequest}catch(e){}if(!t)try{return new(uK[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function AK(){}const kK=null!=new IK({xdomain:!1}).responseType;class xK extends dK{constructor(e,t){super(),mK(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=pK(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new IK(t);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof n.status?n.status:0)}),0))},n.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=xK.requestsCount++,xK.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=AK,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete xK.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(xK.requestsCount=0,xK.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",LK);else if("function"==typeof addEventListener){addEventListener("onpagehide"in uK?"pagehide":"unload",LK,!1)}function LK(){for(let e in xK.requests)xK.requests.hasOwnProperty(e)&&xK.requests[e].abort()}const NK="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),PK=uK.WebSocket||uK.MozWebSocket,DK="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const MK={websocket:class extends vK{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=DK?{}:pK(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=DK?new PK(e,t,n):t?new PK(e,t):new PK(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;Jz(n,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}r&&NK((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=CK()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!PK}},webtransport:class extends vK{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=function(e,t){sK||(sK=new TextDecoder);const n=[];let r=0,i=-1,o=!1;return new TransformStream({transform(a,s){for(n.push(a);;){if(0===r){if(cK(n)<1)break;const e=lK(n,1);o=128==(128&e[0]),i=127&e[0],r=i<126?3:126===i?1:2}else if(1===r){if(cK(n)<2)break;const e=lK(n,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(cK(n)<8)break;const e=lK(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){s.enqueue(Wz);break}i=o*Math.pow(2,32)+t.getUint32(4),r=3}else{if(cK(n)<i)break;const e=lK(n,i);s.enqueue(nK(o?e:sK.decode(e),t)),r=0}if(0===i||i>e){s.enqueue(Wz);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=aK();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();const i=()=>{n.read().then((({done:e,value:t})=>{e||(this.onPacket(t),i())})).catch((e=>{}))};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this.writer.write(n).then((()=>{r&&NK((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends vK{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=kK&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(oK),r=[];for(let e=0;e<n.length;e++){const i=nK(n[e],t);if(r.push(i),"error"===i.type)break}return r})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach(((e,o)=>{Jz(e,!1,(e=>{r[o]=e,++i===n&&t(r.join(oK))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=CK()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new xK(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},UK=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,jK=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function VK(e){const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=UK.exec(e||""),o={},a=14;for(;a--;)o[jK[a]]=i[a]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,o.query),o}class BK extends dK{constructor(e,t={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=VK(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=VK(t.host).host),mK(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let e=0,r=n.length;e<r;e++){let r=n[e].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new MK[e](n)}open(){let e;if(this.opts.rememberUpgrade&&BK.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),n=!1;BK.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;BK.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){n||(n=!0,l(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,i(),this.emitReserved("upgradeError",n)};function a(){o("transport closed")}function s(){o("socket closed")}function c(e){t&&e.name!==t.name&&i()}const l=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",a),this.off("close",s),this.off("upgrading",c)};t.once("open",r),t.once("error",o),t.once("close",a),this.once("close",s),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onOpen(){if(this.readyState="open",BK.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(e+="string"==typeof(t=r)?function(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))),n>0&&e>this.maxPayload)return this.writeBuffer.slice(0,n);e+=2}var t;return this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){BK.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}BK.protocol=4;BK.protocol;const FK="function"==typeof ArrayBuffer,GK=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,HK=Object.prototype.toString,qK="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===HK.call(Blob),WK="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===HK.call(File);function zK(e){return FK&&(e instanceof ArrayBuffer||GK(e))||qK&&e instanceof Blob||WK&&e instanceof File}function KK(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(KK(e[t]))return!0;return!1}if(zK(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return KK(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&KK(e[t]))return!0;return!1}function YK(e){const t=[],n=e.data,r=e;return r.data=JK(n,t),r.attachments=t.length,{packet:r,buffers:t}}function JK(e,t){if(!e)return e;if(zK(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=JK(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=JK(e[r],t));return n}return e}function XK(e,t){return e.data=ZK(e.data,t),delete e.attachments,e}function ZK(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=ZK(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=ZK(e[n],t));return e}const QK=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],$K=5;var eY;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(eY||(eY={}));class tY{constructor(e){this.replacer=e}encode(e){return e.type!==eY.EVENT&&e.type!==eY.ACK||!KK(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===eY.EVENT?eY.BINARY_EVENT:eY.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==eY.BINARY_EVENT&&e.type!==eY.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=YK(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function nY(e){return"[object Object]"===Object.prototype.toString.call(e)}class rY extends dK{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===eY.BINARY_EVENT;n||t.type===eY.BINARY_ACK?(t.type=n?eY.EVENT:eY.ACK,this.reconstructor=new iY(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!zK(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===eY[n.type])throw new Error("unknown packet type "+n.type);if(n.type===eY.BINARY_EVENT||n.type===eY.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!rY.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case eY.CONNECT:return nY(t);case eY.DISCONNECT:return void 0===t;case eY.CONNECT_ERROR:return"string"==typeof t||nY(t);case eY.EVENT:case eY.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===QK.indexOf(t[0]));case eY.ACK:case eY.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class iY{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=XK(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function oY(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const aY=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class sY extends dK{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[oY(e,"open",this.onopen.bind(this)),oY(e,"packet",this.onpacket.bind(this)),oY(e,"error",this.onerror.bind(this)),oY(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(aY.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:eY.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,i)=>{t.push(((e,t)=>n?e?i(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;return null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:eY.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case eY.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case eY.EVENT:case eY.BINARY_EVENT:this.onevent(e);break;case eY.ACK:case eY.BINARY_ACK:this.onack(e);break;case eY.DISCONNECT:this.ondisconnect();break;case eY.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:eY.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:eY.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function cY(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}cY.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},cY.prototype.reset=function(){this.attempts=0},cY.prototype.setMin=function(e){this.ms=e},cY.prototype.setMax=function(e){this.max=e},cY.prototype.setJitter=function(e){this.jitter=e};class lY extends dK{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(n=t,t=void 0),(n=n||{}).path=n.path||"/socket.io",this.opts=n,mK(this,n),this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=n.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new cY({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this._readyState="closed",this.uri=t;const i=n.parser||e;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==n.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new BK(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=oY(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=oY(t,"error",i);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn((()=>{r(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(oY(e,"ping",this.onping.bind(this)),oY(e,"data",this.ondata.bind(this)),oY(e,"error",this.onerror.bind(this)),oY(e,"close",this.onclose.bind(this)),oY(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){NK((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new sY(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const dY={};function uY(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=VK(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,o=n.path,a=dY[i]&&o in dY[i].nsps;let s;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?s=new lY(r,t):(dY[i]||(dY[i]=new lY(r,t)),s=dY[i]),n.query&&!t.query&&(t.query=n.queryKey),s.socket(n.path,t)}function pY(e){return pY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pY(e)}function hY(){hY=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==pY(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function fY(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mY(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fY(Object(n),!0).forEach((function(t){gY(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fY(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==pY(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==pY(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===pY(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vY(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function _Y(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){vY(o,r,i,a,s,"next",e)}function s(e){vY(o,r,i,a,s,"throw",e)}a(void 0)}))}}Object.assign(uY,{Manager:lY,Socket:sY,io:uY,connect:uY});var yY=__webpack_require__(53),wY=__webpack_require__(6269),bY=__webpack_require__(3585),EY=__webpack_require__(8922),SY=function(e,t){var n=D()[e],r=U()[e],i=r.form_data,a=F("user_data_".concat(e))||{},s="string"==typeof n.feedback_form?JSON.parse(n.feedback_form):[],c=t.querySelector(".sa-live-call-widget-expanded-inner-wrapper");c.innerHTML=yY({logo:n.source_image_url});var d=t.querySelector("#sa-live-call-widget-feedback-form"),u=t.querySelector(".sa-live-call-widget-feedback-form-fields-container");if(n.custom_feedback_form){u.insertAdjacentHTML("afterbegin",q(s));var p=t.querySelector(".sa-live-call-widget-lead-capture-form-radio-fields-wrapper");p&&(p.style.cssText="display: flex; gap: 12px"),d.addEventListener("submit",function(){var a=_Y(hY().mark((function a(s){var u,p,h,f,m,g,v;return hY().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s.preventDefault(),(u=t.querySelector(".sa-live-call-widget-feedback-form-submit-btn")).innerHTML=bY({}),u.style.cursor="not-allowed",u.disabled=!0,p=d.querySelectorAll(".sa-live-call-widget-lead-capture-form-field"),h=d.querySelectorAll(".sa-live-call-widget-lead-capture-form-field-radio"),f=d.querySelectorAll(".sa-live-call-widget-lead-capture-form-field-checkbox"),m={},p.forEach((function(e){if("select"===e.tagName.toLocaleLowerCase()){var t=Array.from(e.querySelectorAll("option:checked"),(function(e){return e.value}));m[e.name]=t}else m[e.name]=e.value})),g=function(e){var t=[];e.forEach((function(e){e.checked&&t.push(e.value)})),m[e[0].getAttribute("name")]=t},h.length&&g(h),f.length&&g(f),a.next=15,l.post(o.url.SOURCE,"/".concat(n.id,"/form"),mY(mY({},i),{},{collection_id:n.id,relates_to_collection:"sources",data:m}));case 15:if(!(v=a.sent)){a.next=23;break}return a.next=19,l.post(o.url.SOURCE,"/".concat(n.id,"/conversation"),mY({meeting_id:r.meeting_id,message_content:v.id,message_from:i.people_id,message_type:"feedback_form",meta:[m],source_id:n.id,source_name:n.name,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href,source_type:n.source_type},i));case 19:a.sent,M(gY({},e,mY(mY({},r),{},{message:"Your feedback has been received",widgetName:"thankyouMessage"}))),c.innerHTML=EY({defaultMessage:r.message,thankyouMessage:n.thankyou_message}),M5(e,t);case 23:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}else{u.insertAdjacentHTML("afterbegin",wY({addOrraPixel:"2d776e4a-ca8b-454d-9ceb-aab964ae4ebf"===e,mobileNumber:a.mobile_number,affiliateId:z("utm_medium"),peopleId:i.people_id}));var h=null,f="";document.getElementById("sa-live-call-widget-feedback-form-comment").addEventListener("change",(function(e){f=e.target.value}));var m=t.querySelectorAll(".sa-live-call-widget-feedback-form-star");m.forEach((function(e,t){e.addEventListener("mouseover",(function(){m.forEach((function(e,n){var r=e.querySelector("polygon");n<=t||r.classList.contains("filled-star")?e.style.stroke="#ff9800":e.style.stroke="#aaa"}))}))})),m.forEach((function(e){e.addEventListener("mouseout",(function(){m.forEach((function(e){e.querySelector("polygon").classList.contains("filled-star")?e.style.stroke="#ff9800":e.style.stroke="#aaa"}))}))})),m.forEach((function(e,t){e.addEventListener("click",(function(){h=e.getAttribute("data-star"),m.forEach((function(e,n){if(n<=t){var r=e.querySelector("polygon");r.removeAttribute("class"),r.classList.add("filled-star"),e.style.stroke="#ff9800"}else{var i=e.querySelector("polygon");i.removeAttribute("class"),i.classList.add("unfilled-star"),e.style.stroke="#aaa"}}))}))})),d.addEventListener("submit",function(){var a=_Y(hY().mark((function a(s){var d,u,p,m;return hY().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s.preventDefault(),(d=t.querySelector(".sa-live-call-widget-feedback-form-submit-btn")).innerHTML=bY({}),d.style.cursor="not-allowed",d.disabled=!0,a.next=7,l.post(o.url.SOURCE,"/".concat(n.id,"/form"),mY(mY({},i),{},{collection_id:n.id,relates_to_collection:"sources",data:{star_rating:h,feedback_comments:f}}));case 7:if(!(u=a.sent)){a.next=16;break}return a.next=11,l.post(o.url.SOURCE,"/".concat(n.id,"/conversation"),mY({meeting_id:null===r.meeting_id?"":r.meeting_id,message_content:u.id,message_from:i.people_id,message_type:"feedback_form",meta:[{star_rating:h,feedback_comments:f}],source_id:n.id,source_name:n.name,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href,source_type:n.source_type},i));case 11:(p=a.sent)&&(r.socket?r.socket.emit("chat_message",{is_conversation:!0,conversation:p}):(m=uY(o.url.SOCKET_URL,{query:"id=".concat(r.form_data.people_id,"&client_id=").concat(n.client_id)})).on("connect",(function(t){M(gY({},e,mY(mY({},r),{},{socket:m}))),m.emit("chat_message",{is_conversation:!0,conversation:p})}))),M(gY({},e,mY(mY({},r),{},{message:"Your feedback has been received",widgetName:"thankyouMessage"}))),c.innerHTML=EY({defaultMessage:r.message,thankyouMessage:n.thankyou_message}),M5(e,t);case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}};function TY(e,t){return function(){return e.apply(t,arguments)}}const{toString:CY}=Object.prototype,{getPrototypeOf:RY}=Object,OY=(e=>t=>{const n=CY.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),IY=e=>(e=e.toLowerCase(),t=>OY(t)===e),AY=e=>t=>typeof t===e,{isArray:kY}=Array,xY=AY("undefined");const LY=IY("ArrayBuffer");const NY=AY("string"),PY=AY("function"),DY=AY("number"),MY=e=>null!==e&&"object"==typeof e,UY=e=>{if("object"!==OY(e))return!1;const t=RY(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},jY=IY("Date"),VY=IY("File"),BY=IY("Blob"),FY=IY("FileList"),GY=IY("URLSearchParams");function HY(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,i;if("object"!=typeof e&&(e=[e]),kY(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let a;for(r=0;r<o;r++)a=i[r],t.call(null,e[a],a,e)}}function qY(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const WY="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,zY=e=>!xY(e)&&e!==WY;const KY=(YY="undefined"!=typeof Uint8Array&&RY(Uint8Array),e=>YY&&e instanceof YY);var YY;const JY=IY("HTMLFormElement"),XY=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),ZY=IY("RegExp"),QY=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};HY(n,((n,i)=>{let o;!1!==(o=t(n,i,e))&&(r[i]=o||n)})),Object.defineProperties(e,r)},$Y="abcdefghijklmnopqrstuvwxyz",eJ="0123456789",tJ={DIGIT:eJ,ALPHA:$Y,ALPHA_DIGIT:$Y+$Y.toUpperCase()+eJ};const nJ=IY("AsyncFunction"),rJ={isArray:kY,isArrayBuffer:LY,isBuffer:function(e){return null!==e&&!xY(e)&&null!==e.constructor&&!xY(e.constructor)&&PY(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||PY(e.append)&&("formdata"===(t=OY(e))||"object"===t&&PY(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&LY(e.buffer),t},isString:NY,isNumber:DY,isBoolean:e=>!0===e||!1===e,isObject:MY,isPlainObject:UY,isUndefined:xY,isDate:jY,isFile:VY,isBlob:BY,isRegExp:ZY,isFunction:PY,isStream:e=>MY(e)&&PY(e.pipe),isURLSearchParams:GY,isTypedArray:KY,isFileList:FY,forEach:HY,merge:function e(){const{caseless:t}=zY(this)&&this||{},n={},r=(r,i)=>{const o=t&&qY(n,i)||i;UY(n[o])&&UY(r)?n[o]=e(n[o],r):UY(r)?n[o]=e({},r):kY(r)?n[o]=r.slice():n[o]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&HY(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(HY(t,((t,r)=>{n&&PY(t)?e[r]=TY(t,n):e[r]=t}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,o,a;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)a=i[o],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&RY(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:OY,kindOfTest:IY,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(kY(e))return e;let t=e.length;if(!DY(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:JY,hasOwnProperty:XY,hasOwnProp:XY,reduceDescriptors:QY,freezeMethods:e=>{QY(e,((t,n)=>{if(PY(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];PY(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return kY(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:qY,global:WY,isContextDefined:zY,ALPHABET:tJ,generateString:(e=16,t=tJ.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&PY(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(MY(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const i=kY(e)?[]:{};return HY(e,((e,t)=>{const o=n(e,r+1);!xY(o)&&(i[t]=o)})),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:nJ,isThenable:e=>e&&(MY(e)||PY(e))&&PY(e.then)&&PY(e.catch)};function iJ(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}rJ.inherits(iJ,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:rJ.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const oJ=iJ.prototype,aJ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{aJ[e]={value:e}})),Object.defineProperties(iJ,aJ),Object.defineProperty(oJ,"isAxiosError",{value:!0}),iJ.from=(e,t,n,r,i,o)=>{const a=Object.create(oJ);return rJ.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),iJ.call(a,e.message,t,n,r,i),a.cause=e,a.name=e.name,o&&Object.assign(a,o),a};const sJ=iJ,cJ=null;function lJ(e){return rJ.isPlainObject(e)||rJ.isArray(e)}function dJ(e){return rJ.endsWith(e,"[]")?e.slice(0,-2):e}function uJ(e,t,n){return e?e.concat(t).map((function(e,t){return e=dJ(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const pJ=rJ.toFlatObject(rJ,{},null,(function(e){return/^is[A-Z]/.test(e)}));const hJ=function(e,t,n){if(!rJ.isObject(e))throw new TypeError("target must be an object");t=t||new(cJ||FormData);const r=(n=rJ.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!rJ.isUndefined(t[e])}))).metaTokens,i=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&rJ.isSpecCompliantForm(t);if(!rJ.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(rJ.isDate(e))return e.toISOString();if(!s&&rJ.isBlob(e))throw new sJ("Blob is not supported. Use a Buffer instead.");return rJ.isArrayBuffer(e)||rJ.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,i){let s=e;if(e&&!i&&"object"==typeof e)if(rJ.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(rJ.isArray(e)&&function(e){return rJ.isArray(e)&&!e.some(lJ)}(e)||(rJ.isFileList(e)||rJ.endsWith(n,"[]"))&&(s=rJ.toArray(e)))return n=dJ(n),s.forEach((function(e,r){!rJ.isUndefined(e)&&null!==e&&t.append(!0===a?uJ([n],r,o):null===a?n:n+"[]",c(e))})),!1;return!!lJ(e)||(t.append(uJ(i,n,o),c(e)),!1)}const d=[],u=Object.assign(pJ,{defaultVisitor:l,convertValue:c,isVisitable:lJ});if(!rJ.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!rJ.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),rJ.forEach(n,(function(n,o){!0===(!(rJ.isUndefined(n)||null===n)&&i.call(t,n,rJ.isString(o)?o.trim():o,r,u))&&e(n,r?r.concat(o):[o])})),d.pop()}}(e),t};function fJ(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function mJ(e,t){this._pairs=[],e&&hJ(e,this,t)}const gJ=mJ.prototype;gJ.append=function(e,t){this._pairs.push([e,t])},gJ.toString=function(e){const t=e?function(t){return e.call(this,t,fJ)}:fJ;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const vJ=mJ;function _J(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function yJ(e,t,n){if(!t)return e;const r=n&&n.encode||_J,i=n&&n.serialize;let o;if(o=i?i(t,n):rJ.isURLSearchParams(t)?t.toString():new vJ(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const wJ=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){rJ.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},bJ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},EJ={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:vJ,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};const SJ=function(e){function t(e,n,r,i){let o=e[i++];const a=Number.isFinite(+o),s=i>=e.length;if(o=!o&&rJ.isArray(r)?r.length:o,s)return rJ.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!a;r[o]&&rJ.isObject(r[o])||(r[o]=[]);return t(e,n,r[o],i)&&rJ.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}(r[o])),!a}if(rJ.isFormData(e)&&rJ.isFunction(e.entries)){const n={};return rJ.forEachEntry(e,((e,r)=>{t(function(e){return rJ.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const TJ={transitional:bJ,adapter:EJ.isNode?"http":"xhr",transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=rJ.isObject(e);i&&rJ.isHTMLForm(e)&&(e=new FormData(e));if(rJ.isFormData(e))return r&&r?JSON.stringify(SJ(e)):e;if(rJ.isArrayBuffer(e)||rJ.isBuffer(e)||rJ.isStream(e)||rJ.isFile(e)||rJ.isBlob(e))return e;if(rJ.isArrayBufferView(e))return e.buffer;if(rJ.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return hJ(e,new EJ.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return EJ.isNode&&rJ.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=rJ.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return hJ(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(rJ.isString(e))try{return(t||JSON.parse)(e),rJ.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||TJ.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&rJ.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw sJ.from(e,sJ.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:EJ.classes.FormData,Blob:EJ.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};rJ.forEach(["delete","get","head","post","put","patch"],(e=>{TJ.headers[e]={}}));const CJ=TJ,RJ=rJ.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),OJ=Symbol("internals");function IJ(e){return e&&String(e).trim().toLowerCase()}function AJ(e){return!1===e||null==e?e:rJ.isArray(e)?e.map(AJ):String(e)}function kJ(e,t,n,r,i){return rJ.isFunction(r)?r.call(this,t,n):(i&&(t=n),rJ.isString(t)?rJ.isString(r)?-1!==t.indexOf(r):rJ.isRegExp(r)?r.test(t):void 0:void 0)}class xJ{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=IJ(t);if(!i)throw new Error("header name must be a non-empty string");const o=rJ.findKey(r,i);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=AJ(e))}const o=(e,t)=>rJ.forEach(e,((e,n)=>i(e,n,t)));return rJ.isPlainObject(e)||e instanceof this.constructor?o(e,t):rJ.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?o((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&RJ[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&i(t,e,n),this}get(e,t){if(e=IJ(e)){const n=rJ.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(rJ.isFunction(t))return t.call(this,e,n);if(rJ.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=IJ(e)){const n=rJ.findKey(this,e);return!(!n||void 0===this[n]||t&&!kJ(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=IJ(e)){const i=rJ.findKey(n,e);!i||t&&!kJ(0,n[i],i,t)||(delete n[i],r=!0)}}return rJ.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!kJ(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return rJ.forEach(this,((r,i)=>{const o=rJ.findKey(n,i);if(o)return t[o]=AJ(r),void delete t[i];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(i):String(i).trim();a!==i&&delete t[i],t[a]=AJ(r),n[a]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return rJ.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&rJ.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[OJ]=this[OJ]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=IJ(e);t[r]||(!function(e,t){const n=rJ.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})}))}(n,e),t[r]=!0)}return rJ.isArray(e)?e.forEach(r):r(e),this}}xJ.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),rJ.reduceDescriptors(xJ.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),rJ.freezeMethods(xJ);const LJ=xJ;function NJ(e,t){const n=this||CJ,r=t||n,i=LJ.from(r.headers);let o=r.data;return rJ.forEach(e,(function(e){o=e.call(n,o,i.normalize(),t?t.status:void 0)})),i.normalize(),o}function PJ(e){return!(!e||!e.__CANCEL__)}function DJ(e,t,n){sJ.call(this,null==e?"canceled":e,sJ.ERR_CANCELED,t,n),this.name="CanceledError"}rJ.inherits(DJ,sJ,{__CANCEL__:!0});const MJ=DJ;const UJ=EJ.isStandardBrowserEnv?{write:function(e,t,n,r,i,o){const a=[];a.push(e+"="+encodeURIComponent(t)),rJ.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),rJ.isString(r)&&a.push("path="+r),rJ.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function jJ(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const VJ=EJ.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=rJ.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};const BJ=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];i||(i=c),n[o]=s,r[o]=c;let d=a,u=0;for(;d!==o;)u+=n[d++],d%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),c-i<t)return;const p=l&&c-l;return p?Math.round(1e3*u/p):void 0}};function FJ(e,t){let n=0;const r=BJ(50,250);return i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,s=o-n,c=r(s);n=o;const l={loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&o<=a?(a-o)/c:void 0,event:i};l[t?"download":"upload"]=!0,e(l)}}const GJ="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let r=e.data;const i=LJ.from(e.headers).normalize(),o=e.responseType;let a;function s(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}rJ.isFormData(r)&&(EJ.isStandardBrowserEnv||EJ.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.setContentType("multipart/form-data;",!1));let c=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+n))}const l=jJ(e.baseURL,e.url);function d(){if(!c)return;const r=LJ.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new sJ("Request failed with status code "+n.status,[sJ.ERR_BAD_REQUEST,sJ.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),s()}),(function(e){n(e),s()}),{data:o&&"text"!==o&&"json"!==o?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:r,config:e,request:c}),c=null}if(c.open(e.method.toUpperCase(),yJ(l,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,"onloadend"in c?c.onloadend=d:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(d)},c.onabort=function(){c&&(n(new sJ("Request aborted",sJ.ECONNABORTED,e,c)),c=null)},c.onerror=function(){n(new sJ("Network Error",sJ.ERR_NETWORK,e,c)),c=null},c.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||bJ;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new sJ(t,r.clarifyTimeoutError?sJ.ETIMEDOUT:sJ.ECONNABORTED,e,c)),c=null},EJ.isStandardBrowserEnv){const t=(e.withCredentials||VJ(l))&&e.xsrfCookieName&&UJ.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===r&&i.setContentType(null),"setRequestHeader"in c&&rJ.forEach(i.toJSON(),(function(e,t){c.setRequestHeader(t,e)})),rJ.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),o&&"json"!==o&&(c.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&c.addEventListener("progress",FJ(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",FJ(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=t=>{c&&(n(!t||t.type?new MJ(null,e,c):t),c.abort(),c=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const u=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(l);u&&-1===EJ.protocols.indexOf(u)?n(new sJ("Unsupported protocol "+u+":",sJ.ERR_BAD_REQUEST,e)):c.send(r||null)}))},HJ={http:cJ,xhr:GJ};rJ.forEach(HJ,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const qJ={getAdapter:e=>{e=rJ.isArray(e)?e:[e];const{length:t}=e;let n,r;for(let i=0;i<t&&(n=e[i],!(r=rJ.isString(n)?HJ[n.toLowerCase()]:n));i++);if(!r){if(!1===r)throw new sJ(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT");throw new Error(rJ.hasOwnProp(HJ,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`)}if(!rJ.isFunction(r))throw new TypeError("adapter is not a function");return r},adapters:HJ};function WJ(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new MJ(null,e)}function zJ(e){WJ(e),e.headers=LJ.from(e.headers),e.data=NJ.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return qJ.getAdapter(e.adapter||CJ.adapter)(e).then((function(t){return WJ(e),t.data=NJ.call(e,e.transformResponse,t),t.headers=LJ.from(t.headers),t}),(function(t){return PJ(t)||(WJ(e),t&&t.response&&(t.response.data=NJ.call(e,e.transformResponse,t.response),t.response.headers=LJ.from(t.response.headers))),Promise.reject(t)}))}const KJ=e=>e instanceof LJ?e.toJSON():e;function YJ(e,t){t=t||{};const n={};function r(e,t,n){return rJ.isPlainObject(e)&&rJ.isPlainObject(t)?rJ.merge.call({caseless:n},e,t):rJ.isPlainObject(t)?rJ.merge({},t):rJ.isArray(t)?t.slice():t}function i(e,t,n){return rJ.isUndefined(t)?rJ.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function o(e,t){if(!rJ.isUndefined(t))return r(void 0,t)}function a(e,t){return rJ.isUndefined(t)?rJ.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,o){return o in t?r(n,i):o in e?r(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t)=>i(KJ(e),KJ(t),!0)};return rJ.forEach(Object.keys(Object.assign({},e,t)),(function(r){const o=c[r]||i,a=o(e[r],t[r],r);rJ.isUndefined(a)&&o!==s||(n[r]=a)})),n}const JJ="1.5.0",XJ={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{XJ[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const ZJ={};XJ.transitional=function(e,t,n){function r(e,t){return"[Axios v1.5.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,o)=>{if(!1===e)throw new sJ(r(i," has been removed"+(t?" in "+t:"")),sJ.ERR_DEPRECATED);return t&&!ZJ[i]&&(ZJ[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}};const QJ={assertOptions:function(e,t,n){if("object"!=typeof e)throw new sJ("options must be an object",sJ.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new sJ("option "+o+" must be "+n,sJ.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new sJ("Unknown option "+o,sJ.ERR_BAD_OPTION)}},validators:XJ},$J=QJ.validators;class eX{constructor(e){this.defaults=e,this.interceptors={request:new wJ,response:new wJ}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=YJ(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&QJ.assertOptions(n,{silentJSONParsing:$J.transitional($J.boolean),forcedJSONParsing:$J.transitional($J.boolean),clarifyTimeoutError:$J.transitional($J.boolean)},!1),null!=r&&(rJ.isFunction(r)?t.paramsSerializer={serialize:r}:QJ.assertOptions(r,{encode:$J.function,serialize:$J.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&rJ.merge(i.common,i[t.method]);i&&rJ.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=LJ.concat(o,i);const a=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let d,u=0;if(!s){const e=[zJ.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,c),d=e.length,l=Promise.resolve(t);u<d;)l=l.then(e[u++],e[u++]);return l}d=a.length;let p=t;for(u=0;u<d;){const e=a[u++],t=a[u++];try{p=e(p)}catch(e){t.call(this,e);break}}try{l=zJ.call(this,p)}catch(e){return Promise.reject(e)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return yJ(jJ((e=YJ(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}rJ.forEach(["delete","get","head","options"],(function(e){eX.prototype[e]=function(t,n){return this.request(YJ(n||{},{method:e,url:t,data:(n||{}).data}))}})),rJ.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(YJ(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}eX.prototype[e]=t(),eX.prototype[e+"Form"]=t(!0)}));const tX=eX;class nX{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,i){n.reason||(n.reason=new MJ(e,r,i),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;const t=new nX((function(t){e=t}));return{token:t,cancel:e}}}const rX=nX;const iX={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(iX).forEach((([e,t])=>{iX[t]=e}));const oX=iX;const aX=function e(t){const n=new tX(t),r=TY(tX.prototype.request,n);return rJ.extend(r,tX.prototype,n,{allOwnKeys:!0}),rJ.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(YJ(t,n))},r}(CJ);aX.Axios=tX,aX.CanceledError=MJ,aX.CancelToken=rX,aX.isCancel=PJ,aX.VERSION=JJ,aX.toFormData=hJ,aX.AxiosError=sJ,aX.Cancel=aX.CanceledError,aX.all=function(e){return Promise.all(e)},aX.spread=function(e){return function(t){return e.apply(null,t)}},aX.isAxiosError=function(e){return rJ.isObject(e)&&!0===e.isAxiosError},aX.mergeConfig=YJ,aX.AxiosHeaders=LJ,aX.formToJSON=e=>SJ(rJ.isHTMLForm(e)?new FormData(e):e),aX.getAdapter=qJ.getAdapter,aX.HttpStatusCode=oX,aX.default=aX;const sX=aX;function cX(){return{referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href}}function lX(e){var t=e.replace(/([^:]\/)\/+/g,"$1").replace(/\/+$/,"");return t.split("/").length<=4?t+"/":t}function dX(e){var t=e.url,n=void 0===t?o.url.BASE:t,r=e.path,i=void 0===r?"":r,a=e.data,s=void 0===a?{}:a,c=e.onSuccess,l=void 0===c?function(){}:c,d=e.onFailure,u=void 0===d?function(){}:d,p={};return p.headers=cX(),sX.post(lX(n+"/"+i),s,p).then((function(e){l(e)})).catch((function(e){u(e)}))}function uX(e,t,n){try{var r=new Date;r.setTime(r.getTime()+60*n*60*1e3);var i="expires="+r.toUTCString();document.cookie=e+"="+JSON.stringify(t)+";"+i+";path=/;SameSite=Strict;Secure"}catch(e){return null}}function pX(e){try{for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return JSON.parse(i.substring(t.length,i.length))}}catch(e){}return""}function hX(e){return pX(e)||!1}function fX(e){try{document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict; Secure"}catch(e){console.error("Error deleting cookie:",e)}}function mX(e,t,n){var r=[],i=hX(e);i&&Array.isArray(i)&&(r=i);var o=r.findIndex((function(e){return e.msg_id===t.msg_id}));-1!==o?r[o].text=t.text:r.push(t),uX(e,r,n)}function gX(e){return gX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gX(e)}function vX(){vX=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==gX(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function _X(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function yX(e,t){return wX.apply(this,arguments)}function wX(){return wX=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){_X(o,r,i,a,s,"next",e)}function s(e){_X(o,r,i,a,s,"throw",e)}a(void 0)}))}}(vX().mark((function e(t,n){var r,i,a,s,c,l=this;return vX().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.autoMinimizeTimeout&&(clearTimeout(this.autoMinimizeTimeout),this.autoMinimizeTimeout=null),null===(r=n.querySelector("#videoCallMaxTileOverlay"))||void 0===r||r.click(),"function"==typeof window.stopCoBrowsing&&window.stopCoBrowsing(),null==(a=n.querySelector(".sa-live-call-widget-expanded"))||a.classList.remove("sa-live-call-widget-expanded-maximize"),this.remoteUsers={},this.socket.disconnect(),fX("widget_call_".concat(t)),!this.localVideoTrack||!this.localAudioTrack||"video_call"!==this.message_type){e.next=12;break}return e.next=12,this.client.unpublish([this.localAudioTrack,this.localVideoTrack]);case 12:if(!this.localAudioTrack||"audio_call"!==this.message_type){e.next=15;break}return e.next=15,this.client.unpublish([this.localAudioTrack]);case 15:return e.next=17,this.client.leave();case 17:if(this.messageEngine&&(null===(s=this.messageEngine)||void 0===s||s.cleanup()),this.brightnessInterval&&this.brightnessInterval.stop(),"live_streaming"===this.is_streaming&&this.resizeObserver&&this.resizeObserver.disconnect(),null===(i=this.chatLogObserver)||void 0===i||i.disconnect(),this.localVideoTrack&&"video_call"===this.message_type&&(this.localVideoTrack.stop(),this.localVideoTrack.close()),this.localAudioTrack&&(this.localAudioTrack.stop(),this.localAudioTrack.close()),!this.localScreenTrack){e.next=27;break}return(null===(c=this.localScreenTrack)||void 0===c?void 0:c.length)>0?this.localScreenTrack.map((function(e){e.stop(),e.close()})):(this.localScreenTrack.stop(),this.localScreenTrack.close()),e.next=27,this.screen_client.leave();case 27:dX({url:o.url.SOURCE,path:"transcript/agora/calls",data:{client_id:this.client_id,meeting_id:this.copy_url_id,transcript_data:pX("".concat(this.copy_url_id,"_transcript"))||[]},onSuccess:function(e){fX("".concat(l.copy_url_id,"_transcript"))},onFailure:function(e){console.error(e)}}),dX({url:"https://ingest-stg.saleassist.ai/meeting-log",data:{event_type:"END_MEETING_LCW",meeting_id:this.copy_url_id||U()[t].meeting_id||"",client_id:this.client_id||D()[t].client_id,users_stats:{action:"end-call",conversation_id:U()[t].conversation_id}},onSuccess:function(e){},onFailure:function(e){console.error(e)}}),SY(t,n),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(0),console.error("Failed to leave the channel:",e.t0);case 35:case"end":return e.stop()}}),e,this,[[0,32]])}))),wX.apply(this,arguments)}var bX=__webpack_require__(9346),EX=__webpack_require__(5321);function SX(e,t,n){var r=t.querySelector(".sa-live-call-widget-expanded"),i=t.querySelectorAll(".video-call-wrapper");if(r.classList.toggle("sa-live-call-widget-expanded-maximize"),i.forEach((function(e){return e.classList.toggle("video-call-wrapper-maximize")})),r.classList.contains("sa-live-call-widget-expanded-maximize")?n.innerHTML=EX():n.innerHTML=bX(),"live_streaming"===this.is_streaming&&r.offsetWidth>1200){var o=t.querySelector("#sa-message"),a=t.querySelector("#sa-shoppingCart"),s=t.querySelector(".sa-chat-active"),c=t.querySelector(".sa-shopping-active");s||o.click(),this.streaming_products.length>0&&!c&&a.click()}}var TX=function(e,t){t.querySelector(".saleassist-video-call-more-options-control").classList.toggle("more-options-control-active")},CX=__webpack_require__(1673),RX=function(e,t,n){var r=t.querySelector(".call-recording-indication"),i=t.querySelector(".saleassist-livestream");if("record_started"===n){var o=t.querySelector(".call-recording-indication-popup");if(o.classList.add("call-recording-indication-popup-show"),setTimeout((function(){o.classList.remove("call-recording-indication-popup-show"),r.style.display="flex"}),5e3),i)t.querySelector(".sa-live-stream-info-bar .sa-live-stream-live-button").innerHTML=CX()+"Live"}"record_ended"===n&&(r.style.display="none",i&&(t.querySelector(".sa-live-stream-info-bar .sa-live-stream-live-button").innerHTML="Live"))};function OX(e){return OX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OX(e)}function IX(){IX=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==OX(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function AX(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function kX(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){AX(o,r,i,a,s,"next",e)}function s(e){AX(o,r,i,a,s,"throw",e)}a(void 0)}))}}var xX=__webpack_require__(710),LX=__webpack_require__(9847);function NX(e,t,n,r){return PX.apply(this,arguments)}function PX(){return PX=kX(IX().mark((function e(t,n,r,i){var a,s,c,d,u,p,h,f,m,g,v=this;return IX().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,s=null,e.prev=2,!1!==this.isSharingEnabled){e.next=53;break}return c="screen-share-".concat(this.user_display_name),e.next=7,l.get(o.url.ACTIONS,"/meeting/".concat(this.copy_url_id));case 7:d=e.sent,e.t0=IX().keys(this.remoteUsers);case 9:if((e.t1=e.t0()).done){e.next=16;break}if(!((u=e.t1.value)in d.uid_map)){e.next=14;break}if(!d.uid_map[u].user_display_name.includes("screen-share")){e.next=14;break}return e.abrupt("return",XW(n,"Screen Share Limit Exceeds~Screen sharing is limited to 1 user at a time."));case 14:e.next=9;break;case 16:return e.next=18,l.post(o.url.ACTIONS,"/meeting/join_channel/".concat(this.room_id,"/").concat(c));case 18:return p=e.sent,this.screen_creds=p,h=p.widget_creds.app_id,f=p.widget_creds.channel_name,m=p.widget_creds.token,g=p.widget_creds.uid,e.next=26,this.screen_client.join(h,f,m,g);case 26:return e.prev=26,e.next=29,r.createScreenVideoTrack({},"auto");case 29:this.localScreenTrack=e.sent,e.next=37;break;case 32:return e.prev=32,e.t2=e.catch(26),console.error(e.t2),e.next=37,this.screen_client.leave();case 37:if(this.localScreenTrack instanceof Array?(a=this.localScreenTrack[0],s=this.localScreenTrack[1]):a=this.localScreenTrack,a.play("remoteVideo_".concat(g)),a.on("track-ended",kX(IX().mark((function e(){return IX().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=s){e.next=6;break}return e.next=3,v.screen_client.unpublish(a);case 3:a.close(),e.next=10;break;case 6:return e.next=8,v.screen_client.unpublish([a,s]);case 8:a.close(),s.close();case 10:return e.next=12,v.screen_client.leave();case 12:i.innerHTML=xX(),v.isSharingEnabled=!1;case 14:case"end":return e.stop()}}),e)})))),null!==s){e.next=46;break}if(!a){e.next=44;break}return e.next=44,this.screen_client.publish(a);case 44:e.next=49;break;case 46:if(!a||!s){e.next=49;break}return e.next=49,this.screen_client.publish([a,s]);case 49:i.innerHTML=LX(),this.isSharingEnabled=!0,e.next=68;break;case 53:if(this.localScreenTrack instanceof Array?(a=this.localScreenTrack[0],s=this.localScreenTrack[1]):a=this.localScreenTrack,null!=s){e.next=60;break}return e.next=57,this.screen_client.unpublish(a);case 57:a.close(),e.next=64;break;case 60:return e.next=62,this.screen_client.unpublish([a,s]);case 62:a.close(),s.close();case 64:return e.next=66,this.screen_client.leave();case 66:i.innerHTML=xX(),this.isSharingEnabled=!1;case 68:e.next=72;break;case 70:e.prev=70,e.t3=e.catch(2);case 72:case"end":return e.stop()}}),e,this,[[2,70],[26,32]])}))),PX.apply(this,arguments)}function DX(e){return DX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DX(e)}function MX(){MX=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==DX(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function UX(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var jX=__webpack_require__(5494),VX=__webpack_require__(8958);function BX(e,t,n,r){return FX.apply(this,arguments)}function FX(){return FX=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){UX(o,r,i,a,s,"next",e)}function s(e){UX(o,r,i,a,s,"throw",e)}a(void 0)}))}}(MX().mark((function e(t,n,r,i){var o;return MX().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.querySelector("#localVideoContainer .mic-status-indicator"),!this.localAudioTrack){e.next=17;break}if(this.localAudioTrackMuted){e.next=10;break}return e.next=5,this.localAudioTrack.setMuted(!0);case 5:this.localAudioTrackMuted=!0,r.innerHTML=VX(),o.innerHTML=VX(),e.next=15;break;case 10:return e.next=12,this.localAudioTrack.setMuted(!1);case 12:this.localAudioTrackMuted=!1,r.innerHTML=jX(),o.innerHTML=jX();case 15:e.next=31;break;case 17:return e.prev=17,e.next=20,i.createMicrophoneAudioTrack({encoderConfig:"high_quality_stereo"});case 20:return this.localAudioTrack=e.sent,e.next=23,this.client.publish([this.localAudioTrack]);case 23:this.localAudioTrackMuted=!1,r.innerHTML=jX(),o.innerHTML=jX(),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(17),e.t0.message.includes("NotReadableError")?XW(n,"NotReadableError"):e.t0.message.includes("NotAllowedError")?XW(n,"NotAllowedError"):(XW(n,"Mic Error~"+e.t0.message),console.error("Mic Error:",e.t0.message));case 31:case"end":return e.stop()}}),e,this,[[17,28]])}))),FX.apply(this,arguments)}function GX(e){return GX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GX(e)}function HX(){HX=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==GX(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function qX(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var WX=__webpack_require__(2500),zX=__webpack_require__(2025);function KX(e,t,n,r){return YX.apply(this,arguments)}function YX(){return YX=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){qX(o,r,i,a,s,"next",e)}function s(e){qX(o,r,i,a,s,"throw",e)}a(void 0)}))}}(HX().mark((function e(t,n,r,i){var o;return HX().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.localVideoTrack){e.next=18;break}if(o=n.querySelector("#localUserPlaceholder"),this.localVideoTrackMuted){e.next=10;break}return e.next=5,this.localVideoTrack.setMuted(!0);case 5:this.localVideoTrackMuted=!0,r.innerHTML=zX(),o.style.display="flex",e.next=15;break;case 10:return e.next=12,this.localVideoTrack.setMuted(!1);case 12:this.localVideoTrackMuted=!1,r.innerHTML=WX(),o.style.display="none";case 15:this.isSharingEnabled&&(o.style.display="none"),e.next=32;break;case 18:return e.prev=18,e.next=21,i.createCameraVideoTrack();case 21:return this.localVideoTrack=e.sent,this.localVideoTrack.play("localVideoContainer"),e.next=25,this.client.publish([this.localAudioTrack,this.localVideoTrack]);case 25:this.localVideoTrackMuted=!1,r.innerHTML=WX(),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(18),e.t0.message.includes("NotReadableError")?XW(n,"NotReadableError"):e.t0.message.includes("NotAllowedError")?XW(n,"NotAllowedError"):(XW(n,"Camera Error~"+e.t0.message),console.error("Camera Error:",e.t0.message));case 32:case"end":return e.stop()}}),e,this,[[18,29]])}))),YX.apply(this,arguments)}function JX(e,t){var n="".concat(o.url.BASE,"/actions/join_meeting/").concat(this.copy_url_id,"/ask"),r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("value",n),document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r);var i=t.querySelector(".url-copied-indication-popup");i.classList.add("url-copied-indication-popup-show"),setTimeout((function(){i.classList.remove("url-copied-indication-popup-show")}),3e3)}function XX(e){return XX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XX(e)}function ZX(){ZX=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==XX(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function QX(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var $X=__webpack_require__(7651),eZ=__webpack_require__(429),tZ=__webpack_require__(5583);function nZ(e,t){return rZ.apply(this,arguments)}function rZ(){return rZ=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){QX(o,r,i,a,s,"next",e)}function s(e){QX(o,r,i,a,s,"throw",e)}a(void 0)}))}}(ZX().mark((function e(t,n){var r;return ZX().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw e.prev=0,new Error("CORS blocked - using fallback");case 4:return e.prev=4,e.t0=e.catch(0),console.log("Using image-to-canvas download method..."),e.prev=7,(r=new Image).crossOrigin="anonymous",e.abrupt("return",new Promise((function(e,i){r.onload=function(){try{var t=document.createElement("canvas"),o=t.getContext("2d");t.width=r.naturalWidth,t.height=r.naturalHeight,o.drawImage(r,0,0),t.toBlob((function(t){if(t){var r=window.URL.createObjectURL(t),o=document.createElement("a");o.style.display="none",o.href=r,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout((function(){window.URL.revokeObjectURL(r)}),100),e()}else i(new Error("Failed to create blob from canvas"))}),"image/jpeg",.9)}catch(e){console.error("Canvas method failed:",e),i(e)}},r.onerror=function(){var e=document.createElement("a");if(e.href=t,e.download=n,e.style.display="none",e.setAttribute("download",n),e.rel="noopener noreferrer",document.body.appendChild(e),"function"==typeof e.click)e.click();else{var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),e.dispatchEvent(r)}document.body.removeChild(e),i(new Error("Used direct link fallback"))},r.src=t})));case 13:e.prev=13,e.t1=e.catch(7),console.error("All download methods failed:",e.t1);case 16:case"end":return e.stop()}}),e,null,[[0,4],[7,13]])}))),rZ.apply(this,arguments)}function iZ(e){var t=e?new Date(e):new Date,n=t.getHours(),r=n>=12?"PM":"AM";n=(n%=12)||12;var i=t.getMinutes().toString().padStart(2,"0");return"".concat(n,":").concat(i," ").concat(r)}function oZ(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.querySelector(".saleassist-video-call-chat-container"),o=t.querySelectorAll(".saleassist-video-call-chat-log .unread"),a=t.querySelectorAll(".sa-message-notification"),s=t.querySelector(".saleassist-video-call-chat-header > span:nth-child(1)"),c=t.querySelector(".saleassist-video-call-chat-input-box"),l=t.querySelector("#saleassistVideoCaptionLog"),d=t.querySelector("#saleassistVideoChatLog");if("open"===n){var u=t.querySelector(".saleassist-video-call-more-options-control");i.classList.remove("sa-chat-hidden"),i.classList.add("sa-chat-active"),o&&!r&&o.forEach((function(e){return e.classList.remove("unread")})),a&&!r&&a.forEach((function(e){e.style.display="none",e.innerText=""})),r?(s.innerHTML="AI Chat Captions",c.style.display="none",l.style.display="flex",d.style.display="none",D()[e].is_enable_ai_audio_call_agent_all&&D()[e].is_enable_ai_audio_call_agent_offline||function(e,t){var n=document.createElement("div");[{en:"English"},{hi:"Hindi"},{kn:"Kannada"},{ta:"Tamil"},{te:"Telugu"}].forEach((function(t){var r=document.createElement("span"),i=Object.keys(t)[0];r.textContent=t[i],r.dataset.lang=i,"en"===i&&r.classList.add("activeLang"),r.addEventListener("click",(function(){n.querySelectorAll("span").forEach((function(e){e.classList.remove("activeLang")})),r.classList.add("activeLang"),e.querySelectorAll("#saleassistVideoCaptionLog .message").forEach((function(e){e.dataset[i]&&(e.textContent=e.dataset[i])}))})),n.appendChild(r)})),t.appendChild(n)}(t,s)):(s.innerHTML="In-Call Message",c.style.display="flex",d.style.display="flex",l.style.display="none"),u.classList.remove("more-options-control-active")}"close"===n&&(i.classList.remove("sa-chat-active"),i.classList.add("sa-chat-hidden"))}function aZ(e,t){var n=this,r=t.querySelector("#saleassistVideoChatMessageInput"),i=t.querySelector(".saleassist-video-call-document-preview-container"),a=r.value;if(this.files[0]){var s=t.querySelector(".saleassist-video-call-chat-input-box .chat-input-overlay");s.style.display="flex",function(e){var t=e.url,n=void 0===t?o.url.BASE:t,r=e.path,i=void 0===r?"":r,a=e.files,s=void 0===a?[]:a,c=e.onSuccess,l=void 0===c?function(){}:c,d=e.onFailure,u=void 0===d?function(){}:d,p={};p.headers=cX();var h=new FormData;s.map((function(e){return h.append("files",e)})),sX.post(lX(n+"/"+i),h,p).then((function(e){l(e)})).catch((function(e){u(e)}))}({url:o.url.BASE,path:"/meeting/".concat(this.copy_url_id,"/media"),files:this.files,onSuccess:function(o){n.files.forEach((function(e,t){var n="download-".concat(Date.now(),"-").concat(t);a+='\n            <a class="sa-chat-document-preview-sent" data-download-id="'.concat(n,'" data-url="').concat(o.data[t].url,'" data-filename="').concat(e.name,'" href="javascript:void(0);">\n              <span>').concat(tZ(),"</span>\n              <span>").concat(e.name,"</span>\n            </a>")})),n.socket.emit("chat_message",{text:a,userName:n.user_display_name}),cZ.call(n,e,t,"You",a,!0),n.files=[],r.value="",i.innerHTML="",s.style.display="none"},onFailure:function(e){n.files=[],s.style.display="none",console.warn("Unable to Send the document. "+(e.response&&e.response.data.detail||e.toString()))}})}""===a.trim()||this.files[0]||(this.socket.emit("chat_message",{text:a,userName:this.user_display_name}),cZ.call(this,e,t,"You",a,!0),r.value="")}function sZ(e,t,n,r,i,o,a){var s=t.querySelector("#saleassistVideoCaptionLog"),c=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div");if(s.querySelector(".".concat(a)))s.querySelector(".".concat(a," > div:nth-child(1)")).innerHTML=r;else{i?c.classList.add("sent",a):c.classList.add("received",a),l.classList.add("message"),d.classList.add("message-meta-info"),l.innerHTML=r;var u="".concat(i?"":"".concat(n," | ")).concat(iZ(o));null!=s&&s.lastChild&&(i&&"sent"===s.lastChild.className&&s.lastChild.outerText.includes(u)||!i&&"received"===s.lastChild.className&&s.lastChild.outerText.includes(u))&&(s.lastChild.lastChild.innerHTML=""),d.innerHTML=u,c.appendChild(l),c.appendChild(d),s.appendChild(c),s.scrollTop=s.scrollHeight}}function cZ(e,t,n,r,i){var o=t.querySelector("#saleassistVideoChatLog"),a=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),l=t.querySelector(".sa-message-notification").innerText||0,d=document.createElement("div");d.innerHTML=r,d.querySelectorAll("a.sa-chat-document-preview-sent").forEach((function(e){var t,n,r=e.getAttribute("data-url")||e.getAttribute("href")||e.getAttribute("src"),i=e.getAttribute("data-filename")||(null===(t=e.querySelector("span:last-child"))||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.trim())||"download";if(r&&r.match(/\.(jpg|jpeg|png|gif|webp)$/i)){var o=document.createElement("div");o.className="sa-chat-image-preview",o.innerHTML='\n        <img src="'.concat(r,'" />\n        <div style="padding:5px; background-color:#1f1f1f; border-radius:5px">').concat(i,"</div>"),e.replaceWith(o)}else e.style.cursor="pointer",e.addEventListener("click",(function(e){e.preventDefault();var t=document.createElement("a");t.href=r,t.download=filename,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}))})),d.querySelectorAll('div[style*="display:flex"][style*="justify-content:flex-end"]').forEach((function(e){var t=e.querySelector("a[href][download]");if(t){var n=t.getAttribute("href"),r=t.querySelector("img");if(r&&n.match(/\.(jpg|jpeg|png|gif|webp)$/i)){var i=r.getAttribute("src"),o=r.getAttribute("style")||"max-width:200px; display:block; border-radius:6px;",a=document.createElement("div");a.style.cssText=e.getAttribute("style")||"display:flex; justify-content:flex-end;";var s=document.createElement("img");s.src=i,s.style.cssText=o,a.appendChild(s),e.replaceWith(a)}}})),d.querySelectorAll("a[download], a[href]").forEach((function(e){var t=e.getAttribute("href")||e.getAttribute("data-url")||"",n=e.querySelector("svg");n&&t.match(/\.(jpg|jpeg|png|gif|webp)$/i)&&(n.querySelector('path[d*="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"]')&&n.remove())})),r=d.innerHTML,i?a.classList.add("sent"):(a.classList.add("received"),t.querySelector(".sa-chat-hidden")&&(a.classList.add("unread"),l=+l+1,t.querySelectorAll(".sa-message-notification").forEach((function(e){return e.innerText=l})))),s.classList.add("message"),c.classList.add("message-meta-info"),s.innerHTML=r,setTimeout((function(){!function(e){var t=e.querySelectorAll("a.sa-chat-document-preview-sent");t.forEach((function(e){var t,n,r=e.getAttribute("data-url")||e.getAttribute("href"),i=e.getAttribute("data-filename")||(null===(t=e.querySelector("span:last-child"))||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.trim())||"download";e.setAttribute("href","#"),e.removeAttribute("target"),e.onclick=function(e){return e.preventDefault(),e.stopPropagation(),nZ(r,i),!1}}));var n=e.querySelectorAll("a.sa-chat-download-link");n.forEach((function(e){var t,n,r=e.getAttribute("data-url")||e.getAttribute("href"),i=e.getAttribute("data-filename")||(null===(t=e.querySelector("strong"))||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.trim())||"product-image";e.setAttribute("href","#"),e.removeAttribute("target"),e.onclick=function(e){return e.preventDefault(),e.stopPropagation(),nZ(r,i),!1}}));var r=e.querySelectorAll("a[data-url]");r.forEach((function(e){var t;if(!e.classList.contains("sa-chat-document-preview-sent")&&!e.classList.contains("sa-chat-download-link")){var n=e.getAttribute("data-url"),r=e.getAttribute("data-filename")||(null===(t=e.textContent)||void 0===t?void 0:t.trim())||"download";n&&(e.setAttribute("href","#"),e.removeAttribute("target"),e.onclick=function(e){return e.preventDefault(),e.stopPropagation(),nZ(n,r),!1})}}))}(s)}),100);var u=c.innerHTML="".concat(i?"live_streaming"===this.is_streaming?"".concat(n," | "):"":"".concat(n," | ")).concat(iZ());null!=o&&o.lastChild&&(i&&"sent"===o.lastChild.className&&o.lastChild.outerText.includes(u)||!i&&"received"===o.lastChild.className&&o.lastChild.outerText.includes(u))&&(o.lastChild.lastChild.innerHTML=""),c.innerHTML=u,a.appendChild(s),a.appendChild(c),o.appendChild(a),o.scrollTop=o.scrollHeight,window.downloadFileWithFetch=nZ}function lZ(e,t,n,r){cZ.call(this,e,t,n,r,!1)}function dZ(e,t,n){var r=t.querySelector("#".concat(n)),i=this.files.findIndex((function(e){return e.name===n}));-1!==i&&this.files.splice(i,1),r.remove()}function uZ(e,t,n){var r=this,i=t.querySelector(".saleassist-video-call-document-preview-container");if(n.target.files&&n.target.files.length>0)for(var o=n.target.files,a=function(){r.files.push(o[s]);var n=document.createElement("div");n.className="sa-chat-document-preview",n.id="preview-doc-".concat(o[s].lastModified,"-").concat(o[s].size),n.innerHTML='\n        <span class="sa-chat-document-file-name">\n          '.concat(eZ()+" "+o[s].name,'\n        </span>\n        <span class="sa-chat-remove-document-button">').concat($X(),"</span>\n      "),i.appendChild(n),n.querySelector(".sa-chat-remove-document-button").addEventListener("click",(function(){dZ.call(r,e,t,n.id)}))},s=0;s<o.length;s++)a()}function pZ(e,t,n,r,i){var o=e.querySelector("#saleassistVideoCaptionLog").querySelector(".".concat(t,".").concat(i," .message")),a=e.querySelector(".saleassist-video-call-chat-header > span:nth-child(1) .activeLang");o&&(o.dataset[n]=r,o.textContent=o.dataset[a.dataset.lang])}function hZ(e,t){var n=t.querySelector(".saleassist-video-call-chat-log"),r=t.querySelectorAll(".sa-message-notification");null!==n.querySelector(".unread")?r.forEach((function(e){return e.style.display="flex"})):r.forEach((function(e){return e.style.display="none"}))}function fZ(e){return fZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fZ(e)}function mZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mZ(Object(n),!0).forEach((function(t){vZ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vZ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==fZ(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==fZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===fZ(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _Z=__webpack_require__(8540),yZ=__webpack_require__(9219);function wZ(e,t,n){var r=U()[e],i=t.querySelector("#videoCallContainer"),o=t.querySelector(".sa-hold-screen-container"),a=document.createElement("div");if(a.className="sa-hold-screen-container",a.innerHTML=_Z({phoneHold:yZ()}),!0===n.hold&&!o){var s;if(i.appendChild(a),null!=n&&n.sourceName){var c=document.querySelector(".sa-hold-screen-wrapper"),l=document.createElement("div");l.className="sa-hold-screen-header";var d=document.createElement("span");d.className="sa-hold-screen-text",d.innerText=n.sourceName,l.appendChild(d),c.insertBefore(l,c.firstChild)}if((null==n||null===(s=n.logo)||void 0===s?void 0:s.length)>0){var u,p=document.querySelector(".sa-hold-screen-waiting-message");u='<img alt="" src="'.concat(n.logo,'"/>'),p&&u&&(p.innerHTML=u)}else bZ(e,t)}if(!1===n.hold&&o){i.removeChild(o);var h=r.holdScreenTimers;Array.isArray(h)&&D$(h)}}var bZ=function(e,t){var n=D()[e],r=U()[e],i=[],o=0,a=0,s=setInterval((function(){0==parseInt(o%n.message_interval)&&(EZ(e,t,n.wait_messages[a]),(a+=1)>=n.wait_messages.length&&(a=0)),o+=1}),1e3);i.push(s),M(vZ({},e,gZ(gZ({},r),{},{holdScreenTimers:i})))},EZ=function(e,t,n){var r,i=t.querySelector(".sa-hold-screen-waiting-message");r=/\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(n)?'<img alt=""src="'.concat(n,'"/>'):/\.(mp4|mov|wmv|avi|avchd|mkv|webm|swf)$/.test(n)?'\n        <video\n          src="'.concat(n,'"\n          muted\n          autoplay\n          loop\n          playsinline\n          controls\n        />'):'<img alt="" src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/connecting_720.png"/>',i&&r&&(i.innerHTML=r)};function SZ(e,t,n){var r=t.querySelector(".saleassist-video-call-shopping-container");"open"===n&&(r.classList.remove("sa-shopping-hidden"),r.classList.add("sa-shopping-active")),"close"===n&&(r.classList.remove("sa-shopping-active"),r.classList.add("sa-shopping-hidden"))}var TZ=__webpack_require__(6567);function CZ(e,t){var n=t.querySelector(".saleassist-video-call-products-container");this.streaming_products.map((function(e,t){var r=document.createElement("div");r.className="sa-live-stream-product-card ".concat(0===t?"sa-live-stream-active-product":"");var i=document.createElement("div");i.className="sa-live-stream-highlight-product",i.innerHTML=TZ(),r.appendChild(i);var o=document.createElement("div");o.className="sa-live-stream-product-image";var a=document.createElement("img");a.src=e.product_display_image||e.product_images[0],o.appendChild(a),r.appendChild(o);var s=document.createElement("div");s.className="sa-live-stream-product-details",s.innerHTML='\n        <span class="sa-live-stream-product-title">\n            '.concat(e.product_name,'\n        </span>\n        <span class="sa-live-stream-product-price">\n            <span class="').concat(e.offer_price>0?"strike-through-price":"",'">\n                ').concat(e.product_currency," ").concat(e.product_price," \n            </span>\n            ").concat(e.offer_price>0?"<span>".concat(e.product_currency," ").concat(e.offer_price,"</span>"):"","\n        </span>"),r.appendChild(s);var c=document.createElement("span");c.textContent="Shop Now",c.className="sa-live-stream-shop-now-btn",r.appendChild(c),r.onclick=function(){window.open(e.product_url,"_blank")},n.appendChild(r)}))}function RZ(e,t,n){var r=t.querySelector(".sa-live-stream-active-product"),i=t.querySelectorAll(".saleassist-video-call-products-container .sa-live-stream-product-card");r&&r.classList.remove("sa-live-stream-active-product"),i[n].classList.add("sa-live-stream-active-product")}function OZ(){var e=this;this.client.on("network-quality",(function(t){var n=document.querySelector("#localVideoContainer .network-quality-info"),r=(t.uplinkNetworkQuality+t.downlinkNetworkQuality)/2,i="#999";n&&(r<1?n.style.color="#999":r<2?(n.style.color="#0CDD08",i="#0CDD08"):r<3?(n.style.color="yellow",i="yellow"):r<4?(n.style.color="orange",i="orange"):(n.style.color="#eb271e",i="#eb271e")),e.socket.emit("chat_message",{networkQuality:r,meeting_id:e.copy_url_id,uid:e.agoraUID,color:i})}))}var IZ=__webpack_require__(4492),AZ=(IZ.roots.default||(IZ.roots.default=new IZ.Root)).addJSON({Agora:{nested:{SpeechToText:{options:{objc_class_prefix:"Stt",csharp_namespace:"AgoraSTTSample.Protobuf",java_package:"io.agora.rtc.speech2text",java_outer_classname:"AgoraSpeech2TextProtobuffer"},nested:{Text:{fields:{vendor:{type:"int32",id:1},version:{type:"int32",id:2},seqnum:{type:"int32",id:3},uid:{type:"int64",id:4},flag:{type:"int32",id:5},time:{type:"int64",id:6},lang:{type:"int32",id:7},starttime:{type:"int32",id:8},offtime:{type:"int32",id:9},words:{rule:"repeated",type:"Word",id:10},endOfSegment:{type:"bool",id:11},durationMs:{type:"int32",id:12},dataType:{type:"string",id:13},trans:{rule:"repeated",type:"Translation",id:14},culture:{type:"string",id:15},textTs:{type:"int64",id:16}}},Word:{fields:{text:{type:"string",id:1},startMs:{type:"int32",id:2},durationMs:{type:"int32",id:3},isFinal:{type:"bool",id:4},confidence:{type:"double",id:5}}},Translation:{fields:{isFinal:{type:"bool",id:1},lang:{type:"string",id:2},texts:{rule:"repeated",type:"string",id:3}}}}}}}});function kZ(e,t,n,r,i){var o,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=e.querySelector(".sa-live-call-widget-expanded"),c=e.querySelector(".sa-live-call-widget-expanded-inner-wrapper"),l=e.querySelector(".sa-live-call-widget-powered-by-strip"),d=e.querySelector(t);r?(s.classList.add("sa-live-call-widget-expanded-minimize-tile",i),c.classList.remove("sa-live-call-widget-powered-by-true")):(s.classList.remove("sa-live-call-widget-expanded-minimize-tile",i),c.classList.add("sa-live-call-widget-powered-by-true")),l.style.display=r?"none":"flex",n.style.display=r?"block":"none",d.style.zIndex=r?3:"",null==a||null===(o=a.otherEl)||void 0===o||o.forEach((function(t){var n=e.querySelector(t);n&&(n.style.display=r?"none":"flex")}))}function xZ(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.sampleSize||32,a=i.interval||250,s=null!==(n=i.luminanceThreshold)&&void 0!==n?n:200,c=null!==(r=i.percentThreshold)&&void 0!==r?r:.65,l=Math.max(1,i.streakThreshold||2),d="function"==typeof i.onChange?i.onChange:null,u=i.lightBg||"rgba(0,0,0,0.5)",p=i.darkBg||"rgba(255,255,255,0.3)",h=document.createElement("canvas");h.width=o,h.height=o;var f,m=h.getContext("2d"),g=!0,v=null,_=0,y=null;function w(){if(g){var n,r="function"==typeof e?e():"string"==typeof e?document.querySelector(e):e instanceof Element?e:null,i=(n="function"==typeof t?t():"string"==typeof t?document.querySelectorAll(t):t)?n instanceof Element?[n]:n instanceof NodeList?Array.from(n):Array.isArray(n)?n.filter((function(e){return e instanceof Element})):[]:[];if(r&&0!==i.length)if(r.readyState<2||!r.videoWidth||!r.videoHeight)f=setTimeout(w,a);else{try{m.drawImage(r,0,0,r.videoWidth,r.videoHeight,0,0,o,o);for(var h=m.getImageData(0,0,o,o).data,b=0,E=h.length/4,S=0;S<h.length;S+=4){.2126*h[S]+.7152*h[S+1]+.0722*h[S+2]>=s&&b++}var T=b/E>=c;v===T?_++:(v=T,_=1),_>=l&&T!==y&&(y=T,function(e,t){t.forEach((function(t){t&&(d?d(e,t):t.style.backgroundColor=e?u:p)}))}(T,i))}catch(e){console.warn("monitorVideoLight: sampling failed:",e)}f=setTimeout(w,a)}else f=setTimeout(w,a)}}return f=setTimeout(w,a),{stop:function(){g=!1,clearTimeout(f)},start:function(){g||(g=!0,w())}}}function LZ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return NZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NZ(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PZ(e,t){var n=t.toLowerCase(),r=[];return null==e||e.forEach((function(e){var t=LZ(Object.entries(e)[0],2),i=t[0],o=t[1],a=i.toLowerCase().split(",").map((function(e){return e.trim()})),s=0;a.forEach((function(e){new RegExp("\\b".concat(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"),"i").test(n)&&s++})),s>0&&r.push({url:o,matchCount:s})})),0===r.length?null:(r.sort((function(e,t){return t.matchCount-e.matchCount})),r[0].url)}function DZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(e&&"IMG"===e.tagName){e.style.transition="transform 0.25s ease-out",e.style.cursor="zoom-in",e.style.touchAction="none";var n=function(n){var r=e.getBoundingClientRect(),i=(n.touches?n.touches[0].clientX:n.clientX)-r.left,o=(n.touches?n.touches[0].clientY:n.clientY)-r.top,a=i/r.width*100,s=o/r.height*100;e.style.transformOrigin="".concat(a,"% ").concat(s,"%"),e.style.transform="scale(".concat(t,")")},r=function(){e.style.transform="scale(1)"};e.addEventListener("mousemove",n),e.addEventListener("mouseleave",r),e.addEventListener("touchstart",n),e.addEventListener("touchmove",n),e.addEventListener("touchend",r)}}function MZ(e){return MZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MZ(e)}function UZ(){UZ=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==MZ(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function jZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function VZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jZ(Object(n),!0).forEach((function(t){BZ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function BZ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==MZ(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==MZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===MZ(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FZ(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function GZ(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){FZ(o,r,i,a,s,"next",e)}function s(e){FZ(o,r,i,a,s,"throw",e)}a(void 0)}))}}function HZ(e,t,n){U()[e].form_data.unique_field_value===F("session_data_".concat(e))&&setTimeout((function(){var r=t.querySelector(".sa-lead-capture-prompt"),i=n.unique_field_name;if(r&&!r.querySelector(".sa-unique-field-container")){var a=document.createElement("div");a.className="sa-unique-field-container",a.style.cssText="\n      background: #fff;\n      border-radius: 14px;\n      padding: 16px;\n    ";var s=document.createElement("div");s.style.cssText="font-weight: bold; margin-bottom: 8px; font-size: 14px",s.innerText="Stay Connected";var c=document.createElement("div");switch(c.style.cssText="font-size: 12px; color: #555; margin-bottom: 12px; line-height: normal",i){case"mobile_number":c.innerText="Share your number so we can call you back if the connection drops";break;case"email":c.innerText="Share your email so we can reach you back if needed";break;case"name":c.innerText="Please share your name for better communication";break;default:c.innerText="Please share your details"}var d=document.createElement("input");d.type="text",d.placeholder="mobile_number"===i?"Your phone number":"email"===i?"Your email":"Your name",d.style.cssText="\n      width: 100%;\n      padding: 6.5px 8px;\n      border: 1px solid #ccc;\n      border-radius: 8px;\n      margin-right: 8px;\n    ";var u=document.createElement("button");u.innerText="Save",u.style.cssText="\n      height: 32px;\n      padding: 8px 12px;\n      background: var(--themeColor);\n      color: var(--invertColor);\n      border: none;\n      border-radius: 8px;\n      font-size: 12px;\n      cursor: pointer;\n    ",u.onclick=GZ(UZ().mark((function t(){var n,s;return UZ().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=d.value.trim()){t.next=4;break}return alert("Please enter a value"),t.abrupt("return");case 4:return s=U()[e].form_data,t.prev=5,t.next=8,l.post(o.url.SOURCE,"/".concat(e,"/re-capture"),{session_id:s.session_id,people_id:s.people_id,user_data:BZ({},i,n)});case 8:s.unique_field_value=n,B("form_data_".concat(e),s),B("user_data_".concat(e),BZ({},i,n)),M(BZ({},e,VZ(VZ({},U()[e]),{},{form_data:s}))),r.removeChild(a),r.style.display="none",t.next=19;break;case 16:t.prev=16,t.t0=t.catch(5),console.error("Error in updating the unique field value:",t.t0);case 19:case"end":return t.stop()}}),t,null,[[5,16]])})));var p=document.createElement("div");p.style.cssText="display: flex; align-items: center;",p.appendChild(d),p.appendChild(u),a.appendChild(s),a.appendChild(c),a.appendChild(p),r.appendChild(a),r.style.display="block"}}),5e3)}function qZ(e){return qZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qZ(e)}function WZ(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=KZ(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zZ(e){return function(e){if(Array.isArray(e))return YZ(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||KZ(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KZ(e,t){if(e){if("string"==typeof e)return YZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YZ(e,t):void 0}}function YZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JZ(){JZ=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==qZ(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function XZ(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ZZ(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){XZ(o,r,i,a,s,"next",e)}function s(e){XZ(o,r,i,a,s,"throw",e)}a(void 0)}))}}function QZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==qZ(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==qZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===qZ(o)?o:String(o)),r)}var i,o}UW.enableLogUpload(),UW.setLogLevel(3);var $Z=__webpack_require__(2615),eQ=__webpack_require__(710),tQ=__webpack_require__(2025),nQ=__webpack_require__(2500),rQ=__webpack_require__(5494),iQ=__webpack_require__(296),oQ=__webpack_require__(8738),aQ=__webpack_require__(4699),sQ=__webpack_require__(9346),cQ=__webpack_require__(5506),lQ=__webpack_require__(2012),dQ=__webpack_require__(4925),uQ=__webpack_require__(8073),pQ=__webpack_require__(3618),hQ=__webpack_require__(7651),fQ=__webpack_require__(8437),mQ=__webpack_require__(1673),gQ=__webpack_require__(7458),vQ=__webpack_require__(8873),_Q=__webpack_require__(9644),yQ=__webpack_require__(3585),wQ=__webpack_require__(7339),bQ=__webpack_require__(1906),EQ=__webpack_require__(4520),SQ=__webpack_require__(7565),TQ=__webpack_require__(2832),CQ=function(){function e(t,n,r,i,a){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formData=F("form_data_".concat(t)),this.agoraAppId=r.widget_creds.app_id,this.agoraChannelName=r.widget_creds.channel_name,this.agoraToken=r.widget_creds.token,this.agoraUID=r.widget_creds.uid,this.people_id=this.formData.people_id,this.client_id=r.client_id,this.is_recording_on=r.is_recording_on,this.copy_url_id=r.title,this.user_display_name=r.user_display_name,this.message_type=i,this.streaming_products=r.products,this.streaming_moderators=r.moderators,this.is_streaming=r.meeting_type,this.room_id=a,this.messageEngine=null,this.isEmbedOrJump="embed"===U()[t].form_factor||window.location.href.includes("/jump/"),this.client=UW.createClient({mode:"live_streaming"===this.is_streaming?"live":"rtc",codec:"vp8"}),D()[t].is_enable_ai_audio_call_agent_all&&D()[t].is_enable_ai_audio_call_agent_offline||this.client.on("stream-message",(function(e,t){var r,i;if(5===e.toString().length){var o,a,c=AZ.Agora.SpeechToText.lookup("Text").decode(t);if("translate"===c.dataType&&null!==(r=c.trans[0])&&void 0!==r&&r.texts)if(c.uid===s.agoraUID)pZ(n,"sent",c.culture.split("-")[0],null===(o=c.trans[0])||void 0===o?void 0:o.texts[0],"msg_".concat(c.uid,"_").concat(c.textTs));else pZ(n,"received",c.culture.split("-")[0],null===(a=c.trans[0])||void 0===a?void 0:a.texts[0],"msg_".concat(c.uid,"_").concat(c.textTs));if("transcribe"===c.dataType&&null!==(i=c.words[0])&&void 0!==i&&i.isFinal)if(c.uid===s.agoraUID)sZ(0,n,"You",c.words[0].text,!0,c.textTs,"msg_".concat(c.uid,"_").concat(c.textTs)),pZ(n,"sent",c.culture.split("-")[0],c.words[0].text,"msg_".concat(c.uid,"_").concat(c.textTs)),mX("".concat(s.copy_url_id,"_transcript"),{msg_id:"msg_".concat(c.uid,"_").concat(c.textTs),sender:s.user_display_name,text:c.words[0].text},1);else{var l=iz(s.remoteUsers[c.uid]?s.remoteUsers[c.uid].user_display_name:"User-".concat(null==c?void 0:c.uid));sZ(0,n,l,c.words[0].text,!1,c.textTs,"msg_".concat(c.uid,"_").concat(c.textTs)),pZ(n,"received",c.culture.split("-")[0],c.words[0].text,"msg_".concat(c.uid,"_").concat(c.textTs)),mX("".concat(s.copy_url_id,"_transcript"),{msg_id:"msg_".concat(c.uid,"_").concat(c.textTs),sender:l,text:c.words[0].text},1)}}})),this.localAudioTrack,this.localVideoTrack,this.localScreenTrack,this.remoteUsers={},this.localAudioTrackMuted=!1,this.localVideoTrackMuted=!0,this.isSharingEnabled=!1,this.videoInputDevices,this.audioInputDevices,this.files=[],this.isMessageOpen=!1,this.isChatCaptionOpen=!1,this.isShoppingOpen=!1,this.liveStreamTimer=null,this.loaderEl="",this.resizeObserver,this.chatLogObserver,this.brightnessInterval=null,this.autoMinimizeTimeout=null,this.screen_creds,this.screen_client=UW.createClient({mode:"live_streaming"===this.is_streaming?"live":"rtc",codec:"vp8"});var c="meeting_id=".concat(this.copy_url_id,"&client_id=").concat(this.client_id,"&uid=").concat(this.formData.unique_field_value);"live_streaming"===this.is_streaming?c+="&type=anonymous":c+="&id=".concat(this.people_id);var l=uY(o.url.SOCKET_URL,{query:c,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:1e4,transports:["websocket"]});l.on("connect",(function(e){s.socket=l})),l.on("message",function(){var e=ZZ(JZ().mark((function e(r){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("meeting_recording_started"===r.message&&RX(0,n,"record_started"),"meeting_recording_ended"===r.message&&RX(0,n,"record_ended"),"widget_incoming_request_closed"!==r.message){e.next=5;break}return e.next=5,yX.call(s,t,n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.on("chat_message",function(){var e=ZZ(JZ().mark((function e(r){var i,o;return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in r)"text"===i&&s.user_display_name!=r.userName&&lZ.call(s,t,n,iz(r.userName),r.text),"hold"===i&&wZ(t,n,r),"product_index"===i&&RZ(0,n,r.product_index),"networkQuality"===i&&s.agoraUID!=r.uid&&(o=document.querySelector("#remoteVideo_".concat(r.uid," .network-quality-info")))&&(o.style.color=r.color);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),"function"==typeof window.startCoBrowsing&&window.startCoBrowsing(this.user_display_name,this.copy_url_id),this.initStylesheet().then((function(){s.init(t,n).then((function(){return s.renderElement(t,n)}))}))}var t,n,r,i,a,s;return t=e,n=[{key:"initStylesheet",value:(s=ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("live_streaming"!==this.is_streaming){e.next=5;break}return e.next=3,__webpack_require__.e(163).then(__webpack_require__.bind(__webpack_require__,9163));case 3:e.next=7;break;case 5:return e.next=7,__webpack_require__.e(249).then(__webpack_require__.bind(__webpack_require__,7249));case 7:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"init",value:(a=ZZ(JZ().mark((function e(t,n){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.querySelector("#saleassist-video-call-app").innerHTML=$Z({user_display_name_first_letter:"Y",user_display_name:"You",screenShare:eQ(),toggleCamera:tQ(),toggleAudio:rQ(),flipCamera:iQ(),endCall:oQ(),videoCallTileToggle:aQ(),maximize:sQ(),minTile:cQ(),maxTile:lQ(),moreOption:dQ(),message:uQ(),settings:pQ(),videoInputDeivce:nQ(),ccBtn:TQ(),closeBtn:hQ(),infoIcon:fQ(),recordIcon:mQ(),shareUrl:gQ(),uploadBtn:_Q(),sendBtn:vQ(),threeDotsLoader:yQ(),shoppingCart:wQ(),UserCountIcon:bQ(),shareIcon:EQ(),networkIcon:SQ(),agoraUID:this.agoraUID,isLiveStream:"live_streaming"===this.is_streaming,isEmbedOrJump:this.isEmbedOrJump,isAudioCall:"audio_call"===this.message_type}),this.loaderEl=document.querySelector(".saleassist-video-call-loader"),this.loaderEl.style.display="flex","live_streaming"!==this.is_streaming){e.next=10;break}return this.client.setClientRole("audience"),e.next=8,Fz.call(this,t,n,UW);case 8:return this.loaderEl.style.display="none",e.abrupt("return");case 10:return e.next=12,ez.call(this,t,n,UW);case 12:return e.next=14,Fz.call(this,t,n,UW);case 14:this.loaderEl.style.display="none";case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"renderElement",value:(i=ZZ(JZ().mark((function e(t,n){var r,i,o,a,s,c,l,d,u,p,h,f,m,g,v,_,y,w,b,E,S,T,C,R,O,I,A,k,x,L,N,P,M=this;return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.querySelector("#leaveButton"),i=n.querySelector("#screenShare"),o=n.querySelector("#flipCamera"),a=n.querySelector("#toggleCamera"),s=n.querySelector("#toggleAudio"),c=n.querySelector("#videoCallMaximizeButton"),l=n.querySelector("#videoCallMinTileButton"),d=n.querySelector("#videoCallMaxTileOverlay"),u=n.querySelector("#moreButton"),p=n.querySelector("#sa-settings"),h=n.querySelector("#inputDeviceSettingsClose"),f=n.querySelector("#videoInputDeviceSetting select"),m=n.querySelector("#audioInputDeviceSetting select"),g=n.querySelector("#videoCallShareUrlCopyButton"),v=n.querySelector("#sa-message"),_=n.querySelector("#sa-chat-caption"),y=n.querySelector("#saleassistVideoChatMessageInput"),w=n.querySelector("#saleassistVideoChatSendButton"),b=n.querySelector("#saleassistVideoChatCloseButton"),E=n.querySelector("#saleassistVideoChatUploadButton #upload-file"),S=n.querySelector(".saleassist-video-call-chat-log"),T=n.querySelector("#sa-shoppingCart"),C=n.querySelector("#saleassistVideoShoppingCloseButton"),window.matchMedia("(max-width: 1024px)").matches,R=n.querySelector(".sa-live-stream-info-bar"),O=n.querySelector(".sa-live-stream-info span"),I=n.querySelector("#sa-live-stream-message"),A=n.querySelector("#sa-live-stream-share"),k=n.querySelector("#liveStreamCloseButton"),x=n.querySelector("#sa-live-stream-shoppingCart"),OZ.call(this),Az(n),HZ(t,n,D()[t]),this.brightnessInterval=xZ("#videoCallMainScreen video",(function(){return[n.querySelector(".videoCallVideoTilesToggleBtn"),n.querySelector("#videoCallMainScreen .mic-status-indicator"),n.querySelector("#videoCallMainScreen .network-quality-info"),n.querySelector("#videoCallShareUrlCopyButton"),n.querySelector("#videoCallMinTileButton"),n.querySelector("#videoCallMaximizeButton"),n.querySelector(".saleassist-video-call-more-options-control")].concat(zZ(n.querySelectorAll("#saleassist-video-call-controls button")))})),"mediaDevices"in navigator&&"getDisplayMedia"in navigator.mediaDevices&&(i.style.display="live_streaming"===this.is_streaming?"block":"flex"),"audio_call"===this.message_type&&(a.style.display="none",n.querySelector("#videoInputDeviceSetting").style.display="none"),"live_streaming"===this.is_streaming&&(L=n.querySelector("#saleassist-video-call-app"),N=n.querySelector("#localVideoContainer"),L.classList.add("saleassist-livestream"),N.remove(),i.remove(),o.remove(),a.remove(),s.remove(),u.remove(),p.remove(),this.streaming_products.length>0&&CZ.call(this,t,n),this.streaming_products.length<=0&&(T.style.display="none",x.style.display="none"),R.style.display="flex",O.innerHTML=0),this.is_recording_on&&RX(0,n,"record_started"),r.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yX.call(M,t,n);case 2:case"end":return e.stop()}}),e)})))),i.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,NX.call(M,t,n,UW,i);case 2:case"end":return e.stop()}}),e)})))),o.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,KW.call(M,t,n,f);case 2:case"end":return e.stop()}}),e)})))),a.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,KX.call(M,t,n,a,UW);case 2:case"end":return e.stop()}}),e)})))),s.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,BX.call(M,t,n,s,UW);case 2:case"end":return e.stop()}}),e)})))),c.addEventListener("click",(function(){SX.call(M,t,n,c)})),null==l||l.addEventListener("click",(function(){kZ(n,"#videoCallMainScreen",d,!0,M.message_type)})),d.addEventListener("click",(function(){kZ(n,"#videoCallMainScreen",d,!1,M.message_type)})),u.addEventListener("click",(function(){TX(0,n)})),p.addEventListener("click",(function(){HW(0,n,"open")})),h.addEventListener("click",(function(){HW(0,n,"close")})),"audio_call"!==this.message_type||this.isEmbedOrJump||(this.autoMinimizeTimeout=setTimeout((function(){return l.click()}),5e3)),"video_call"===this.message_type&&f&&f.addEventListener("change",function(){var e=ZZ(JZ().mark((function e(r){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FW.call(M,t,n,"video",r.target.value);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m&&m.addEventListener("change",function(){var e=ZZ(JZ().mark((function e(r){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FW.call(M,t,n,"audio",r.target.value);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JX.call(M,t,n);case 2:case"end":return e.stop()}}),e)})))),v.addEventListener("click",(function(){M.isMessageOpen?oZ(t,n,"close"):(oZ(t,n,"open"),M.isChatCaptionOpen=!1),M.isMessageOpen=!M.isMessageOpen})),_.addEventListener("click",(function(){M.isChatCaptionOpen?oZ(t,n,"close",!0):(oZ(t,n,"open",!0),M.isMessageOpen=!1),M.isChatCaptionOpen=!M.isChatCaptionOpen})),b.addEventListener("click",(function(){oZ(t,n,"close"),M.isMessageOpen=!1,M.isChatCaptionOpen=!1})),w.addEventListener("click",(function(){aZ.call(M,t,n)})),y.addEventListener("keydown",(function(e){13===e.keyCode&&(e.preventDefault(),aZ.call(M,t,n))})),E.addEventListener("click",(function(e){e.target.value=null})),E.addEventListener("change",(function(e){uZ.call(M,t,n,e)})),this.chatLogObserver=new MutationObserver((function(e,t){var r,i=WZ(e);try{for(i.s();!(r=i.n()).done;)"childList"===r.value.type&&hZ(0,n)}catch(e){i.e(e)}finally{i.f()}})),this.chatLogObserver.observe(S,{childList:!0,subtree:!0}),null==T||T.addEventListener("click",(function(){M.isShoppingOpen?SZ(0,n,"close"):SZ(0,n,"open"),M.isShoppingOpen=!M.isShoppingOpen})),null==C||C.addEventListener("click",(function(){SZ(0,n,"close"),M.isShoppingOpen=!1})),null==I||I.addEventListener("click",(function(){M.isMessageOpen?oZ(t,n,"close"):oZ(t,n,"open"),M.isMessageOpen=!M.isMessageOpen})),null==A||A.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JX.call(M,t,n);case 2:case"end":return e.stop()}}),e)})))),null==k||k.addEventListener("click",ZZ(JZ().mark((function e(){return JZ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yX.call(M,t,n);case 2:case"end":return e.stop()}}),e)})))),null==x||x.addEventListener("click",(function(){M.isShoppingOpen?SZ(0,n,"close"):SZ(0,n,"open"),M.isShoppingOpen=!M.isShoppingOpen})),"live_streaming"===this.is_streaming&&(P=n.querySelector("#videoCallMainScreen"),this.resizeObserver=new ResizeObserver((function(e){var t,n,r=WZ(e);try{for(r.s();!(n=r.n()).done;)t=n.value.contentRect.width}catch(e){r.e(e)}finally{r.f()}window.innerWidth>768&&t<810?P.classList.add("sa-optimize--layout"):P.classList.remove("sa-optimize--layout")})),this.resizeObserver.observe(P)),window.addEventListener("message",(function(e){var r=e.data;if("captions"===(null==r?void 0:r.type)){var i=r.chatCaptionHistory;if(!i)return;i.forEach((function(e){if(0===e.uid){var r,i,o=(null===(r=D()[t])||void 0===r?void 0:r.ai_chat_bot_name)||"Agent";sZ(0,n,o,e.text,!1,e._time,"msg_".concat(e.uid,"_").concat(e.turn_id)),mX("".concat(M.copy_url_id,"_transcript"),{msg_id:"msg_".concat(e.uid,"_").concat(e.turn_id),sender:o,text:e.text},1);var a,s=PZ(null===(i=D()[t])||void 0===i?void 0:i.screenshare_context,e.text),c=n.querySelector(".sa-video-call-action-panel");s?(c.style.display="block",c&&(/\.(jpg|jpeg|png|gif|webp)$/i.test(s)?((a=document.createElement("img")).src=s,a.alt="Screen share content"):/\.(mp4|webm|ogg)$/i.test(s)&&((a=document.createElement("video")).src=s,a.controls=!0,a.autoplay=!0,a.muted=!0,a.loop=!0),a&&(c.innerHTML="",c.appendChild(a),DZ(a)))):(c.style.display="none",c.innerHTML="")}else if(e.uid===M.agoraUID)sZ(0,n,"You",e.text,!0,e._time,"msg_".concat(e.uid,"_").concat(e.turn_id)),mX("".concat(M.copy_url_id,"_transcript"),{msg_id:"msg_".concat(e.uid,"_").concat(e.turn_id),sender:M.user_display_name,text:e.text},1);else{var l=iz(M.remoteUsers[e.uid]?M.remoteUsers[e.uid].user_display_name:"User-".concat(null==e?void 0:e.uid));sZ(0,n,l,e.text,!1,e._time,"msg_".concat(e.uid,"_").concat(e.turn_id)),mX("".concat(M.copy_url_id,"_transcript"),{msg_id:"msg_".concat(e.uid,"_").concat(e.turn_id),sender:l,text:e.text},1)}}))}}));case 70:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})}],n&&QZ(t.prototype,n),r&&QZ(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const RQ=CQ;var OQ=__webpack_require__(8235),IQ={};IQ.styleTagTransform=S(),IQ.setAttributes=y(),IQ.insert=v().bind(null,"head"),IQ.domAPI=m(),IQ.insertStyleElement=b();h()(OQ.Z,IQ);OQ.Z&&OQ.Z.locals&&OQ.Z.locals;function AQ(e){return AQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AQ(e)}function kQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kQ(Object(n),!0).forEach((function(t){LQ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kQ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function LQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==AQ(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==AQ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===AQ(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NQ(){NQ=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==AQ(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function PQ(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function DQ(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){PQ(o,r,i,a,s,"next",e)}function s(e){PQ(o,r,i,a,s,"throw",e)}a(void 0)}))}}var MQ=function(e){return new Promise(function(){var t=DQ(NQ().mark((function t(n,r){var i,a;return NQ().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=function(){var e=DQ(NQ().mark((function e(t){var n;return NQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.get(o.url.SOURCE,"/".concat(t).concat(F("form_data_".concat(t))?"/"+F("form_data_".concat(t)).form_id:"","/can_queue"));case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),t.next=4,i(e);case 4:a=t.sent,M(LQ({},e,xQ(xQ({},U()[e]),{},{is_agent_online:a}))),n(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),r(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}())};function UQ(e){return UQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UQ(e)}function jQ(){jQ=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==UQ(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function VQ(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function BQ(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){VQ(o,r,i,a,s,"next",e)}function s(e){VQ(o,r,i,a,s,"throw",e)}a(void 0)}))}}var FQ=!1;function GQ(e){return HQ.apply(this,arguments)}function HQ(){return HQ=BQ(jQ().mark((function e(t){var n,r,i=arguments;return jQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},e.prev=1,!FQ){e.next=5;break}return console.warn("Recording already in progress"),e.abrupt("return");case 5:return r={layout:{preset:n.layout||"default",max_cam_streams:n.maxCamStreams||2}},e.next=8,t.startRecording(r);case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(1),console.error("Failed to start recording:",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),HQ.apply(this,arguments)}function qQ(e){return WQ.apply(this,arguments)}function WQ(){return(WQ=BQ(jQ().mark((function e(t){return jQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,FQ){e.next=4;break}return console.warn("No recording in progress"),e.abrupt("return");case 4:return e.next=6,t.stopRecording();case 6:e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),console.error("Failed to stop recording:",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function zQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.on("recording-started",(function(e){FQ=!0,e.recordingId,t.onRecordingStarted&&t.onRecordingStarted(e)})),e.on("recording-stopped",(function(e){FQ=!1,null,t.onRecordingFinished&&t.onRecordingFinished(e)})),e.on("recording-error",(function(e){console.error("Recording error:",e),FQ=!1,null,t.onRecordingError&&t.onRecordingError(e)}))}function KQ(e){return KQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KQ(e)}function YQ(){YQ=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==KQ(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function JQ(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function XQ(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){JQ(o,r,i,a,s,"next",e)}function s(e){JQ(o,r,i,a,s,"throw",e)}a(void 0)}))}}var ZQ=__webpack_require__(2500),QQ=__webpack_require__(2025),$Q=__webpack_require__(5494),e$=__webpack_require__(8958);function t$(e,t,n,r,i){return n$.apply(this,arguments)}function n$(){return n$=XQ(YQ().mark((function e(t,n,r,i,a){var s,c,d,u,p,h,f,m,g;return YQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=function(){var e,t,n,r,i,o=d.participants(),a=o.local;"playable"===(null==a||null===(e=a.tracks)||void 0===e||null===(t=e.video)||void 0===t?void 0:t.state)&&a.tracks.video.track?(null===(i=u.srcObject)||void 0===i?void 0:i.getVideoTracks()[0])!==a.tracks.video.track&&(u.srcObject=new MediaStream([a.tracks.video.track])):"off"===(null==a||null===(n=a.tracks)||void 0===n||null===(r=n.video)||void 0===r?void 0:r.state)&&(u.srcObject=null,u.style.backgroundColor="transparent");Object.values(o).forEach((function(e){var t,n,r,i;if(!e.local){var o,a;if("playable"===(null==e||null===(t=e.tracks)||void 0===t||null===(n=t.video)||void 0===n?void 0:n.state)&&e.tracks.video.track)(null===(o=p.srcObject)||void 0===o?void 0:o.getVideoTracks()[0])!==e.tracks.video.track&&(p.srcObject=new MediaStream([e.tracks.video.track]));if("playable"===(null==e||null===(r=e.tracks)||void 0===r||null===(i=r.audio)||void 0===i?void 0:i.state)&&e.tracks.audio.track)(null===(a=h.srcObject)||void 0===a?void 0:a.getAudioTracks()[0])!==e.tracks.audio.track&&(h.srcObject=new MediaStream([e.tracks.audio.track]))}}))},c=function(){window.currentCall&&(window.currentCall.destroy(),window.currentCall=null)},d=window.Daily.createCallObject(),window.currentCall=d,u=r.querySelector("#local-video"),p=r.querySelector("#remote-video"),h=r.querySelector("#remote-audio")||document.createElement("audio"),f=r.querySelector("#toggle-mic"),m=r.querySelector("#toggle-cam"),g=r.querySelector("#leave-call"),r.querySelector("#remote-audio")||(h.id="remote-audio",h.autoplay=!0,h.playsInline=!0,h.style.display="none",r.appendChild(h)),u&&p){e.next=15;break}return console.error("Video elements not found in container"),e.abrupt("return");case 15:return e.next=17,d.join({url:n,startVideoOff:!1,startAudioOff:!1});case 17:if(!D()[a].auto_record){e.next=21;break}return zQ(d,{onRecordingStarted:function(e){},onRecordingFinished:function(e){},onRecordingError:function(e){}}),e.next=21,GQ(d,{layout:"default",maxCamStreams:2});case 21:return p.addEventListener("playing",(function(){u.classList.add("local-video-small");var e=r.querySelector(".sa-ai-video-loader-overlay");e&&(e.style.display="none")})),d.on("participant-joined",(function(e){s()})),d.on("participant-updated",(function(e){s()})),d.on("track-started",(function(e){s()})),d.on("participant-left",(function(e){s()})),d.on("error",(function(e){console.error("Call error:",e)})),d.on("left-meeting",(function(){g.click()})),f&&(f.onclick=XQ(YQ().mark((function e(){var t;return YQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=d.localAudio(),e.next=4,d.setLocalAudio(!t);case 4:f.innerHTML=t?e$():$Q(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error toggling microphone:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),m&&(m.onclick=XQ(YQ().mark((function e(){var t;return YQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=d.localVideo(),e.next=4,d.setLocalVideo(!t);case 4:m.innerHTML=t?QQ():ZQ(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error toggling camera:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),g&&(g.onclick=XQ(YQ().mark((function e(){return YQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.post(o.url.BASE,"/tavus/api/conversation/".concat(t,"/end"));case 3:if(!e.sent.success){e.next=13;break}if(!D()[a].auto_record){e.next=8;break}return e.next=8,qQ(d);case 8:return e.next=10,d.leave();case 10:c(),fX("widget_call_".concat(a)),SY(a,i);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error leaving call:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))),d.on("app-message",(function(e){if("conversation.utterance"===e.data.event_type){var t,n=e.data.properties;if(!n||!n.speech)return;var i=n.role,o=n.speech,s=(null===(t=D()[a])||void 0===t?void 0:t.ai_chat_bot_name)||"Agent",c="replica"===i?s:"You",l=document.createElement("div");l.className="chat-message "+("replica"===i?"chat-left":"chat-right"),l.innerHTML="<strong>".concat(c,":</strong> ").concat(o);var d=r.querySelector(".transcript-chats");if(d&&(d.appendChild(l),d.scrollTop=d.scrollHeight),"replica"===i){var u,p,h=PZ(null===(u=D()[a])||void 0===u?void 0:u.screenshare_context,o),f=r.querySelector(".sa-ai-video-call-action-panel");if(h){if(f.style.display="block",f)/\.(jpg|jpeg|png|gif|webp)$/i.test(h)?((p=document.createElement("img")).src=h,p.alt="Screen share content"):/\.(mp4|webm|ogg)$/i.test(h)&&((p=document.createElement("video")).src=h,p.controls=!0,p.autoplay=!0,p.muted=!0,p.loop=!0),p&&(f.innerHTML="",f.appendChild(p),DZ(p))}else f.style.display="none",f.innerHTML=""}}})),s(),e.abrupt("return",c);case 36:throw e.prev=36,e.t0=e.catch(0),console.error("Error setting up Daily call:",e.t0),e.t0;case 40:case"end":return e.stop()}}),e,null,[[0,36]])}))),n$.apply(this,arguments)}function r$(e){return r$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r$(e)}function i$(){i$=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==r$(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function o$(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var a$=__webpack_require__(3903),s$=__webpack_require__(1442),c$=__webpack_require__(9671),l$=__webpack_require__(2500),d$=__webpack_require__(5494),u$=__webpack_require__(2832),p$=__webpack_require__(5506),h$=__webpack_require__(2012),f$=__webpack_require__(8738);function m$(e,t,n){return g$.apply(this,arguments)}function g$(){return g$=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){o$(o,r,i,a,s,"next",e)}function s(e){o$(o,r,i,a,s,"throw",e)}a(void 0)}))}}(i$().mark((function e(t,n,r){var i,a,s,c,d,u,p,h,f,m,g,v,_=arguments;return i$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_.length>3&&void 0!==_[3]?_[3]:{},a=D()[t],s=U()[t],e.prev=3,r.innerHTML=s$({closeButton:c$(),cameraOn:l$(),mic:d$(),cc:u$(),endCall:f$(),minimize:p$(),maximize:h$(),callWaitingPage:a$({call_timeout:a.call_timeout,messageType:"video_call",messageTypeText:j("video_call"),addOrraPixel:"2d776e4a-ca8b-454d-9ceb-aab964ae4ebf"===t,mobileNumber:null==s||null===(p=s.form_data)||void 0===p?void 0:p.unique_field_value,affiliateId:z("utm_medium"),peopleId:null==s||null===(h=s.form_data)||void 0===h?void 0:h.people_id})}),r.querySelector(".sa-ai-video-loader-overlay").style.display="block",y=void 0,(y=document.querySelector(".sa-ai-video-call-container"))&&(y.offsetWidth>y.offsetHeight?y.classList.add("landscape"):y.classList.add("portrait")),null==i||!i.isAiVideoCall){e.next=13;break}c=i.conversation_id,d=i.conversation_url,e.next=21;break;case 13:return f={meta:[],message_content:"",message_type:"video_call",message_from:s.form_data.people_id,people_id:s.form_data.people_id,form_id:s.form_data.form_id,unique_field_value:s.form_data.unique_field_value,source_id:a.id,source_name:a.name,source_type:a.source_type,source_referrer:"https://jump-stg.saleassist.ai/jump/".concat(a.id),session_id:s.form_data.session_id},e.next=16,l.post(o.url.BASE,"/tavus/api/conversation",f);case 16:if((m=e.sent).conversation_url){e.next=19;break}throw new Error("No conversation URL received from backend");case 19:c=m.conversation_id,d=m.conversation_url;case 21:return e.next=23,new Promise((function(e,t){if(window.Daily)return e(window.Daily);var n=document.querySelector('script[src*="@daily-co/daily-js"]');if(n)return n.addEventListener("load",(function(){return e(window.Daily)})),void n.addEventListener("error",(function(){return t(new Error("Failed to load Daily.js"))}));var r=document.createElement("script");r.src="https://unpkg.com/@daily-co/daily-js",r.crossOrigin="anonymous",r.onload=function(){return e(window.Daily)},r.onerror=function(){return t(new Error("Failed to load Daily.js"))},document.head.appendChild(r)}));case 23:return e.next=25,new Promise((function(e){return setTimeout(e,100)}));case 25:return e.next=27,t$(c,d,r,n,t);case 27:u=e.sent,uX("widget_call_".concat(t),{isAiVideoCall:!0,conversation_id:c,conversation_url:d,message_type:"video_call"},1),g=r.querySelector(".transcript-wrapper"),r.querySelector("#transcript-open-btn").addEventListener("click",(function(){g&&(g.style.display="flex")})),r.querySelector("#transcript-close-btn").addEventListener("click",(function(){g&&(g.style.display="none")})),(v=r.querySelector("#maximize-tile-overlay")).addEventListener("click",(function(){kZ(n,".sa-ai-video-call-container #remote-video",v,!1,"video_call")})),r.querySelector("#minimize-tile").addEventListener("click",(function(){kZ(n,".sa-ai-video-call-container #remote-video",v,!0,"video_call")})),HZ(t,n,D()[t]),e.next=46;break;case 41:throw e.prev=41,e.t0=e.catch(3),console.error("Failed to initiate AI call:",e.t0),r.innerHTML='\n      <div style="display: flex;flex-direction: column;gap: 1.5rem;position: relative;height: 100%;place-content: center;">\n        <div style="display: flex;justify-content: center;align-items: center;margin-bottom: 0.5rem;">\n          <div style="width: 3rem; height: 3rem; background-color: #FEE2E2; border-radius: 9999px; display: flex; justify-content: center; align-items: center;">\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 1.5rem; height: 1.5rem; color: #EF4444;">\n              <path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"></path>\n              <line x1="22" x2="2" y1="2" y2="22"></line>\n            </svg>\n          </div>\n        </div>\n\n        <div style="padding: 0 1.8rem;text-align: center;display: flex;flex-direction: column;">\n          <div style="margin-bottom: 2rem;">\n            <h1 style="font-size: 1.25rem; font-weight: 600; color: #111827; margin-bottom: 0.75rem;">Call Failed</h1>\n            <p style="color: #4B5563; font-size: 0.875rem; line-height: 1.5rem;">Unable to start the video call. Please check your connection and try again.</p>\n          </div>\n\n          <button onclick="location.reload()" style="display: inline-flex;align-items: center;justify-content: center;gap: 0.5rem;font-size: 0.875rem;font-weight: 500;padding: 0.75rem 1rem;border-radius: 0.5rem;border: none;cursor: pointer;color: var(--invertColor);background: var(--themeColor);">            \n            Try Again\n          </button>\n\n          <p style="font-size: 11.5px;color: #6B7280;margin-top: 0.725rem;">Having trouble? Check your internet connection.</p>\n        </div>\n      </div>\n    ',e.t0;case 46:return e.abrupt("return",u);case 47:case"end":return e.stop()}var y}),e,null,[[3,41]])}))),g$.apply(this,arguments)}function v$(e){return v$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v$(e)}function _$(){_$=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==v$(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function y$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y$(Object(n),!0).forEach((function(t){b$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==v$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==v$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===v$(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E$(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function S$(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){E$(o,r,i,a,s,"next",e)}function s(e){E$(o,r,i,a,s,"throw",e)}a(void 0)}))}}var T$=__webpack_require__(1223),C$=__webpack_require__(3903),R$=__webpack_require__(3525),O$=!1,I$=!1,A$=[],k$=function(){var e=S$(_$().mark((function e(t,n,r,i){var o,a,s,c,l,d,u,p,h=arguments;return _$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=h.length>4&&void 0!==h[4]&&h[4],O$=!1,I$=!1,D$(A$),e.next=6,MQ(t);case 6:if(a=U()[t].is_agent_online,s=D()[t],c=F("form_data_".concat(t)),l=F("user_data_".concat(t))||{},d=U()[t],u=hX("widget_call_".concat(t)),!s.is_enable_ai_video_call_agent_all||"video_call"!==i){e.next=16;break}return e.next=15,m$(t,n,r,u);case 15:return e.abrupt("return");case 16:if(!s.is_enable_ai_video_call_agent_offline||"video_call"!==i||a){e.next=20;break}return e.next=19,m$(t,n,r,u);case 19:return e.abrupt("return");case 20:if(!o){e.next=23;break}return L$(t,n,d.meeting_id,c.unique_field_value,r,i,o),e.abrupt("return");case 23:if(s.is_enable_ai_audio_call_agent_all||s.is_enable_ai_audio_call_agent_offline||a){e.next=29;break}return D$(A$),r.innerHTML=R$({timeoutMessage:s.timeout_message,ctaText:s.offline_cta_text,addOrraPixel:"2d776e4a-ca8b-454d-9ceb-aab964ae4ebf"===t,mobileNumber:l.mobile_number,affiliateId:z("utm_medium"),peopleId:c.people_id}),n5(t,n,!0),console.log("status","Triggered timeoutPage. Reason: Agent offline and widget CTA did not update. Called at: videoCall()"),e.abrupt("return");case 29:if(!u){e.next=33;break}return r.innerHTML=T$(),p=new RQ(t,n,u.credential,i,u.room_id),e.abrupt("return",p);case 33:return e.next=35,P$(t,n,s,c,i).then((function(e){M(b$({},t,w$(w$({},d),{},{conversation_id:e.id}))),N$(t,n,s,e.id,A$,r,i,o)})).catch((function(e){}));case 35:r.innerHTML=C$({call_timeout:s.call_timeout,messageType:i,messageTypeText:j(i),addOrraPixel:"2d776e4a-ca8b-454d-9ceb-aab964ae4ebf"===t,mobileNumber:l.mobile_number,affiliateId:z("utm_medium"),peopleId:c.people_id}),HZ(t,n,D()[t]);case 37:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),x$=function(){var e=S$(_$().mark((function e(t,n,r,i,a,s){var c,d,u,p,h;return _$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MQ(t);case 2:if(c=D()[t],U()[t].is_agent_online||s){e.next=9;break}return D$(A$),i.innerHTML=R$({timeoutMessage:c.timeout_message,ctaText:c.offline_cta_text}),n5(t,n,!0),e.abrupt("return");case 9:return d=F("user_data_".concat(t)),u=F("form_data_".concat(t)),e.next=13,l.post(o.url.ACTIONS,"/meeting/join_channel/".concat(r,"/").concat(d.name||u.unique_field_value||u.people_id));case 13:if(!(p=e.sent)){e.next=20;break}return i.innerHTML=T$(),h=new RQ(t,n,p,a,r),dX({url:"https://ingest-stg.saleassist.ai/meeting-log",data:{event_type:"START_MEETING_LCW",meeting_id:U()[t].meeting_id,client_id:D()[t].client_id,users_stats:{action:"",conversation_id:U()[t].conversation_id}},onSuccess:function(e){},onFailure:function(e){console.error(e)}}),s||uX("widget_call_".concat(t),{credential:p,message_type:a,room_id:r},1),e.abrupt("return",h);case 20:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}(),L$=function(){var e=S$(_$().mark((function e(t,n,r,i,a,s,c){var d,u,p;return _$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.get(o.url.ACTIONS,"/get_join_url/".concat(r,"/").concat(i));case 2:(d=e.sent)&&(u=new URL(d),p=u.pathname.split("/").filter(Boolean)[0],x$(t,n,p,a,s,c));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o,a,s){return e.apply(this,arguments)}}(),N$=function(e,t,n,r,i,a,s,c){var l=0,d=0,u=U()[e],p=(n.call_timeout,setInterval((function(){0==parseInt(l%n.message_interval)&&(M$(e,t,n.wait_messages[d],s),d=(d+1)%n.wait_messages.length),(l+=1)%2!=0||I$||(I$=!0,function(e,t,n,r,i,a,s,c,l,d){var u=U()[e];fetch("".concat(o.url.SOURCE,"/").concat(n.id,"/conversation_status/").concat(r),{method:"GET",headers:{referrer:window.location.href}}).then((function(r){if(r.ok)return r.json();throw 428===r.status?(D$(i),a.innerHTML=R$({timeoutMessage:n.timeout_message,ctaText:n.offline_cta_text}),n5(e,t,!0),new Error("Request timeout")):404===r.status?new Error("Resource not found"):new Error("Request failed")})).then((function(n){if(""!==n.meeting_id&&!O$){D$(i),new Audio("https://client-static.saleassist.ai/Call_join.mp3").play(i),M(b$({},e,w$(w$({},u),{},{meeting_id:n.meeting_id}))),O$=!0,a.innerHTML=T$();var r=new RQ(e,t,n.join_channel_details,s,n.join_channel_details.room_id);return c||uX("widget_call_".concat(e),{credential:n.join_channel_details,message_type:s,room_id:n.join_channel_details.room_id},1),r}})).catch((function(e){})).finally((function(){I$=!1}))}(e,t,n,r,i,a,s,c))}),1e3));i.push(p),M(b$({},e,w$(w$({},u),{},{videoCallTimers:i})))},P$=function(){var e=S$(_$().mark((function e(t,n,r,i,a){var s;return _$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.post(o.url.SOURCE,"/".concat(r.id,"/conversation"),{meta:[],message_content:"",message_type:a,message_from:i.people_id,people_id:i.people_id,form_id:i.form_id,unique_field_value:i.unique_field_value,source_id:r.id,source_name:r.name,source_type:r.source_type,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href,session_id:F("session_data_".concat(t))});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o){return e.apply(this,arguments)}}(),D$=function(e){e.forEach((function(e){clearInterval(e)}))},M$=function(e,t,n,r){var i,o=t.querySelector(".sa-live-call-widget-call-waiting-content"),a=t.querySelector(".sa-live-call-widget-call-waiting-title");/\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(n)?(a.innerHTML="Please wait while we connect you to our agent.",i='<img alt="" src="'.concat(n,'"/>')):/\.(mp4|mov|wmv|avi|avchd|mkv|webm|swf)$/.test(n)?(a.innerHTML="Please wait while we connect you to our agent.",i='<video src="'.concat(n,'" autoplay loop playsinline></video>')):(a.innerHTML=n,i='\n      <div class="sa-live-call-widget-call-waiting-text">\n        <div class="ring"></div>\n        <div class="ring"></div>\n        <div class="ring"></div>\n        <div class="ring"></div>\n        <div class="icon-'.concat(r,'"></div>\n      </div>\n    ')),o&&(o.innerHTML=i),U$()},U$=function(){var e=document.querySelector(".sa-live-call-widget-call-waiting-dialing .text");setTimeout((function(){e.textContent="Ringing."}),3e3)};function j$(e){return j$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j$(e)}function V$(){V$=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==j$(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function B$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B$(Object(n),!0).forEach((function(t){G$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==j$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==j$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===j$(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H$(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function q$(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){H$(o,r,i,a,s,"next",e)}function s(e){H$(o,r,i,a,s,"throw",e)}a(void 0)}))}}var W$=__webpack_require__(8922),z$=__webpack_require__(289),K$=__webpack_require__(3585),Y$=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"video_message",i=D()[e],a=U()[e];n.innerHTML=z$();var s=t.querySelector(".sa-live-call-widget-video-message-preview"),c=t.querySelector(".sa-live-call-widget-recorded-video-message"),d=t.querySelector(".sa-live-call-widget-video-message-start-stop-recording-btn"),u=t.querySelector(".sa-live-call-widget-video-message-switch-camera-btn"),p=t.querySelector(".sa-live-call-widget-video-message-toggle-screen-recording-btn"),h=t.querySelector(".sa-live-call-widget-video-message-toggle-recording-btn-wrapper"),f=t.querySelector(".sa-live-call-widget-video-message-preview-wrapper"),m=document.querySelector(".sa-live-call-widget-video-recording-indicator"),g=t.querySelector("#sa-live-call-widget-video-message-upload-btn"),v=t.querySelector("#sa-live-call-widget-video-message-upload-input");s.autoplay=!0,s.muted=!0,s.setAttribute("playsinline",""),s.style.transform="rotateY(180deg)",h.style.display="none",d.disabled=!0,d.style.cursor="not-allowed";var _,y,w=[],b=!1,E=!1,S="user",T=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];d.classList.toggle("recording",e);var t=e?"none":"flex";[u,p,g].forEach((function(e){return e.style.display=t})),h.style.padding=e?"0px":"0px 5px",d.innerHTML=e?"STOP":'<div class="sa-live-call-widget-video-message-start-stop-recording-btn-inner-wrapper">REC</div>'},C=function(){var e;return null===(e=_)||void 0===e||e.getTracks().forEach((function(e){return e.stop()})),navigator.mediaDevices.getUserMedia({video:{facingMode:S},audio:!0}).then((function(e){_=e,s.srcObject=_,s.style.objectFit="cover",s.style.transform="user"===S?"rotateY(180deg)":"rotateY(0deg)",h.style.display="flex",d.disabled=!1,d.style.cursor="pointer",p.innerHTML='<svg stroke="currentColor" fill="#fff" stroke-width="0" viewBox="0 0 24 24" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M20 18c1.1 0 1.99-.9 1.99-2L22 6a2 2 0 0 0-2-2H4c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2H0v2h24v-2h-4zM4 16V6h16v10.01L4 16zm9-6.87c-3.89.54-5.44 3.2-6 5.87 1.39-1.87 3.22-2.72 6-2.72v2.19l4-3.74L13 7v2.13z"></path></svg>'})).catch((function(e){console.error(e),alert("Error accessing camera and microphone")}))},R=function(){f.classList.add("video-recorded"),d.style.display="none",g.style.display="none";document.querySelector(".sa-live-call-widget-video-message-post-recording-btn").innerHTML='\n      <button id="sa-live-call-widget-video-message-re-record-btn">Re-record</button>\n      <button id="sa-live-call-widget-video-message-submit-recording-btn">Submit</button>';var u=t.querySelector("#sa-live-call-widget-video-message-submit-recording-btn"),p=t.querySelector("#sa-live-call-widget-video-message-re-record-btn");p.addEventListener("click",(function(){f.classList.remove("video-recorded"),c.style.display="none",s.style.display="block",c.src="",_=y=void 0,w=[],b=E=!1,C(),p.remove(),u.remove(),T(),d.style.display="grid",h.style.display="flex",g.style.display="flex"})),u.addEventListener("click",q$(V$().mark((function s(){var c,d,p,h,f;return V$().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return u.innerHTML=K$({}),u.style.cursor="not-allowed",c=F("form_data_".concat(e)),d=new Blob(w,{type:"video/webm"}),(p=new FormData).append("files",d,"".concat(c.people_id,"/").concat(Date.now(),".").concat(d.type.split("/")[1])),s.prev=6,s.next=9,fetch(o.url.SOURCE+"/".concat(i.id,"/storage"),{method:"POST",body:p,headers:{referrer:window.location.href}});case 9:if((h=s.sent).ok){s.next=12;break}throw new Error("Upload failed");case 12:return s.next=14,h.json();case 14:if(!(f=s.sent)){s.next=20;break}return s.next=18,l.post(o.url.SOURCE,"/".concat(i.id,"/conversation"),F$(F$({},c),{},{message_content:f[0].url,message_type:r,message_from:c.people_id,source_id:i.id,source_type:"live_call",source_name:i.name,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href}));case 18:s.sent&&(M(G$({},e,F$(F$({},a),{},{message:"Your message has been received.",widgetName:"thankyouMessage"}))),n.innerHTML=W$({defaultMessage:a.message,thankyouMessage:i.thankyou_message}),M5(e,t));case 20:s.next=25;break;case 22:s.prev=22,s.t0=s.catch(6),console.error("Upload error:",s.t0);case 25:case"end":return s.stop()}}),s,null,[[6,22]])}))))},O=function(){var e=q$(V$().mark((function e(){var t,n;return V$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=_)||void 0===t||t.getTracks().forEach((function(e){return e.stop()})),e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({video:{facingMode:"user"===S?"environment":"user"},audio:!0});case 4:n=e.sent,_=n,s.srcObject=n,S="user"===S?"environment":"user",s.style.transform="user"===S?"rotateY(180deg)":"rotateY(0deg)",e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0),alert("Error switching camera");case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();C(),p.addEventListener("click",q$(V$().mark((function e(){return V$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b=!b,e.next=3,b?(t=void 0,null===(t=_)||void 0===t||t.getTracks().forEach((function(e){return e.stop()})),navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(e){_=e,s.srcObject=_,s.style.objectFit="contain",s.style.transform="rotateY(0deg)",h.style.display="flex",b=!0,p.innerHTML='<svg stroke="currentColor" fill="#fff" stroke-width="0" viewBox="0 0 24 24" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="m21.79 18 2 2H24v-2h-2.21zM1.11 2.98l1.55 1.56c-.41.37-.66.89-.66 1.48V16c0 1.1.9 2 2.01 2H0v2h18.13l2.71 2.71 1.41-1.41L2.52 1.57 1.11 2.98zM4 6.02h.13l4.95 4.93C7.94 12.07 7.31 13.52 7 15c.96-1.29 2.13-2.08 3.67-2.46l3.46 3.48H4v-10zm16 0v10.19l1.3 1.3c.42-.37.7-.89.7-1.49v-10a2 2 0 0 0-2-2H7.8l2 2H20zm-7.07 3.13 2.79 2.78 1.28-1.2L13 7v2.13l-.07.02z"></path></svg>'})).catch((function(e){console.error(e),b=!1}))):C();case 3:T(!1);case 4:case"end":return e.stop()}var t}),e)})))),u.addEventListener("click",O),d.addEventListener("click",(function(){var e;E?(y&&(y.onstop=function(){var e=new Blob(w,{type:"video/mp4"});c.src=URL.createObjectURL(e),c.style.objectFit=b?"contain":"cover",s.style.display="none",c.style.display="block",h.style.display="none",R()},y.stop(),null===(e=_)||void 0===e||e.getTracks().forEach((function(e){return e.stop()})),m.style.display="none"),E=!1,T(!1)):(!function(){if(!_)return console.error("Start video preview first.");w=[],(y=new MediaRecorder(_)).ondataavailable=function(e){return e.data&&e.data.size&&w.push(e.data)},y.start(),m.style.display="block"}(),E=!0,T(!0))})),g.addEventListener("click",(function(){return v.click()})),v.addEventListener("change",(function(e){var t=e.target.files[0];if(!t||!t.type.startsWith("video/"))return alert("Please select a valid video file.");w=[t],c.src=URL.createObjectURL(t),c.style.display="block",c.play(),s.style.display="none",h.style.display="none",R()}));window.addEventListener("widgetClosed",(function e(){_&&(_.getTracks().forEach((function(e){return e.stop()})),_=null),document.removeEventListener("widgetClosed",e)}))};function J$(e){return J$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J$(e)}function X$(){X$=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==J$(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function Z$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z$(Object(n),!0).forEach((function(t){$$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==J$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==J$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===J$(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e0(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function t0(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){e0(o,r,i,a,s,"next",e)}function s(e){e0(o,r,i,a,s,"throw",e)}a(void 0)}))}}var n0=__webpack_require__(8922),r0=__webpack_require__(7685),i0=__webpack_require__(3585),o0='<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 16 16"\n  height="24"\n  width="24"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path\n    d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"\n  ></path>\n</svg>',a0=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"voice_message",i=D()[e],a=U()[e];n.innerHTML=r0();var s,c=t.querySelector(".sa-live-call-widget-audio-message-start-stop-recording-btn"),d=t.querySelector(".sa-live-call-widget-audio-message-controls-btn-wrapper"),u=t.querySelector(".sa-live-call-widget-audio-message-waves"),p=t.querySelector(".sa-live-call-widget-audio-message-play-pause-btn"),h=[],f=!1,m=!1,g=new Audio,v=!1;function _(){"permissions"in navigator&&"getUserMedia"in navigator.mediaDevices?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){h=[],(s=new MediaRecorder(e)).addEventListener("dataavailable",(function(e){e.data&&e.data.size>0&&h.push(e.data)})),s.start(),u.style.display="block"})).catch((function(e){console.error("Microphone permission denied or error:",e),w(!1),m=!0})):(console.error("Permissions API not supported"),w(!1))}function y(){s&&"inactive"!==s.state&&(s.stop(),s.addEventListener("stop",(function(){var s,m=new Blob(h,{type:"audio/".concat(/iPad|iPhone|iPod/.test(null===(s=navigator)||void 0===s?void 0:s.userAgent)?"mpeg":"webm")});g=new Audio(URL.createObjectURL(m)),u.style.display="block",p.style.display="flex",function(){c.style.display="none";var s='<button\n        class="sa-live-call-widget-audio-message-start-stop-recording-btn"\n        id="sa-live-call-widget-audio-message-re-record-btn"\n        style="color: black, opacity: 0.5"\n      >\n        Re-record\n      </button>\n      <button\n        class="sa-live-call-widget-audio-message-start-stop-recording-btn"\n        id="sa-live-call-widget-audio-message-submit-recording-btn"\n      >\n        Submit\n      </button>';d.insertAdjacentHTML("beforeend",s);var m=t.querySelector("#sa-live-call-widget-audio-message-submit-recording-btn"),y=t.querySelector("#sa-live-call-widget-audio-message-re-record-btn");y.addEventListener("click",(function(){g.pause(),g.src="",v=!1,p.innerHTML="".concat(o0,"Play"),p.style.display="none",_(),f=!0,c.style.display="block",u.style.display="block",w(!0),y.remove(),m.remove()})),m.addEventListener("click",t0(X$().mark((function s(){var c,d,u,p,f;return X$().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return m.innerHTML=i0({}),m.style.cursor="not-allowed",c=F("form_data_".concat(e)),d=new Blob(h,{type:"audio/webm"}),(u=new FormData).append("files",d,"".concat(c.people_id,"/").concat((new Date).getTime(),".").concat(d.type.split("/")[1])),s.prev=6,s.next=9,fetch(o.url.SOURCE+"/".concat(i.id,"/storage"),{method:"POST",body:u,headers:{referrer:window.location.href}});case 9:if((p=s.sent).ok){s.next=12;break}throw new Error("Error uploading recorded audio");case 12:return s.next=14,p.json();case 14:if(!(f=s.sent)){s.next=20;break}return s.next=18,l.post(o.url.SOURCE,"/".concat(i.id,"/conversation"),Q$(Q$({},c),{},{message_content:f[0].url,message_type:r,message_from:c.people_id,source_id:i.id,source_type:"live_call",source_name:i.name,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href}));case 18:s.sent&&(M($$({},e,Q$(Q$({},a),{},{message:"Your message has been received.",widgetName:"thankyouMessage"}))),n.innerHTML=n0({defaultMessage:a.message,thankyouMessage:i.thankyou_message}),M5(e,t));case 20:s.next=25;break;case 22:s.prev=22,s.t0=s.catch(6),console.error("Error uploading recorded video:",s.t0);case 25:case"end":return s.stop()}}),s,null,[[6,22]])}))))}(),g.addEventListener("ended",(function(){v=!1,p.innerHTML="".concat(o0,"Play")}))})))}function w(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(c.textContent="Stop Recording",c.style.backgroundColor="#f44336",c.style.hover={backgroundColor:"#f44336"},c.style.color=t.style.getPropertyValue("--invertColor")):(c.textContent="Start Recording",c.style.background="#4285f4",c.style.color="#fff")}c.addEventListener("click",(function(){m||(f?(y(),f=!1,w(!1)):(_(),f=!0,w(!0)))})),p.addEventListener("click",(function(){v?(p.innerHTML="".concat(o0,"Play"),g.pause(),v=!1):(p.innerHTML="".concat('<svg\n  stroke="currentColor"\n  fill="currentColor"\n  stroke-width="0"\n  viewBox="0 0 24 24"\n  height="24"\n  width="24"\n  xmlns="http://www.w3.org/2000/svg"\n>\n  <path fill="none" d="M0 0h24v24H0z"></path>\n  <path\n    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"\n  ></path>\n</svg>',"Pause"),g.play(),v=!0)}))};function s0(e){return s0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s0(e)}function c0(){c0=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==s0(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function l0(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function d0(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){l0(o,r,i,a,s,"next",e)}function s(e){l0(o,r,i,a,s,"throw",e)}a(void 0)}))}}function u0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u0(Object(n),!0).forEach((function(t){h0(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u0(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h0(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==s0(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==s0(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===s0(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f0=__webpack_require__(8922),m0=__webpack_require__(8141),g0=__webpack_require__(3585),v0=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text_message",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=D()[e],s=U()[e];if(i){window.open('https://api.whatsapp.com/send?text="Hi, I wanted to know more about your product."&phone='.concat(a.whatsapp_number),"_blank","noopener"),M(h0({},e,p0(p0({},s),{},{message:"You have been redirected to WhatsApp on another tab."}))),n.innerHTML=f0({defaultMessage:s.message,thankyouMessage:a.thankyou_message}),M5(e,t);var c=function(){var t=d0(c0().mark((function t(){var n;return c0().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=F("form_data_".concat(e)),t.prev=1,t.next=4,l.post(o.url.SOURCE,"/".concat(a.id,"/conversation"),p0(p0({},n),{},{message_content:"Hi, I wanted to know more about your product.",message_type:"text_message",message_from:n.people_id,source_id:a.id,source_name:a.name,source_type:"live_call",source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(){return t.apply(this,arguments)}}();c()}else{n.innerHTML=m0({placeholder:i?"Enter message here":"Please leave a message for us"});var d=t.querySelector(".sa-live-call-widget-audio-message-submit-btn"),u=t.querySelector(".sa-live-call-widget-audio-message-textarea");d.addEventListener("click",d0(c0().mark((function i(){var c;return c0().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return d.innerHTML=g0({}),d.style.cursor="not-allowed",d.disabled=!0,c=F("form_data_".concat(e)),i.prev=4,i.next=7,l.post(o.url.SOURCE,"/".concat(a.id,"/conversation"),p0(p0({},c),{},{message_content:u.value,message_type:r,message_from:c.people_id,source_id:a.id,source_name:a.name,source_type:"live_call",source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href}));case 7:i.sent&&(M(h0({},e,p0(p0({},s),{},{message:"Your message has been received.",widgetName:"thankyouMessage"}))),n.innerHTML=f0({defaultMessage:s.message,thankyouMessage:a.thankyou_message}),M5(e,t)),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(4),console.error("Error uploading recorded video:",i.t0);case 14:case"end":return i.stop()}}),i,null,[[4,11]])}))))}};function _0(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let y0={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function w0(e){y0=e}const b0={exec:()=>null};function E0(e,t=""){let n="string"==typeof e?e:e.source;const r={replace:(e,t)=>{let i="string"==typeof t?t:t.source;return i=i.replace(S0.caret,"$1"),n=n.replace(e,i),r},getRegex:()=>new RegExp(n,t)};return r}const S0={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},T0=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,C0=/(?:[*+-]|\d{1,9}[.)])/,R0=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,O0=E0(R0).replace(/bull/g,C0).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),I0=E0(R0).replace(/bull/g,C0).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),A0=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,k0=/(?!\s*\])(?:\\.|[^\[\]\\])+/,x0=E0(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",k0).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),L0=E0(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,C0).getRegex(),N0="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",P0=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,D0=E0("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",P0).replace("tag",N0).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),M0=E0(A0).replace("hr",T0).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N0).getRegex(),U0={blockquote:E0(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",M0).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:x0,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:T0,html:D0,lheading:O0,list:L0,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:M0,table:b0,text:/^[^\n]+/},j0=E0("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",T0).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N0).getRegex(),V0={...U0,lheading:I0,table:j0,paragraph:E0(A0).replace("hr",T0).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",j0).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N0).getRegex()},B0={...U0,html:E0("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",P0).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:b0,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:E0(A0).replace("hr",T0).replace("heading"," *#{1,6} *[^\n]").replace("lheading",O0).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},F0=/^( {2,}|\\)\n(?!\s*$)/,G0=/[\p{P}\p{S}]/u,H0=/[\s\p{P}\p{S}]/u,q0=/[^\s\p{P}\p{S}]/u,W0=E0(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,H0).getRegex(),z0=/(?!~)[\p{P}\p{S}]/u,K0=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Y0=E0(K0,"u").replace(/punct/g,G0).getRegex(),J0=E0(K0,"u").replace(/punct/g,z0).getRegex(),X0="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Z0=E0(X0,"gu").replace(/notPunctSpace/g,q0).replace(/punctSpace/g,H0).replace(/punct/g,G0).getRegex(),Q0=E0(X0,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,z0).getRegex(),$0=E0("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,q0).replace(/punctSpace/g,H0).replace(/punct/g,G0).getRegex(),e1=E0(/\\(punct)/,"gu").replace(/punct/g,G0).getRegex(),t1=E0(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),n1=E0(P0).replace("(?:--\x3e|$)","--\x3e").getRegex(),r1=E0("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",n1).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),i1=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,o1=E0(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",i1).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),a1=E0(/^!?\[(label)\]\[(ref)\]/).replace("label",i1).replace("ref",k0).getRegex(),s1=E0(/^!?\[(ref)\](?:\[\])?/).replace("ref",k0).getRegex(),c1={_backpedal:b0,anyPunctuation:e1,autolink:t1,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:F0,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:b0,emStrongLDelim:Y0,emStrongRDelimAst:Z0,emStrongRDelimUnd:$0,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:o1,nolink:s1,punctuation:W0,reflink:a1,reflinkSearch:E0("reflink|nolink(?!\\()","g").replace("reflink",a1).replace("nolink",s1).getRegex(),tag:r1,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:b0},l1={...c1,link:E0(/^!?\[(label)\]\((.*?)\)/).replace("label",i1).getRegex(),reflink:E0(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",i1).getRegex()},d1={...c1,emStrongRDelimAst:Q0,emStrongLDelim:J0,url:E0(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},u1={...d1,br:E0(F0).replace("{2,}","*").getRegex(),text:E0(d1.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},p1={normal:U0,gfm:V0,pedantic:B0},h1={normal:c1,gfm:d1,breaks:u1,pedantic:l1},f1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},m1=e=>f1[e];function g1(e,t){if(t){if(S0.escapeTest.test(e))return e.replace(S0.escapeReplace,m1)}else if(S0.escapeTestNoEncode.test(e))return e.replace(S0.escapeReplaceNoEncode,m1);return e}function v1(e){try{e=encodeURI(e).replace(S0.percentDecode,"%")}catch{return null}return e}function _1(e,t){const n=e.replace(S0.findPipe,((e,t,n)=>{let r=!1,i=t;for(;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"})).split(S0.splitPipe);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(S0.slashPipe,"|");return n}function y1(e,t,n){const r=e.length;if(0===r)return"";let i=0;for(;i<r;){if(e.charAt(r-i-1)!==t)break;i++}return e.slice(0,r-i)}function w1(e,t,n,r,i){const o=t.href,a=t.title||null,s=e[1].replace(i.other.outputLinkReplace,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:o,title:a,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:o,title:a,text:s}}class b1{options;rules;lexer;constructor(e){this.options=e||y0}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:y1(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(null===r)return t;const i=r[1];return t.split("\n").map((e=>{const t=e.match(n.other.beginningSpace);if(null===t)return e;const[r]=t;return r.length>=i.length?e.slice(i.length):e})).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=y1(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:y1(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=y1(t[0],"\n").split("\n"),n="",r="";const i=[];for(;e.length>0;){let t=!1;const o=[];let a;for(a=0;a<e.length;a++)if(this.rules.other.blockquoteStart.test(e[a]))o.push(e[a]),t=!0;else{if(t)break;o.push(e[a])}e=e.slice(a);const s=o.join("\n"),c=s.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${s}`:s,r=r?`${r}\n${c}`:c;const l=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,i,!0),this.lexer.state.top=l,0===e.length)break;const d=i.at(-1);if("code"===d?.type)break;if("blockquote"===d?.type){const t=d,o=t.raw+"\n"+e.join("\n"),a=this.blockquote(o);i[i.length-1]=a,n=n.substring(0,n.length-t.raw.length)+a.raw,r=r.substring(0,r.length-t.text.length)+a.text;break}if("list"!==d?.type);else{const t=d,o=t.raw+"\n"+e.join("\n"),a=this.list(o);i[i.length-1]=a,n=n.substring(0,n.length-d.raw.length)+a.raw,r=r.substring(0,r.length-t.raw.length)+a.raw,e=o.substring(i.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:n,tokens:i,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const o=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let n=!1,r="",s="";if(!(t=o.exec(e)))break;if(this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let c=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),l=e.split("\n",1)[0],d=!c.trim(),u=0;if(this.options.pedantic?(u=2,s=c.trimStart()):d?u=t[1].length+1:(u=t[2].search(this.rules.other.nonSpaceChar),u=u>4?1:u,s=c.slice(u),u+=t[1].length),d&&this.rules.other.blankLine.test(l)&&(r+=l+"\n",e=e.substring(l.length+1),n=!0),!n){const t=this.rules.other.nextBulletRegex(u),n=this.rules.other.hrRegex(u),i=this.rules.other.fencesBeginRegex(u),o=this.rules.other.headingBeginRegex(u),a=this.rules.other.htmlBeginRegex(u);for(;e;){const p=e.split("\n",1)[0];let h;if(l=p,this.options.pedantic?(l=l.replace(this.rules.other.listReplaceNesting,"  "),h=l):h=l.replace(this.rules.other.tabCharGlobal,"    "),i.test(l))break;if(o.test(l))break;if(a.test(l))break;if(t.test(l))break;if(n.test(l))break;if(h.search(this.rules.other.nonSpaceChar)>=u||!l.trim())s+="\n"+h.slice(u);else{if(d)break;if(c.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(i.test(c))break;if(o.test(c))break;if(n.test(c))break;s+="\n"+l}d||l.trim()||(d=!0),r+=p+"\n",e=e.substring(p.length+1),c=h.slice(u)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(r)&&(a=!0));let p,h=null;this.options.gfm&&(h=this.rules.other.listIsTask.exec(s),h&&(p="[ ] "!==h[0],s=s.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:r,task:!!h,checked:p,loose:!1,text:s,tokens:[]}),i.raw+=r}const s=i.items.at(-1);if(!s)return;s.raw=s.raw.trimEnd(),s.text=s.text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){const t=i.items[e].tokens.filter((e=>"space"===e.type)),n=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));i.loose=n}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t){return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const n=_1(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const e of r)this.rules.other.tableAlignRight.test(e)?o.align.push("right"):this.rules.other.tableAlignCenter.test(e)?o.align.push("center"):this.rules.other.tableAlignLeft.test(e)?o.align.push("left"):o.align.push(null);for(let e=0;e<n.length;e++)o.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:o.align[e]});for(const e of i)o.rows.push(_1(e,o.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:o.align[t]}))));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=y1(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let r=0;r<e.length;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),w1(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return w1(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r)return;if(r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const n=[...r[0]].length-1;let i,o,a=n,s=0;const c="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=c.exec(t));){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(o=[...i].length,r[3]||r[4]){a+=o;continue}if((r[5]||r[6])&&n%3&&!((n+o)%3)){s+=o;continue}if(a-=o,a>0)continue;o=Math.min(o,o+a+s);const t=[...r[0]][0].length,c=e.slice(0,n+r.index+t+o);if(Math.min(n,o)%2){const e=c.slice(1,-1);return{type:"em",raw:c,text:e,tokens:this.lexer.inlineTokens(e)}}const l=c.slice(2,-2);return{type:"strong",raw:c,text:l,tokens:this.lexer.inlineTokens(l)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(e),r=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&r&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let r;do{r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(r!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}}class E1{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||y0,this.options.tokenizer=this.options.tokenizer||new b1,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:S0,block:p1.normal,inline:h1.normal};this.options.pedantic?(t.block=p1.pedantic,t.inline=h1.pedantic):this.options.gfm&&(t.block=p1.gfm,this.options.breaks?t.inline=h1.breaks:t.inline=h1.gfm),this.tokenizer.rules=t}static get rules(){return{block:p1,inline:h1}}static lex(e,t){return new E1(t).lex(e)}static lexInline(e,t){return new E1(t).inlineTokens(e)}lex(e){e=e.replace(S0.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(S0.tabCharGlobal,"    ").replace(S0.spaceLine,""));e;){let r;if(this.options.extensions?.block?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);const n=t.at(-1);1===r.raw.length&&void 0!==n?n.raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.at(-1).src=n.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let i=e;if(this.options.extensions?.startBlock){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startBlock.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(i=e.substring(0,t+1))}if(this.state.top&&(r=this.tokenizer.paragraph(i))){const o=t.at(-1);n&&"paragraph"===o?.type?(o.raw+="\n"+r.raw,o.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(r),n=i.length!==e.length,e=e.substring(r.raw.length)}else if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,r=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(n));)e.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(n));)n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.anyPunctuation.exec(n));)n=n.slice(0,r.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i=!1,o="";for(;e;){let r;if(i||(o=""),i=!1,this.options.extensions?.inline?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===r.type&&"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,n,o)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}let a=e;if(this.options.extensions?.startInline){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startInline.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(r=this.tokenizer.inlineText(a)){e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(o=r.raw.slice(-1)),i=!0;const n=t.at(-1);"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}}class S1{options;parser;constructor(e){this.options=e||y0}space(e){return""}code({text:e,lang:t,escaped:n}){const r=(t||"").match(S0.notSpaceStart)?.[0],i=e.replace(S0.endingNewline,"")+"\n";return r?'<pre><code class="language-'+g1(r)+'">'+(n?i:g1(i,!0))+"</code></pre>\n":"<pre><code>"+(n?i:g1(i,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,n=e.start;let r="";for(let t=0;t<e.items.length;t++){const n=e.items[t];r+=this.listitem(n)}const i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+r+"</"+i+">\n"}listitem(e){let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+g1(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r="";for(let t=0;t<e.rows.length;t++){const i=e.rows[t];n="";for(let e=0;e<i.length;e++)n+=this.tablecell(i[e]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+r+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${g1(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),i=v1(e);if(null===i)return r;let o='<a href="'+(e=i)+'"';return t&&(o+=' title="'+g1(t)+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:n}){const r=v1(e);if(null===r)return g1(n);let i=`<img src="${e=r}" alt="${n}"`;return t&&(i+=` title="${g1(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:g1(e.text)}}class T1{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class C1{options;renderer;textRenderer;constructor(e){this.options=e||y0,this.options.renderer=this.options.renderer||new S1,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new T1}static parse(e,t){return new C1(t).parse(e)}static parseInline(e,t){return new C1(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(this.options.extensions?.renderers?.[i.type]){const e=i,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}const o=i;switch(o.type){case"space":n+=this.renderer.space(o);continue;case"hr":n+=this.renderer.hr(o);continue;case"heading":n+=this.renderer.heading(o);continue;case"code":n+=this.renderer.code(o);continue;case"table":n+=this.renderer.table(o);continue;case"blockquote":n+=this.renderer.blockquote(o);continue;case"list":n+=this.renderer.list(o);continue;case"html":n+=this.renderer.html(o);continue;case"paragraph":n+=this.renderer.paragraph(o);continue;case"text":{let i=o,a=this.renderer.text(i);for(;r+1<e.length&&"text"===e[r+1].type;)i=e[++r],a+="\n"+this.renderer.text(i);n+=t?this.renderer.paragraph({type:"paragraph",raw:a,text:a,tokens:[{type:"text",raw:a,text:a,escaped:!0}]}):a;continue}default:{const e='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t=this.renderer){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(this.options.extensions?.renderers?.[i.type]){const e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=e||"";continue}}const o=i;switch(o.type){case"escape":case"text":n+=t.text(o);break;case"html":n+=t.html(o);break;case"link":n+=t.link(o);break;case"image":n+=t.image(o);break;case"strong":n+=t.strong(o);break;case"em":n+=t.em(o);break;case"codespan":n+=t.codespan(o);break;case"br":n+=t.br(o);break;case"del":n+=t.del(o);break;default:{const e='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class R1{options;block;constructor(e){this.options=e||y0}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?E1.lex:E1.lexInline}provideParser(){return this.block?C1.parse:C1.parseInline}}const O1=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=C1;Renderer=S1;TextRenderer=T1;Lexer=E1;Tokenizer=b1;Hooks=R1;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{const e=r;for(const r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(const r of e.rows)for(const e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=r;n=n.concat(this.walkTokens(e.items,t));break}default:{const e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((r=>{const i=e[r].flat(1/0);n=n.concat(this.walkTokens(i,t))})):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer){const t=this.defaults.renderer||new S1(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const r=n,i=e.renderer[r],o=t[r];t[r]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=o.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new b1(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const r=n,i=e.tokenizer[r],o=t[r];t[r]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=o.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new R1;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;const r=n,i=e.hooks[r],o=t[r];R1.passThroughHooks.has(n)?t[r]=e=>{if(this.defaults.async)return Promise.resolve(i.call(t,e)).then((e=>o.call(t,e)));const n=i.call(t,e);return o.call(t,n)}:t[r]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=o.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return E1.lex(e,t??this.defaults)}parser(e,t){return C1.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{const r={...n},i={...this.defaults,...r},o=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===r.async)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return o(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const a=i.hooks?i.hooks.provideLexer():e?E1.lex:E1.lexInline,s=i.hooks?i.hooks.provideParser():e?C1.parse:C1.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then((e=>a(e,i))).then((e=>i.hooks?i.hooks.processAllTokens(e):e)).then((e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then((()=>e)):e)).then((e=>s(e,i))).then((e=>i.hooks?i.hooks.postprocess(e):e)).catch(o);try{i.hooks&&(t=i.hooks.preprocess(t));let e=a(t,i);i.hooks&&(e=i.hooks.processAllTokens(e)),i.walkTokens&&this.walkTokens(e,i.walkTokens);let n=s(e,i);return i.hooks&&(n=i.hooks.postprocess(n)),n}catch(e){return o(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+g1(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function I1(e,t){return O1.parse(e,t)}I1.options=I1.setOptions=function(e){return O1.setOptions(e),I1.defaults=O1.defaults,w0(I1.defaults),I1},I1.getDefaults=_0,I1.defaults=y0,I1.use=function(...e){return O1.use(...e),I1.defaults=O1.defaults,w0(I1.defaults),I1},I1.walkTokens=function(e,t){return O1.walkTokens(e,t)},I1.parseInline=O1.parseInline,I1.Parser=C1,I1.parser=C1.parse,I1.Renderer=S1,I1.TextRenderer=T1,I1.Lexer=E1,I1.lexer=E1.lex,I1.Tokenizer=b1,I1.Hooks=R1,I1.parse=I1;I1.options,I1.setOptions,I1.use,I1.walkTokens,I1.parseInline,C1.parse,E1.lex;function A1(e){return A1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A1(e)}function k1(){k1=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==A1(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function x1(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var L1=new I1.Renderer;L1.link=function(e){var t=e.href,n=(e.title,e.text),r=t?t.replace(/"/g,"&quot;"):"#";return'<a href="'.concat(r,'" target="_blank" rel="noopener noreferrer">').concat(n,"</a>")},I1.setOptions({gfm:!0,breaks:!0,sanitize:!1,renderer:L1});var N1=__webpack_require__(9402),P1=__webpack_require__(8150),D1=__webpack_require__(1290),M1=__webpack_require__(6189);var U1=function(){var e=document.querySelector(".sa-ai-chat-header #sa-ai-chat-typing-indicator");e&&(e.innerHTML="online");var t=document.querySelector("#saleassistAiChatLog #typing-loader-wrapper");t&&t.remove()};function j1(e,t){return V1.apply(this,arguments)}function V1(){return V1=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){x1(o,r,i,a,s,"next",e)}function s(e){x1(o,r,i,a,s,"throw",e)}a(void 0)}))}}(k1().mark((function e(t,n){var r,i,a,s,c,l,d,u,p,h=arguments;return k1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=h.length>2&&void 0!==h[2]?h[2]:Date.now(),i=n.querySelector("#saleassistAiChatMessageInput"),n.querySelector(".sa-ai-chat-document-preview-container"),a=i.value,s=D()[t],c=U()[t],l=c.form_data,d=c.socket,""!==a.trim()&&(B1(t,n,"You",a,!0,r),i.value="",document.getElementById("sa-ai-chat-typing-indicator").innerHTML="typing...",c2(n),u={message_content:a,message_type:"chat_request",message_from:l.people_id,meta:[],message_to:"",people_id:l.people_id,meeting_id:"",form_id:l.form_id,unique_field_value:l.unique_field_value,source_id:s.id,source_name:s.name,source_type:s.source_type,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href,session_id:l.session_id,chat_group_id:"",page_url:window.location.pathname},p={method:"POST",headers:{"Content-Type":"application/json",referrer:window.location.href},body:JSON.stringify(u)},null==d||d.emit("ai_chat_message",u),fetch(o.url.SOURCE+"/".concat(s.id,"/ai_conversation"),p).then((function(e){if(e.ok)return e.json();throw new Error("Request failed with status: ".concat(e.status))})).then((function(e){console.log("success",e)})).catch((function(e){var t=n.querySelectorAll("#saleassistAiChatLog .sent"),r=t[t.length-1].querySelector(".sender-info-wrapper .sender-details");r.querySelector(".tick").remove(),r.innerHTML+='<span title="Message Not Sent" class="sa-message-not-sent-error">'.concat(M1(),"</span>"),U1(),console.error("Message not sent:",e)})));case 9:case"end":return e.stop()}}),e)}))),V1.apply(this,arguments)}function B1(e,t,n,r,i,o){var a=t.querySelector("#saleassistAiChatLog"),s=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div");d.classList.add("sender-info-wrapper");var u=D()[e].ai_chat_bot_icon,p=document.createElement("span");p.classList.add("sender-avatar"),p.innerHTML=u?"<img src=".concat(u,' alt="chat bot icon" />'):n.slice(0,1),u&&(p.style.backgroundColor="transparent");var h=document.createElement("div");h.classList.add("sender-details"),h.innerHTML=i?"":n;var f=document.createElement("span");f.classList.add("message-sent-at"),f.innerHTML=function(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}(o);var m=document.createElement("span");m.classList.add("tick"),m.innerHTML=N1(),h.appendChild(f),i?(s.classList.add("sent"),d.prepend(h),h.appendChild(m)):(s.classList.add("received"),d.prepend(p,h)),s.appendChild(d),c.classList.add("message"),l.classList.add("message-meta-info");var g=I1(r);c.innerHTML=g,s.prepend(c),a.appendChild(s),a.scrollTop=a.scrollHeight,U1(),setTimeout((function(){m.innerHTML=P1()}),500),setTimeout((function(){m.innerHTML=D1()}),1500)}function F1(e,t,n,r){B1(e,t,r,n,!1,arguments.length>4&&void 0!==arguments[4]?arguments[4]:Date.now())}function G1(e){return G1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G1(e)}function H1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H1(Object(n),!0).forEach((function(t){W1(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==G1(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==G1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===G1(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z1(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return K1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K1(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Y1(){Y1=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==G1(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function J1(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function X1(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){J1(o,r,i,a,s,"next",e)}function s(e){J1(o,r,i,a,s,"throw",e)}a(void 0)}))}}var Z1=__webpack_require__(1587),Q1=(__webpack_require__(2461),__webpack_require__(9001)),$1=__webpack_require__(4516),e2=__webpack_require__(3585),t2=__webpack_require__(9644),n2=__webpack_require__(8873),r2=function(){var e=X1(Y1().mark((function e(){var t,n,r;return Y1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://ipapi.co/json/");case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,r=n.country_calling_code,e.abrupt("return",r);case 11:return e.prev=11,e.t0=e.catch(0),console.error("Error fetching country code:",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();function i2(e){var t=z1(e.split("-").map(Number),3),n=t[0],r=t[1],i=t[2],o=new Date(n,r-1,i),a=new Date;return a.setHours(0,0,0,0),o<=a}function o2(e,t){return e.replace(/{{(.*?)}}/g,(function(e,n){return t[n.trim()]||""}))}function a2(e){var t=document.querySelector(".sa-ai-chat-header-title"),n=document.querySelector(".sa-ai-chat-title-initials");t&&(t.childNodes[0].textContent=e),n&&(n.innerHTML=e.slice(0,2)||"")}var s2=function(e,t){var n=document.createElement("div");n.classList.add("chat-handover-msg"),n.innerHTML=e,t.appendChild(n),t.scrollTop=t.scrollHeight},c2=function(e){var t=e.querySelector("#saleassistAiChatLog"),n=document.createElement("div");n.id="typing-loader-wrapper",n.innerHTML='<div class="loader">\n    <span></span>\n    <span></span>\n    <span></span>\n    </div>',t.appendChild(n),t.scrollTop=t.scrollHeight},l2=function(){var e=X1(Y1().mark((function e(t,n,r){var i,a,s,c=arguments;return Y1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>3&&void 0!==c[3]?c[3]:function(){},a=c.length>4&&void 0!==c[4]?c[4]:function(){},e.prev=2,e.next=5,l.post(o.url.SOURCE,"/".concat(t,"/capture"),{session_id:F("session_data_".concat(t)),user_data:q1({},n)});case 5:(s=e.sent)&&(B("user_data_".concat(t),n),B("form_data_".concat(t),s),M(W1({},t,q1(q1({},r),{},{form_data:s}))),i()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("Something went wrong while capturing the lead",e.t0),a(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n,r){return e.apply(this,arguments)}}(),d2=function(e,t,n){var r=t.querySelector("#saleassistAiChatLog");if(e.length>0){var i="";e.forEach((function(e){i+='<button class="ai-chat-faq-btn">'.concat(e,"</button>")}));var o=document.createElement("div");o.classList.add("ai-chat-faq-wrapper"),o.innerHTML=i,r.appendChild(o),r.scrollTop=r.scrollHeight,t.querySelectorAll(".ai-chat-faq-btn").forEach((function(e){e.addEventListener("click",(function(e){t.querySelector("#saleassistAiChatMessageInput").value=e.target.innerText,j1(n,t),null==o||o.remove()}))}))}},u2=function(){var e=X1(Y1().mark((function e(t,n,r){var i,a,s,c,d,u,p,h,f,m,g,v,_,y,w,b,E,S,T,C,R,O,I,A,k,x,L,N,P,j,V,G,H,q,W,z,K,Y,J,X,Z,Q;return Y1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E=function(e){e.preventDefault()},i=D()[t],a=F("ai_chat_handover_".concat(t)),s=null!=a&&a.is_handover?a.handler_name:i.ai_chat_bot_name||"ChatBot",c=i.ai_chat_welcome_message||"Hello!  How can I assist you today?",d=i.ai_chat_handover_message||"Let me connect you with a human agent for further assistance. Please hold on.",u=i.ai_faq_context_json,m=U()[t],g=m.form_data,v=m.is_agent_online,r.innerHTML=Z1({chatBotIcon:i.ai_chat_bot_icon,chatBotName:s,chatBotInitials:s.slice(0,2)||"",chatLike:Q1,chatDislike:$1,threeDotsLoader:e2,uploadBtn:t2,sendBtn:n2}),_=n.querySelector("#saleassistAiChatLog"),$=i.ai_chat_background,ee=_,"doodle_image"===$?(ee.style.backgroundImage='url("https://my-stg.saleassist.ai/7381928ef7d92993ddec254ed1edf435.jpg")',ee.style.backgroundPosition="center",ee.style.backgroundRepeat="repeat",ee.style.backgroundSize="cover"):ee.style.backgroundColor="#"===$[0]?$:o.colors[$],y=n.querySelector("#saleassistAiChatMessageInput"),w=n.querySelector("#saleassistAiChatSendButton"),setInterval((function(){y.placeholder.startsWith("Ask me")?y.placeholder="You can talk in any language":y.placeholder="Ask me anything"}),5e3),b=function(e,r,i){F1(t,n,e,r||s,i)},S={},T=0,C=JSON.parse(i.lead_form),R="paragraph"===C[0].type?C[0].label:"",O="paragraph"===C[C.length-1].type?C[C.length-1].label:"Thank you for sharing the details. How would you like to proceed with us?",I=C.filter((function(e){return"text"===e.type||"number"===e.type||"textarea"===e.type||"date"===e.type||"hidden"===e.type})),A=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,k=/^\+?[1-9]\d{1,14}$/,x=/^[6-9]\d{9}$/,L=/^[0-9]+$/,N="",P=I.map((function(e){return e.type})).indexOf("date"),j=I.map((function(e){return e.type})).lastIndexOf("date"),V=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=y.value.trim()||r;if(""!==i){y.value="";var o=I[T].name,a=I[T].type,s=I[T].subtype;if("date"===a){var c=z1(i.split("-"),3),l=c[0],d=c[1],p=c[2];i="".concat(p,"/").concat(d,"/").concat(l)}if("hidden"!==a&&B1(t,n,"You",i,!0,Date.now()),"text"!==a||"email"!==s||A.test(i)){if("text"===a&&"tel"===s){if(10===I[T].maxlength){if(!x.test(i))return void b("Please enter a valid mobile number without country code")}else if(!k.test(i))return void b("Please enter the valid mobile number");var h=i.replace(/[^\d+]/g,"");h.startsWith("+")||r2().then((function(e){e&&(S[o]=e+h)})),i=h}else if("number"===a){if(!L.test(i))return void b("Please enter a valid number eg. 1, 2, 3");if(I[T].min&&i<I[T].min)return void b("Minimum ".concat(I[T].label," can be ").concat(I[T].min));if(I[T].max&&i>I[T].max)return void b("Maximum ".concat(I[T].label," can be ").concat(I[T].max));y.type="text",y.removeAttribute("step"),y.removeAttribute("min"),y.removeAttribute("max")}else if("date"===a){if(i2(i))return void b("Please select a future date");if(""===N&&(N=i),""!==N&&P!==j&&T===j&&new Date(i)<=new Date(N))return void b("".concat(I[P].label," must be greater then ").concat(I[j].label));y.type="text",y.removeEventListener("keydown",E);var f=document.getElementById("ai_chat_date_input_icon");f.removeEventListener("click",(function(){})),null==f||f.remove()}if(S[o]=i,++T<I.length){if("date"===I[T].type){if(y.type="date",y.addEventListener("keydown",E),y.focus(),!document.getElementById("ai_chat_date_input_icon")){document.querySelector(".sa-ai-chat-input-wrapper").insertAdjacentHTML("beforeend",'<span id="ai_chat_date_input_icon" style="position: absolute; right: 24px; width: -webkit-fill-available; height: 100%; display: flex; justify-content: end; align-items: center; cursor: pointer;"></span>'),document.getElementById("ai_chat_date_input_icon").addEventListener("click",(function(){y.showPicker()}))}}else"number"===I[T].type&&(y.type="number",I[T].step&&(y.step=I[T].step),I[T].min&&(y.min=I[T].min),I[T].max&&(y.max=I[T].max),y.removeEventListener("keydown",E));if("hidden"!==I[T].type){var v=o2(I[T].placeholder,S);b(v)}else e(I[T].value)}else{l2(t,S,m,(function(){m=U()[t],g=m.form_data,Y(),b(o2(O,S)),d2(u,n,t)}),(function(e){b("Something is wrong!! Please refresh the page to try again"),y.disabled=!0}))}}else b("Please enter the valid email address")}},G=function(e){return["lead_owner_changed","lead_purchase_status_change","lead_config_status_change","lead_config_type_change"].includes(e)},!g){e.next=39;break}return e.next=35,l.get(o.url.SOURCE,"/".concat(i.id,"/conversation/").concat(g.session_id));case 35:if((H=e.sent)&&H.length>0)for(q=H.length-1;q>=0;q--)"openai"===H[q].message_from?b(H[q].message_content,s,H[q].updated_on):"handover_message"===H[q].message_type?(W=H[q].message_content.includes("AI Bot")?H[q].message_content.replace("AI Bot",i.ai_chat_bot_name):H[q].message_content,s2(W,_)):H[q].message_from!==g.people_id?G(H[q].message_type)||b(H[q].message_content,H[q].unique_field_value,H[q].updated_on):B1(t,n,"You",H[q].message_content,!0,H[q].updated_on);else s2("You are now connected with ".concat(i.ai_chat_bot_name),_),c2(n),setTimeout((function(){b(c),d2(u,n,t)}),2e3);e.next=43;break;case 39:s2("You are now connected with ".concat(i.ai_chat_bot_name),_),c2(n),c2(n),setTimeout((function(){b(c),b(R+" "+I[T].placeholder)}),2e3);case 43:z=function(){try{var e=i.ai_chat_handover_failed_message||"Handover failed";s2(e,_);var r=document.createElement("div");r.classList.add("ai-chat-offline-cta-wrapper"),_.appendChild(r),n5(t,n,!0,!0),setTimeout((function(){_.scrollTop=_.scrollHeight}),150)}catch(e){console.error(e)}},Y=function(){var e;(K=uY(o.url.SOCKET_URL,{query:"id=".concat(g.people_id,"&client_id=").concat(i.client_id)})).on("connect",(function(e){M(W1({},t,q1(q1({},m),{},{socket:K})))})),K.on("message",function(){var e=X1(Y1().mark((function e(n){var r,o,c;return Y1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("widget_incoming_request_picked"===n.message&&(b("You have been connected to our agent, please proceed with your concern."),B("ai_chat_handover_".concat(t),{is_handover:!0,handler_name:s},1)),"widget_incoming_request_closed"===n.message&&b("Thank you, hope your concern got resolved."),!n.message_content||"AI_HANDOVER"!==n.message_content){e.next=6;break}if("whatsapp_message"!==n.message_type){e.next=5;break}return e.abrupt("return");case 5:v?(b(d),f&&(clearTimeout(p),clearInterval(h),null===(r=f)||void 0===r||r.remove()),o=i.call_timeout,(f=document.createElement("div")).classList.add("chat-handover-msg"),f.innerHTML='Transferring chat to my senior. Please wait... <div style="margin-top: 6px">estimated time 00:'.concat(o,"</div>"),_.appendChild(f),_.scrollTop=_.scrollHeight,h=setInterval((function(){if(--o>0){var e=o<10?"0".concat(o):o;f.childNodes[1].innerHTML="estimated time 00:".concat(e)}}),1e3),p=setTimeout((function(){clearInterval(h);var e=null==a?void 0:a.is_handover;e&&void 0!==e||(f.remove(),z())}),1e3*i.call_timeout)):(b(d),z());case 6:n.message_content&&"AI_HANDOVER"!==n.message_content&&n.message_from!==g.people_id&&(c=s,G(n.message_type)||b(n.message_content,c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),null===(e=K)||void 0===e||e.on("handover_message",function(){var e=X1(Y1().mark((function e(n){var r;return Y1().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.conversation.is_bot_handover&&(clearTimeout(p),clearInterval(h),null===(r=f)||void 0===r||r.remove(),s2("You are now connected with ".concat(n.text,"."),_),a2(s=n.text),B("ai_chat_handover_".concat(t),{is_handover:!0,handler_name:s},1)),n.conversation.is_bot_handover||(clearTimeout(p),s2("Conversation handed back to ".concat(i.ai_chat_bot_name),_),a2(s=i.ai_chat_bot_name),U1(),B("ai_chat_handover_".concat(t),{is_handover:!1,handler_name:s}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},g&&!K&&Y(),J=n.querySelector("#saleassistAiChatUploadButton #ai-chat-upload-file"),X=n.querySelector("#sa-ai-chat-toggle-emoji-btn"),Z=n.querySelector("#sa-ai-chat-emoji-wrapper"),Q=n.querySelectorAll(".sa-ai-chat-emoji"),X.addEventListener("click",(function(){Z.classList.toggle("open")})),Q.forEach((function(e){e.addEventListener("click",(function(e){y.value+=e.target.innerText}))})),y.addEventListener("keydown",(function(e){if(13===e.keyCode){if(!g)return void V();e.preventDefault(),j1(t,n),Z.classList.remove("open")}})),w.addEventListener("click",(function(){g?(j1(t,n),Z.classList.remove("open")):V()})),J.addEventListener("click",(function(e){e.target.value=null})),J.addEventListener("change",(function(e){}));case 56:case"end":return e.stop()}var $,ee}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function p2(e){return p2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p2(e)}function h2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h2(Object(n),!0).forEach((function(t){m2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==p2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p2(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g2=__webpack_require__(8922);function v2(e){return v2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v2(e)}function _2(){_2=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==v2(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function y2(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function w2(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){y2(o,r,i,a,s,"next",e)}function s(e){y2(o,r,i,a,s,"throw",e)}a(void 0)}))}}function b2(e){return new Promise((function(t){var n=document.createElement("script");n.src=e,n.onload=function(){t(!0)},n.onerror=function(){t(!1)},document.body.appendChild(n)}))}function E2(e,t,n,r,i,o,a,s,c,l){return S2.apply(this,arguments)}function S2(){return S2=w2(_2().mark((function e(t,n,r,i,a,s,c,l,d,u){var p,h;return _2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b2("https://checkout.razorpay.com/v1/checkout.js");case 2:if(e.sent){e.next=6;break}return alert("Razorpay SDK failed to load. Are you online?"),e.abrupt("return");case 6:p={key:l,order_id:t,description:"Live call Payment",handler:function(e){dX({url:o.url.SOURCE,path:"/live_merchant_pay_confirmation/"+r+"/"+s,data:{plan_payment_id:e.razorpay_payment_id,people_id:a,mode:"live_payment",amount:n,status:"authenticated",provider:"razorpay"},onSuccess:function(e){d&&d(e)}})},modal:{ondismiss:function(){dX({url:o.url.SOURCE,path:"/live_merchant_pay_confirmation/"+r+"/"+s,data:{people_id:a,mode:"live_payment",amount:n,status:"denied",provider:"razorpay"},onFailure:function(e){u&&u(e)}})}},notes:{people_id:a,meeting_id:c,client_id:i}},(h=new window.Razorpay(p)).on("payment.failed",(function(e){dX({url:o.url.SOURCE,path:"/live_merchant_pay_confirmation/"+r+"/"+s,data:{people_id:a,mode:"live_payment",amount:n,status:"failed",provider:"razorpay"},onFailure:function(e){u&&u(e)}})})),h.open();case 10:case"end":return e.stop()}}),e)}))),S2.apply(this,arguments)}function T2(e,t,n,r,i,o,a,s){return C2.apply(this,arguments)}function C2(){return C2=w2(_2().mark((function e(t,n,r,i,a,s,c,l){return _2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:dX({url:o.url.SOURCE,path:"/merchant_pay_order/"+t,data:{amount:s,currency:a,receipt:r,notes:{client_id:n,people_id:r}},onSuccess:function(){var e=w2(_2().mark((function e(o){return _2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E2(o.data.order_id,s,t,n,r,i,null,o.razorpay_api_key,c,l);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onFailure:function(e){l&&l(e)}});case 1:case"end":return e.stop()}}),e)}))),C2.apply(this,arguments)}function R2(e){return R2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R2(e)}function O2(){O2=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==R2(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function I2(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var A2=__webpack_require__(8345),k2=function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){I2(o,r,i,a,s,"next",e)}function s(e){I2(o,r,i,a,s,"throw",e)}a(void 0)}))}}(O2().mark((function e(t,n,r){var i,a,s,c,d,u,p,h,f,m,g=arguments;return O2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=g.length>3&&void 0!==g[3]?g[3]:"",a=D()[t],s=F("form_data_".concat(t)),c=F("user_data_".concat(t))||{},s){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,l.get(o.url.SOURCE,"/get_initiate_call_payment_confirmation/".concat(a.id,"/").concat(null==s?void 0:s.people_id));case 9:e.sent?"video_call"===i?k$(t,n,r,i):ae(r,a.id,t,n):(f=c.advance_payment_type?null===(d=c.advance_payment_type)||void 0===d||null===(u=d[0])||void 0===u?void 0:u.split("-")[0]:a.advance_payment_currency,m=c.advance_payment_type?null===(p=c.advance_payment_type)||void 0===p||null===(h=p[0])||void 0===h?void 0:h.split("-")[1]:a.advance_payment_amount,r.innerHTML=A2({paymentCurrency:f,paymentAmount:m}),n.querySelector("#sa-live-call-widget-advance-payment-btn").addEventListener("click",(function(){T2(a.id,a.client_id,s.people_id,s.form_id,f,m,(function(e){"video_call"===i?k$(t,n,r,i):ae(r,a.id,t,n)}),(function(e){console.error("Your payment could not be processed.")}))}))),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(6);case 15:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t,n,r){return e.apply(this,arguments)}}();function x2(e){return x2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x2(e)}function L2(){L2=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==x2(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function N2(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function P2(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){N2(o,r,i,a,s,"next",e)}function s(e){N2(o,r,i,a,s,"throw",e)}a(void 0)}))}}function D2(e){return D2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D2(e)}function M2(){M2=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==D2(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function U2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U2(Object(n),!0).forEach((function(t){V2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==D2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D2(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B2(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function F2(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){B2(o,r,i,a,s,"next",e)}function s(e){B2(o,r,i,a,s,"throw",e)}a(void 0)}))}}var G2=__webpack_require__(8922),H2=__webpack_require__(4475),q2=__webpack_require__(3585),W2=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Record Video Message",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"video_message",a=D()[e],s=U()[e];n.innerHTML=H2({title:r});var c,d=t.querySelector(".sa-live-call-widget-video-preview-wrapper"),u=t.querySelector(".sa-live-call-widget-video-preview"),p=t.querySelector(".sa-live-call-capture-image-btn-wrapper"),h=t.querySelector(".sa-live-call-widget-capture-image-btn"),f=t.querySelector(".sa-live-call-widget-switch-camera-btn");u.style.transform="rotateY(180deg)",p.style.display="none";var m="user",g=document.createElement("canvas");function v(){return navigator.mediaDevices.getUserMedia({video:{facingMode:m},audio:!1}).then((function(e){c=e,u.srcObject=c,u.style.objectFit="cover",u.style.transform="user"===m?"rotateY(180deg)":"rotateY(0deg)",p.style.display="flex",h.disabled=!1,h.style.cursor="pointer"})).catch((function(e){console.error("Error accessing camera and microphone:",e),alert("Error accessing camera and microphone")}))}function _(){d.classList.add("video-recorded"),u.style.display="none",h.style.display="none";document.querySelector(".sa-live-call-widget-post-captured-image-btn-wrapper").insertAdjacentHTML("beforeend",'<button\n        id="sa-live-call-widget-recapture-image-btn"\n      >\n        Re-capture\n      </button>\n      <button id="sa-live-call-widget-submit-captured-image-btn">\n        Submit\n      </button>');var r=t.querySelector("#sa-live-call-widget-submit-captured-image-btn"),f=t.querySelector("#sa-live-call-widget-recapture-image-btn");f.addEventListener("click",(function(){d.classList.remove("video-recorded"),u.style.display="block",document.querySelector(".sa-live-call-widget-captured-image").remove(),c=void 0,void 0,[],!1,f.remove(),r.remove();var e=function(){[],!0,h.style.display="block",p.style.display="flex"};v().then((function(){e()})).catch((function(e){console.error(e)}))})),r.addEventListener("click",(function(){c.getVideoTracks().forEach((function(e){e.stop()})),r.innerHTML=q2({}),r.style.cursor="not-allowed";var d=F("form_data_".concat(e)),u=function(){var r=F2(M2().mark((function r(c){var u,p,h;return M2().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(u=new FormData).append("files",c,(new Date).getTime()+".png"),r.prev=2,r.next=5,fetch(o.url.SOURCE+"/".concat(a.id,"/storage"),{method:"POST",body:u,headers:{referrer:window.location.href}});case 5:if((p=r.sent).ok){r.next=8;break}throw new Error("Error uploading image");case 8:return r.next=10,p.json();case 10:if(!(h=r.sent)){r.next=16;break}return r.next=14,l.post(o.url.SOURCE,"/".concat(a.id,"/conversation"),j2(j2({},d),{},{message_content:h[0].url,message_type:i,message_from:d.people_id,source_id:a.id,source_type:"live_call",source_name:a.name,source_referrer:window.location.href.includes("&saleassist_referrer=")?window.location.href.split("&saleassist_referrer=")[1]:window.location.href}));case 14:r.sent&&(M(V2({},e,j2(j2({},s),{},{message:"Your message has been received.",widgetName:"thankyouMessage"}))),n.innerHTML=G2({defaultMessage:s.message,thankyouMessage:a.thankyou_message}),M5(e,t));case 16:r.next=21;break;case 18:r.prev=18,r.t0=r.catch(2),console.error("Error uploading image:",r.t0);case 21:case"end":return r.stop()}}),r,null,[[2,18]])})));return function(e){return r.apply(this,arguments)}}();g.toBlob((function(e){u(e)}))}))}function y(){return(y=F2(M2().mark((function e(){var t;return M2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c.getTracks().forEach((function(e){return e.stop()})),e.next=4,navigator.mediaDevices.getUserMedia({video:{facingMode:"user"===m?"environment":"user"},audio:!0});case 4:t=e.sent,u.srcObject=t,c=t,m="user"===m?"environment":"user",u.style.transform="user"===m?"rotateY(180deg)":"rotateY(0deg)",e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error switching camera:",e.t0),alert("Error switching camera");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}g.id="canvas",g.width=640,g.height=480,g.style.display="none",f.addEventListener("click",(function(){return y.apply(this,arguments)})),v(),h.addEventListener("click",(function(){!function(){g.getContext("2d").drawImage(u,0,0,g.width,g.height);var e=new Image;e.src=g.toDataURL("image/png"),e.classList.add("sa-live-call-widget-captured-image"),d.append(e)}(),_()}))};function z2(e){return z2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z2(e)}function K2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K2(Object(n),!0).forEach((function(t){J2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==z2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==z2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===z2(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X2=function(e,t,n,r){var i=D()[n],o=U()[n];M(J2({},n,Y2(Y2({},o),{},{isWidgetOpened:!0}))),t.includes("schedule_meeting")?(i.capture_advance_payment?k2(n,r,e,"schedule_meeting"):ae(e,n,r),M(J2({},n,Y2(Y2({},o),{},{widgetName:"scheduleMeeting"})))):t.includes("video_call")?(i.capture_advance_payment?k2(n,r,e,"video_call"):k$(n,r,e,"video_call",!1),M(J2({},n,Y2(Y2({},o),{},{widgetName:"videoCall"})))):t.includes("video_message")?(Y$(n,r,e),M(J2({},n,Y2(Y2({},o),{},{widgetName:"videoMessage"})))):t.includes("video_feedback")?(Y$(n,r,e,"video_feedback"),M(J2({},n,Y2(Y2({},o),{},{widgetName:"videoFeedback"})))):t.includes("audio_call")?(k$(n,r,e,"audio_call",!1),M(J2({},n,Y2(Y2({},o),{},{widgetName:"audioCall"})))):t.includes("voice_message")?(a0(n,r,e),M(J2({},n,Y2(Y2({},o),{},{widgetName:"voiceMessage"})))):t.includes("audio_feedback")?(a0(n,r,e,"audio_feedback"),M(J2({},n,Y2(Y2({},o),{},{widgetName:"audioFeedback"})))):t.includes("text_message")?(v0(n,r,e),M(J2({},n,Y2(Y2({},o),{},{widgetName:"textMessage"})))):t.includes("text_feedback")?(v0(n,r,e,"text_feedback"),M(J2({},n,Y2(Y2({},o),{},{widgetName:"textFeedback"})))):t.includes("whatsapp_message")?(v0(n,r,e,"",!0),M(J2({},n,Y2(Y2({},o),{},{widgetName:"whatsappMessage"})))):t.includes("feedback_form")?(SY(n,r),M(J2({},n,Y2(Y2({},o),{},{widgetName:"feedbackForm"})))):t.includes("ai_chat")?(u2(n,r,e),M(J2({},n,Y2(Y2({},o),{},{widgetName:"AiChat"})))):t.includes("shoppable_video")?function(e,t,n){var r=D()[e],i=U()[e];M(m2({},e,f2(f2({},i),{},{message:"",widgetName:"thankyouMessage"}))),n.innerHTML=g2({defaultMessage:i.message,thankyouMessage:r.thankyou_message}),M5(e,t)}(n,r,e):t.includes("chat-first-approach")?(u2(n,r,e),M(J2({},n,Y2(Y2({},o),{},{widgetName:"AiChat"})))):t.includes("share_jump_page")?function(e,t){var n=t.querySelector(".sa-live-call-widget-share-widget-container");n.style.display="block";var r="Hi,\n  I recommend Policybazaar for all your insurance needs.\n  I recently bought a health insurance policy from Policybazaar and I am extremely satisfied.\n  Great service and pricing!\n  Bye & Good day!",i=window.location.href;t.querySelector(".sa-live-call-widget-share-widget-on-whatsapp").addEventListener("click",(function(){window.open("https://api.whatsapp.com/send?text=".concat(encodeURIComponent(r)," ").concat(encodeURIComponent(i)),"_blank","noopener")})),t.querySelector(".sa-live-call-widget-share-widget-on-twitter").addEventListener("click",(function(){var e="https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(r),"&url=").concat(encodeURIComponent(i));window.open(e,"_blank")})),t.querySelector(".sa-live-call-widget-share-widget-on-linkedin").addEventListener("click",(function(){var e="https://www.linkedin.com/shareArticle?mini=true&url=".concat(encodeURIComponent(i));window.open(e,"_blank")})),t.querySelector(".sa-live-call-widget-share-widget-on-gmail").addEventListener("click",(function(){var e="Here is the link you might find interesting: "+i,t="https://mail.google.com/mail/?view=cm&fs=1&tf=1&su=".concat(encodeURIComponent(r),"&body=").concat(encodeURIComponent(e));window.open(t,"_blank")})),t.querySelector(".sa-live-call-widget-copy-widget-page-url-btn").addEventListener("click",P2(L2().mark((function e(){return L2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(i);case 3:t.querySelector(".sa-live-call-widget-copy-widget-page-url-btn-text").textContent="Copied",e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to copy: ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),t.querySelector(".sa-live-call-widget-close-share-widget-popup-btn").addEventListener("click",(function(){n.style.display="none"}))}(0,r):t.includes("watch-live-stream")?k$(n,r,e,"video_call",!0):t.includes("image_message")&&(W2(n,r,e),M(J2({},n,Y2(Y2({},o),{},{widgetName:"videoMessage"}))))},Z2=__webpack_require__(7289),Q2=__webpack_require__(8666),$2=__webpack_require__(6254),e3=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AIzaSyDRnJ-FGnxGDemTnGqkAOWAjw35bOlE-Yg";return new Promise((function(t,n){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(r){var i=r.coords.latitude,o=r.coords.longitude,a="https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(i,",").concat(o,"&key=").concat(e);fetch(a).then((function(e){if(!e.ok)throw new Error("Request failed");return e.json()})).then((function(e){if("OK"===e.status&&e.results.length>0){var r=e.results[0];t({address:r,latitude:i,longitude:o})}else n("No results found")})).catch((function(e){n(e.message)}))}),(function(e){n("Geolocation error: "+e.message)})):n("Geolocation is not supported by this browser")}))};function t3(e){return t3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t3(e)}function n3(){n3=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==t3(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function r3(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i3(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){r3(o,r,i,a,s,"next",e)}function s(e){r3(o,r,i,a,s,"throw",e)}a(void 0)}))}}var o3=function(e,t,n){var r=document.querySelector(".sa-live-call-widget-lead-capture-form-submit-btn-wrapper"),i=document.querySelector(".sa-live-call-widget-required-field-error"),a=function e(t){var n=r.querySelector("#countDown");t>0?setTimeout((function(){t-=1,n.innerHTML="(".concat(t,")s"),e(t)}),1e3):(n.innerHTML="",r.querySelector("#resendOTP").disabled=!1)},s=function(){var n=i3(n3().mark((function n(){return n3().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l.post(o.url.SOURCE,"/send_otp/".concat(e.id,"/").concat(t[e.lead_otp_params]),{});case 3:null===n.sent&&(r.querySelector("#resendOTP").disabled=!0,a(30)),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("Something went wrong");case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}(),c=function(){var a=i3(n3().mark((function a(){var s;return n3().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(""===(s=r.querySelector("#otpField")).value){a.next=14;break}return a.prev=2,a.next=5,l.post(o.url.SOURCE,"/verify_otp/".concat(e.id,"/").concat(t[e.lead_otp_params],"/").concat(s.value.trim()),{});case 5:a.sent?n():(s.value="",i.textContent="OTP is wrong!",i.style.display="block"),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(2),console.error("Something went wrong");case 12:a.next=16;break;case 14:i.textContent="Enter the OTP code",i.style.display="block";case 16:case"end":return a.stop()}}),a,null,[[2,9]])})));return function(){return a.apply(this,arguments)}}();r.innerHTML='<input type="text" id="otpField" placeHolder="Enter the OTP code" required /><span id="resendOTPCont">Didn\'t receive a OTP? <button id="resendOTP">Resend OTP</button> <span id="countDown"></span></span><button id="verifyOTP">Verify OTP</button>';var d=r.querySelector("#resendOTP"),u=r.querySelector("#verifyOTP");d.addEventListener("click",s),u.addEventListener("click",c),s()};function a3(e){var t=e.querySelector(".sa-live-call-widget-lead-capture-form-field-box-group-date"),n=e.querySelector(".date-input"),r=e.querySelector("#clearBtn"),i=e.querySelector("#calendar"),o=e.querySelector("#days"),a=e.querySelector("#monthYear"),s=e.querySelector("#prevMonth"),c=e.querySelector("#nextMonth");if(t&&n&&i&&o&&a&&s&&c){var l=new Date,d=new Date(l.getFullYear(),l.getMonth(),l.getDate()).getTime(),u=l.getMonth(),p=l.getFullYear(),h=null,f=["January","February","March","April","May","June","July","August","September","October","November","December"];t.addEventListener("click",(function(e){i.contains(e.target)||i.classList.toggle("active")})),r&&r.addEventListener("click",(function(e){e.stopPropagation(),h=null,n.value="",r.style.display="none";var t=o.querySelector(".day.selected");t&&t.classList.remove("selected"),i.classList.remove("active")})),s.addEventListener("click",(function(e){e.stopPropagation(),--u<0&&(u=11,p--),g(u,p),m()})),c.addEventListener("click",(function(e){e.stopPropagation(),++u>11&&(u=0,p++),g(u,p),m()})),o.addEventListener("click",(function(e){e.stopPropagation();var t=e.target;if(t&&t instanceof Element){var a=t.closest(".day");if(a&&!a.classList.contains("disabled")){var s=Number(a.getAttribute("data-day"));h={day:s,month:u,year:p};var c=o.querySelector(".day.selected");c&&c.classList.remove("selected"),a.classList.add("selected"),n.value=function(e,t,n){return"".concat(e," ").concat(f[t]," ").concat(n)}(s,u,p),r&&(r.style.display="block"),i.classList.remove("active")}}})),i.addEventListener("click",(function(e){e.stopPropagation()})),document.addEventListener("click",(function(e){i.contains(e.target)||e.target===n||i.classList.remove("active")})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&i.classList.remove("active")})),g(u,p)}function m(){var e=o.querySelector(".day.selected");if(e&&e.classList.remove("selected"),h){var t='.day[data-day="'.concat(h.day,'"]'),n=o.querySelector(t);n&&n.classList.add("selected")}}function g(e,t){o.innerHTML="",a.textContent="".concat(f[e]," ").concat(t),a.setAttribute("aria-live","polite");for(var n=new Date(t,e,1).getDay(),r=new Date(t,e+1,0).getDate(),i=document.createDocumentFragment(),s=0;s<n;s++){var c=document.createElement("div");c.classList.add("empty"),c.setAttribute("aria-hidden","true"),i.appendChild(c)}for(var l=1;l<=r;l++){var u=document.createElement("div");u.textContent=l,u.className="day",u.setAttribute("data-day",String(l)),new Date(t,e,l).getTime()<d&&(u.classList.add("disabled"),u.setAttribute("aria-disabled","true")),h&&h.day===l&&h.month===e&&h.year===t&&u.classList.add("selected"),i.appendChild(u)}o.appendChild(i)}}var s3={"+93":9,"+355":9,"+213":9,"+376":6,"+244":9,"+1268":10,"+54":10,"+374":8,"+297":7,"+61":9,"+43":10,"+994":9,"+1242":10,"+973":8,"+880":10,"+1246":10,"+375":9,"+32":9,"+501":7,"+229":8,"+975":8,"+591":8,"+387":8,"+267":8,"+55":11,"+246":7,"+673":7,"+359":8,"+226":8,"+257":8,"+855":9,"+237":9,"+1":10,"+238":7,"+345":10,"+236":8,"+235":8,"+56":9,"+86":11,"+57":10,"+269":7,"+242":9,"+243":9,"+225":10,"+385":9,"+53":8,"+357":8,"+420":9,"+45":8,"+253":8,"+1767":10,"+1849":10,"+593":9,"+20":10,"+503":8,"+240":9,"+291":7,"+372":7,"+251":9,"+500":5,"+298":6,"+679":7,"+358":9,"+33":9,"+594":9,"+689":8,"+262":9,"+241":8,"+220":7,"+995":9,"+49":10,"+233":9,"+350":8,"+30":10,"+299":6,"+1473":10,"+590":9,"+1671":10,"+502":8,"+224":9,"+245":7,"+592":7,"+509":8,"+672":6,"+852":8,"+36":9,"+354":7,"+91":10,"+62":10,"+98":10,"+964":10,"+353":9,"+44":10,"+972":9,"+39":10,"+1876":10,"+81":10,"+962":9,"+7":10,"+254":9,"+686":5,"+850":8,"+82":9,"+383":8,"+965":8,"+996":9,"+856":8,"+371":8,"+961":8,"+266":8,"+231":8,"+218":9,"+423":7,"+370":8,"+352":9,"+853":8,"+389":8,"+261":9,"+265":9,"+60":9,"+960":7,"+223":8,"+356":8,"+692":7,"+596":9,"+222":8,"+230":8,"+52":10,"+373":8,"+377":8,"+976":8,"+382":8,"+1664":10,"+212":9,"+258":9,"+95":9,"+264":9,"+674":7,"+977":10,"+31":9,"+64":9,"+505":8,"+227":8,"+234":10,"+683":4,"+47":8,"+968":8,"+92":10,"+680":7,"+970":9,"+507":8,"+675":8,"+595":9,"+51":9,"+63":10,"+48":9,"+351":9,"+1939":10,"+974":8,"+40":9,"+250":9,"+378":10,"+239":7,"+966":9,"+221":9,"+248":7,"+232":8,"+65":8,"+421":9,"+386":8,"+677":7,"+252":9,"+27":9,"+211":9,"+249":9,"+597":7,"+268":8,"+46":9,"+963":9,"+886":9,"+992":9,"+255":9,"+66":9,"+670":7,"+228":8,"+690":4,"+676":7,"+1868":10,"+216":8,"+90":10,"+993":8,"+1649":10,"+688":5,"+256":9,"+380":9,"+971":9,"+598":9,"+998":9,"+678":7,"+58":10,"+84":9,"+1284":10,"+1340":10,"+681":6,"+263":9};function c3(e){return c3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c3(e)}function l3(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d3(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function d3(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u3(){u3=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==c3(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function p3(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function h3(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){p3(o,r,i,a,s,"next",e)}function s(e){p3(o,r,i,a,s,"throw",e)}a(void 0)}))}}function f3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f3(Object(n),!0).forEach((function(t){g3(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f3(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c3(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c3(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v3=__webpack_require__(9004),_3=__webpack_require__(715),y3=__webpack_require__(8922),w3=function(e){for(var t in e)e[t]&&("string"!=typeof e[t]||e[t].trim())||"boolean"==typeof e[t]||delete e[t];return e},b3=function(e,t,n,r){var i=r.querySelector("#".concat(e));if(i){var a=D()[n],s=U()[n],c=r.querySelector(".sa-live-call-widget-expanded-inner-wrapper");if(a.skip_lead_form&&e.includes("ai_chat"))X2(c,e,n,r);else{var d=i.getAttribute("data-capture-lead-form");if("false"!==d){var u="7d4ccb4b-facb-4a29-9809-f482dad29d68"===a.id||"9eb36291-3d62-420e-be90-f14f3cb41a13"===a.id||"3f721258-3015-413b-baf7-7f78f8d07633"===a.id;window.location.href.includes("/jump/")&&u&&e.includes("share_jump_page")&&X2(c,e,n,r),M(g3({},n,m3(m3({},s),{},{isWidgetOpened:!0,widgetName:"leadCaptureForm"})));var p="string"==typeof a.lead_form?JSON.parse(a.lead_form):[],h=p.filter((function(e){return e.required})),f=function(){if(d){var t=i.getAttribute("data-cta-link");t.length>1?window.open(t,"_blank"):(M(g3({},n,m3(m3({},s),{},{widgetName:"thankyouMessage"}))),c.innerHTML=y3({defaultMessage:U()[n].message,thankyouMessage:a.thankyou_message}),M5(n,r))}else X2(c,e,n,r)},m=function(){var e=h3(u3().mark((function e(){var t,i,a,c=arguments;return u3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(c.length>0&&void 0!==c[0]&&c[0])){e.next=17;break}return null!==(t=_.mobile_number)&&void 0!==t&&t.trim().length&&(_.country_code=b),e.prev=3,e.next=6,l.post(o.url.SOURCE,"/".concat(n,"/capture"),{session_id:F("session_data_".concat(n)),user_data:m3(m3(m3({},w3(_)),y),w)});case 6:(i=e.sent)&&(B("user_data_".concat(n),m3(m3(m3({},w3(_)),y),w)),B("form_data_".concat(n),i),M(g3({},n,m3(m3({},s),{},{form_data:i}))),f()),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Something went wrong"),a=r.querySelector(".sa-live-call-widget-lead-capture-form-submit-btn"),e.t0.toLocaleLowerCase().includes("email")&&(K("email","Invalid Email.","block",!0),a.innerHTML="Submit",a.disabled=!1,a.style.cursor="pointer");case 15:e.next=18;break;case 17:f();case 18:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}();if(F("form_data_".concat(n)))m();else{var g,v,_={},y={},w={},b="+91",E={};if(a.capture_lead_url_params&&a.lead_url_params.length>0&&(g=a.lead_url_params.split(new RegExp("[,; ]","g")).filter((function(e){var t;return(null==e||null===(t=e.trim())||void 0===t?void 0:t.length)>0})),Array.isArray(g)&&g.length>0&&g.forEach((function(e){var t=z(e);t.length>0&&(y[e]=decodeURI(t))}))),a.capture_lead_cookies&&a.lead_cookies.length>0&&(v=a.lead_cookies.split(new RegExp("[,; ]","g")).filter((function(e){var t;return(null==e||null===(t=e.trim())||void 0===t?void 0:t.length)>0})),Array.isArray(v)&&v.length>0&&v.forEach((function(e){var t=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):""}("".concat(e,"_").concat(n));t.length>0&&(w[e]=JSON.parse(t))}))),["www.unbottle.com","unbottle.com"].includes(window.location.hostname)&&s.is_agent_online)return y.name="user-".concat(Math.random().toString(36).substring(2,15)),void m(!0);if(["9d0510ed-a76a-4b99-a7e0-3e1907bfd2ac"].includes(n)&&["Video Call","Audio Call"].includes(t)){var S=Math.floor(9*Math.random()+1)+String(Math.floor(1e9*Math.random())).padStart(9,"0");return y.name="user-".concat(S),y.mobile_number=S,void m(!0)}if(a.skip_lead_form&&(e.includes("video_call")||e.includes("audio_call")))return y[a.unique_field_name]=F("session_data_".concat(n)),void m(!0);if(!a.capture_lead_form&&a.unique_field_name in y&&y[a.unique_field_name])m(!0);else if(!a.capture_lead_form&&a.unique_field_name in w&&w[a.unique_field_name])m(!0);else{var T,C;c.innerHTML="a62ba426-d527-4ba7-af51-fbe88d5bdd21"===n||"f7d7ffaa-d212-45bc-b97a-c92b5a43a051"===n?_3({conversationName:t.toLocaleLowerCase().replace(" ","_")||""}):v3({poweredBy:!s.addons.remove_powered_by});var R=r.querySelectorAll(".sa-live-call-widget-main-title-text");R&&R.length&&R.forEach((function(e){e.textContent=t||"Fill the form"})),a3(c);var O=r.querySelector("#sa-live-call-widget-lead-capture-form"),I=r.querySelector(".sa-live-call-widget-lead-capture-form-fields-main-container");I.insertAdjacentHTML("afterbegin",q(p)),a3(I);var A=r.querySelector(".sa-live-call-widget-selected-country-wrapper");if(A){var k=r.querySelector(".sa-live-call-widget-select-country-arrow"),x=r.querySelector(".sa-live-call-widget-country-list");A.addEventListener("click",(function(){x.classList.toggle("sa-live-call-widget-d-hidden"),k.classList.toggle("sa-live-call-widget-rotate-180")}));var L=r.querySelectorAll(".sa-live-call-widget-country"),N=r.querySelector(".sa-live-call-widget-selected-country");L.forEach((function(e){e.addEventListener("click",(function(){b=e.getAttribute("data-country-dial-code"),N.innerHTML=b,x.classList.add("sa-live-call-widget-d-hidden"),k.classList.remove("sa-live-call-widget-rotate-180")}))}))}if((e.includes("audio_call")||e.includes("video_call")||e.includes("video_message"))&&function(e,t){var n=D()[e],r="undefined"!=typeof InstallTrigger||navigator.userAgent.includes("Firefox"),i=t.querySelector(".sa-live-call-widget-lead-capture-form-container"),o=t.querySelector(".sa-live-call-widget-lead-capture-form-submit-btn-wrapper");o.innerHTML=Z2({});var a=t.querySelector("#sa-live-call-widget-lead-capture-form-microphone-permission-btn"),s=".sa-live-call-widget-lead-capture-form-media-permission-denied-overlay",c=!1,l=function(){var e=t.querySelector(s);e?e.style.display="flex":(i.insertAdjacentHTML("beforeend",$2({})),e=t.querySelector(s)),c||(e.addEventListener("click",(function(){e.style.display="none"})),c=!0)};a.addEventListener("click",(function(){"getUserMedia"in navigator.mediaDevices&&(r?navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){o.innerHTML=Q2({label:n.capture_lead_otp_params?"Send OTP":"Start Now"}),e.getTracks().forEach((function(e){e.stop()}))})).catch((function(e){alert("Microphone or camera permission denied or error"),l()})):navigator.permissions.query({name:"microphone"}).then((function(e){"granted"===e.state?o.innerHTML=Q2({label:n.capture_lead_otp_params?"Send OTP":"Start Now"}):"prompt"===e.state?navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){o.innerHTML=Q2({label:n.capture_lead_otp_params?"Send OTP":"Start Now"}),e.getTracks().forEach((function(e){e.stop()}))})).catch((function(e){alert("Microphone or camera permission denied or error")})):"denied"===e.state&&l()})).catch((function(e){alert("Error checking microphone permission")})))}))}(n,r),null!==(T=a.privacy_policy_url)&&void 0!==T&&T.trim()||null!==(C=a.terms_n_conditions_url)&&void 0!==C&&C.trim()){var P,j,V=O.querySelector(".sa-live-call-widget-terms-n-conditions"),G=null===(P=a.privacy_policy_url)||void 0===P?void 0:P.trim(),H=null===(j=a.terms_n_conditions_url)||void 0===j?void 0:j.trim();V.innerHTML='\n        <input type="checkbox" name="terms-and-conditions" id="terms-and-conditions" checked disabled>\n        I accept the terms of use,\n        '.concat(G?'<a href="'.concat(G,'" target="_blank">Privacy Policy</a>'):"","\n        ").concat(G&&H&&"and","\n        ").concat(H?'<a href="'.concat(H,'" target="_blank">Terms of Service</a>'):"","\n      ")}r.querySelectorAll("input[type='number']").forEach((function(e){e.addEventListener("input",(function(e){var t=e.target.id,n=e.target.value;"mobile_number"===t&&n.trim().length>=10&&(e.target.value=n.slice(0,10)),"pincode"===t&&n.trim().length>=6&&(e.target.value=n.slice(0,6))}))}));var W=!1;O.addEventListener("submit",function(){var e=h3(u3().mark((function e(t){var i,o,s,c,l,d,u,p,f,g,v,y,w,S;return u3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r.querySelector(".sa-live-call-widget-required-field-error").style.display="none",!a.capture_location){e.next=23;break}return e.prev=4,e.next=7,e3();case 7:i=e.sent,o=i.address,s=i.latitude,c=i.longitude,_.widget_location_source="GPS("+s+", "+c+")",_.widget_address=o.formatted_address,_.widget_city=o.address_components[o.address_components.length-4].long_name,_.widget_state=o.address_components[o.address_components.length-3].long_name,_.widget_country=o.address_components[o.address_components.length-2].long_name,_.widget_latitude=s,_.widget_longitude=c,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),console.error("Geocoding failed:",e.t0);case 23:l=r.querySelector(".sa-live-call-widget-lead-capture-form-submit-btn"),d=O.querySelectorAll(".sa-live-call-widget-lead-capture-form-field"),u=O.querySelectorAll(".sa-live-call-widget-lead-capture-form-field-radio"),p=O.querySelectorAll(".sa-live-call-widget-lead-capture-form-field-checkbox"),d.forEach((function(e){if("select"===e.tagName.toLocaleLowerCase()){var t=Array.from(e.querySelectorAll("option:checked"),(function(e){return e.value}));"3a872dc3-0c79-48ac-9bde-1e847990e7bb"===a.id?_[e.name]=t.join(","):_[e.name]=t}else _[e.name]=e.value})),f=function(e){var t=[];e.forEach((function(e){e.checked&&t.push(e.value)})),_[e[0].getAttribute("name")]=t.join(",")},u.length&&f(u),p.length&&f(p),r.querySelectorAll("input[type='text'], input[type='number'], input[type='email'], textarea").forEach((function(e){var t=e.name,n=e.value.trim(),r=n.length,i=e.required;if("mobile_number"===t){var o=s3[b]||10;i||0!==r?0===r?K(t,"Please enter your Mobile Number","block",!0):r===o&&/^[1-9]/.test(n)?K(t,"","none",!1):K(t,"Please enter a valid ".concat(o,"-digit Mobile Number"),"block",!0):K(t,"","none",!1)}"pincode"===t&&i&&(0===r?K(t,"Please enter your PIN code","block",!0):r<6?K(t,"Please enter a valid PIN code","block",!0):K(t,"","none",!1)),"email"===t&&i&&(0===r?K(t,"Please enter your Email ID","block",!0):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(n)?K(t,"","none",!1):K(t,"Please enter a valid Email ID","block",!0))})),g=l3(h);try{for(g.s();!(v=g.n()).done;)y=v.value,(w=y.name)in _&&(!1===_[w]||null===_[w]||void 0===_[w]||"string"==typeof _[w]&&""===_[w].trim())&&(E[w]=!0,r.querySelector(".sa-live-call-widget-lead-capture-form-error-message[data-name=".concat(w,"]")).style.display="block")}catch(e){g.e(e)}finally{g.f()}e.t1=u3().keys(E);case 36:if((e.t2=e.t1()).done){e.next=42;break}if(S=e.t2.value,!E[S]){e.next=40;break}return e.abrupt("return");case 40:e.next=36;break;case 42:a.capture_lead_otp_params?W||(W=!0,o3(a,_,(function(){return m(!0)}))):(l.innerHTML="Loading...",l.disabled=!0,l.style.cursor="not-allowed",_.mobile_number="".concat(b).concat(_.mobile_number),B("user_data_".concat(n),_),m(!0));case 43:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(t){return e.apply(this,arguments)}}())}var K=function(e,t,n,i){E[e]=i;var o=r.querySelector(".sa-live-call-widget-lead-capture-form-error-message[data-name=".concat(e,"]"));o&&(o.textContent=t,o.style.display=n)}}}else{var Y=i.getAttribute("data-cta-link");window.open(Y,"_blank")}}}};function E3(e){return E3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E3(e)}function S3(){S3=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==E3(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function T3(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var C3=function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){T3(o,r,i,a,s,"next",e)}function s(e){T3(o,r,i,a,s,"throw",e)}a(void 0)}))}}(S3().mark((function e(t,n,r){var i,a,s,c,d,u,p,h,f,m,g;return S3().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=D()[r],s=U()[r],c=s.widgetFormFactor,d=s.widgetName,u=null===(i=F("form_data_".concat(r)))||void 0===i?void 0:i.people_id,p=F("session_data_".concat(r)),h="",f="","boolean"==typeof t?s.isWidgetOpened?f="video_message"===a.button_type||"video_icon"===a.button_type?o.clicked_on.video_icon:a.button_type:(m="".concat(U()[r].widgetName.replace(/[A-Z]/g,(function(e){return"_".concat(e.toLowerCase())})),"_button"),f=m in o.clicked_on?"".concat(m,"_and_").concat(o.clicked_on.close_window):o.clicked_on.close_window):f=t,p||(p=G(),B("session_data_".concat(r),p)),h="button"===c?"button":"embed"===c?"embedded_widget":window.location.href.includes("".concat(o.url.SOURCE,"/jump/"))?"jump":window.location.href.includes("".concat(o.url.SOURCE,"/registration/"))?"registration":"widget",g={clicked_on:f,source_form:h,app_panel:n||d,session_id:p,people_id:u||""},e.prev=12,e.next=15,l.post(o.url.SOURCE,"/register_click/".concat(a.id),g);case 15:e.sent,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),console.error("Unable to register click on ".concat(n||d));case 21:case"end":return e.stop()}}),e,null,[[12,18]])})));return function(t,n,r){return e.apply(this,arguments)}}();function R3(e){return R3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R3(e)}function O3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O3(Object(n),!0).forEach((function(t){A3(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O3(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==R3(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==R3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===R3(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k3=__webpack_require__(3378),x3=__webpack_require__(1717),L3=__webpack_require__(5366),N3=__webpack_require__(6315),P3=__webpack_require__(5761),D3=__webpack_require__(3209),M3=__webpack_require__(8095),U3=__webpack_require__(8310),j3=__webpack_require__(8617),V3=__webpack_require__(5801),B3=__webpack_require__(9022),F3=__webpack_require__(6113),G3=__webpack_require__(5622),H3=__webpack_require__(3838),q3=__webpack_require__(8061),W3=__webpack_require__(4486),z3=__webpack_require__(7532),K3=__webpack_require__(8001),Y3=__webpack_require__(3585),J3=null,X3=null,Z3=!1,Q3=!1,$3=function(e){if(e){var t=z("cta");t&&"video_call"===t&&e.id.includes(t)&&e.click()}},e5=function(){var e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;if(Q3||arguments.length>0&&void 0!==arguments[0]&&arguments[0])return clearTimeout(X3),void clearTimeout(J3);var n=D()[e],r=U()[e],i=n.button_position,o=n.trigger_loop,a=n.trigger_delay,s=n.trigger_hold,c=n.trigger_interval,l=n.trigger_messages;if(n.allow_trigger_messages&&0!==(null==l?void 0:l.filter((function(e){return e.trim().length>0})).length)){var d=r.is_agent_online?n.live_conversation_types.filter((function(e){return e.length>0})):n.offline_conversation_types.filter((function(e){return e.length>0})),u=t.querySelector("#sa-live-call-widget-trigger-message-container"),p=(t.querySelector(".sa-live-call-widget-trigger-message-cta-wrapper-".concat(i)),t.querySelector(".sa-live-call-widget-trigger-message"));u.style.display="none";var h=i.includes("bottom"),f=0;setTimeout((function(){m()}),1e3*a)}function m(){Object.assign(u.style,{display:h?"block":"flex",flexDirection:"column-reverse",gap:d.length>0?"10px":""}),r.is_streaming?p.innerHTML='<span class="live-now-indication"></span> We are live now!':p.innerHTML="".concat(n.trigger_messages[f]);var e=u.clientHeight;(u.style["".concat(h?"top":"bottom")]="-".concat(e+14,"px"),Z3)||(Z3=!0,t.querySelector(".sa-live-call-widget-close-trigger-message-btn").addEventListener("click",(function(){u.innerHTML="",Q3=!0,clearTimeout(X3),clearTimeout(J3)})));(f+=1)>=l.length&&(f=0),o&&(J3=setTimeout((function(){u.style.display="none",X3=setTimeout((function(){m()}),1e3*c)}),1e3*s))}},t5=function(e,t){var n,r=D()[e],i=U()[e],o=r.button_position,a=i.is_agent_online?r.live_conversation_types:r.offline_conversation_types,s=t.querySelector(".sa-live-call-widget-trigger-message-cta-wrapper-".concat(o));"shoppable_video"!==r.button_type&&(null===(n=a.filter((function(e){return e.length>0})))||void 0===n||n.forEach((function(e,t){var n,r,i,o='\n          <div\n            id="sa-live-call-widget-'.concat(e,'-btn"\n            class="sa-btn-cta-icon-box"\n          >\n            ').concat((n=e,r=0===t?"var(--invertColor)":null,i=r||"var(--sa-live-call-widget-text-color-info)","video_call"==n?"<svg\n        stroke=".concat(i,'\n        fill="none"\n        stroke-width="1.5"\n        viewBox="0 0 24 24"\n        aria-hidden="true"\n        height="20"\n        width="20"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          stroke-linecap="round"\n          d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"\n        ></path>\n      </svg>'):"audio_call"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="2 2 16 16"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M6.98706 2.06589L6.27036 2.28192C4.96684 2.67484 4.00944 3.78801 3.81598 5.13565C3.519 7.20438 4.18323 9.62242 5.78368 12.3945C7.38077 15.1607 9.13867 16.9433 11.0739 17.7231C12.3435 18.2346 13.7948 17.9592 14.7886 17.018L15.3314 16.5039C16.0589 15.815 16.1643 14.694 15.5781 13.8815L14.2215 12.0014C13.8458 11.4807 13.1805 11.2569 12.5665 11.4446L10.5158 12.0716L10.4628 12.082C10.2366 12.115 9.7154 11.6259 9.06527 10.4999C8.38512 9.32181 8.24417 8.63298 8.43194 8.45541L9.47529 7.48248C10.2572 6.75332 10.4882 5.60728 10.0499 4.63213L9.38841 3.16075C8.97652 2.24451 7.94888 1.77597 6.98706 2.06589ZM8.47634 3.57077L9.13779 5.04215C9.40063 5.62682 9.26212 6.31395 8.7933 6.75113L7.74739 7.72645C7.0783 8.35918 7.29992 9.44218 8.19924 10.9999C9.04545 12.4655 9.81744 13.1898 10.6469 13.0642L10.7713 13.0376L12.8589 12.4009C13.0635 12.3383 13.2853 12.413 13.4105 12.5865L14.7671 14.4666C15.0603 14.8729 15.0076 15.4334 14.6438 15.7778L14.101 16.2919C13.3911 16.9642 12.3545 17.1609 11.4476 16.7955C9.74957 16.1113 8.14475 14.484 6.64971 11.8945C5.15161 9.29969 4.54531 7.09254 4.80583 5.27775C4.94402 4.31515 5.62787 3.52003 6.55896 3.23937L7.27566 3.02334C7.75657 2.87838 8.27039 3.11265 8.47634 3.57077Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"whatsapp_message"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="2 2.9 15.5 14.85"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          fill-rule="evenodd"\n          clip-rule="evenodd"\n          d="M15.3358 4.69419C14.6428 3.99659 13.8182 3.44345 12.9099 3.06681C12.0015 2.69018 11.0275 2.49752 10.0442 2.50002C5.92083 2.50002 2.56417 5.85586 2.5625 9.98086C2.5625 11.2992 2.90667 12.5859 3.56083 13.7209L2.5 17.5967L6.46583 16.5559C7.56283 17.153 8.79183 17.4661 10.0408 17.4667H10.0442C14.1667 17.4667 17.5233 14.1109 17.525 9.98586C17.5278 9.00293 17.3358 8.02918 16.9601 7.12091C16.5843 6.21263 16.0323 5.38783 15.3358 4.69419ZM10.0442 16.2042H10.0417C8.92793 16.2043 7.83469 15.9047 6.87667 15.3367L6.65 15.2017L4.29667 15.8192L4.92417 13.525L4.77667 13.29C4.15399 12.2987 3.82436 11.1515 3.82583 9.98086C3.8275 6.55252 6.61667 3.76336 10.0467 3.76336C10.8635 3.76154 11.6727 3.92176 12.4272 4.23473C13.1818 4.54771 13.8667 5.00723 14.4425 5.58669C15.0213 6.16339 15.4802 6.8491 15.7924 7.60419C16.1047 8.35927 16.2641 9.16876 16.2617 9.98586C16.26 13.4142 13.4708 16.2042 10.0442 16.2042ZM13.455 11.5467C13.2675 11.4525 12.3492 11.0009 12.1775 10.9384C12.0067 10.8759 11.8825 10.845 11.7575 11.0317C11.6325 11.2184 11.2742 11.6392 11.165 11.7642C11.0558 11.8892 10.9467 11.9042 10.76 11.8109C10.5733 11.7175 9.97083 11.52 9.25667 10.8834C8.70083 10.3875 8.32583 9.77586 8.21667 9.58836C8.1075 9.40086 8.205 9.30002 8.29917 9.20669C8.38333 9.12336 8.48583 8.98836 8.57917 8.87919C8.6725 8.77002 8.70333 8.69252 8.76583 8.56752C8.82833 8.44252 8.7975 8.33336 8.75 8.24002C8.70333 8.14586 8.32917 7.22586 8.17333 6.85169C8.0225 6.48919 7.86833 6.53752 7.75333 6.53252C7.63423 6.52765 7.51503 6.52543 7.39583 6.52586C7.30105 6.52827 7.20778 6.55025 7.12188 6.5904C7.03599 6.63055 6.95931 6.68801 6.89667 6.75919C6.725 6.94669 6.2425 7.39836 6.2425 8.31836C6.2425 9.23836 6.9125 10.1275 7.00583 10.2525C7.09917 10.3775 8.32417 12.265 10.1992 13.075C10.6458 13.2675 10.9942 13.3825 11.265 13.4692C11.7125 13.6117 12.12 13.5909 12.4425 13.5434C12.8017 13.49 13.5483 13.0917 13.7042 12.655C13.86 12.2184 13.86 11.8442 13.8133 11.7659C13.7667 11.6875 13.6408 11.64 13.455 11.5467Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"text_message"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="2 2 16 16"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C8.72679 18 7.49591 17.7018 6.38669 17.1393L6.266 17.075L2.62109 17.9851C2.31127 18.0625 2.02622 17.8369 2.00131 17.5438L2.00114 17.4624L2.01493 17.3787L2.925 13.735L2.86169 13.6153C2.4066 12.7186 2.12433 11.7422 2.03275 10.7283L2.00738 10.3463L2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 11.217 3.31054 12.3878 3.89352 13.4249C3.94046 13.5084 3.9621 13.603 3.95692 13.6973L3.94274 13.7912L3.187 16.812L6.21104 16.0583C6.27294 16.0429 6.33662 16.0396 6.39873 16.0479L6.4903 16.0691L6.57701 16.1075C7.61362 16.6898 8.7837 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10.5 11C10.7761 11 11 11.2239 11 11.5C11 11.7455 10.8231 11.9496 10.5899 11.9919L10.5 12H7.5C7.22386 12 7 11.7761 7 11.5C7 11.2545 7.17688 11.0504 7.41012 11.0081L7.5 11H10.5ZM12.5 8C12.7761 8 13 8.22386 13 8.5C13 8.74546 12.8231 8.94961 12.5899 8.99194L12.5 9H7.5C7.22386 9 7 8.77614 7 8.5C7 8.25454 7.17688 8.05039 7.41012 8.00806L7.5 8H12.5Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"video_message"==n?"<svg\n        stroke=".concat(i,'\n        fill="none"\n        stroke-width="1.5"\n        viewBox="0 0 24 24"\n        aria-hidden="true"\n        height="20"\n        width="20"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          stroke-linecap="round"\n          d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"\n        ></path>\n      </svg>'):"voice_message"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="2 2 16 16"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M10 13C11.6569 13 13 11.6568 13 9.99998V5C13 3.34315 11.6569 2 10 2C8.34315 2 7 3.34315 7 5V9.99998C7 11.6568 8.34315 13 10 13ZM10 12C8.89543 12 8 11.1046 8 9.99998V5C8 3.89543 8.89543 3 10 3C11.1046 3 12 3.89543 12 5V9.99998C12 11.1046 11.1046 12 10 12ZM5 9.49998C5.27614 9.49998 5.5 9.72384 5.5 9.99998C5.5 12.4853 7.51472 14.5 10 14.5C12.4853 14.5 14.5 12.4853 14.5 9.99998C14.5 9.72384 14.7239 9.49998 15 9.49998C15.2761 9.49998 15.5 9.72384 15.5 9.99998C15.5 12.869 13.3033 15.2249 10.5 15.4776V17.5C10.5 17.7761 10.2761 18 10 18C9.72386 18 9.5 17.7761 9.5 17.5V15.4776C6.69675 15.2249 4.5 12.869 4.5 9.99998C4.5 9.72384 4.72386 9.49998 5 9.49998Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"text_feedback"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="3 3 16 16"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M5 3C3.89543 3 3 3.89543 3 5V15C3 16.1046 3.89543 17 5 17H9.22047L9.43163 16.1553C9.44469 16.1031 9.45904 16.0513 9.47466 16H5C4.44772 16 4 15.5523 4 15V5C4 4.44772 4.44772 4 5 4H15C15.5523 4 16 4.44772 16 5V9.23163C16.3194 9.09477 16.6586 9.01856 17 9.00299V5C17 3.89543 16.1046 3 15 3H5ZM9.5 14H10.9427L11.9427 13H9.5C9.22386 13 9 13.2239 9 13.5C9 13.7761 9.22386 14 9.5 14ZM7.5 7.25C7.5 7.66421 7.16421 8 6.75 8C6.33579 8 6 7.66421 6 7.25C6 6.83579 6.33579 6.5 6.75 6.5C7.16421 6.5 7.5 6.83579 7.5 7.25ZM6.75 11C7.16421 11 7.5 10.6642 7.5 10.25C7.5 9.83579 7.16421 9.5 6.75 9.5C6.33579 9.5 6 9.83579 6 10.25C6 10.6642 6.33579 11 6.75 11ZM6.75 14C7.16421 14 7.5 13.6642 7.5 13.25C7.5 12.8358 7.16421 12.5 6.75 12.5C6.33579 12.5 6 12.8358 6 13.25C6 13.6642 6.33579 14 6.75 14ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H13.5C13.7761 8 14 7.77614 14 7.5C14 7.22386 13.7761 7 13.5 7H9.5ZM9.5 10C9.22386 10 9 10.2239 9 10.5C9 10.7761 9.22386 11 9.5 11H13.5C13.7761 11 14 10.7761 14 10.5C14 10.2239 13.7761 10 13.5 10H9.5ZM10.9798 15.3772L15.8092 10.5478C16.5395 9.81741 17.7237 9.81741 18.454 10.5478C19.1843 11.2781 19.1843 12.4622 18.454 13.1926L13.6246 18.022C13.343 18.3036 12.9902 18.5033 12.6039 18.5999L11.106 18.9744C10.4546 19.1372 9.86451 18.5472 10.0274 17.8958L10.4018 16.3979C10.4984 16.0116 10.6982 15.6588 10.9798 15.3772Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"video_feedback"==n?"<svg\n        stroke=".concat(i,'\n        fill="none"\n        stroke-width="1.5"\n        viewBox="0 0 24 24"\n        aria-hidden="true"\n        height="20"\n        width="20"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          stroke-linecap="round"\n          d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"\n        ></path>\n      </svg>'):"audio_feedback"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="0 0 122.88 113.8"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          fill='.concat(i,'\n          d="M0,67.6c-.06-5.83,2.16-11,7.37-12.69l.13-.22a2.91,2.91,0,0,1,.6-.8,3.1,3.1,0,0,1,1.05-.5l.29-.11C34.7,44,46.09,30.07,52.64,20.61c0,9.29,2.33,21.4,6.43,33.12,4.21,12,10.29,23.71,17.71,31.76h0c-7.73-2.2-17.43-5-33.21-2.85a15.17,15.17,0,0,0-1.12,5.06,3.9,3.9,0,0,0,1,3l.24.22c1,.91,1.49,1.36,1.71,2.17a9.17,9.17,0,0,1-.13,3.22l-.09.67c-.37,2.93,1.05,3.53,2.46,4.13s2.51,1.08,3.08,2.69a.68.68,0,0,1,0,.4c-.58,3-2.5,4.64-4.43,6.29-.47.41-.95.82-1.36,1.21l-.06,0c-3.92,3.14-6.57,2.3-8.58-.22-1.58-2-2.68-5-3.7-7.81l-.44-1.22a122.88,122.88,0,0,1-4-15.09l-.34-1.5c-.87.24-1.78.51-2.73.79h0c-1.2.35-2.4.73-3.59,1.11l-.38.14a1.21,1.21,0,0,1-1.33,0C13.47,90,8.2,87,4.68,82a25,25,0,0,1-3.41-6.9A25.74,25.74,0,0,1,0,67.6ZM87.81,16.16a3,3,0,0,1-4.23-.6l-.07-.09a3.05,3.05,0,0,1,.63-4.19C89,7.69,93.84,4.07,98.7.56A3.09,3.09,0,0,1,100.92,0a3.06,3.06,0,0,1,2,1.21l0,.05a3,3,0,0,1,.52,2.23,3,3,0,0,1-1.21,2L87.81,16.16Zm15.79,57.7h0a3,3,0,0,1-2.11-.93,3,3,0,0,1-.85-2.14v-.07a3,3,0,0,1,3.07-3c5.37,0,10.83.2,16.2.3a3.07,3.07,0,0,1,3,3.1,3.09,3.09,0,0,1-.93,2.15,3,3,0,0,1-2.16.86l-16.19-.31Zm.47-15.71a3,3,0,0,1-3.25-2.78V55.3a3.07,3.07,0,0,1,2.77-3.23c5-.4,10.09-.83,15.1-1.15a3.06,3.06,0,0,1,3.24,2.81h0a3,3,0,0,1-.73,2.21A3.08,3.08,0,0,1,119.12,57c-4.85.48-10.18.88-15.05,1.14Zm-2.16-14.59a3.06,3.06,0,0,1-3.78-2.11v0a3,3,0,0,1,.27-2.3,3.1,3.1,0,0,1,1.83-1.46c5.21-1.37,10.4-3.05,15.61-4.45a3,3,0,0,1,2.3.27,3.08,3.08,0,0,1,1.45,1.8v0a3.07,3.07,0,0,1-2.1,3.78l-15.59,4.45Zm-6.3-14.32a3.05,3.05,0,0,1-4.09-1.37,3,3,0,0,1-.17-2.33,3.09,3.09,0,0,1,1.53-1.77l15-7.49a3,3,0,0,1,4.09,1.37,3,3,0,0,1,.16,2.33,3.07,3.07,0,0,1-1.53,1.76l-15,7.5ZM58.75,12c.13-.15.27-.29.4-.42a4.46,4.46,0,0,1,1.48-1.11h0a3.58,3.58,0,0,1,2-.08c2.25.36,4.66,2,7.11,4.51,6,6.19,12.32,18,16.82,30.41s7.2,25.36,5.85,33.77c-.51,3.13-1.57,5.66-3.31,7.33l-.09.07a5.64,5.64,0,0,1-2.47,1,2.43,2.43,0,0,0-.25-.2C80.3,83,75,75.9,70.54,67.55c1.14.22,2.6-.63,4-2.08,7-7.38,3.56-20.28-5.17-23.27C65.81,41,62.27,41,60.87,41.69l-.15.08C57.52,29.42,56.61,18,58.75,12Z"\n        />\n      </svg>'):"ai_chat"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="0 0 459.579 459.579"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M429.579,14.7H139.935c-16.569,0-30,13.431-30,30v80.993h30V44.7h289.644v183.393h-48.495v30h48.495c16.568,0,30-13.431,30-30V44.7C459.579,28.132,446.148,14.7,429.579,14.7z"\n          fill='.concat(i,'\n        />\n        <path\n          d="M319.644,155.693H30c-16.565,0-30,13.427-30,30v183.393c0,16.569,13.431,30,30,30h92.333l29.531,35.11c11.99,14.255,33.945,14.234,45.917,0l29.531-35.11h92.333c9.32,0,17.647-4.25,23.149-10.917c0.306-0.37,0.603-0.748,0.891-1.133c3.743-5.005,5.96-11.219,5.96-17.95V185.693C349.644,169.126,336.214,155.693,319.644,155.693z M319.644,369.086h-106.3l-38.522,45.799L136.3,369.086H30V185.693h289.644V369.086z"\n          fill=').concat(i,'\n        />\n        <path\n          d="M80.011,257.792h189.621c8.284,0,15-6.716,15-15s-6.716-15-15-15H80.011c-8.284,0-15,6.716-15,15S71.727,257.792,80.011,257.792z"\n          fill=').concat(i,'\n        />\n        <path\n          d="M80.011,325.573h77.621c8.284,0,15-6.716,15-15s-6.716-15-15-15H80.011c-8.284,0-15,6.716-15,15S71.727,325.573,80.011,325.573z"\n          fill=').concat(i,"\n        />\n      </svg>"):"schedule_meeting"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="3 3 14 14"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"feedback_form"==n?'<svg\n        width="20"\n        height="20"\n        viewBox="3 3 14 14"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M6.5 6C6.22386 6 6 6.22386 6 6.5C6 6.77614 6.22386 7 6.5 7H13.5C13.7761 7 14 6.77614 14 6.5C14 6.22386 13.7761 6 13.5 6H6.5ZM6 9.5C6 9.22386 6.22386 9 6.5 9H10.5C10.7761 9 11 9.22386 11 9.5C11 9.77614 10.7761 10 10.5 10H6.5C6.22386 10 6 9.77614 6 9.5ZM6.5 12C6.22386 12 6 12.2239 6 12.5C6 12.7761 6.22386 13 6.5 13H13.5C13.7761 13 14 12.7761 14 12.5C14 12.2239 13.7761 12 13.5 12H6.5ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V5.5C4 4.67157 4.67157 4 5.5 4Z"\n          fill='.concat(i,"\n        />\n      </svg>"):"shop"==n?'<svg\n        xmlns="http://www.w3.org/2000/svg"\n        width="20"\n        height="20"\n        viewBox="0 0 18.865 21.2"\n      >\n        <g\n          id="Group_9986"\n          data-name="Group 9986"\n          transform="translate(-8908.899 86.1)"\n        >\n          <path\n            id="Vector-1"\n            d="M9,10V5A4,4,0,1,0,1,5v5"\n            transform="translate(8913.33 -86.5)"\n            fill="none"\n            stroke={themeColor}\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            stroke-width="1.2"\n          />\n          <path\n            id="Vector"\n            d="M1.979,2.84A2,2,0,0,1,3.973,1H16.031a2,2,0,0,1,1.994,1.84l.8,10A2,2,0,0,1,16.835,15H3.169a2,2,0,0,1-1.993-2.16l.8-10Z"\n            transform="translate(8908.33 -80.5)"\n            fill="none"\n            stroke={themeColor}\n            stroke-linecap="round"\n            stroke-linejoin="round"\n            stroke-width="1.2"\n          />\n        </g>\n      </svg>':'<svg\n        width="12"\n        height="10"\n        viewBox="0 0 18 14"\n        fill="none"\n        xmlns="http://www.w3.org/2000/svg"\n      >\n        <path\n          d="M17.7303 6.52416L8.491 0.0766853C8.42008 0.027528 8.3296 0 8.23422 0H6.06989C5.88892 0 5.80577 0.180899 5.94272 0.275281L14.5071 6.25281H0.195645C0.0880404 6.25281 0 6.3236 0 6.41011V7.58989C0 7.6764 0.0880404 7.74719 0.195645 7.74719H14.5046L5.94028 13.7247C5.80333 13.8211 5.88648 14 6.06745 14H8.30514C8.35161 14 8.39807 13.9862 8.43231 13.9607L17.7303 7.47584C17.815 7.41665 17.8829 7.34354 17.9294 7.26145C17.9759 7.17936 18 7.09021 18 7C18 6.90979 17.9759 6.82064 17.9294 6.73855C17.8829 6.65646 17.815 6.58335 17.7303 6.52416Z"\n          fill='.concat(i,"\n        />\n      </svg>")),'\n            <p\n              class="sa-btn-cta-icon-text"\n              style="color: ').concat(0===t?"var(--invertColor)":null,'"\n            >\n              ').concat(j("ai_chat"===e?"Chat":e),"\n            </p>\n          </div>\n        ");s.insertAdjacentHTML("beforeend",o)})));t.querySelectorAll(".sa-btn-cta-icon-box").forEach((function(n){n.addEventListener("click",(function(){M(A3({},e,I3(I3({},i),{},{isWidgetOpened:!0,widgetName:"liveCallButton"}))),C3("".concat(null==a?void 0:a.find((function(e){return e&&n.id.includes(e)})),"_button"),null,e),function(e,t,n,r){var i=D()[n],o=U()[n],a=r.querySelector(".sa-live-call-widget-btn-container"),s=r.querySelector(".sa-live-call-widget-expanded");if(a.style.display="none",s)s.style.display="flex",b3(e,t,n,r),M(A3({},n,I3(I3({},o),{},{isWidgetOpened:!0})));else{r.insertAdjacentHTML("beforeend",K3({logo:i.watermark})),r.querySelector(".sa-live-call-widget-expanded-inner-wrapper").innerHTML="";var c=r.querySelector(".sa-live-call-widget-close-expanded-widget-btn");s=r.querySelector(".sa-live-call-widget-expanded"),c.addEventListener("click",(function(){s.style.display="none",a.style.display="block",document.querySelector(".sa-live-call-widget-call-waiting-container")&&dX({url:"https://ingest-stg.saleassist.ai/meeting-log",data:{event_type:"END_MEETING_LCW",meeting_id:U()[n].meeting_id||"",client_id:D()[n].client_id||"",users_stats:{action:"close-button",conversation_id:U()[n].conversation_id||""}},onSuccess:function(e){},onFailure:function(e){console.error(e)}})})),b3(e,t,n,r),M(A3({},n,I3(I3({},o),{},{isWidgetOpened:!0})))}}(n.id,j(null==a?void 0:a.find((function(e){return e&&n.id.includes(e)}))),e,t)})),$3(n)})),e5(!1,e,t)},n5=function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(D()[e].skip_welcome_screen||U()[e].is_strike_yes_trigger||U()[e].is_strike_no_trigger)&&(n=t.querySelector(".sa-live-call-widget-expanded"),(r=t.querySelector(".sa-live-call-widget-expanded-inner-wrapper")).querySelector("video")&&(r.querySelector("video").muted=!0),r.style.opacity="0",(i=document.createElement("div")).style.cssText="position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);",i.innerHTML=Y3({}),i.querySelectorAll(".sa-live-call-widget-loader-spinner > div").forEach((function(e){e.style.width="24px",e.style.height="24px",e.style.backgroundColor="#ccc"})),n.appendChild(i));MQ(e).then((function(){var s,c,l,d=D()[e],u=U()[e];(d.skip_welcome_screen||u.is_strike_yes_trigger||u.is_strike_no_trigger)&&(n.removeChild(i),r.style.opacity="1");var p=o||!u.is_agent_online?null===(s=d.offline_conversation_types)||void 0===s?void 0:s.filter((function(e){return e.length>0})):null===(c=d.live_conversation_types)||void 0===c?void 0:c.filter((function(e){return e.length>0})),h="7d4ccb4b-facb-4a29-9809-f482dad29d68"===d.id||"9eb36291-3d62-420e-be90-f14f3cb41a13"===d.id||"3f721258-3015-413b-baf7-7f78f8d07633"===d.id;window.location.href.includes("/jump/")&&h&&!p.includes("share_jump_page")&&(p.push("share_jump_page"),t.querySelector(".sa-live-call-widget-expanded").insertAdjacentHTML("beforeend",z3({})));var f=["7ca97a0f-02eb-4c98-bbd5-8d51163cdfb2","be030784-c08f-480c-a7e4-04e955e876b8"].includes(e);f&&p.push("image_message"),d.call_to_action_links.length&&d.call_to_action_links.forEach((function(e){var t=V(e.display_name).toLowerCase();p.includes(t)||p.push(t)}));var m,g=f||p.filter((function(e){return e.length>0})).length<2;if(a){var v=t.querySelectorAll("#saleassistAiChatLog .ai-chat-offline-cta-wrapper");m=v.length?v[v.length-1]:null}else m=t.querySelector(".sa-live-call-widget-expanded-cta-btn-wrapper-2");(g&&m.classList.add("sa-live-call-widget-one-cta"),"9eb36291-3d62-420e-be90-f14f3cb41a13"===d.id||"3f721258-3015-413b-baf7-7f78f8d07633"===d.id||"4db02170-7fd4-4af3-b359-330e2c1149cb"===d.id||"cae3668c-d5ee-414b-8f58-6433953df8a1"===d.id)&&(t.querySelector(".sa-live-call-widget-expanded").classList.add("sa-live-call-widget-paybima-widget"),m.classList.add("sa-live-call-widget-cta-custom-layout"));var _={video_call:"Video Call",audio_call:"Audio Call",whatsapp_message:"WhatsApp",text_message:"Message",video_message:f?"Video Message":"Message",voice_message:f?"Audio Message":"Message",text_feedback:"Feedback",video_feedback:"Feedback",audio_feedback:"Feedback",ai_chat:"Chat",schedule_meeting:"Schedule",feedback_form:"Feedback Form",image_message:"Upload Image"},y=null==d?void 0:d.cta_configuration,w=function(e){return f?_[e]:y[e]?y[e]:_[e]},b=function(e){return d.call_to_action_links.find((function(t){return V(t.display_name).toLowerCase()===e}))},E="";null===(l=p.filter((function(e){return e.length>0})))||void 0===l||l.forEach((function(e){switch(e){case"video_call":E+=k3({title:w(e)});break;case"audio_call":E+=x3({title:w(e)});break;case"schedule_meeting":E+=L3({title:w(e)});break;case"ai_chat":E+=N3({title:w(e)});break;case"video_message":E+=P3({title:w(e)});break;case"voice_message":E+=D3({title:w(e)});break;case"text_message":E+=M3({title:w(e)});break;case"whatsapp_message":E+=U3({title:w(e)});break;case"video_feedback":E+=j3({title:w(e)});break;case"audio_feedback":E+=V3({title:w(e)});break;case"text_feedback":E+=B3({title:w(e)});break;case"feedback_form":E+=F3({title:w(e)});break;case"shoppable_video":E+=G3({title:d.shoppable_video_button_message});break;case"share_jump_page":E+=H3({title:"Share",isCustomStyle:"9eb36291-3d62-420e-be90-f14f3cb41a13"===d.id||"3f721258-3015-413b-baf7-7f78f8d07633"===d.id||"4db02170-7fd4-4af3-b359-330e2c1149cb"===d.id||"cae3668c-d5ee-414b-8f58-6433953df8a1"===d.id});break;case"image_message":E+=W3({title:w(e)});break;case b(e)&&e:var t=b(e)||{};E+=q3({id:"sa-live-call-widget-".concat(e,"-btn"),icon:t.icon_reference,title:t.display_name,captureLeadForm:t.require_data_capture,link:t.action_link})}})),m.innerHTML=E;var S=t.querySelectorAll(".sa-btn-cta-icon-box-expanded");S.forEach((function(n,r){n.addEventListener("click",(function(){var r;if(S.forEach((function(e){return e.style.pointerEvents="none"})),n.id.includes("shoppable_video")&&(null===(r=d.shoppable_video_button_url)||void 0===r?void 0:r.trim().length)>0)return window.open(d.shoppable_video_button_url,"_top"),void C3("".concat(null==p?void 0:p.find((function(e){return e&&n.id.includes(e)})),"_button"),null,e);M(A3({},e,I3(I3({},u),{},{isWidgetOpened:!0,widgetName:"mainPanel"}))),n.id.includes("share_jump_page-btn")||n.id.includes("refer-btn")?C3("share_button",null,e):C3("".concat(null==p?void 0:p.find((function(e){return e&&n.id.includes(e)})),"_button"),null,e),b3(n.id,j(null==p?void 0:p.find((function(e){return n.id.includes(e)}))),e,t)})),0===r&&d.skip_welcome_screen&&n.click(),"whatsapp"===d.strike_yes&&"widget"===d.strike_yes||U()[e].is_strike_yes_trigger&&r===+d.strike_yes-1&&n.click(),"none"===d.strike_no&&"widget"===d.strike_no||U()[e].is_strike_no_trigger&&r===+d.strike_no-1&&n.click(),$3(n)}));var T=t.querySelector("#sa-live-call-widget-chat-first-approach-btn"),C=t.querySelector("#sa-live-call-widget-watch-live-stream-btn");T&&T.addEventListener("click",(function(){M(A3({},e,I3(I3({},u),{},{isWidgetOpened:!0,widgetName:"mainPanel"}))),C3("ai_chat_button",null,e),b3("sa-live-call-widget-chat-first-approach-btn","Connect Over Chat",e,t)})),C&&C.addEventListener("click",(function(){M(A3({},e,I3(I3({},u),{},{isWidgetOpened:!0,widgetName:"mainPanel"}))),C3("watch_live_button",null,e),b3("sa-live-call-widget-watch-live-stream-btn","Live Stream",e,t)}))})).catch((function(e){console.error("Failed to fetch updated agent status during initializeExpandedWidgetCtaBtn :",e)}))},r5=__webpack_require__(384),i5={};i5.styleTagTransform=S(),i5.setAttributes=y(),i5.insert=v().bind(null,"head"),i5.domAPI=m(),i5.insertStyleElement=b();h()(r5.Z,i5);r5.Z&&r5.Z.locals&&r5.Z.locals;var o5=function(e,t,n){var r=document.querySelector("#".concat(t)),i="thankyou-page";n.innerHTML="";var o=document.createElement("div");o.className="saleassist-client-hyderabad-governemnt-thankyou";var a=document.createElement("h2");a.id="".concat(i,"-title"),a.innerText="Thank You";var s=document.createElement("p");s.id="".concat(i,"-subTitle"),s.innerText="It's our pleasure serving you.";var c=document.createElement("button");c.id="".concat(i,"-goBack"),c.innerText="Go Back",c.addEventListener("click",(function(){n.innerHTML="",y5(e,t,n)}));var l=document.createElement("img");l.id="".concat(i,"-peopleImage"),l.src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/Image775.png",o.appendChild(a),o.appendChild(s),o.appendChild(c),o.appendChild(l),n.appendChild(o),r&&r.appendChild(n)},a5={english:{title:"Welcome",description:"Dear Citizen, Report any issue/incident regarding polling at your booth. Use one of the options below:",startButton:"Report an Issue",boothCountButton:"Report Booth Voting Count",mobileNumberLabel:"Enter your mobile number",logoImage:"https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/2.png"},telugu:{title:"",description:"  ,           .   .",startButton:" ",boothCountButton:" ",mobileNumberLabel:"     ",logoImage:"https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/3.png"}},s5={english:{title:"Report a polling issue impacting YSRCP",searchBoothTitle:"Search Polling Booth",searchBoothLabel:"Search Booth by number or name",orEl:"Or",selectBoothTitle:"Select Polling Booth",districtLabel:"Select District",assemblyLabel:"Select Assembly",boothLabel:"Select Booth",issueTitle:"Issue",issueTypeLabel:"Select Issue Type",issueDesLabel:"Issue Description",issueOption1:"Women and Elders less than 50% in voting line",issueOption2:"Agent Related",issueOption3:"Others",attachBtnLabel:"Attach Video/Audio",polledVotesTitle:"Polled Votes",polledVotesInputLabel:"Enter Polled Votes Count",submitBtnLabel:"Submit"},telugu:{title:"     ",searchBoothTitle:"  ",searchBoothLabel:"      ",orEl:"",selectBoothTitle:"  ",districtLabel:"   ",assemblyLabel:"    ",boothLabel:"   ",issueTitle:"",issueTypeLabel:"   ",issueDesLabel:"    ",issueOption1:"     50%  ",issueOption2:"  ",issueOption3:"",attachBtnLabel:"/  ",polledVotesTitle:"Polled Votes",polledVotesInputLabel:"Enter Polled Votes Count",submitBtnLabel:""}},c5=__webpack_require__(3007),l5={};l5.styleTagTransform=S(),l5.setAttributes=y(),l5.insert=v().bind(null,"head"),l5.domAPI=m(),l5.insertStyleElement=b();h()(c5.Z,l5);c5.Z&&c5.Z.locals&&c5.Z.locals;function d5(e){return d5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d5(e)}function u5(){u5=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==d5(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function p5(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function h5(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){p5(o,r,i,a,s,"next",e)}function s(e){p5(o,r,i,a,s,"throw",e)}a(void 0)}))}}var f5='<svg id="arrow-down" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"></path></svg>',m5='<svg id="arrow-up" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg>',g5=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"english",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];localStorage.removeItem("user_data_".concat(e)),localStorage.removeItem("form_data_".concat(e)),localStorage.removeItem("session_data_".concat(e));var o=document.querySelector("#".concat(t)),a=document.createElement("form"),s=document.createElement("div");s.classList.add("booth-form-wrapper");var c=document.createElement("div");c.classList.add("hyderabad-govt-form-wrapper"),n.classList.add("saleassist-client-hyderabad-governemnt"),n.innerHTML="",a.className="saleassist-client-hyderabad-governemnt-form";var l=document.createElement("img");l.id="peopleImage",l.src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/Image775.png";var d=document.createElement("p");d.innerText=s5[r].title,a.appendChild(d);var u=function(){var e=h5(u5().mark((function e(t){var n,r,i=arguments;return u5().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.prev=1,e.next=4,fetch(t,n);case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Failed to fetch data");case 7:return e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),console.error("Error fetching data:",e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=h5(u5().mark((function e(t,n,i,o,a,s){var c,l,d,p,h=arguments;return u5().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=h.length>6&&void 0!==h[6]?h[6]:{},o.innerHTML="",!a){e.next=11;break}if("issue-api"!=a){e.next=7;break}l={data:[{name:s5[r].issueOption1,issue_type:"Women & Elderly Citizen < 50%"},{name:s5[r].issueOption2,issue_type:"Agent Related"},{name:s5[r].issueOption3,issue_type:"Others"}]},e.next=10;break;case 7:return e.next=9,u(a,c);case 9:l=e.sent;case 10:null===(d=l)||void 0===d||null===(p=d.data)||void 0===p||p.forEach((function(e){var r=document.createElement("div");r.setAttribute("value",e[s]),r.innerHTML="boothDropdown"===t||"boothSearchBox"===t?"".concat(e.booth_number," - ").concat(e.booth_name):e.name,r.addEventListener("click",(function(){if(i.value="boothDropdown"===t||"boothSearchBox"===t?"".concat(e.booth_number," - ").concat(e.booth_name):e.name,i.setAttribute("data-value",e[s]),o.style.display="none",n&&(n.innerHTML=f5),"boothSearchBox"===t){var r,a=document.getElementById("districtDropdown-input"),c=document.getElementById("assemblyDropdown-input"),l=document.getElementById("boothDropdown-input");a.value=null===(r=e.district)||void 0===r?void 0:r.name,c.value=e.assembly_name,l.value="".concat(e.booth_number," - ").concat(e.booth_name)}f(t,e[s])})),o.appendChild(r)}));case 11:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}(),h=function(e,t,n,r,i){var o=document.createElement("div");o.id=t;var l=document.createElement("span");l.id="".concat(t,"-arrow"),l.innerHTML=f5;var d=document.createElement("input");d.id="".concat(t,"-input"),d.type="text",d.autocomplete="off",d.placeholder=e,"issueTypeDropdown"===t&&(d.readOnly=!0);var u=document.createElement("div");u.id="".concat(t,"-datalist"),u.style.display="none",o.appendChild(l),o.appendChild(d),o.appendChild(u),i?("selectBooth"===i&&(s.append(o),a.appendChild(s)),"issue"===i&&(c.append(o),a.appendChild(c))):a.appendChild(o),p(t,l,d,u,n,r),l.addEventListener("click",(function(){if(d.value.trim().length>0){var e=document.getElementById("assemblyDropdown-input"),n=document.getElementById("boothDropdown-input");"districtDropdown"===t&&(e.value="",n.value=""),"assemblyDropdown"===t&&(n.value=""),d.value="",d.setAttribute("data-value",""),m(t);var r=new Event("keyup");d.dispatchEvent(r)}else"none"===u.style.display?(u.style.display="block",l.innerHTML=m5):(u.style.display="none",l.innerHTML=f5)})),d.addEventListener("click",(function(){"none"===u.style.display?(u.style.display="block",!d.value.trim().length>0&&(l.innerHTML=m5)):(u.style.display="none",!d.value.trim().length>0&&(l.innerHTML=f5))})),d.addEventListener("keyup",(function(){var e=d.value.toUpperCase(),n=u.getElementsByTagName("div");u.style.display="block",l.innerHTML=m5,m(t);for(var r=0;r<n.length;r++){(n[r].textContent||n[r].innerText).toUpperCase().indexOf(e)>-1?n[r].style.display="":n[r].style.display="none"}})),document.addEventListener("click",(function(e){o.contains(e.target)||"arrow-up"===e.target.id||"arrow-down"===e.target.id||(!d.value.trim().length>0&&(l.innerHTML=f5),u.style.display="none")}))},f=function(t,n){var i,o,a,s,c,l,d,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,h={};"districtDropdown"===t&&(i="assemblyDropdown",l="https://api.sonido.one/assemblies/by_district_number/".concat(n),d="assembly_number",m(t),pX("district_".concat(e)).number!=n&&(document.getElementById("assemblyDropdown-input").value="",document.getElementById("boothDropdown-input").value="")),"assemblyDropdown"===t&&(i="boothDropdown",l="https://api.sonido.one/booths/elastic/search",d="id",h={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search_key:u,assembly_number:n,language:r.substring(0,2)})},m(t),pX("assembly_".concat(e)).number!=n&&(document.getElementById("boothDropdown-input").value="")),"boothDropdown"===t&&m(t),"boothSearchBox"===t&&(i=t,l="https://api.sonido.one/booths/elastic/search",d="id",h={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search_key:u,language:r.substring(0,2)})},m(t)),i&&(a=(o=document.getElementById(i)).querySelector("#".concat(i,"-arrow")),s=o.querySelector("#".concat(i,"-input")),c=o.querySelector("#".concat(i,"-datalist")),p(i,a,s,c,l,d,h))},m=function(e){var t=document.getElementById("boothSearchBox-input"),n=document.getElementById("boothSearchBox-search"),r=document.getElementById("districtDropdown-input"),i=document.getElementById("districtDropdown-arrow"),o=document.getElementById("assemblyDropdown-input"),a=document.getElementById("assemblyDropdown-arrow"),s=document.getElementById("boothDropdown-input"),c=document.getElementById("boothDropdown-arrow");"districtDropdown"===e&&(r.value.trim().length>0?(t.disabled=!0,i.innerHTML='<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>'):(t.disabled=!1,i.innerHTML=f5)),"assemblyDropdown"===e&&(r.value.trim().length>0?a.innerHTML='<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>':a.innerHTML=f5),"boothDropdown"===e&&(r.value.trim().length>0?c.innerHTML='<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>':c.innerHTML=f5),"boothSearchBox"===e&&(t.value.trim().length>0?(r.disabled=!0,o.disabled=!0,s.disabled=!0,n.innerHTML='<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>'):(r.disabled=!1,o.disabled=!1,s.disabled=!1,n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="0" fill="currentColor" stroke="currentColor"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>'))},g=document.createElement("p");g.classList.add("select-booth-title"),g.innerText=s5[r].searchBoothTitle,a.appendChild(g),function(e,t,n,r){var i=document.createElement("div");i.id=t;var o=document.createElement("span");o.id="".concat(t,"-search"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="0" fill="currentColor" stroke="currentColor"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>';var s=document.createElement("input");s.type="text",s.id="".concat(t,"-input"),s.autocomplete="off",s.placeholder=e;var c=document.createElement("div");c.id="".concat(t,"-datalist"),c.style.display="none",i.appendChild(o),i.appendChild(s),i.appendChild(c),a.appendChild(i),p(t,null,s,c,n,r),o.addEventListener("click",(function(){if(s.value.trim().length>0){var e=document.getElementById("districtDropdown-input"),n=document.getElementById("assemblyDropdown-input"),r=document.getElementById("boothDropdown-input");e.value="",n.value="",r.value="",s.value="",s.setAttribute("data-value",""),f(t,"",""),m(t)}else"none"===c.style.display?c.style.display="block":c.style.display="none"})),s.addEventListener("click",(function(){"none"===c.style.display?c.style.display="block":c.style.display="none"})),s.addEventListener("keyup",(function(){var e;c.style.display="block",m(t),f(t,"",null!==(e=null==s?void 0:s.value)&&void 0!==e?e:"")})),document.addEventListener("click",(function(e){i.contains(e.target)||(c.style.display="none")}))}(s5[r].searchBoothLabel,"boothSearchBox","","id");var v=document.createElement("p");v.innerText=s5[r].orEl,a.appendChild(v);var _=document.createElement("p");_.classList.add("select-booth-title"),_.innerText=s5[r].selectBoothTitle,a.appendChild(_),h(s5[r].districtLabel,"districtDropdown","https://api.sonido.one/districts","district_number","selectBooth"),h(s5[r].assemblyLabel,"assemblyDropdown","","assembly_number","selectBooth"),h(s5[r].boothLabel,"boothDropdown","","id","selectBooth");var y=document.createElement("p");if(y.classList.add("select-booth-title"),y.innerText=s5[r][i?"polledVotesTitle":"issueTitle"],a.appendChild(y),i){var w="polledVotesBox",b=document.createElement("div");b.id=w;var E=document.createElement("input");E.id="".concat(w,"-input"),E.type="number",E.placeholder=s5[r].polledVotesInputLabel,b.appendChild(E),a.appendChild(b)}if(i||(h(s5[r].issueTypeLabel,"issueTypeDropdown","issue-api","issue_type","issue"),function(e,t,n){var r=document.createElement("div");r.id=t;var i=document.createElement("textarea");i.id="".concat(t,"-textarea"),i.placeholder=e,i.maxLength=1024,r.appendChild(i),n&&"issue"===n?(c.append(r),a.append(c)):a.appendChild(r)}(s5[r].issueDesLabel,"issueDescriptionText","issue")),function(r,i,o){var s=document.createElement("div");s.id=i;var c=document.createElement("span");c.id="errorMsg";var l=document.createElement("button");l.id="".concat(i,"-button"),l.type="submit",l.innerText=r,l.addEventListener("click",function(){var r=h5(u5().mark((function r(i){var a,s,l,d,u,p,h,f,m,g,v,_,y,w,b;return u5().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i.preventDefault(),a=document.getElementById("districtDropdown-input"),s=document.getElementById("assemblyDropdown-input"),l=document.getElementById("boothDropdown-input"),d=document.getElementById("boothSearchBox-input"),u=document.getElementById("issueTypeDropdown-input"),p=document.getElementById("issueDescriptionText-textarea"),h=l.value||d.value,f=l.getAttribute("data-value")||d.getAttribute("data-value"),0!==h.length){r.next=12;break}return c.innerText="Polling Booth Is Required!",r.abrupt("return");case 12:if(o){r.next=19;break}if(0!==u.value.length){r.next=16;break}return c.innerText="Please Select Issue Type!",r.abrupt("return");case 16:if(0!==p.value.length){r.next=19;break}return c.innerText="Please Enter Issue Description!",r.abrupt("return");case 19:if(!o){r.next=31;break}if(m=document.getElementById("polledVotesBox-input"),g=pX("mobile_number_".concat(e)),0!==m.value.length){r.next=25;break}return c.innerText="Please Enter Polled Votes Count!",r.abrupt("return");case 25:return v=function(){var e=h5(u5().mark((function e(t){var n;return u5().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({polled_votes:+m.value,phonenumber:"+91".concat(g),booth_id:+f})});case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Failed to send data");case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(0),console.error("Error sending data:",e.t0),e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),r.next=28,v("https://api.sonido.one/votes/new/v2");case 28:return null!=(_=r.sent)&&_.polled_votes&&o5(e,t,n),r.abrupt("return");case 31:y="?booth_number=".concat(encodeURIComponent(f),"&issue_type=").concat(encodeURI(u.value)),w=window.location.href.split("?")[0],b=w+y,uX("district_".concat(e),{name:a.value,number:a.getAttribute("data-value")},48),uX("assembly_".concat(e),{name:s.value,number:s.getAttribute("data-value")},48),uX("booth_".concat(e),{name:h,number:f},48),uX("issue_description_".concat(e),p.value,48),history.pushState(null,"",b),D5(e,n);case 40:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),s.appendChild(c),s.appendChild(l),a.appendChild(s)}(s5[r][i?"submitBtnLabel":"attachBtnLabel"],"submitButton",i),n.appendChild(l),n.appendChild(a),o&&o.appendChild(n),pX("booth_".concat(e)).name&&pX("booth_".concat(e)).number){var S=document.getElementById("districtDropdown-input"),T=document.getElementById("assemblyDropdown-input"),C=document.getElementById("boothDropdown-input"),R=new Event("keyup");S.value=pX("district_".concat(e)).name,S.setAttribute("data-value",pX("district_".concat(e)).number),T.value=pX("assembly_".concat(e)).name,T.setAttribute("data-value",pX("assembly_".concat(e)).number),C.value=pX("booth_".concat(e)).name,C.setAttribute("data-value",pX("booth_".concat(e)).number),f(S.id.split("-")[0],pX("district_".concat(e)).number),f(T.id.split("-")[0],pX("assembly_".concat(e)).number),S.dispatchEvent(R),T.dispatchEvent(R),C.dispatchEvent(R)}},v5=__webpack_require__(8869),_5={};_5.styleTagTransform=S(),_5.setAttributes=y(),_5.insert=v().bind(null,"head"),_5.domAPI=m(),_5.insertStyleElement=b();h()(v5.Z,_5);v5.Z&&v5.Z.locals&&v5.Z.locals;var y5=function(e,t,n){var r="telugu",i=document.querySelector("#".concat(t)),o=document.createElement("div");o.className="saleassist-client-hyderabad-governemnt-home";var a=document.createElement("div");a.id="languageBox";var s=document.createElement("input");s.type="radio",s.id="english",s.name="language",s.value="english";var c=document.createElement("label");c.setAttribute("for","english"),c.textContent="English",c.addEventListener("click",(function(){var e=c.getAttribute("for");document.getElementById(e).checked=!0,E("english")}));var l=document.createElement("input");l.type="radio",l.id="telugu",l.name="language",l.value="telugu",l.checked=!0;var d=document.createElement("label");d.setAttribute("for","telugu"),d.textContent="",d.addEventListener("click",(function(){var e=d.getAttribute("for");document.getElementById(e).checked=!0,E("telugu")}));var u=document.createElement("img");u.id="logo",u.src=a5[r].logoImage;var p=document.createElement("p");p.id="title",p.innerText=a5[r].title;var h=document.createElement("p");h.id="description",h.innerText=a5[r].description;var f=document.createElement("div");f.id="mobileNumberContainer";var m=document.createElement("div");m.id="mobileNumberContainer-input";var g=document.createElement("input");g.id="countryCode",g.type="text",g.value="+91",g.readOnly=!0;var v=document.createElement("input");v.type="tel",v.maxLength="10",v.id="boothCountMobNumInput",v.placeholder=a5[r].mobileNumberLabel,v.value=pX("mobile_number_".concat(e))||"";var _=document.createElement("span");_.id="errorMsg";var y=document.createElement("button");y.id="startButton",y.innerText=a5[r].startButton,y.addEventListener("click",(function(){if(S(v.value)){var r=document.querySelector('#languageBox input[type="radio"]:checked');_.innerText="",uX("mobile_number_".concat(e),v.value,48),g5(e,t,n,r.value)}else v.value="",_.innerText="Enter a valid mobile number!"}));var w=document.createElement("button");w.id="boothCountButton",w.innerText=a5[r].boothCountButton,w.addEventListener("click",(function(){if(S(v.value)){var r=document.querySelector('#languageBox input[type="radio"]:checked');_.innerText="",uX("mobile_number_".concat(e),v.value),g5(e,t,n,r.value,!0)}else v.value="",_.innerText="Enter a valid mobile number!"}));var b=document.createElement("img");b.id="peopleImage",b.src="https://client-static.saleassist.ai/74c28198-7762-40d3-8925-5cc00dc99e98/Image775.png";var E=function(e){p.innerText=a5[e].title,h.innerText=a5[e].description,y.innerText=a5[e].startButton,w.innerText=a5[e].boothCountButton,v.placeholder=a5[e].mobileNumberLabel,u.src=a5[e].logoImage},S=function(e){return/[0-9]{10}/.test(e)};a.appendChild(s),a.appendChild(c),a.appendChild(l),a.appendChild(d),m.appendChild(g),m.appendChild(v),f.appendChild(m),f.appendChild(_),o.appendChild(a),o.appendChild(u),o.appendChild(p),o.appendChild(h),o.appendChild(f),o.appendChild(y),o.appendChild(w),o.appendChild(b),n.appendChild(o),i&&i.appendChild(n)};function w5(e){return w5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w5(e)}function b5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E5(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b5(Object(n),!0).forEach((function(t){S5(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b5(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S5(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==w5(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===w5(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T5=__webpack_require__(9103),C5=__webpack_require__(8001),R5=__webpack_require__(9923),O5=__webpack_require__(9671),I5=!1,A5=!1,k5=function(e,t,n){if(!U()[e].isWelcomeImage){var r=t.querySelector("#sa-live-call-widget-hls-video"),i=t.querySelector(".sa-live-call-widget-mute-unmute-video-btn"),o=i.querySelector(".sa-live-call-widget-mute-icon"),a=i.querySelector(".sa-live-call-widget-unmute-icon"),s=t.querySelector(".unmute-helper-animation");i.addEventListener("click",(function(){r.muted?(r.muted=!1,o.style.display="block",a.style.display="none"):(r.muted=!0,a.style.display="block",o.style.display="none")})),window.location.href.includes("/jump/")&&(o.style.display=n?"none":"block",a.style.display=n?"block":"none",s&&(s.style.display=n?"flex":"none"))}},x5=function(e,t,n){if(!U()[e].isWelcomeImage){var r=t.querySelector("#sa-live-call-widget-hls-video"),i=t.querySelector(".sa-live-call-widget-mute-unmute-video-btn");n&&r&&r.play(),r.addEventListener("click",(function(){null==i||i.click()}))}},L5=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=D()[e],i=U()[e],o="shoppable_video"===r.button_type||"video_icon"===r.button_type&&r.allow_popup_video;if(!i.isWelcomeImage&&o&&!I5){var a=t.querySelector(".sa-live-call-widget-btn-container");if(n){a.classList.remove("sa-live-call-widget-btn-container-pop-up-video");var s=a.querySelector(".sa-live-call-widget-close-pop-up-video-btn");null==s||s.remove()}else{a.classList.add("sa-live-call-widget-btn-container-pop-up-video"),a.insertAdjacentHTML("beforeend",'<div class="sa-live-call-widget-close-pop-up-video-btn">\n          <svg\n            stroke="currentColor"\n            fill="none"\n            stroke-width="0"\n            viewBox="0 0 24 24"\n            height="16"\n            width="16"\n            xmlns="http://www.w3.org/2000/svg"\n          >\n            <path\n              d="M6.2253 4.81108C5.83477 4.42056 5.20161 4.42056 4.81108 4.81108C4.42056 5.20161 4.42056 5.83477 4.81108 6.2253L10.5858 12L4.81114 17.7747C4.42062 18.1652 4.42062 18.7984 4.81114 19.1889C5.20167 19.5794 5.83483 19.5794 6.22535 19.1889L12 13.4142L17.7747 19.1889C18.1652 19.5794 18.7984 19.5794 19.1889 19.1889C19.5794 18.7984 19.5794 18.1652 19.1889 17.7747L13.4142 12L19.189 6.2253C19.5795 5.83477 19.5795 5.20161 19.189 4.81108C18.7985 4.42056 18.1653 4.42056 17.7748 4.81108L12 10.5858L6.2253 4.81108Z"\n              fill="currentColor"\n            ></path>\n          </svg>\n        </div>');var c=a.querySelector(".sa-live-call-widget-close-pop-up-video-btn");c.addEventListener("click",(function(){a.classList.remove("sa-live-call-widget-btn-container-pop-up-video"),I5=!0,c.remove()}))}}},N5=function(e,t){var n,r=D()[e],i=null===(n=U()[e].intentsData)||void 0===n?void 0:n.tree_intends;if(i&&0!==(null==i?void 0:i.length)){var o=t.querySelector(".sa-live-call-widget-intent-container"),a="",s="";i.forEach((function(e,t){var n;a+='\n      <div class="sa-live-call-widget-intent-box" data-isParent="true"  data-id="'.concat(e.id,'" data-name="').concat(e.name,'" data-videoUrl="').concat(null===(n=e.media)||void 0===n?void 0:n.url,'">\n        <span class="sa-live-call-widget-intent-number"\n          >').concat(String.fromCharCode(65+t),"</span\n        >\n        <span>").concat(e.name,"</span>\n      </div>\n    "),e.children.length&&e.children.forEach((function(t,n){var r;s+='\n          <div class="sa-live-call-widget-intent-box sa-live-call-widget-child-intent-box" data-parentId="'.concat(e.id,'" data-id="').concat(t.id,'" data-name="').concat(t.name,'" data-videoUrl="').concat(null===(r=t.media)||void 0===r?void 0:r.url,'">\n            <span class="sa-live-call-widget-intent-number"\n              >').concat(String.fromCharCode(65+n),"</span\n            >\n            <span>").concat(t.name,"</span>\n          </div>\n        ")}))})),o.insertAdjacentHTML("beforeend",a),o.insertAdjacentHTML("beforeend",s);var c=t.querySelectorAll(".sa-live-call-widget-intent-box"),l=t.querySelector(".sa-live-call-widget-intent-box-home"),d=t.querySelector(".sa-live-call-widget-intent-box-back"),u=t.querySelector("#sa-live-call-widget-hls-video"),p=t.querySelector(".sa-live-call-widget-intent-title"),h=function(e,t){e.classList.add("sa-live-call-widget-video-hidden"),e.addEventListener("transitionend",(function n(){e.removeEventListener("transitionend",n),e.src=t,e.load(),setTimeout((function(){e.classList.remove("sa-live-call-widget-video-hidden")}),10)}))};c.forEach((function(e,t){e.addEventListener("click",(function(t){if(l===t.currentTarget)return h(u,r.source_welcome_video_url),p.innerHTML="",p.style.display="none",e.style.display="none",void c.forEach((function(e){var t=e.getAttribute("data-isParent");e.style.display="true"==t?"flex":"none"}));if(d===t.currentTarget){var n,o=e.getAttribute("data-parentId"),a=i.find((function(e){return e.id===o}));return h(u,null===(n=a.media)||void 0===n?void 0:n.url),p.innerHTML=a.name,p.style.display="block",l.style.display="flex",d.style.display="none",c.forEach((function(e){e.getAttribute("data-parentId")===o&&(e.style.display="flex")})),void(d.style.display="none")}if(e.classList.contains("sa-live-call-widget-child-intent-box")){var s=e.getAttribute("data-parentId");d.setAttribute("data-parentId",s),l.style.display="none",d.style.display="flex",e.style.display="none"}var f=e.getAttribute("data-isParent"),m=e.getAttribute("data-id"),g=e.getAttribute("data-name"),v=e.getAttribute("data-videoUrl");h(u,v),p.innerHTML=g,p.style.display="block","true"==f&&(c.forEach((function(e){var t=e.getAttribute("data-parentId");e.style.display=t===m?"flex":"none"})),l.style.display="flex",d.style.display="none"),setTimeout((function(){p.style.display="none"}),11e3)}))}))}},P5=function(e,t,n){var r;return!(0===e.length||(null==n||null===(r=n.intents)||void 0===r?void 0:r.length)>0&&e.length<2)&&t},D5=function(e,t){var n,r,i=D()[e],a=U()[e],s=(a.form_data,i.source_welcome_video_url,a.is_agent_online),c=a.form_factor,l=a.parentElementId,d=a.isNotificationType,u="button"===c||!1,p="embed"===c||"true"===z("open")||!1,h=["c4136933-628e-4dc4-aca4-f07118ca9c69","ae50ffc9-33e2-41ed-a720-d13d4c596971","53fab8a5-35f0-403a-b907-5f402c6e8b2b","bf39d7e0-c129-4dbc-a29a-e97d90558e63","5f567d2b-5ae6-45f1-8f06-8c93f6881994","3f5208e0-c2af-4cf4-ad79-c6963db222c9"].includes(e)||["678290fe-0ca5-43cc-8842-7a7365429bb2","c30608b9-039d-4400-bce8-75be2a42cf8c","1b1d1e30-6934-475b-9a4b-d3c73b1116bd"].includes(i.client_id),f=s?i.live_conversation_types.filter((function(e){return e.length>0})):i.offline_conversation_types.filter((function(e){return e.length>0}));t.innerHTML+=T5({allow_trigger_messages:i.allow_trigger_messages,button_position:i.button_position,trigger_messages:i.trigger_messages,button_type:i.button_type,isIconButton:"icon"===i.button_type,isWelcomeImage:a.isWelcomeImage,isStreaming:a.is_streaming,streamingUrl:a.streaming_url+"&user_identity=widget_call_tile",source_welcome_video_url:i.short_video_url||i.source_welcome_video_url,source_image_url:i.source_image_url,buttonPositionOldClassName:(r=i.button_position,"bottom_right"===r?"safemeet-btn-bottom-right ":"bottom_left"===r?"safemeet-btn-bottom-left ":"top_left"===r?"safemeet-btn-top-left ":"safemeet-btn-top-right "),closeButton:O5()});var m=t.querySelector(".sa-live-call-widget-btn-container");t.querySelector(".sa-live-call-widget-close-btn").addEventListener("click",(function(){m.innerHTML="",m.style.display="none"}));var g=t.querySelector(".sa-live-call-widget-btn");!function(e,t){var n=D()[e].button_position;"bottom_right"===n?t.style.setProperty("--saLiveWidgetBtnPosition","auto 20px 20px auto"):"bottom_left"===n?t.style.setProperty("--saLiveWidgetBtnPosition","auto auto 20px 20px"):"top_left"===n?t.style.setProperty("--saLiveWidgetBtnPosition","20px auto auto 20px"):t.style.setProperty("--saLiveWidgetBtnPosition","20px 20px auto auto")}(e,t),L5(e,t),i.allow_trigger_messages&&0!==(null===(n=i.trigger_messages)||void 0===n?void 0:n.filter((function(e){return e.trim().length>0})).length)&&t5(e,t);var v=t.querySelector(".sa-live-call-widget-expanded"),_=s?i.live_cta_text:i.offline_cta_text;if(g.addEventListener("click",(function(){if(a=U()[e],M(S5({},e,E5(E5({},U()[e]),{},{isWidgetOpened:!0,widgetName:"liveCallButton"}))),C3(!0,null,e),m.style.display="none",e5(!0,e,t),L5(e,t,!0),v)v.style.display="flex",function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.querySelector("video#sa-live-call-widget-hls-video");r&&(n?r.play():r.pause())}(e,t),n5(e,t,!1);else{var n,r;if(t.insertAdjacentHTML("beforeend",C5({logo:i.watermark,chatFirstApproach:i.chat_first_approach,chatFirstApproachMessage:null==i?void 0:i.cta_configuration.chat_first_approach_message,ctaText:_,isWelcomeImage:a.isWelcomeImage,isStreaming:a.is_streaming,streamingUrl:a.streaming_url+"&user_identity=widget_call",sourceWelcomeVideo:i.source_welcome_video_url,intents:(null===(n=a.intentsData)||void 0===n||null===(r=n.intents)||void 0===r?void 0:r.length)>0&&a.intentsData.intents,verticalContainerClass:f.length<2?"sa-live-call-widget-intent-vertical-container":"",poweredBy:!a.addons.remove_powered_by,customPoweredBy:h||a.addons.custom_powered_by,customPoweredByData:h?{domain_name:"https://letsmapit.in/",domain_url:"Mktg by LetsMapIt"}:a.addons.custom_powered_by_value,isMuted:window.location.href.includes("/jump/")?"muted":""})),a.is_streaming)t.querySelector(".sa-live-call-widget-mute-unmute-video-btn").style.display="none";a.is_streaming||(k5(e,t,!0),x5(e,t,!1)),n5(e,t,!1),N5(e,t);var s=t.querySelector(".sa-live-call-widget-close-expanded-widget-btn");v=t.querySelector(".sa-live-call-widget-expanded"),"a62ba426-d527-4ba7-af51-fbe88d5bdd21"!==e&&"f7d7ffaa-d212-45bc-b97a-c92b5a43a051"!==e||v.classList.add("ThomasCookCustomization"),uY(o.url.SOCKET_URL).on("connect",(function(e){})),s.addEventListener("click",(function(){var n,r;d&&t.querySelector("#saleassist-notification-btn-one").classList.remove("hidden");var s=document.querySelector(".sa-live-call-widget-call-waiting-container"),c=U()[e].videoCallTimers;(Array.isArray(c)&&D$(c),s&&dX({url:o.url.SOURCE,path:"user_dropped/".concat(U()[e].conversation_id),onSuccess:function(e){},onFailure:function(e){console.error(e)}}),M(S5({},e,E5(E5({},U()[e]),{},{isWidgetOpened:!1,widgetName:U()[e].widgetName||"mainPanel",is_strike_yes_trigger:!1,is_strike_no_trigger:!1}))),C3(!0,null,e),v.style.display=p?"flex":"none",m.style.display=u||p?"none":"block",t.querySelector(".sa-live-call-widget-expanded-inner-wrapper").innerHTML=R5({chatFirstApproach:i.chat_first_approach,chatFirstApproachMessage:null==i?void 0:i.cta_configuration.chat_first_approach_message,ctaText:P5(f,_,a.intentsData),isWelcomeImage:a.isWelcomeImage,isStreaming:a.is_streaming,streamingUrl:a.streaming_url+"&user_identity=widget_call",sourceWelcomeVideo:i.source_welcome_video_url,intents:(null===(n=a.intentsData)||void 0===n||null===(r=n.intents)||void 0===r?void 0:r.length)>0&&a.intentsData.intents,verticalContainerClass:f.length<2?"sa-live-call-widget-intent-vertical-container":""}),a.is_streaming)&&(t.querySelector(".sa-live-call-widget-mute-unmute-video-btn").style.display="none");a.is_streaming||(k5(e,t,!1),x5(e,t,window.location.href.includes("/jump/")||p)),(window.location.pathname.includes("jump")||p)&&n5(e,t,!1),L5(e,t),e5(!1,e,t),N5(e,t);var l=new CustomEvent("widgetClosed",{detail:{widgetId:e}});window.dispatchEvent(l),document.querySelector(".strike-incoming-call-popup")&&(document.querySelector(".strike-incoming-call-popup").style.display="block")}))}!function(e){var t=document.querySelectorAll(".saleassist");t.length>1&&t.forEach((function(t){if(!t.id.includes(e)){var n=t.querySelector(".sa-live-call-widget-expanded");"flex"===(null==n?void 0:n.style.display)&&t.querySelector(".sa-live-call-widget-close-expanded-widget-btn").click()}}))}(e);var c=new CustomEvent("widgetOpened",{detail:{widgetId:e}});window.dispatchEvent(c),document.querySelector(".strike-incoming-call-popup")&&(document.querySelector(".strike-incoming-call-popup").style.display="none")})),hX("widget_call_".concat(e))){g.click();var y=t.querySelector(".sa-live-call-widget-expanded-inner-wrapper");y.innerHTML="",k$(e,t,y,hX("widget_call_".concat(e)).message_type,!1)}if(u){var w=document.querySelector("#".concat(l));m.style.display="none",w?w.addEventListener("click",(function(){return g.click()})):(console.error("Please provide parent element id for the button"),g.click());var b=t.querySelector("#sa-live-call-widget-video_call-btn"),E=t.querySelector(".sa-live-call-widget-expanded-inner-wrapper");["www.irth.in","irth.in"].includes(window.location.hostname)&&s&&b&&(E.innerHTML="",b.click(),A5=!0)}if(p){var S,T=document.querySelector("#".concat(l));null==T||null===(S=T.classList)||void 0===S||S.add("sa-live-call-widget-embed-page"),m.style.display="none",g.click(),"true"!==z("open")&&(v.style.position="relative",v.style.inset="unset"),null==T||T.appendChild(t)}},M5=function(e,t){var n=t.querySelector(".sa-live-call-widget-go-back-btn");A5?n.style.cursor="not-allowed":n.addEventListener("click",(function(){if(["7ca97a0f-02eb-4c98-bbd5-8d51163cdfb2","be030784-c08f-480c-a7e4-04e955e876b8"].includes(e))return y5(e,"saleassistEmbed",t),void t.querySelector(".sa-live-call-widget-expanded").remove();t.querySelector(".sa-live-call-widget-close-expanded-widget-btn").click()}))},U5=function(e,t,n,r){if(e){var i=e.includes("#")?e:o.colors[e];0===i.indexOf("#")&&(i=i.slice(1));var a=parseInt(i.slice(0,2),16),s=parseInt(i.slice(2,4),16),c=parseInt(i.slice(4,6),16);return i=t&&a>220&&s>220&&c>220?"#ffffff":"#"+i,n?(0===i.indexOf("#")&&(i=i.slice(1)),"rgba("+parseInt(i.slice(0,2),16)+", "+parseInt(i.slice(2,4),16)+", "+parseInt(i.slice(4,6),16)+(null!==r?", "+r:", 1")+")"):i}return o.colors.saleassist};function j5(e,t){return t=t||2,(new Array(t).join("0")+e).slice(-t)}var V5=function(e,t){t.style.setProperty("--themeColor",U5(e,!0),"important"),t.style.setProperty("--themeColorWithOpacity",U5(e,!0)+"60","important"),t.style.setProperty("--themeColorWithFadeOpacity",U5(e,!0)+"0d","important"),t.style.setProperty("--invertColor",function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.colors.saleassist,i=arguments.length>1?arguments[1]:void 0,a=r.includes("#")?r:o.colors[r];if(0===(null===(e=a)||void 0===e?void 0:e.indexOf("#"))&&(a=a.slice(1)),3===(null===(t=a)||void 0===t?void 0:t.length)&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),6!==(null===(n=a)||void 0===n?void 0:n.length))throw new Error("Invalid HEX color.");var s=parseInt(a.slice(0,2),16),c=parseInt(a.slice(2,4),16),l=parseInt(a.slice(4,6),16);return i?.299*s+.587*c+.114*l>186?"#000000":"#FFFFFF":(s=(255-s).toString(16),c=(255-c).toString(16),l=(255-l).toString(16),"#"+j5(s)+j5(c)+j5(l))}(e,!0),"important")};function B5(e){return B5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B5(e)}function F5(){F5=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==B5(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function G5(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var H5=function(e,t){return Object.keys(t).some((function(t){return e.startsWith(t)}))},q5=function(e,t){if(!t||0===t.length)return!0;var n=["na","000000"],r=Object.values(e).map((function(e){return String(e).toLowerCase()})).filter((function(e){return e&&!n.includes(e)}));return t.some((function(e){return r.includes(String(e).toLowerCase())}))},W5=function(e,t){var n=F("page_visits")||{};n[e]?n[e]++:n[e]=1,B("page_visits",n),n[e]},z5=function(e){return F("form_data_".concat(e))},K5=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=0,i=setInterval((function(){r++,B("current_waiting_time",r),r>=t&&(clearInterval(i),"function"==typeof n&&n())}),1e3);window.addEventListener("beforeunload",(function(){clearInterval(i)}))},Y5=function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){G5(o,r,i,a,s,"next",e)}function s(e){G5(o,r,i,a,s,"throw",e)}a(void 0)}))}}(F5().mark((function e(){var t,n,r,i,o;return F5().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"6798427d03e796",t="01PewOEfxNItSmsOSAKQqN:0S3GYC8k710Ohwmv2e0gs0",e.next=5,fetch("https://api.ipify.org?format=json");case 5:return n=e.sent,e.next=8,n.json();case 8:return r=e.sent,e.next=11,fetch("https://ip.bigpicture.io/v2/companies/ip?ip=".concat(r.ip),{method:"GET",headers:{Authorization:t}});case 11:if((i=e.sent).ok){e.next=14;break}throw new Error("BigPicture request failed");case 14:return e.next=16,i.json();case 16:o=e.sent,B("ipAndCompanyData",{ip:r.ip,org:o}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.error("Error fetching user location and IP:",e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),J5=function(e,t){var n=F("exit_intent_counter")||{};n[e]||(n[e]=0,B("exit_intent_counter",n));var r=function(){n[e]++,B("exit_intent_counter",n),n[e]};document.addEventListener("mouseleave",(function(e){e.clientY<0&&r()})),window.addEventListener("beforeunload",(function(e){r()}))};function X5(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z5(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z5(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Q5=__webpack_require__(4704),$5=function(e,t){var n=D()[e].notification_type;t.innerHTML+=Q5({notificationPosition:n.parentContainer.position,headerText:n.headerText.text,isCloseCtaIcon:"icon"===n.closeCtaText.type,closeIconBorderRadius:n.closeCtaButton.borderRadius,closeIconBackground:n.closeCtaButton.background,closeIconColor:n.closeCtaButton.color,bodyText:n.bodyText.text,mainCtaText:n.mainCtaText.text,closeCtaText:n.closeCtaText.text,notificationBtnPosition:n.notificationButton.position,isColorType:"color"===n.notificationButtonText.type,isImageType:"image"===n.notificationButtonText.type,isVideoType:"video"===n.notificationButtonText.type,notificationButtonText:n.notificationButtonText}),t4(t,".saleassist-notification",n.parentContainer),t4(t,".notification-wrapper",n.contentContainer),t4(t,".notification-title",n.headerContainer),t4(t,".notification-content",n.bodyContainer),t4(t,".notification-buttons-wrapper",n.ctaContainer),t4(t,"#notification-action-btn",n.mainCtaButton),t4(t,"#notification-close-btn.close-button",n.closeCtaButton),t4(t,".saleassist-notification-btn",n.notificationButton),D5(e,t),e4(t)},e4=function(e){var t=e.querySelector("#saleassist-notification-one"),n=e.querySelector("#notification-action-btn");n.onclick=function(){return t.classList.add("hidden")};var r=e.querySelector("#saleassist-notification-btn-one");r.onclick=function(){r.classList.add("hidden"),n.click()},e.querySelector("#notification-close-btn").onclick=function(){t.classList.toggle("hidden"),r.classList.toggle("hidden")}},t4=function(e,t,n){var r=e.querySelector(t);r&&Object.entries(n).forEach((function(e){var t=X5(e,2),n=t[0],i=t[1];n.startsWith("--")?r.style.setProperty(n,i):r.style[n]="number"==typeof i?"".concat(i,"px"):i}))};function n4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?n4(Object(n),!0).forEach((function(t){c4(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n4(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i4(){i4=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==d4(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function o4(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function a4(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){o4(o,r,i,a,s,"next",e)}function s(e){o4(o,r,i,a,s,"throw",e)}a(void 0)}))}}function s4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l4(r.key),r)}}function c4(e,t,n){return(t=l4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l4(e){var t=function(e,t){if("object"!==d4(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d4(t)?t:String(t)}function d4(e){return d4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d4(e)}var u4=__webpack_require__(4271),p4=__webpack_require__(5382),h4=(__webpack_require__(7549),__webpack_require__(866)),f4=__webpack_require__(753);function m4(e){var t,n,r,i=e.description||"";try{i=decodeURIComponent(i)}catch(e){}return e.specs=(t=i,n={},(r=(new DOMParser).parseFromString(t,"text/html")).querySelectorAll("table tr").forEach((function(e){var t=e.querySelectorAll("th,td");if(t.length>=2){var r=t[0].textContent.trim().replace(/\s+/g," "),i=t[1].textContent.trim().replace(/\s+/g," ");r&&(n[r]=i)}})),Object.keys(n).length||r.body.textContent.split(/\r?\n/).forEach((function(e){var t=e.trim().match(/^([^:]+):\s*(.+)$/);t&&(n[t[1].trim()]=t[2].trim())})),n),e}function g4(e,t){for(var n in t)t[n]&&"object"===d4(t[n])&&!Array.isArray(t[n])?e[n]=g4(e[n]||{},t[n]):e[n]=t[n];return e}var v4=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.id?(this.widgetID=t.id,this.form_factor=t.form_factor,this.parentElementId=t.parentElementId,this.notificationType=t.notificationType,this.sessionContext=(null==t?void 0:t.sessionContext)||[{}],this.socket=null,this.socketConnected=!1,this.duration=0,this.country="",this.state="",this.city="",this.pincode="",this.init()):console.warn("SaleAssist: Please pass an id to initialize the SDK")}var t,n,r,i,a,s,c,d,u,p,h;return t=e,n=[{key:"getOnlineStatus",value:(h=a4(i4().mark((function e(){var t;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.get(o.url.SOURCE,"/".concat(this.widgetID).concat(F("form_data_".concat(this.widgetID))?"/"+F("form_data_".concat(this.widgetID)).form_id:"","/can_queue"));case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return h.apply(this,arguments)})},{key:"getLivestreamingDetails",value:(p=a4(i4().mark((function e(){var t;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.get(o.url.SOURCE,"/live_streaming_detail/".concat(this.widgetID));case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return p.apply(this,arguments)})},{key:"getAddOns",value:(u=a4(i4().mark((function e(){var t;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.get(o.url.SOURCE,"/addons/".concat(this.widgetID));case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return u.apply(this,arguments)})},{key:"getSourceData",value:(d=a4(i4().mark((function e(){var t,n;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.get(o.url.SOURCE,"/"+this.widgetID);case 2:if(t=e.sent)try{n="",n="video_icon"===t.button_type||"video_message"===t.button_type?"video_icon":t.button_type,M(c4({},this.widgetID,r4(r4({},U()[this.widgetID]),{},{impressionType:n,isWelcomeImage:/\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(t.source_welcome_video_url)})))}catch(e){console.error(e)}return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"getIntents",value:(c=a4(i4().mark((function e(){var t;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.get(o.url.SOURCE,"/".concat(this.widgetID,"/video-workflows"));case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return c.apply(this,arguments)})},{key:"getProducts",value:(s=a4(i4().mark((function e(){var t;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.get(o.url.SOURCE,"/fetch_products/".concat(this.widgetID));case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return s.apply(this,arguments)})},{key:"setSessionContext",value:(a=a4(i4().mark((function e(t,n){var r,i,a,s,c,d,u,p,h,f,m,g;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=["30d6c23b-a8aa-4bd5-8d30-2d84a7c3b002","25172ce8-2701-454a-b4eb-56655d321a00"],i=window.location.pathname,a=F("session_data_".concat(this.widgetID)),s={},!r.includes(n)){e.next=21;break}return e.prev=5,e.next=8,fetch("".concat(i,".js"));case 8:return c=e.sent,e.next=11,c.json();case 11:d=e.sent,u=m4(d),s=(null==u?void 0:u.specs)||{},["available","created_at","description","handle","id","price","published_at","specs","title","variant","vendor","type"].forEach((function(e){e in d&&(s[e]="price"===e?d[e]/100:d[e])})),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),console.warn("Error enriching product with specs:",e.t0);case 21:if(p=Array.isArray(t)&&t.length>0,h=Object.keys(s).length>0,f={},p&&t.forEach((function(e){f=g4(f,e)})),m={},h&&(m.enriched_product_specs=s),!((g=Object.keys(f).length>0||h?[g4(m,f)]:[]).length>0)){e.next=39;break}return e.prev=29,e.next=32,l.post(o.url.SOURCE,"/set_AI_sessionContext",{client_id:n,source_id:this.widgetID,session_id:a,page_url:i,context:g});case 32:e.next=37;break;case 34:e.prev=34,e.t1=e.catch(29),console.error("Error posting session context:",e.t1);case 37:e.next=40;break;case 39:console.log("Skipping API call: Empty final context");case 40:case"end":return e.stop()}}),e,this,[[5,18],[29,34]])}))),function(e,t){return a.apply(this,arguments)})},{key:"init",value:(i=a4(i4().mark((function t(){var n,r,i,o,a,s,c,l,d,u,p,h,f,m,g,v,_,y,w,b,E,S,T,C,R,O,I,A,k,x=this;return i4().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=document.querySelector("#saleassist-widget-".concat(this.widgetID)))){t.next=5;break}return r.querySelector(".sa-live-call-widget-btn").click(),t.abrupt("return");case 5:return t.next=7,this.getSourceData();case 7:if(this.sourceData=t.sent,i=this.sourceData.source_exclude_url.split("\n"),o=i.some((function(e){return e.length>0&&window.location.pathname.startsWith(e)})),e.urlChangeListenerAdded||(e.urlChangeListenerAdded=!0,a=history.pushState,s=history.replaceState,history.pushState=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.apply(history,t),window.dispatchEvent(new Event("urlchange"))},history.replaceState=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s.apply(history,t),window.dispatchEvent(new Event("urlchange"))},c=function(){var e=a4(i4().mark((function e(){var t,n;return i4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.some((function(e){return e.length>0&&window.location.pathname.startsWith(e)})),n=document.querySelector("#saleassist-widget-".concat(x.widgetID)),!t){e.next=5;break}return n&&n.remove(),e.abrupt("return");case 5:if(n){e.next=8;break}return e.next=8,x.init();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),window.addEventListener("urlchange",c),window.addEventListener("popstate",c)),!o){t.next=13;break}return t.abrupt("return");case 13:return(l=document.createElement("div")).id="saleassist-widget-".concat(this.widgetID),l.classList.add("saleassist"),document.body.appendChild(l),"bc625866-ac2d-4c04-baf1-42f9fd1dbdaa"===(null===(n=this.sourceData)||void 0===n?void 0:n.client_id)&&l.classList.add("client-bc625866-ac2d-4c04-baf1-42f9fd1dbdaa"),F("session_data_".concat(this.widgetID))||B("session_data_".concat(this.widgetID),G()),P(c4({},this.widgetID,r4(r4({},this.sourceData),{},{offline_conversation_types:"shoppable_video"===this.sourceData.button_type?["shoppable_video"]:this.sourceData.offline_conversation_types,live_conversation_types:"shoppable_video"===this.sourceData.button_type?["shoppable_video"]:this.sourceData.live_conversation_types}))),t.t0=M,t.t1=c4,t.t2={},t.t3=this.widgetID,t.t4=r4,t.t5=r4({},U()[this.widgetID]),t.t6={},t.next=29,this.getOnlineStatus();case 29:return t.t7=t.sent,t.next=32,this.getAddOns();case 32:if(t.t8=t.sent,t.t9=this.form_factor,t.t10=this.parentElementId,t.t11=this.notificationType,t.t12=F("form_data_".concat(this.widgetID)),t.t13=window.location.href.includes("embed=true")?"embed":void 0,t.t14={is_agent_online:t.t7,addons:t.t8,form_factor:t.t9,parentElementId:t.t10,isNotificationType:t.t11,form_data:t.t12,widgetFormFactor:t.t13},t.t15=(0,t.t4)(t.t5,t.t6,t.t14),t.t16=(0,t.t1)(t.t2,t.t3,t.t15),(0,t.t0)(t.t16),V5(this.sourceData.theme,l),l.style.setProperty("--saLiveCallWidgetDefaultContainerPaddingTop",this.sourceData.watermark&&this.sourceData.watermark.length>0?"51px":"15px","important"),d=F("receivedReverseTrigger"),u=F("receivedAutoReverseTrigger"),p=F("userLocation"),h=D()[this.widgetID],this.setSessionContext(this.sessionContext,h.client_id),f=h.is_reverse_trigger_enabled,m=h.is_global_auto_reverse_trigger_enabled,g=h.whitelisted_pages,v=h.whitelisted_locations,h.cookies_header,h.local_storage_header,_=h.strike_timeout,y=h.strike_auto_timeout,w=h.widget_visibility,f&&!d&&(B("receivedReverseTrigger",0,_,!0),d=F("receivedReverseTrigger")),!m&&!this.isAgentAutoReverseTriggerEnabled()||u||(B("receivedAutoReverseTrigger",0,y,!0),u=F("receivedAutoReverseTrigger")),0!==d){t.next=80;break}if(p){t.next=78;break}return t.prev=54,t.next=57,fetch("https://ipapi.co/json/");case 57:return b=t.sent,t.next=60,b.json();case 60:E=t.sent,this.country=E.country_name,this.state=E.region,this.city=E.city,this.pincode=E.postal,B("userLocation",{country:this.country,state:this.state,city:this.city,pincode:this.pincode}),p=F("userLocation"),t.next=78;break;case 69:t.prev=69,t.t17=t.catch(54),console.warn("IP-based location failed. We won't use geolocation fallback."),this.country="NA",this.state="NA",this.city="NA",this.pincode="000000",B("userLocation",{country:this.country,state:this.state,city:this.city,pincode:this.pincode}),p=F("userLocation");case 78:S=window.location.pathname,q5(p,v)&&H5(S,g)&&((T=Object.keys(g).find((function(e){return S.startsWith(e)})))||(T="/"),this.setupIdleTimeHandler(g[T][7]),this.hideWidget(w,l),J5(S,g[T][2]),W5(S,g[T][1]),K5(S,g[T][0]),Y5(),(C=z5(this.widgetID))&&B("form_data",C),this.shouldEmitUserData(T,g)&&this.startDataTransmission(l,g[T][3]));case 80:if(!m&&!this.isAgentAutoReverseTriggerEnabled()||u&&0!==u){t.next=108;break}if(p){t.next=106;break}return t.prev=82,t.next=85,fetch("https://ipapi.co/json/");case 85:return R=t.sent,t.next=88,R.json();case 88:O=t.sent,this.country=O.country_name,this.state=O.region,this.city=O.city,this.pincode=O.postal,B("userLocation",{country:this.country,state:this.state,city:this.city,pincode:this.pincode}),p=F("userLocation"),t.next=106;break;case 97:t.prev=97,t.t18=t.catch(82),console.warn("IP-based location failed. We won't use geolocation fallback."),this.country="NA",this.state="NA",this.city="NA",this.pincode="000000",B("userLocation",{country:this.country,state:this.state,city:this.city,pincode:this.pincode}),p=F("userLocation");case 106:I=window.location.pathname,q5(p,v)&&H5(I,g)&&((A=Object.keys(g).find((function(e){return I.startsWith(e)})))||(A="/"),this.setupIdleTimeHandler(g[A][7]),this.hideWidget(w,l),J5(I,g[A][6]),W5(I,g[A][5]),K5(I,g[A][4],(function(){x.shouldTriggerAutoPopUp(A,g)&&(x.startDataTransmission(l,g[A][3]),x.showIncomingAutoPopUp(l))})),Y5(),(k=z5(this.widgetID))&&B("form_data",k));case 108:window.addEventListener("beforeunload",(function(){x.closeSocketConnection()})),["7ca97a0f-02eb-4c98-bbd5-8d51163cdfb2","be030784-c08f-480c-a7e4-04e955e876b8"].includes(this.widgetID)?y5(this.widgetID,this.parentElementId,l):this.notificationType?$5(this.widgetID,l):D5(this.widgetID,l);case 110:case"end":return t.stop()}}),t,this,[[54,69],[82,97]])}))),function(){return i.apply(this,arguments)})},{key:"isAgentAutoReverseTriggerEnabled",value:function(){return 1===F("isAgentAutoReverseTriggerEnabled")}},{key:"hideWidget",value:function(e,t){setTimeout((function(){if(!e){var n=t.querySelector(".sa-live-call-widget-btn-container");n&&(n.style.display="none")}}),500)}},{key:"setupIdleTimeHandler",value:function(e){var t=this;setTimeout((function(){t.stopDataTransmission()}),1e3*e)}},{key:"shouldEmitUserData",value:function(e,t){var n=F("page_visits")||{},r=F("exit_intent_counter")||{},i=window.location.pathname,o=F("current_waiting_time")>t[e][0],a=n[i]>t[e][1],s=r[i]>t[e][2];return o||a||s}},{key:"shouldTriggerAutoPopUp",value:function(e,t){var n=F("page_visits")||{},r=F("exit_intent_counter")||{},i=window.location.pathname,o=F("current_waiting_time")>=t[e][4],a=n[i]>t[e][5],s=r[i]>t[e][6];return o||a||s}},{key:"collectUserData",value:function(){var e=F("ipAndCompanyData"),t=F("userLocation"),n=D()[this.widgetID],r=n.cookies_header||[],i=n.local_storage_header||[],o={};r.forEach((function(e){o[e]=hX(e)}));var a={};i.forEach((function(e){a[e]=F(e)}));var s="",c="";e&&(s=e.ip,c=e.org);var l=window.location.pathname,d=Object.keys(null==n?void 0:n.whitelisted_pages).find((function(e){return l.startsWith(e)}));return d||(d="/"),{current_page:window.location.pathname,page_visit_count:F("page_visits")[l],exit_intent_count:F("exit_intent_counter")[l],country:t.country||"",state:t.state,city:t.city,pincode:t.pincode,form_data:F("form_data"),duration:this.duration,ip:s,ip_to_company_data:c,cookies_data:o,local_storage_data:a,priority:n.whitelisted_pages[d][8],widget_id:this.widgetID,is_global_auto_reverse_trigger_enabled:n.is_global_auto_reverse_trigger_enabled}}},{key:"sendUserDataToSocket",value:function(e){if(this.socketConnected&&this.socket){var t=F("session_data_".concat(this.widgetID));this.socket.emit("user_data",{session_id:t,userData:e})}}},{key:"initSocketConnection",value:function(e,t){var n=this;this.socket=uY(o.url.STRIKE_SOCKET);var r=F("session_data_".concat(this.widgetID)),i=D()[this.widgetID];this.socket.on("connect",(function(){n.socket.emit("widget_connect",{session_id:r,widget_id:n.widgetID,is_global_auto_reverse_trigger_enabled:i.is_global_auto_reverse_trigger_enabled}),n.socketConnected=!0,"function"==typeof t&&t()})),this.socket.on("disconnect",(function(){n.socketConnected=!1})),this.socket.on("meeting_url",(function(t){var r=t.meetingUrl;n.showIncomingCallPopUp(e,r)})),this.socket.on("stop_tracking",(function(){n.stopDataTransmission()})),this.socket.on("agent_reject",(function(){})),this.socket.on("local_auto_popup_enabled",(function(t){n.isAgentAutoReverseTriggerEnabled=!0,B("isAgentAutoReverseTriggerEnabled",1);var r=D()[n.widgetID].whitelisted_pages;window.location.pathname,n.shouldTriggerAutoPopUp(r)&&n.showIncomingAutoPopUp(e)})),this.socket.on("local_auto_popup_disabled",(function(e){n.isAgentAutoReverseTriggerEnabled=!1,B("isAgentAutoReverseTriggerEnabled",0)}))}},{key:"startDataTransmission",value:function(e,t){var n=this;this.initSocketConnection(e,(function(){n.durationIntervalId=setInterval((function(){n.duration++}),1e3),n.dataTransmissionIntervalId=setInterval((function(){var e=n.collectUserData();e.duration=n.duration,n.sendUserDataToSocket(e)}),1e3*t)}))}},{key:"stopDataTransmission",value:function(){this.dataTransmissionIntervalId&&(clearInterval(this.dataTransmissionIntervalId),this.dataTransmissionIntervalId=null),this.durationIntervalId&&(clearInterval(this.durationIntervalId),this.durationIntervalId=null),this.closeSocketConnection()}},{key:"showIncomingCallPopUp",value:function(e,t){var n=this,r=F("session_data_".concat(this.widgetID));this.socket&&this.socketConnected&&this.socket.emit("call_popup_shown",{session_id:r,widget_id:this.widgetID});var i=D()[this.widgetID],o=this.getPositionClass(i.button_position),a=i.source_welcome_video_url,s=p4({positionClass:o,videoUrl:a}),c=e.querySelector(".sa-live-call-widget-btn-container");c&&"none"!==c.style.display&&(c.style.display="none");var l=document.createElement("div");l.innerHTML=s,document.body.appendChild(l),document.getElementById("popup-yes").addEventListener("click",(function(){document.body.removeChild(l),n.handleAcceptCall(e,t)})),document.getElementById("popup-no").addEventListener("click",(function(){document.body.removeChild(l),n.handleRejectCall(e,i)})),this.socket.on("agent_reject",(function(){document.body.removeChild(l)}))}},{key:"getPositionClass",value:function(e){switch(e){case"bottom_right":default:return"bottom-right";case"bottom_left":return"bottom-left";case"top_right":return"top-right";case"top_left":return"top-left"}}},{key:"handleAcceptCall",value:function(e,t){if(t){var n=D()[this.widgetID],r=F("session_data_".concat(this.widgetID));this.socket&&this.socketConnected&&this.socket.emit("user_accept",{session_id:r}),B("receivedReverseTrigger",1,n.strike_timeout,!0);var i=e.querySelector(".sa-live-call-widget-btn");i&&i.click(),e.querySelector(".sa-live-call-widget-expanded-inner-wrapper").innerHTML=u4();var o=document.getElementById("meeting-iframe-container"),a=document.getElementById("meeting-iframe");o&&a&&(o.style.display="block",a.src=t,a.allow="microphone *; camera *"),this.stopDataTransmission()}}},{key:"handleRejectCall",value:function(e,t){var n=F("session_data_".concat(this.widgetID));t.source_welcome_video_url,this.socket&&this.socketConnected&&this.socket.emit("user_reject",{session_id:n}),B("receivedReverseTrigger",1,t.strike_timeout,!0),this.stopDataTransmission();var r=e.querySelector(".sa-live-call-widget-btn");r&&r.click(),e.querySelector(".sa-live-call-widget-expanded-inner-wrapper"),n5(this.widgetID,e,!0)}},{key:"showIncomingAutoPopUp",value:function(e){var t=this,n=F("session_data_".concat(this.widgetID));this.socket&&this.socketConnected&&this.socket.emit("auto_popup_shown",{session_id:n,widget_id:this.widgetID});var r,i=D()[this.widgetID],o=this.getPositionClass(i.button_position),a=i.source_welcome_video_url;r=["83259b9c-6d2d-4c8c-bdeb-c221d048143d","10b07b83-c8e3-4b74-8c06-3eb5923794af"].includes(i.client_id)?f4({positionClass:o}):h4({positionClass:o,videoUrl:a}),setTimeout((function(){var n,o=e.querySelector(".sa-live-call-widget-btn-container");o&&(o.style.display="none");var a=document.createElement("div");a.innerHTML=r,document.body.appendChild(a),"flex"===(null===(n=document.querySelector(".sa-live-call-widget-expanded"))||void 0===n?void 0:n.style.display)&&(document.querySelector(".strike-incoming-call-popup").style.display="none"),document.getElementById("popup-close").addEventListener("click",(function(){var n=document.querySelector("#saleassist-widget-".concat(t.widgetID," .sa-live-call-widget-btn"));document.body.removeChild(a),o&&"none"===o.style.display&&(o.style.display=""),"widget"===i.strike_no?null==n||n.click():"none"!==i.strike_no&&(M(c4({},t.widgetID,r4(r4({},U()[t.widgetID]),{},{is_strike_no_trigger:!0}))),null==n||n.click()),t.handleRejectAutoPopUp(e)})),document.getElementById("popup-whatsapp").addEventListener("click",(function(){var n=document.querySelector("#saleassist-widget-".concat(t.widgetID," .sa-live-call-widget-btn"));if(document.body.removeChild(a),o&&"none"===o.style.display&&(o.style.display=""),"whatsapp"===i.strike_yes){var r=t.sourceData.whatsapp_number||"9315431137",s=encodeURIComponent("Hello, I wanted to know more about your product"),c="https://wa.me/".concat(r,"?text=").concat(s);window.open(c,"_blank")}else"widget"===i.strike_yes||M(c4({},t.widgetID,r4(r4({},U()[t.widgetID]),{},{is_strike_yes_trigger:!0}))),null==n||n.click();t.handleAcceptAutoPopUp(e)}))}),500)}},{key:"handleAcceptAutoPopUp",value:function(e){var t=D()[this.widgetID],n=F("session_data_".concat(this.widgetID)),r=this.collectUserData();r.duration=this.duration,this.socket&&this.socketConnected&&this.socket.emit("auto_trigger_accept",{session_id:n,userData:r}),B("receivedAutoReverseTrigger",1,t.strike_auto_timeout,!0),this.stopDataTransmission()}},{key:"handleRejectAutoPopUp",value:function(e){var t=D()[this.widgetID],n=F("session_data_".concat(this.widgetID)),r=this.collectUserData();r.duration=this.duration,this.socket&&this.socketConnected&&this.socket.emit("auto_trigger_reject",{session_id:n,userData:r}),B("receivedAutoReverseTrigger",1,t.strike_auto_timeout,!0),this.stopDataTransmission()}},{key:"closeSocketConnection",value:function(){this.socket&&this.socketConnected&&(this.socket.disconnect(),this.socketConnected=!1,this.stopDataTransmission())}}],n&&s4(t.prototype,n),r&&s4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c4(v4,"urlChangeListenerAdded",!1);const _4=v4;var y4=__webpack_require__(7484),w4=__webpack_require__.n(y4);function b4(e){return b4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b4(e)}function E4(){E4=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:b(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function h(){}function f(){}var m={};c(m,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(R([])));v&&v!==t&&n.call(v,o)&&(m=v);var _=f.prototype=p.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==b4(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=f,r(_,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=c(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),c(_,s,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function S4(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function T4(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){S4(o,r,i,a,s,"next",e)}function s(e){S4(o,r,i,a,s,"throw",e)}a(void 0)}))}}function C4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==b4(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==b4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===b4(o)?o:String(o)),r)}var i,o}var R4=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event_name=t.event_name,this.data=t.data,this.widgetID=ket.widgetID,this.init()}var t,n,r,i,a;return t=e,n=[{key:"saveEvent",value:(a=T4(E4().mark((function e(t){var n,r;return E4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,l.get(o.url.EVENT,"?".concat(t));case 4:r=e.sent,n=r,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(e){return a.apply(this,arguments)})},{key:"init",value:(i=T4(E4().mark((function e(){var t,n,r,i,o;return E4().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=D()[this.widgetID],n=U()[this.widgetID],r=F("session_data_".concat(this.widgetID)),!(n.form_data&&n.form_data.people_id&&r)){e.next=8;break}return i={people_id:n.form_data.people_id,client_id:t.client_id,source_id:t.id,session_id:r,event:this.event_name,data:JSON.stringify(this.data),z:w4()().valueOf(),source_referrer:window?window.location.href:""},o=Object.keys(i).map((function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(i[e]))})).join("&"),e.next=8,this.saveEvent(o);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],n&&C4(t.prototype,n),r&&C4(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const O4=R4;"undefined"!=typeof window&&(window.saleassist=window.saleassist||{},window.saleassist.mountWidget=function(e){var t=e.id,n=e.form_factor,r=e.parentElementId,i=e.notificationType,o=e.sessionContext;return"b96b666f-f160-47cb-960c-5b8506774d85"===t&&I4(),new _4({id:t,form_factor:n,parentElementId:r,notificationType:i,sessionContext:o})},window.EmbeddableWidget=window.saleassist||{},window.EmbeddableWidget.mount=function(e){var t=e.source_key,n=e.form_factor,r=e.parentElementId,i=e.notificationType,o=e.sessionContext;return new _4({id:t,form_factor:n,parentElementId:r,notificationType:i,sessionContext:o})},window.saleassist.track=function(e,t,n){return new O4({event_name:e,data:t,widgetID:n})});var I4=function(){!function(e,t,n,r,i,o,a){e.fbq||(i=e.fbq=function(){i.callMethod?i.callMethod.apply(i,arguments):i.queue.push(arguments)},e._fbq||(e._fbq=i),i.push=i,i.loaded=!0,i.version="2.0",i.queue=[],(o=t.createElement(n)).async=!0,o.src="https://connect.facebook.net/en_US/fbevents.js",(a=t.getElementsByTagName(n)[0]).parentNode.insertBefore(o,a))}(window,document,"script"),fbq("init","824436206322717");var e=document.createElement("noscript");e.innerHTML='<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=824436206322717&ev=PageView&noscript=1"/>',document.body.appendChild(e)}})(),__webpack_exports__})()));